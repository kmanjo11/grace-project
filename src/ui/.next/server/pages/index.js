/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/index";
exports.ids = ["pages/index"];
exports.modules = {

/***/ "(pages-dir-node)/./api/apiClient.ts":
/*!**************************!*\
  !*** ./api/apiClient.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   API_ENDPOINTS: () => (/* binding */ API_ENDPOINTS),\n/* harmony export */   ApiError: () => (/* binding */ ApiError),\n/* harmony export */   ChatApi: () => (/* binding */ ChatApi),\n/* harmony export */   TradingApi: () => (/* binding */ TradingApi),\n/* harmony export */   addAuthHeaders: () => (/* binding */ addAuthHeaders),\n/* harmony export */   api: () => (/* binding */ api),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getAuthToken: () => (/* binding */ getAuthToken),\n/* harmony export */   removeAuthToken: () => (/* binding */ removeAuthToken),\n/* harmony export */   saveAuthToken: () => (/* binding */ saveAuthToken)\n/* harmony export */ });\n/**\n * API Client for Grace App\n * \n * Provides standardized error handling and response processing for all API calls.\n */ // Front api constant and robust resolver for base URL\nconst API_BASE_URL = \"http://localhost:9000\" || 0;\n// Resolve base URL; prefer env var, else use relative path to avoid CORS issues\nconst resolveBaseUrl = ()=>{\n    const envUrl = \"http://localhost:9000\";\n    if (envUrl && envUrl.trim() !== '') {\n        return envUrl.endsWith('/') ? envUrl.slice(0, -1) : envUrl;\n    }\n    // Fallback to relative base to use same-origin or dev proxy\n    return '';\n};\n// Auth token key for localStorage\nconst AUTH_TOKEN_KEY = 'grace_auth_token';\nconst ALT_TOKEN_KEY = 'grace_token';\n// Get auth token from storage (checks both session and local, and both keys)\nconst getAuthToken = ()=>{\n    if (false) {}\n    return null;\n};\n// Save auth token to localStorage under both keys for compatibility\nconst saveAuthToken = (token)=>{\n    if (false) {}\n};\n// Remove auth token from both storage locations and keys\nconst removeAuthToken = ()=>{\n    if (false) {}\n};\n// Add auth headers to request options\nconst addAuthHeaders = (options = {})=>{\n    const token = getAuthToken();\n    if (token) {\n        return {\n            ...options,\n            headers: {\n                ...options.headers,\n                'Authorization': `Bearer ${token}`,\n                'Content-Type': 'application/json'\n            }\n        };\n    }\n    return options;\n};\n// API Error types\nclass ApiError extends Error {\n    statusCode;\n    data;\n    constructor(message, statusCode, data){\n        super(message);\n        this.name = 'ApiError';\n        this.statusCode = statusCode;\n        this.data = data;\n    }\n}\n// API configuration - use environment variable if available, otherwise use relative path\n// Ensure API_BASE_URL ends with a slash (kept for backward compatibility)\nconst getBaseUrl = ()=>{\n    const base = API_BASE_URL;\n    if (base && base.endsWith('/')) {\n        return base.slice(0, -1);\n    }\n    return base;\n};\n// API endpoints constants\nconst API_ENDPOINTS = {\n    AUTH: {\n        LOGIN: '/api/auth/login',\n        REGISTER: '/api/auth/register',\n        VERIFY_TOKEN: '/api/auth/verify',\n        LOGOUT: '/api/auth/logout',\n        REFRESH_TOKEN: '/auth/refresh-token',\n        FORGOT_PASSWORD: '/api/auth/forgot-password',\n        RESET_PASSWORD: '/api/auth/reset-password'\n    },\n    USER: {\n        PROFILE: '/api/user/profile',\n        LEVERAGE_POSITIONS: '/api/user/leverage_positions',\n        SPOT_POSITIONS: '/api/user/spot_positions',\n        POSITION_HISTORY: '/api/user/position_history',\n        TRADE_HISTORY: '/api/user/trade_history',\n        LIMIT_ORDERS: '/api/limit-orders'\n    },\n    WALLET: {\n        DATA: '/api/wallet/data',\n        INFO: '/api/wallet/info',\n        MANGO_BALANCE: '/api/wallet/mango-balance',\n        GENERATE: '/api/wallet/generate',\n        SEND: '/api/wallet/send',\n        CONNECT_PHANTOM: '/api/wallet/phantom/connect',\n        COMPLETE_PHANTOM: '/api/wallet/phantom/callback',\n        DISCONNECT_PHANTOM: '/api/wallet/phantom/disconnect',\n        // Map BALANCE to INFO since the server uses /api/wallet/info endpoint to get wallet balance\n        BALANCE: '/api/wallet/info',\n        TRANSACTIONS: '/api/wallet/transactions'\n    },\n    CHAT: {\n        // Get all chat sessions for the authenticated user\n        SESSIONS: '/api/chat/sessions',\n        // Create a new chat session\n        NEW_SESSION: '/api/chat/session/new',\n        // Get chat history for a specific session\n        HISTORY: (sessionId)=>`/api/chat/history/${sessionId}`,\n        // Send a chat message\n        MESSAGE: '/api/chat/message'\n    },\n    SOCIAL: {\n        // Core social media endpoints\n        SENTIMENT: '/api/social/sentiment',\n        TRENDING: '/api/social/trending-topics',\n        INFLUENTIAL: '/api/social/influential',\n        TWEETS: '/api/social/tweets'\n    },\n    MANGO: {\n        // Mango Markets API endpoints\n        BASE: '/api/mango',\n        OHLCV: '/api/mango/ohlcv',\n        MARKETS: '/api/mango/markets',\n        ORDER_BOOK: '/api/mango/orderbook',\n        TRADES: '/api/mango/trades',\n        MARKET_STATS: '/api/mango/market-stats',\n        COMMUNITIES: '/api/social/communities',\n        ENTITIES: '/api/social/entities',\n        FEED: '/api/social/feed',\n        CONNECTIONS: '/api/social/connections'\n    },\n    TRADING: {\n        EXECUTE: '/api/trading/execute',\n        CONFIRM: '/api/trading/confirm',\n        SMART_SETTINGS: '/api/trading/smart-settings',\n        TOKENS: '/api/trading/tokens',\n        PRICE_CHART: '/api/trading/price-chart',\n        SWAP: '/api/trading/swap',\n        SELL_POSITION: '/api/trading/sell-position',\n        USER_POSITIONS: '/api/user/positions',\n        LEVERAGE_POSITIONS: '/api/user/leverage_positions',\n        SPOT_POSITIONS: '/api/user/spot_positions'\n    },\n    SETTINGS: {\n        // Updated to match backend implementation\n        PROFILE: '/api/user/settings',\n        NOTIFICATIONS: '/api/settings/notifications',\n        // Additional backend settings endpoint\n        TRADING_SETTINGS: '/api/trading/smart-settings'\n    }\n};\n/**\n * Normalize different API response formats to a consistent structure\n * \n * This prioritizes API response formats in a predictable order:\n * 1. Auth responses with token and user\n * 2. Standard success responses with data\n * 3. Results-based responses\n * 4. Default pass-through\n */ function normalizeResponse(responseData) {\n    // Handle auth responses with token\n    if (responseData && typeof responseData === 'object' && 'token' in responseData) {\n        // Save the token when received in the response\n        saveAuthToken(responseData.token);\n        // Remove token from response data to avoid exposing it\n        const { token, ...rest } = responseData;\n        return rest;\n    }\n    // Handle standard success response format\n    if (responseData && typeof responseData === 'object' && 'success' in responseData) {\n        return responseData;\n    }\n    // Handle results-based response format\n    if (responseData && typeof responseData === 'object' && 'results' in responseData) {\n        return {\n            success: true,\n            data: responseData.results,\n            ...responseData\n        };\n    }\n    // Default: pass through the response data as-is\n    // Some endpoints return results in a 'results' property\n    if (responseData.results) {\n        return responseData.results;\n    }\n    // PRIORITY 4: Handle direct data format without success flag\n    // Some old endpoints return {data: {...}} directly\n    if (responseData.data && responseData.success === undefined) {\n        return responseData.data;\n    }\n    // Fall back to returning the entire response as is\n    return responseData;\n}\n/**\n * Process the API response and handle errors consistently\n */ async function processResponse(response) {\n    try {\n        // Clone the response so we can read it multiple times\n        const responseClone = response.clone();\n        // Read body ONCE as text, then attempt to parse JSON from it.\n        const bodyText = await response.text();\n        let data = undefined;\n        try {\n            data = bodyText ? JSON.parse(bodyText) : undefined;\n            // If we get a new token in the response, save it\n            if (data && data.token) {\n                saveAuthToken(data.token);\n            }\n        } catch (e) {\n            // Non-JSON body; treat as text error payload when not ok\n            if (!response.ok) {\n                return {\n                    success: false,\n                    error: bodyText || 'Invalid response format',\n                    statusCode: response.status,\n                    rawResponse: responseClone\n                };\n            }\n            // If OK status but non-JSON, pass raw text as data\n            return {\n                success: true,\n                data: bodyText,\n                statusCode: response.status,\n                rawResponse: responseClone\n            };\n        }\n        // Handle HTTP error status codes\n        if (!response.ok) {\n            // Do not perform global side effects here; let callers decide how to handle 401/403\n            return {\n                success: false,\n                error: data?.message || data?.error || `HTTP error ${response.status}`,\n                statusCode: response.status,\n                data,\n                rawResponse: responseClone\n            };\n        }\n        // Success case - normalize the response data\n        return {\n            success: true,\n            data: normalizeResponse(data),\n            statusCode: response.status,\n            rawResponse: responseClone\n        };\n    } catch (error) {\n        console.error('Error processing response:', error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : 'Unknown error processing response',\n            rawResponse: response.clone()\n        };\n    }\n}\n/**\n * Make an API request with proper error handling\n */ async function apiRequest(endpoint, options = {}) {\n    try {\n        // Get base URL from environment or use robust fallback\n        const baseUrl = resolveBaseUrl();\n        const url = endpoint.startsWith('http') ? endpoint : `${baseUrl}${endpoint}`;\n        console.log('API Request:', {\n            baseUrl,\n            endpoint,\n            url\n        });\n        // Add auth headers to the request\n        const requestOptions = addAuthHeaders({\n            ...options,\n            credentials: 'include',\n            headers: {\n                ...options.headers,\n                'Content-Type': 'application/json'\n            }\n        });\n        console.log('Making fetch request to:', url, 'with options:', requestOptions);\n        const response = await fetch(url, requestOptions);\n        console.log('Response received:', response.status, response.statusText);\n        return await processResponse(response);\n    } catch (error) {\n        if (error instanceof ApiError) {\n            // Rethrow ApiError instances\n            throw error;\n        }\n        // Handle network errors\n        throw new ApiError(error instanceof Error ? error.message : 'Network error', 0);\n    }\n}\n// Convenience methods for common HTTP methods\nconst api = {\n    async get (endpoint, options = {}) {\n        return apiRequest(endpoint, {\n            ...options,\n            method: 'GET'\n        });\n    },\n    async post (endpoint, data, options = {}) {\n        return apiRequest(endpoint, {\n            ...options,\n            method: 'POST',\n            body: JSON.stringify(data)\n        });\n    },\n    async put (endpoint, data, options = {}) {\n        return apiRequest(endpoint, {\n            ...options,\n            method: 'PUT',\n            body: JSON.stringify(data)\n        });\n    },\n    async delete (endpoint, options = {}) {\n        return apiRequest(endpoint, {\n            ...options,\n            method: 'DELETE'\n        });\n    }\n};\n// Chat API methods\nconst ChatApi = {\n    /**\n   * Get all chat sessions for the authenticated user\n   * @returns Promise with list of chat sessions\n   */ /**\n   * Get all chat sessions for the authenticated user\n   * @param limit Optional limit for pagination\n   * @param offset Optional offset for pagination\n   * @returns Promise with list of chat sessions and pagination info\n   */ async getSessions (limit, offset) {\n        try {\n            const params = new URLSearchParams();\n            if (limit) params.append('limit', limit.toString());\n            if (offset) params.append('offset', offset.toString());\n            const query = params.toString();\n            const url = query ? `${API_ENDPOINTS.CHAT.SESSIONS}?${query}` : API_ENDPOINTS.CHAT.SESSIONS;\n            const response = await api.get(url);\n            return {\n                sessions: response.data?.data || [],\n                total: response.data?.total || 0,\n                has_more: response.data?.has_more || false\n            };\n        } catch (error) {\n            const errorMessage = error.response?.data?.error || 'Failed to fetch chat sessions';\n            const usingFallback = error.response?.data?.using_fallback;\n            console.error('Error fetching chat sessions:', errorMessage, {\n                usingFallback\n            });\n            throw new Error(errorMessage);\n        }\n    },\n    /**\n   * Create a new chat session\n   * @param title Optional title for the new session\n   * @returns Promise with the new session ID\n   */ async createSession (title) {\n        try {\n            const response = await api.post(API_ENDPOINTS.CHAT.NEW_SESSION, {\n                title: title || 'New Chat'\n            });\n            if (!response.data?.session_id) {\n                throw new Error('Invalid response format from server');\n            }\n            return {\n                session_id: response.data.session_id\n            };\n        } catch (error) {\n            console.error('Error creating chat session:', error);\n            throw new Error('Failed to create chat session');\n        }\n    },\n    /**\n   * Get chat history for a specific session\n   * @param sessionId ID of the chat session\n   * @returns Promise with chat history\n   */ /**\n   * Get chat history for a specific session\n   * @param sessionId ID of the chat session\n   * @param limit Optional limit for pagination\n   * @param offset Optional offset for pagination\n   * @returns Promise with chat history and pagination info\n   */ async getHistory (sessionId, limit, offset) {\n        try {\n            const params = new URLSearchParams();\n            if (limit) params.append('limit', limit.toString());\n            if (offset) params.append('offset', offset.toString());\n            const query = params.toString();\n            const url = query ? `${API_ENDPOINTS.CHAT.HISTORY(sessionId)}?${query}` : API_ENDPOINTS.CHAT.HISTORY(sessionId);\n            const response = await api.get(url);\n            return {\n                messages: response.data?.data || [],\n                total: response.data?.total || 0,\n                has_more: response.data?.has_more || false\n            };\n        } catch (error) {\n            const errorMessage = error.response?.data?.error || 'Failed to fetch chat history';\n            const usingFallback = error.response?.data?.using_fallback;\n            console.error('Error fetching chat history:', errorMessage, {\n                usingFallback\n            });\n            throw new Error(errorMessage);\n        }\n    },\n    /**\n   * Send a message in a chat session\n   * @param sessionId ID of the chat session\n   * @param message The message content\n   * @returns Promise with the assistant's response\n   */ /**\n   * Send a message in a chat session\n   * @param sessionId ID of the chat session\n   * @param message The message content\n   * @param metadata Optional metadata to include with the message\n   * @returns Promise with the assistant's response\n   */ async sendMessage (sessionId, message, metadata) {\n        try {\n            const response = await api.post(API_ENDPOINTS.CHAT.MESSAGE, {\n                session_id: sessionId,\n                message,\n                timestamp: new Date().toISOString(),\n                ...metadata && {\n                    metadata\n                }\n            });\n            if (!response.data || !response.data.data) {\n                throw new Error('Invalid response format from server');\n            }\n            return {\n                response: response.data.data.response || '',\n                metadata: response.data.data.metadata,\n                session_id: response.data.data.session_id || sessionId,\n                message_id: response.data.data.message_id || `msg_${Date.now()}`,\n                timestamp: response.data.data.timestamp || new Date().toISOString()\n            };\n        } catch (error) {\n            const errorMessage = error.response?.data?.error || 'Failed to send chat message';\n            const usingFallback = error.response?.data?.using_fallback;\n            console.error('Error sending chat message:', errorMessage, {\n                usingFallback\n            });\n            throw new Error(errorMessage);\n        }\n    }\n};\n// Trading API methods\nconst TradingApi = {\n    /**\n   * Execute a trade (first step of two-phase trade execution)\n   * @param params Trade execution parameters\n   * @returns Trade execution result with confirmation ID if confirmation required\n   */ async executeTrade (params) {\n        try {\n            const response = await api.post('/api/trading/execute', {\n                ...params,\n                amount: params.amount.toString()\n            });\n            return response.data;\n        } catch (error) {\n            console.error('Trade execution failed:', error);\n            throw new Error(error.response?.data?.error || 'Trade execution failed');\n        }\n    },\n    /**\n   * Confirm a pending trade (second step of two-phase trade execution)\n   * @param confirmationId The confirmation ID from executeTrade response\n   * @returns Final trade execution result\n   */ async confirmTrade (confirmationId) {\n        try {\n            const response = await api.post('/api/trading/confirm', {\n                confirmation_id: confirmationId\n            });\n            return response.data;\n        } catch (error) {\n            console.error('Trade confirmation failed:', error);\n            throw new Error(error.response?.data?.error || 'Trade confirmation failed');\n        }\n    },\n    /**\n   * Close an existing position (leverage or spot)\n   * @param params Position parameters to close\n   * @returns Position closing result\n   */ async closePosition (params) {\n        try {\n            const response = await api.post('/api/trading/sell-position', params);\n            return response.data;\n        } catch (error) {\n            console.error('Position closing failed:', error);\n            throw new Error(error.response?.data?.error || 'Failed to close position');\n        }\n    },\n    /**\n   * Sell a spot token for another token (usually USDC)\n   * @param params Token selling parameters\n   * @returns Token selling result\n   */ async sellToken (params) {\n        try {\n            const response = await api.post('/api/trading/sell-token', {\n                ...params,\n                amount: params.amount.toString()\n            });\n            return response.data;\n        } catch (error) {\n            console.error('Token selling failed:', error);\n            throw new Error(error.response?.data?.error || 'Failed to sell token');\n        }\n    },\n    /**\n   * Sell or close a position (full or partial)\n   * @param params Position selling parameters\n   * @returns Result of the position sale\n   */ async sellPosition (params) {\n        try {\n            const requestData = {\n                ...params\n            };\n            // If percentage is provided, adjust the amount accordingly\n            if (params.percentage && params.percentage > 0 && params.percentage < 100) {\n                requestData.amount = params.amount * params.percentage / 100;\n            }\n            const response = await api.post(API_ENDPOINTS.TRADING.SELL_POSITION, requestData);\n            return response.data;\n        } catch (error) {\n            console.error('Failed to close position:', error);\n            throw new Error(error.response?.data?.error || 'Failed to close position');\n        }\n    },\n    /**\n   * Get user's leverage positions from Mango V3\n   * @returns User's leverage positions with success/error status\n   */ async getUserLeveragePositions () {\n        try {\n            const response = await api.get(API_ENDPOINTS.USER.LEVERAGE_POSITIONS);\n            // If response already has the right format, return it directly\n            if (response.data && typeof response.data === 'object' && 'success' in response.data) {\n                return response.data;\n            }\n            // Otherwise format according to Mango V3 spec\n            const positions = Array.isArray(response.data) ? response.data : [];\n            return {\n                success: true,\n                positions,\n                metadata: {\n                    total_positions: positions.length,\n                    timestamp: new Date().toISOString()\n                }\n            };\n        } catch (error) {\n            console.error('Error fetching leverage positions:', error);\n            return {\n                success: false,\n                positions: [],\n                error: {\n                    message: error instanceof Error ? error.message : 'Failed to fetch leverage positions',\n                    code: 'POSITION_FETCH_ERROR'\n                }\n            };\n        }\n    },\n    /**\n   * Get user's spot positions from wallet balances\n   * @returns User's spot positions with success/error status\n   */ async getUserSpotPositions () {\n        try {\n            const response = await api.get(API_ENDPOINTS.USER.SPOT_POSITIONS);\n            // If response already has the right format, return it directly\n            if (response.data && typeof response.data === 'object' && 'success' in response.data) {\n                return response.data;\n            }\n            // Otherwise format according to Mango V3 spec\n            const positions = Array.isArray(response.data) ? response.data : [];\n            return {\n                success: true,\n                positions,\n                metadata: {\n                    total_positions: positions.length,\n                    timestamp: new Date().toISOString()\n                }\n            };\n        } catch (error) {\n            console.error('Error fetching spot positions:', error);\n            return {\n                success: false,\n                positions: [],\n                error: {\n                    message: error instanceof Error ? error.message : 'Failed to fetch spot positions',\n                    code: 'POSITION_FETCH_ERROR'\n                }\n            };\n        }\n    },\n    /**\n   * Get position history for a user with pagination and filtering\n   * @param params Query parameters for filtering position history\n   * @returns Promise with position history data\n   */ getPositionHistory: async (params)=>{\n        try {\n            // Build query parameters\n            const queryParams = new URLSearchParams();\n            if (params?.market) queryParams.append('market', params.market);\n            if (params?.startTime) queryParams.append('start_time', String(params.startTime));\n            if (params?.endTime) queryParams.append('end_time', String(params.endTime));\n            if (params?.interval) queryParams.append('interval', params.interval);\n            if (params?.includePnl !== undefined) queryParams.append('include_pnl', String(params.includePnl));\n            if (params?.includeLivePnl) queryParams.append('include_live_pnl', 'true');\n            if (params?.cursor) queryParams.append('cursor', params.cursor);\n            if (params?.limit) queryParams.append('limit', String(params.limit));\n            const response = await fetch(`${API_ENDPOINTS.USER.POSITION_HISTORY}?${queryParams.toString()}`, {\n                method: 'GET',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${getAuthToken()}`\n                }\n            });\n            const data = await response.json();\n            // Handle error responses\n            if (!response.ok) {\n                const errorData = data?.error || {};\n                throw new ApiError(errorData.message || `HTTP error! status: ${response.status}`, response.status, {\n                    code: errorData.code || 'api_error',\n                    status: errorData.status || response.status,\n                    timestamp: errorData.timestamp || new Date().toISOString(),\n                    ...errorData.details && {\n                        details: errorData.details\n                    }\n                });\n            }\n            // Transform the successful response to match the PositionHistoryResponse type\n            return {\n                success: data.success,\n                position_history: data.position_history || [],\n                pnl_over_time: data.pnl_over_time || [],\n                pagination: data.pagination || {\n                    has_more: data.metadata?.has_more || false,\n                    next_cursor: data.metadata?.cursor,\n                    limit: params?.limit || 100,\n                    total: data.metadata?.total || 0\n                },\n                metadata: {\n                    user_identifier: data.metadata?.user_identifier || '',\n                    market: params?.market || 'all',\n                    start_time: data.metadata?.start_time || new Date().toISOString(),\n                    end_time: data.metadata?.end_time || new Date().toISOString(),\n                    interval: params?.interval || '1d',\n                    total_positions: data.metadata?.total || 0,\n                    has_more: data.metadata?.has_more || false,\n                    cursor: data.metadata?.cursor\n                }\n            };\n        } catch (error) {\n            console.error('Error fetching position history:', error);\n            // Handle ApiError instances\n            if (error instanceof ApiError) {\n                return {\n                    success: false,\n                    position_history: [],\n                    pnl_over_time: [],\n                    pagination: {\n                        has_more: false,\n                        next_cursor: undefined,\n                        limit: params?.limit || 100,\n                        total: 0\n                    },\n                    metadata: {\n                        user_identifier: '',\n                        market: params?.market || 'all',\n                        start_time: new Date().toISOString(),\n                        end_time: new Date().toISOString(),\n                        interval: params?.interval || '1d',\n                        total_positions: 0,\n                        has_more: false\n                    },\n                    error: error.message,\n                    error_details: error.data\n                };\n            }\n            // Handle other types of errors\n            return {\n                success: false,\n                position_history: [],\n                pnl_over_time: [],\n                pagination: {\n                    has_more: false,\n                    next_cursor: undefined,\n                    limit: params?.limit || 100,\n                    total: 0\n                },\n                metadata: {\n                    user_identifier: '',\n                    market: params?.market || 'all',\n                    start_time: new Date().toISOString(),\n                    end_time: new Date().toISOString(),\n                    interval: params?.interval || '1d',\n                    total_positions: 0,\n                    has_more: false\n                },\n                error: error instanceof Error ? error.message : 'Unknown error',\n                error_details: {\n                    code: 'unexpected_error',\n                    status: 500,\n                    timestamp: new Date().toISOString()\n                }\n            };\n        }\n    },\n    /**\n   * Get detailed position history for a specific position\n   * @param positionId ID of the position to get history for\n   * @param params Additional query parameters\n   * @returns Promise with detailed position history\n   */ getPositionDetails: async (positionId, params)=>{\n        try {\n            // Convert params to query string\n            const queryParams = new URLSearchParams({\n                positionId\n            });\n            if (params?.startTime) queryParams.append('startTime', String(params.startTime));\n            if (params?.endTime) queryParams.append('endTime', String(params.endTime));\n            if (params?.interval) queryParams.append('interval', params.interval);\n            const endpoint = `${API_ENDPOINTS.USER.POSITION_HISTORY}/details?${queryParams.toString()}`;\n            // Create headers object with proper typing\n            const authHeaders = addAuthHeaders();\n            const headers = new Headers();\n            headers.append('Content-Type', 'application/json');\n            // Add auth headers if they exist\n            if (authHeaders) {\n                Object.entries(authHeaders).forEach(([key, value])=>{\n                    if (value) headers.append(key, value);\n                });\n            }\n            const response = await api.get(endpoint, {\n                headers\n            });\n            if (!response.success) {\n                throw new Error(response.error || 'Failed to fetch position details');\n            }\n            return response.data.data;\n        } catch (error) {\n            console.error('Error fetching position details:', error);\n            throw error;\n        }\n    }\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (api);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0YsRUFBRTtBQUVGLGlFQUFlYyxHQUFHQSxFQUFDIiwic291cmNlcyI6WyIvaG9tZS91YnVudHUvZ3JhY2UtcHJvamVjdC9zcmMvdWkvYXBpL2FwaUNsaWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFQSSBDbGllbnQgZm9yIEdyYWNlIEFwcFxuICogXG4gKiBQcm92aWRlcyBzdGFuZGFyZGl6ZWQgZXJyb3IgaGFuZGxpbmcgYW5kIHJlc3BvbnNlIHByb2Nlc3NpbmcgZm9yIGFsbCBBUEkgY2FsbHMuXG4gKi9cblxuLy8gRnJvbnQgYXBpIGNvbnN0YW50IGFuZCByb2J1c3QgcmVzb2x2ZXIgZm9yIGJhc2UgVVJMXG5jb25zdCBBUElfQkFTRV9VUkwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUElfVVJMIHx8ICcnO1xuXG4vLyBSZXNvbHZlIGJhc2UgVVJMOyBwcmVmZXIgZW52IHZhciwgZWxzZSB1c2UgcmVsYXRpdmUgcGF0aCB0byBhdm9pZCBDT1JTIGlzc3Vlc1xuY29uc3QgcmVzb2x2ZUJhc2VVcmwgPSAoKTogc3RyaW5nID0+IHtcbiAgY29uc3QgZW52VXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBJX1VSTDtcbiAgaWYgKGVudlVybCAmJiBlbnZVcmwudHJpbSgpICE9PSAnJykge1xuICAgIHJldHVybiBlbnZVcmwuZW5kc1dpdGgoJy8nKSA/IGVudlVybC5zbGljZSgwLCAtMSkgOiBlbnZVcmw7XG4gIH1cbiAgLy8gRmFsbGJhY2sgdG8gcmVsYXRpdmUgYmFzZSB0byB1c2Ugc2FtZS1vcmlnaW4gb3IgZGV2IHByb3h5XG4gIHJldHVybiAnJztcbn07XG5cbi8vIEF1dGggdG9rZW4ga2V5IGZvciBsb2NhbFN0b3JhZ2VcbmNvbnN0IEFVVEhfVE9LRU5fS0VZID0gJ2dyYWNlX2F1dGhfdG9rZW4nO1xuY29uc3QgQUxUX1RPS0VOX0tFWSA9ICdncmFjZV90b2tlbic7XG5cbi8vIEdldCBhdXRoIHRva2VuIGZyb20gc3RvcmFnZSAoY2hlY2tzIGJvdGggc2Vzc2lvbiBhbmQgbG9jYWwsIGFuZCBib3RoIGtleXMpXG5leHBvcnQgY29uc3QgZ2V0QXV0aFRva2VuID0gKCk6IHN0cmluZyB8IG51bGwgPT4ge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gKFxuICAgICAgLy8gUHJlZmVyIHNlc3Npb25TdG9yYWdlIGZvciBjdXJyZW50IHNlc3Npb25cbiAgICAgIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oQVVUSF9UT0tFTl9LRVkpIHx8XG4gICAgICBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKEFMVF9UT0tFTl9LRVkpIHx8XG4gICAgICAvLyBGYWxsYmFjayB0byBsb2NhbFN0b3JhZ2VcbiAgICAgIGxvY2FsU3RvcmFnZS5nZXRJdGVtKEFVVEhfVE9LRU5fS0VZKSB8fFxuICAgICAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oQUxUX1RPS0VOX0tFWSlcbiAgICApO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcblxuLy8gU2F2ZSBhdXRoIHRva2VuIHRvIGxvY2FsU3RvcmFnZSB1bmRlciBib3RoIGtleXMgZm9yIGNvbXBhdGliaWxpdHlcbmV4cG9ydCBjb25zdCBzYXZlQXV0aFRva2VuID0gKHRva2VuOiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oQVVUSF9UT0tFTl9LRVksIHRva2VuKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShBTFRfVE9LRU5fS0VZLCB0b2tlbik7XG4gIH1cbn07XG5cbi8vIFJlbW92ZSBhdXRoIHRva2VuIGZyb20gYm90aCBzdG9yYWdlIGxvY2F0aW9ucyBhbmQga2V5c1xuZXhwb3J0IGNvbnN0IHJlbW92ZUF1dGhUb2tlbiA9ICgpOiB2b2lkID0+IHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oQVVUSF9UT0tFTl9LRVkpO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKEFMVF9UT0tFTl9LRVkpO1xuICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oQVVUSF9UT0tFTl9LRVkpO1xuICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oQUxUX1RPS0VOX0tFWSk7XG4gIH1cbn07XG5cbi8vIEFkZCBhdXRoIGhlYWRlcnMgdG8gcmVxdWVzdCBvcHRpb25zXG5leHBvcnQgY29uc3QgYWRkQXV0aEhlYWRlcnMgPSAob3B0aW9uczogUmVxdWVzdEluaXQgPSB7fSk6IFJlcXVlc3RJbml0ID0+IHtcbiAgY29uc3QgdG9rZW4gPSBnZXRBdXRoVG9rZW4oKTtcbiAgaWYgKHRva2VuKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIC4uLm9wdGlvbnMuaGVhZGVycyxcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuICByZXR1cm4gb3B0aW9ucztcbn07XG5pbXBvcnQgeyBUcmFkZSwgVHJhZGVIaXN0b3J5UmVzcG9uc2UsIFBvc2l0aW9uSGlzdG9yeVJlc3BvbnNlLCBUcmFkZUV4ZWN1dGlvblJlc3VsdCwgUG9zaXRpb25IaXN0b3J5RW50cnksIFVzZXJQb3NpdGlvbnNSZXNwb25zZSwgQmFzZVBvc2l0aW9uIH0gZnJvbSAnLi9hcGlUeXBlcyc7XG4vLyBObyBjaXJjdWxhciBpbXBvcnRzXG5cbi8vIEFQSSBSZXNwb25zZSB0eXBlc1xuZXhwb3J0IGludGVyZmFjZSBBcGlSZXNwb25zZTxUID0gYW55PiB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGRhdGE/OiBUO1xuICBlcnJvcj86IHN0cmluZztcbiAgc3RhdHVzQ29kZT86IG51bWJlcjtcbiAgcmF3UmVzcG9uc2U/OiBhbnk7IC8vIE9yaWdpbmFsIHVucHJvY2Vzc2VkIHJlc3BvbnNlIGZvciBkZWJ1Z2dpbmdcbn1cblxuLy8gQVBJIEVycm9yIHR5cGVzXG5leHBvcnQgY2xhc3MgQXBpRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIHB1YmxpYyBzdGF0dXNDb2RlOiBudW1iZXI7XG4gIHB1YmxpYyBkYXRhPzogYW55O1xuXG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgc3RhdHVzQ29kZTogbnVtYmVyLCBkYXRhPzogYW55KSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gJ0FwaUVycm9yJztcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gIH1cbn1cblxuLy8gQVBJIGNvbmZpZ3VyYXRpb24gLSB1c2UgZW52aXJvbm1lbnQgdmFyaWFibGUgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgdXNlIHJlbGF0aXZlIHBhdGhcblxuLy8gRW5zdXJlIEFQSV9CQVNFX1VSTCBlbmRzIHdpdGggYSBzbGFzaCAoa2VwdCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcbmNvbnN0IGdldEJhc2VVcmwgPSAoKSA9PiB7XG4gIGNvbnN0IGJhc2UgPSBBUElfQkFTRV9VUkw7XG4gIGlmIChiYXNlICYmIGJhc2UuZW5kc1dpdGgoJy8nKSkge1xuICAgIHJldHVybiBiYXNlLnNsaWNlKDAsIC0xKTtcbiAgfVxuICByZXR1cm4gYmFzZTtcbn07XG5cbi8vIEFQSSBlbmRwb2ludHMgY29uc3RhbnRzXG5leHBvcnQgY29uc3QgQVBJX0VORFBPSU5UUyA9IHtcbiAgQVVUSDoge1xuICAgIExPR0lOOiAnL2FwaS9hdXRoL2xvZ2luJyxcbiAgICBSRUdJU1RFUjogJy9hcGkvYXV0aC9yZWdpc3RlcicsXG4gICAgVkVSSUZZX1RPS0VOOiAnL2FwaS9hdXRoL3ZlcmlmeScsXG4gICAgTE9HT1VUOiAnL2FwaS9hdXRoL2xvZ291dCcsXG4gICAgUkVGUkVTSF9UT0tFTjogJy9hdXRoL3JlZnJlc2gtdG9rZW4nLFxuICAgIEZPUkdPVF9QQVNTV09SRDogJy9hcGkvYXV0aC9mb3Jnb3QtcGFzc3dvcmQnLFxuICAgIFJFU0VUX1BBU1NXT1JEOiAnL2FwaS9hdXRoL3Jlc2V0LXBhc3N3b3JkJ1xuICB9LFxuICBVU0VSOiB7XG4gICAgUFJPRklMRTogJy9hcGkvdXNlci9wcm9maWxlJyxcbiAgICBMRVZFUkFHRV9QT1NJVElPTlM6ICcvYXBpL3VzZXIvbGV2ZXJhZ2VfcG9zaXRpb25zJyxcbiAgICBTUE9UX1BPU0lUSU9OUzogJy9hcGkvdXNlci9zcG90X3Bvc2l0aW9ucycsXG4gICAgUE9TSVRJT05fSElTVE9SWTogJy9hcGkvdXNlci9wb3NpdGlvbl9oaXN0b3J5JyxcbiAgICBUUkFERV9ISVNUT1JZOiAnL2FwaS91c2VyL3RyYWRlX2hpc3RvcnknLFxuICAgIExJTUlUX09SREVSUzogJy9hcGkvbGltaXQtb3JkZXJzJ1xuICB9LFxuICBXQUxMRVQ6IHtcbiAgICBEQVRBOiAnL2FwaS93YWxsZXQvZGF0YScsXG4gICAgSU5GTzogJy9hcGkvd2FsbGV0L2luZm8nLFxuICAgIE1BTkdPX0JBTEFOQ0U6ICcvYXBpL3dhbGxldC9tYW5nby1iYWxhbmNlJywgLy8gTWFuZ28gZXhjIGJhbGFuY2VcbiAgICBHRU5FUkFURTogJy9hcGkvd2FsbGV0L2dlbmVyYXRlJyxcbiAgICBTRU5EOiAnL2FwaS93YWxsZXQvc2VuZCcsXG4gICAgQ09OTkVDVF9QSEFOVE9NOiAnL2FwaS93YWxsZXQvcGhhbnRvbS9jb25uZWN0JyxcbiAgICBDT01QTEVURV9QSEFOVE9NOiAnL2FwaS93YWxsZXQvcGhhbnRvbS9jYWxsYmFjaycsIC8vIFVwZGF0ZWQgdG8gbWF0Y2ggYWN0dWFsIGJhY2tlbmQgZW5kcG9pbnRcbiAgICBESVNDT05ORUNUX1BIQU5UT006ICcvYXBpL3dhbGxldC9waGFudG9tL2Rpc2Nvbm5lY3QnLFxuICAgIC8vIE1hcCBCQUxBTkNFIHRvIElORk8gc2luY2UgdGhlIHNlcnZlciB1c2VzIC9hcGkvd2FsbGV0L2luZm8gZW5kcG9pbnQgdG8gZ2V0IHdhbGxldCBiYWxhbmNlXG4gICAgQkFMQU5DRTogJy9hcGkvd2FsbGV0L2luZm8nLFxuICAgIFRSQU5TQUNUSU9OUzogJy9hcGkvd2FsbGV0L3RyYW5zYWN0aW9ucydcbiAgfSxcbiAgQ0hBVDoge1xuICAgIC8vIEdldCBhbGwgY2hhdCBzZXNzaW9ucyBmb3IgdGhlIGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgIFNFU1NJT05TOiAnL2FwaS9jaGF0L3Nlc3Npb25zJyxcbiAgICAvLyBDcmVhdGUgYSBuZXcgY2hhdCBzZXNzaW9uXG4gICAgTkVXX1NFU1NJT046ICcvYXBpL2NoYXQvc2Vzc2lvbi9uZXcnLFxuICAgIC8vIEdldCBjaGF0IGhpc3RvcnkgZm9yIGEgc3BlY2lmaWMgc2Vzc2lvblxuICAgIEhJU1RPUlk6IChzZXNzaW9uSWQ6IHN0cmluZykgPT4gYC9hcGkvY2hhdC9oaXN0b3J5LyR7c2Vzc2lvbklkfWAsXG4gICAgLy8gU2VuZCBhIGNoYXQgbWVzc2FnZVxuICAgIE1FU1NBR0U6ICcvYXBpL2NoYXQvbWVzc2FnZSdcbiAgfSxcbiAgU09DSUFMOiB7XG4gICAgLy8gQ29yZSBzb2NpYWwgbWVkaWEgZW5kcG9pbnRzXG4gICAgU0VOVElNRU5UOiAnL2FwaS9zb2NpYWwvc2VudGltZW50JyxcbiAgICBUUkVORElORzogJy9hcGkvc29jaWFsL3RyZW5kaW5nLXRvcGljcycsXG4gICAgSU5GTFVFTlRJQUw6ICcvYXBpL3NvY2lhbC9pbmZsdWVudGlhbCcsXG4gICAgVFdFRVRTOiAnL2FwaS9zb2NpYWwvdHdlZXRzJyxcbiAgfSxcbiAgTUFOR086IHtcbiAgICAvLyBNYW5nbyBNYXJrZXRzIEFQSSBlbmRwb2ludHNcbiAgICBCQVNFOiAnL2FwaS9tYW5nbycsXG4gICAgT0hMQ1Y6ICcvYXBpL21hbmdvL29obGN2JyxcbiAgICBNQVJLRVRTOiAnL2FwaS9tYW5nby9tYXJrZXRzJyxcbiAgICBPUkRFUl9CT09LOiAnL2FwaS9tYW5nby9vcmRlcmJvb2snLFxuICAgIFRSQURFUzogJy9hcGkvbWFuZ28vdHJhZGVzJyxcbiAgICBNQVJLRVRfU1RBVFM6ICcvYXBpL21hbmdvL21hcmtldC1zdGF0cycsXG4gICAgQ09NTVVOSVRJRVM6ICcvYXBpL3NvY2lhbC9jb21tdW5pdGllcycsXG4gICAgRU5USVRJRVM6ICcvYXBpL3NvY2lhbC9lbnRpdGllcycsXG4gICAgRkVFRDogJy9hcGkvc29jaWFsL2ZlZWQnLFxuICAgIENPTk5FQ1RJT05TOiAnL2FwaS9zb2NpYWwvY29ubmVjdGlvbnMnXG4gIH0sXG4gIFRSQURJTkc6IHtcbiAgICBFWEVDVVRFOiAnL2FwaS90cmFkaW5nL2V4ZWN1dGUnLFxuICAgIENPTkZJUk06ICcvYXBpL3RyYWRpbmcvY29uZmlybScsXG4gICAgU01BUlRfU0VUVElOR1M6ICcvYXBpL3RyYWRpbmcvc21hcnQtc2V0dGluZ3MnLFxuICAgIFRPS0VOUzogJy9hcGkvdHJhZGluZy90b2tlbnMnLFxuICAgIFBSSUNFX0NIQVJUOiAnL2FwaS90cmFkaW5nL3ByaWNlLWNoYXJ0JyxcbiAgICBTV0FQOiAnL2FwaS90cmFkaW5nL3N3YXAnLFxuICAgIFNFTExfUE9TSVRJT046ICcvYXBpL3RyYWRpbmcvc2VsbC1wb3NpdGlvbicsXG4gICAgVVNFUl9QT1NJVElPTlM6ICcvYXBpL3VzZXIvcG9zaXRpb25zJyxcbiAgICBMRVZFUkFHRV9QT1NJVElPTlM6ICcvYXBpL3VzZXIvbGV2ZXJhZ2VfcG9zaXRpb25zJyxcbiAgICBTUE9UX1BPU0lUSU9OUzogJy9hcGkvdXNlci9zcG90X3Bvc2l0aW9ucydcbiAgfSxcbiAgU0VUVElOR1M6IHtcbiAgICAvLyBVcGRhdGVkIHRvIG1hdGNoIGJhY2tlbmQgaW1wbGVtZW50YXRpb25cbiAgICBQUk9GSUxFOiAnL2FwaS91c2VyL3NldHRpbmdzJywgIC8vIE1hdGNoZXMgdXNlcl9zZXR0aW5ncyBlbmRwb2ludCBpbiBiYWNrZW5kXG4gICAgTk9USUZJQ0FUSU9OUzogJy9hcGkvc2V0dGluZ3Mvbm90aWZpY2F0aW9ucycsIC8vIEtlZXAgZm9yIGZ1dHVyZSBpbXBsZW1lbnRhdGlvblxuICAgIC8vIEFkZGl0aW9uYWwgYmFja2VuZCBzZXR0aW5ncyBlbmRwb2ludFxuICAgIFRSQURJTkdfU0VUVElOR1M6ICcvYXBpL3RyYWRpbmcvc21hcnQtc2V0dGluZ3MnLCAvLyBNYXRjaGVzIHRyYWRpbmdfc21hcnRfc2V0dGluZ3MgaW4gYmFja2VuZFxuICB9LFxufTtcblxuLyoqXG4gKiBOb3JtYWxpemUgZGlmZmVyZW50IEFQSSByZXNwb25zZSBmb3JtYXRzIHRvIGEgY29uc2lzdGVudCBzdHJ1Y3R1cmVcbiAqIFxuICogVGhpcyBwcmlvcml0aXplcyBBUEkgcmVzcG9uc2UgZm9ybWF0cyBpbiBhIHByZWRpY3RhYmxlIG9yZGVyOlxuICogMS4gQXV0aCByZXNwb25zZXMgd2l0aCB0b2tlbiBhbmQgdXNlclxuICogMi4gU3RhbmRhcmQgc3VjY2VzcyByZXNwb25zZXMgd2l0aCBkYXRhXG4gKiAzLiBSZXN1bHRzLWJhc2VkIHJlc3BvbnNlc1xuICogNC4gRGVmYXVsdCBwYXNzLXRocm91Z2hcbiAqL1xuZnVuY3Rpb24gbm9ybWFsaXplUmVzcG9uc2U8VD4ocmVzcG9uc2VEYXRhOiBhbnkpOiBUIHtcbiAgLy8gSGFuZGxlIGF1dGggcmVzcG9uc2VzIHdpdGggdG9rZW5cbiAgaWYgKHJlc3BvbnNlRGF0YSAmJiB0eXBlb2YgcmVzcG9uc2VEYXRhID09PSAnb2JqZWN0JyAmJiAndG9rZW4nIGluIHJlc3BvbnNlRGF0YSkge1xuICAgIC8vIFNhdmUgdGhlIHRva2VuIHdoZW4gcmVjZWl2ZWQgaW4gdGhlIHJlc3BvbnNlXG4gICAgc2F2ZUF1dGhUb2tlbihyZXNwb25zZURhdGEudG9rZW4pO1xuICAgIC8vIFJlbW92ZSB0b2tlbiBmcm9tIHJlc3BvbnNlIGRhdGEgdG8gYXZvaWQgZXhwb3NpbmcgaXRcbiAgICBjb25zdCB7IHRva2VuLCAuLi5yZXN0IH0gPSByZXNwb25zZURhdGE7XG4gICAgcmV0dXJuIHJlc3QgYXMgVDtcbiAgfVxuICBcbiAgLy8gSGFuZGxlIHN0YW5kYXJkIHN1Y2Nlc3MgcmVzcG9uc2UgZm9ybWF0XG4gIGlmIChyZXNwb25zZURhdGEgJiYgdHlwZW9mIHJlc3BvbnNlRGF0YSA9PT0gJ29iamVjdCcgJiYgJ3N1Y2Nlc3MnIGluIHJlc3BvbnNlRGF0YSkge1xuICAgIHJldHVybiByZXNwb25zZURhdGEgYXMgVDtcbiAgfVxuICBcbiAgLy8gSGFuZGxlIHJlc3VsdHMtYmFzZWQgcmVzcG9uc2UgZm9ybWF0XG4gIGlmIChyZXNwb25zZURhdGEgJiYgdHlwZW9mIHJlc3BvbnNlRGF0YSA9PT0gJ29iamVjdCcgJiYgJ3Jlc3VsdHMnIGluIHJlc3BvbnNlRGF0YSkge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogcmVzcG9uc2VEYXRhLnJlc3VsdHMsXG4gICAgICAuLi5yZXNwb25zZURhdGFcbiAgICB9IGFzIHVua25vd24gYXMgVDtcbiAgfVxuICBcbiAgLy8gRGVmYXVsdDogcGFzcyB0aHJvdWdoIHRoZSByZXNwb25zZSBkYXRhIGFzLWlzXG4gIC8vIFNvbWUgZW5kcG9pbnRzIHJldHVybiByZXN1bHRzIGluIGEgJ3Jlc3VsdHMnIHByb3BlcnR5XG4gIGlmIChyZXNwb25zZURhdGEucmVzdWx0cykge1xuICAgIHJldHVybiByZXNwb25zZURhdGEucmVzdWx0cyBhcyBUO1xuICB9XG4gIFxuICAvLyBQUklPUklUWSA0OiBIYW5kbGUgZGlyZWN0IGRhdGEgZm9ybWF0IHdpdGhvdXQgc3VjY2VzcyBmbGFnXG4gIC8vIFNvbWUgb2xkIGVuZHBvaW50cyByZXR1cm4ge2RhdGE6IHsuLi59fSBkaXJlY3RseVxuICBpZiAocmVzcG9uc2VEYXRhLmRhdGEgJiYgcmVzcG9uc2VEYXRhLnN1Y2Nlc3MgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiByZXNwb25zZURhdGEuZGF0YSBhcyBUO1xuICB9XG4gIFxuICAvLyBGYWxsIGJhY2sgdG8gcmV0dXJuaW5nIHRoZSBlbnRpcmUgcmVzcG9uc2UgYXMgaXNcbiAgcmV0dXJuIHJlc3BvbnNlRGF0YSBhcyBUO1xufVxuXG4vKipcbiAqIFByb2Nlc3MgdGhlIEFQSSByZXNwb25zZSBhbmQgaGFuZGxlIGVycm9ycyBjb25zaXN0ZW50bHlcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1Jlc3BvbnNlPFQ+KHJlc3BvbnNlOiBSZXNwb25zZSk6IFByb21pc2U8QXBpUmVzcG9uc2U8VD4+IHtcbiAgdHJ5IHtcbiAgICAvLyBDbG9uZSB0aGUgcmVzcG9uc2Ugc28gd2UgY2FuIHJlYWQgaXQgbXVsdGlwbGUgdGltZXNcbiAgICBjb25zdCByZXNwb25zZUNsb25lID0gcmVzcG9uc2UuY2xvbmUoKTtcbiAgICBcbiAgICAvLyBSZWFkIGJvZHkgT05DRSBhcyB0ZXh0LCB0aGVuIGF0dGVtcHQgdG8gcGFyc2UgSlNPTiBmcm9tIGl0LlxuICAgIGNvbnN0IGJvZHlUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIGxldCBkYXRhOiBhbnkgPSB1bmRlZmluZWQ7XG4gICAgdHJ5IHtcbiAgICAgIGRhdGEgPSBib2R5VGV4dCA/IEpTT04ucGFyc2UoYm9keVRleHQpIDogdW5kZWZpbmVkO1xuICAgICAgLy8gSWYgd2UgZ2V0IGEgbmV3IHRva2VuIGluIHRoZSByZXNwb25zZSwgc2F2ZSBpdFxuICAgICAgaWYgKGRhdGEgJiYgZGF0YS50b2tlbikge1xuICAgICAgICBzYXZlQXV0aFRva2VuKGRhdGEudG9rZW4pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIE5vbi1KU09OIGJvZHk7IHRyZWF0IGFzIHRleHQgZXJyb3IgcGF5bG9hZCB3aGVuIG5vdCBva1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBib2R5VGV4dCB8fCAnSW52YWxpZCByZXNwb25zZSBmb3JtYXQnLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICByYXdSZXNwb25zZTogcmVzcG9uc2VDbG9uZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgLy8gSWYgT0sgc3RhdHVzIGJ1dCBub24tSlNPTiwgcGFzcyByYXcgdGV4dCBhcyBkYXRhXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBib2R5VGV4dCBhcyB1bmtub3duIGFzIFQsXG4gICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgcmF3UmVzcG9uc2U6IHJlc3BvbnNlQ2xvbmVcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBIVFRQIGVycm9yIHN0YXR1cyBjb2Rlc1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIC8vIERvIG5vdCBwZXJmb3JtIGdsb2JhbCBzaWRlIGVmZmVjdHMgaGVyZTsgbGV0IGNhbGxlcnMgZGVjaWRlIGhvdyB0byBoYW5kbGUgNDAxLzQwM1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBkYXRhPy5tZXNzYWdlIHx8IGRhdGE/LmVycm9yIHx8IGBIVFRQIGVycm9yICR7cmVzcG9uc2Uuc3RhdHVzfWAsXG4gICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgZGF0YSxcbiAgICAgICAgcmF3UmVzcG9uc2U6IHJlc3BvbnNlQ2xvbmVcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8vIFN1Y2Nlc3MgY2FzZSAtIG5vcm1hbGl6ZSB0aGUgcmVzcG9uc2UgZGF0YVxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogbm9ybWFsaXplUmVzcG9uc2U8VD4oZGF0YSksXG4gICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICByYXdSZXNwb25zZTogcmVzcG9uc2VDbG9uZVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyByZXNwb25zZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3IgcHJvY2Vzc2luZyByZXNwb25zZScsXG4gICAgICByYXdSZXNwb25zZTogcmVzcG9uc2UuY2xvbmUoKVxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBNYWtlIGFuIEFQSSByZXF1ZXN0IHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGFwaVJlcXVlc3Q8VCA9IGFueT4oXG4gIGVuZHBvaW50OiBzdHJpbmcsXG4gIG9wdGlvbnM6IFJlcXVlc3RJbml0ID0ge31cbik6IFByb21pc2U8QXBpUmVzcG9uc2U8VD4+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgYmFzZSBVUkwgZnJvbSBlbnZpcm9ubWVudCBvciB1c2Ugcm9idXN0IGZhbGxiYWNrXG4gICAgY29uc3QgYmFzZVVybCA9IHJlc29sdmVCYXNlVXJsKCk7XG4gICAgY29uc3QgdXJsID0gZW5kcG9pbnQuc3RhcnRzV2l0aCgnaHR0cCcpID8gZW5kcG9pbnQgOiBgJHtiYXNlVXJsfSR7ZW5kcG9pbnR9YDtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnQVBJIFJlcXVlc3Q6JywgeyBiYXNlVXJsLCBlbmRwb2ludCwgdXJsIH0pO1xuICAgIFxuICAgIC8vIEFkZCBhdXRoIGhlYWRlcnMgdG8gdGhlIHJlcXVlc3RcbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IGFkZEF1dGhIZWFkZXJzKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLCAvLyBJbmNsdWRlIGNvb2tpZXMgZm9yIENTUkYgcHJvdGVjdGlvblxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAuLi5vcHRpb25zLmhlYWRlcnMsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICB9LFxuICAgIH0pO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNYWtpbmcgZmV0Y2ggcmVxdWVzdCB0bzonLCB1cmwsICd3aXRoIG9wdGlvbnM6JywgcmVxdWVzdE9wdGlvbnMpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCByZXF1ZXN0T3B0aW9ucyk7XG4gICAgY29uc29sZS5sb2coJ1Jlc3BvbnNlIHJlY2VpdmVkOicsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG5cbiAgICByZXR1cm4gYXdhaXQgcHJvY2Vzc1Jlc3BvbnNlPFQ+KHJlc3BvbnNlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBBcGlFcnJvcikge1xuICAgICAgLy8gUmV0aHJvdyBBcGlFcnJvciBpbnN0YW5jZXNcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgbmV0d29yayBlcnJvcnNcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdOZXR3b3JrIGVycm9yJyxcbiAgICAgIDBcbiAgICApO1xuICB9XG59XG5cbi8vIENvbnZlbmllbmNlIG1ldGhvZHMgZm9yIGNvbW1vbiBIVFRQIG1ldGhvZHNcbmV4cG9ydCBjb25zdCBhcGkgPSB7XG4gIGFzeW5jIGdldDxUID0gYW55PihlbmRwb2ludDogc3RyaW5nLCBvcHRpb25zOiBSZXF1ZXN0SW5pdCA9IHt9KTogUHJvbWlzZTxBcGlSZXNwb25zZTxUPj4ge1xuICAgIHJldHVybiBhcGlSZXF1ZXN0PFQ+KGVuZHBvaW50LCB7IC4uLm9wdGlvbnMsIG1ldGhvZDogJ0dFVCcgfSk7XG4gIH0sXG4gIFxuICBhc3luYyBwb3N0PFQgPSBhbnk+KGVuZHBvaW50OiBzdHJpbmcsIGRhdGE6IGFueSwgb3B0aW9uczogUmVxdWVzdEluaXQgPSB7fSk6IFByb21pc2U8QXBpUmVzcG9uc2U8VD4+IHtcbiAgICByZXR1cm4gYXBpUmVxdWVzdDxUPihlbmRwb2ludCwge1xuICAgICAgLi4ub3B0aW9ucyxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgfSk7XG4gIH0sXG4gIFxuICBhc3luYyBwdXQ8VCA9IGFueT4oZW5kcG9pbnQ6IHN0cmluZywgZGF0YTogYW55LCBvcHRpb25zOiBSZXF1ZXN0SW5pdCA9IHt9KTogUHJvbWlzZTxBcGlSZXNwb25zZTxUPj4ge1xuICAgIHJldHVybiBhcGlSZXF1ZXN0PFQ+KGVuZHBvaW50LCB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgIH0pO1xuICB9LFxuICBcbiAgYXN5bmMgZGVsZXRlPFQgPSBhbnk+KGVuZHBvaW50OiBzdHJpbmcsIG9wdGlvbnM6IFJlcXVlc3RJbml0ID0ge30pOiBQcm9taXNlPEFwaVJlc3BvbnNlPFQ+PiB7XG4gICAgcmV0dXJuIGFwaVJlcXVlc3Q8VD4oZW5kcG9pbnQsIHsgLi4ub3B0aW9ucywgbWV0aG9kOiAnREVMRVRFJyB9KTtcbiAgfVxufTtcblxuLy8gQ2hhdCBBUEkgVHlwZXNcbmludGVyZmFjZSBDaGF0U2Vzc2lvbiB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGNyZWF0ZWQ6IHN0cmluZztcbiAgdXBkYXRlZDogc3RyaW5nO1xuICBtZXNzYWdlX2NvdW50OiBudW1iZXI7XG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pjtcbn1cblxuaW50ZXJmYWNlIENoYXRNZXNzYWdlIHtcbiAgaWQ6IHN0cmluZztcbiAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcbiAgY29udGVudDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IHN0cmluZztcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufVxuXG5pbnRlcmZhY2UgQXBpRXJyb3JSZXNwb25zZSB7XG4gIGVycm9yOiBzdHJpbmc7XG4gIHVzaW5nX2ZhbGxiYWNrPzogYm9vbGVhbjtcbiAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG4vLyBDaGF0IEFQSSBtZXRob2RzXG5leHBvcnQgY29uc3QgQ2hhdEFwaSA9IHtcbiAgLyoqXG4gICAqIEdldCBhbGwgY2hhdCBzZXNzaW9ucyBmb3IgdGhlIGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgKiBAcmV0dXJucyBQcm9taXNlIHdpdGggbGlzdCBvZiBjaGF0IHNlc3Npb25zXG4gICAqL1xuICAvKipcbiAgICogR2V0IGFsbCBjaGF0IHNlc3Npb25zIGZvciB0aGUgYXV0aGVudGljYXRlZCB1c2VyXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdCBmb3IgcGFnaW5hdGlvblxuICAgKiBAcGFyYW0gb2Zmc2V0IE9wdGlvbmFsIG9mZnNldCBmb3IgcGFnaW5hdGlvblxuICAgKiBAcmV0dXJucyBQcm9taXNlIHdpdGggbGlzdCBvZiBjaGF0IHNlc3Npb25zIGFuZCBwYWdpbmF0aW9uIGluZm9cbiAgICovXG4gIGFzeW5jIGdldFNlc3Npb25zKGxpbWl0PzogbnVtYmVyLCBvZmZzZXQ/OiBudW1iZXIpOiBQcm9taXNlPHtcbiAgICBzZXNzaW9uczogQ2hhdFNlc3Npb25bXTtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIGhhc19tb3JlOiBib29sZWFuO1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgIGlmIChsaW1pdCkgcGFyYW1zLmFwcGVuZCgnbGltaXQnLCBsaW1pdC50b1N0cmluZygpKTtcbiAgICAgIGlmIChvZmZzZXQpIHBhcmFtcy5hcHBlbmQoJ29mZnNldCcsIG9mZnNldC50b1N0cmluZygpKTtcbiAgICAgIFxuICAgICAgY29uc3QgcXVlcnkgPSBwYXJhbXMudG9TdHJpbmcoKTtcbiAgICAgIGNvbnN0IHVybCA9IHF1ZXJ5ID8gYCR7QVBJX0VORFBPSU5UUy5DSEFULlNFU1NJT05TfT8ke3F1ZXJ5fWAgOiBBUElfRU5EUE9JTlRTLkNIQVQuU0VTU0lPTlM7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmdldDx7XG4gICAgICAgIGRhdGE6IENoYXRTZXNzaW9uW107XG4gICAgICAgIHRvdGFsOiBudW1iZXI7XG4gICAgICAgIGhhc19tb3JlOiBib29sZWFuO1xuICAgICAgfT4odXJsKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2Vzc2lvbnM6IHJlc3BvbnNlLmRhdGE/LmRhdGEgfHwgW10sXG4gICAgICAgIHRvdGFsOiByZXNwb25zZS5kYXRhPy50b3RhbCB8fCAwLFxuICAgICAgICBoYXNfbW9yZTogcmVzcG9uc2UuZGF0YT8uaGFzX21vcmUgfHwgZmFsc2UsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvciB8fCAnRmFpbGVkIHRvIGZldGNoIGNoYXQgc2Vzc2lvbnMnO1xuICAgICAgY29uc3QgdXNpbmdGYWxsYmFjayA9IGVycm9yLnJlc3BvbnNlPy5kYXRhPy51c2luZ19mYWxsYmFjaztcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNoYXQgc2Vzc2lvbnM6JywgZXJyb3JNZXNzYWdlLCB7IHVzaW5nRmFsbGJhY2sgfSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBjaGF0IHNlc3Npb25cbiAgICogQHBhcmFtIHRpdGxlIE9wdGlvbmFsIHRpdGxlIGZvciB0aGUgbmV3IHNlc3Npb25cbiAgICogQHJldHVybnMgUHJvbWlzZSB3aXRoIHRoZSBuZXcgc2Vzc2lvbiBJRFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlU2Vzc2lvbih0aXRsZT86IHN0cmluZyk6IFByb21pc2U8eyBzZXNzaW9uX2lkOiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5wb3N0PHsgc2Vzc2lvbl9pZDogc3RyaW5nIH0+KFxuICAgICAgICBBUElfRU5EUE9JTlRTLkNIQVQuTkVXX1NFU1NJT04sXG4gICAgICAgIHsgdGl0bGU6IHRpdGxlIHx8ICdOZXcgQ2hhdCcgfVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKCFyZXNwb25zZS5kYXRhPy5zZXNzaW9uX2lkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBzZXJ2ZXInKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHsgc2Vzc2lvbl9pZDogcmVzcG9uc2UuZGF0YS5zZXNzaW9uX2lkIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNoYXQgc2Vzc2lvbjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgY2hhdCBzZXNzaW9uJyk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgY2hhdCBoaXN0b3J5IGZvciBhIHNwZWNpZmljIHNlc3Npb25cbiAgICogQHBhcmFtIHNlc3Npb25JZCBJRCBvZiB0aGUgY2hhdCBzZXNzaW9uXG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCBjaGF0IGhpc3RvcnlcbiAgICovXG4gIC8qKlxuICAgKiBHZXQgY2hhdCBoaXN0b3J5IGZvciBhIHNwZWNpZmljIHNlc3Npb25cbiAgICogQHBhcmFtIHNlc3Npb25JZCBJRCBvZiB0aGUgY2hhdCBzZXNzaW9uXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdCBmb3IgcGFnaW5hdGlvblxuICAgKiBAcGFyYW0gb2Zmc2V0IE9wdGlvbmFsIG9mZnNldCBmb3IgcGFnaW5hdGlvblxuICAgKiBAcmV0dXJucyBQcm9taXNlIHdpdGggY2hhdCBoaXN0b3J5IGFuZCBwYWdpbmF0aW9uIGluZm9cbiAgICovXG4gIGFzeW5jIGdldEhpc3RvcnkoXG4gICAgc2Vzc2lvbklkOiBzdHJpbmcsXG4gICAgbGltaXQ/OiBudW1iZXIsXG4gICAgb2Zmc2V0PzogbnVtYmVyXG4gICk6IFByb21pc2U8e1xuICAgIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xuICAgIHRvdGFsOiBudW1iZXI7XG4gICAgaGFzX21vcmU6IGJvb2xlYW47XG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICAgICAgaWYgKGxpbWl0KSBwYXJhbXMuYXBwZW5kKCdsaW1pdCcsIGxpbWl0LnRvU3RyaW5nKCkpO1xuICAgICAgaWYgKG9mZnNldCkgcGFyYW1zLmFwcGVuZCgnb2Zmc2V0Jywgb2Zmc2V0LnRvU3RyaW5nKCkpO1xuICAgICAgXG4gICAgICBjb25zdCBxdWVyeSA9IHBhcmFtcy50b1N0cmluZygpO1xuICAgICAgY29uc3QgdXJsID0gcXVlcnkgXG4gICAgICAgID8gYCR7QVBJX0VORFBPSU5UUy5DSEFULkhJU1RPUlkoc2Vzc2lvbklkKX0/JHtxdWVyeX1gXG4gICAgICAgIDogQVBJX0VORFBPSU5UUy5DSEFULkhJU1RPUlkoc2Vzc2lvbklkKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZ2V0PHtcbiAgICAgICAgZGF0YTogQ2hhdE1lc3NhZ2VbXTtcbiAgICAgICAgdG90YWw6IG51bWJlcjtcbiAgICAgICAgaGFzX21vcmU6IGJvb2xlYW47XG4gICAgICB9Pih1cmwpO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlczogcmVzcG9uc2UuZGF0YT8uZGF0YSB8fCBbXSxcbiAgICAgICAgdG90YWw6IHJlc3BvbnNlLmRhdGE/LnRvdGFsIHx8IDAsXG4gICAgICAgIGhhc19tb3JlOiByZXNwb25zZS5kYXRhPy5oYXNfbW9yZSB8fCBmYWxzZSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdGYWlsZWQgdG8gZmV0Y2ggY2hhdCBoaXN0b3J5JztcbiAgICAgIGNvbnN0IHVzaW5nRmFsbGJhY2sgPSBlcnJvci5yZXNwb25zZT8uZGF0YT8udXNpbmdfZmFsbGJhY2s7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjaGF0IGhpc3Rvcnk6JywgZXJyb3JNZXNzYWdlLCB7IHVzaW5nRmFsbGJhY2sgfSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFNlbmQgYSBtZXNzYWdlIGluIGEgY2hhdCBzZXNzaW9uXG4gICAqIEBwYXJhbSBzZXNzaW9uSWQgSUQgb2YgdGhlIGNoYXQgc2Vzc2lvblxuICAgKiBAcGFyYW0gbWVzc2FnZSBUaGUgbWVzc2FnZSBjb250ZW50XG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCB0aGUgYXNzaXN0YW50J3MgcmVzcG9uc2VcbiAgICovXG4gIC8qKlxuICAgKiBTZW5kIGEgbWVzc2FnZSBpbiBhIGNoYXQgc2Vzc2lvblxuICAgKiBAcGFyYW0gc2Vzc2lvbklkIElEIG9mIHRoZSBjaGF0IHNlc3Npb25cbiAgICogQHBhcmFtIG1lc3NhZ2UgVGhlIG1lc3NhZ2UgY29udGVudFxuICAgKiBAcGFyYW0gbWV0YWRhdGEgT3B0aW9uYWwgbWV0YWRhdGEgdG8gaW5jbHVkZSB3aXRoIHRoZSBtZXNzYWdlXG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCB0aGUgYXNzaXN0YW50J3MgcmVzcG9uc2VcbiAgICovXG4gIGFzeW5jIHNlbmRNZXNzYWdlKFxuICAgIHNlc3Npb25JZDogc3RyaW5nLFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgKTogUHJvbWlzZTx7XG4gICAgcmVzcG9uc2U6IHN0cmluZztcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gICAgc2Vzc2lvbl9pZDogc3RyaW5nO1xuICAgIG1lc3NhZ2VfaWQ6IHN0cmluZztcbiAgICB0aW1lc3RhbXA6IHN0cmluZztcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5wb3N0PHsgZGF0YTogYW55IH0+KFxuICAgICAgICBBUElfRU5EUE9JTlRTLkNIQVQuTUVTU0FHRSxcbiAgICAgICAge1xuICAgICAgICAgIHNlc3Npb25faWQ6IHNlc3Npb25JZCxcbiAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIC4uLihtZXRhZGF0YSAmJiB7IG1ldGFkYXRhIH0pLFxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLmRhdGEgfHwgIXJlc3BvbnNlLmRhdGEuZGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZm9ybWF0IGZyb20gc2VydmVyJyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3BvbnNlOiByZXNwb25zZS5kYXRhLmRhdGEucmVzcG9uc2UgfHwgJycsXG4gICAgICAgIG1ldGFkYXRhOiByZXNwb25zZS5kYXRhLmRhdGEubWV0YWRhdGEsXG4gICAgICAgIHNlc3Npb25faWQ6IHJlc3BvbnNlLmRhdGEuZGF0YS5zZXNzaW9uX2lkIHx8IHNlc3Npb25JZCxcbiAgICAgICAgbWVzc2FnZV9pZDogcmVzcG9uc2UuZGF0YS5kYXRhLm1lc3NhZ2VfaWQgfHwgYG1zZ18ke0RhdGUubm93KCl9YCxcbiAgICAgICAgdGltZXN0YW1wOiByZXNwb25zZS5kYXRhLmRhdGEudGltZXN0YW1wIHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdGYWlsZWQgdG8gc2VuZCBjaGF0IG1lc3NhZ2UnO1xuICAgICAgY29uc3QgdXNpbmdGYWxsYmFjayA9IGVycm9yLnJlc3BvbnNlPy5kYXRhPy51c2luZ19mYWxsYmFjaztcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgY2hhdCBtZXNzYWdlOicsIGVycm9yTWVzc2FnZSwgeyB1c2luZ0ZhbGxiYWNrIH0pO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxuICB9LFxufTtcblxuLy8gVHJhZGluZyBBUEkgbWV0aG9kc1xuZXhwb3J0IGNvbnN0IFRyYWRpbmdBcGkgPSB7XG4gIC8qKlxuICAgKiBFeGVjdXRlIGEgdHJhZGUgKGZpcnN0IHN0ZXAgb2YgdHdvLXBoYXNlIHRyYWRlIGV4ZWN1dGlvbilcbiAgICogQHBhcmFtIHBhcmFtcyBUcmFkZSBleGVjdXRpb24gcGFyYW1ldGVyc1xuICAgKiBAcmV0dXJucyBUcmFkZSBleGVjdXRpb24gcmVzdWx0IHdpdGggY29uZmlybWF0aW9uIElEIGlmIGNvbmZpcm1hdGlvbiByZXF1aXJlZFxuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZVRyYWRlKHBhcmFtczoge1xuICAgIGFjdGlvbjogJ2J1eScgfCAnc2VsbCc7XG4gICAgdG9rZW46IHN0cmluZztcbiAgICBhbW91bnQ6IHN0cmluZyB8IG51bWJlcjtcbiAgICBpc0xldmVyYWdlPzogYm9vbGVhbjtcbiAgICBsZXZlcmFnZT86IG51bWJlcjtcbiAgICBzdG9wTG9zcz86IG51bWJlcjtcbiAgICB0YWtlUHJvZml0PzogbnVtYmVyO1xuICB9KTogUHJvbWlzZTxUcmFkZUV4ZWN1dGlvblJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5wb3N0KCcvYXBpL3RyYWRpbmcvZXhlY3V0ZScsIHtcbiAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICBhbW91bnQ6IHBhcmFtcy5hbW91bnQudG9TdHJpbmcoKVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignVHJhZGUgZXhlY3V0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGVycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvciB8fCAnVHJhZGUgZXhlY3V0aW9uIGZhaWxlZCdcbiAgICAgICk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBDb25maXJtIGEgcGVuZGluZyB0cmFkZSAoc2Vjb25kIHN0ZXAgb2YgdHdvLXBoYXNlIHRyYWRlIGV4ZWN1dGlvbilcbiAgICogQHBhcmFtIGNvbmZpcm1hdGlvbklkIFRoZSBjb25maXJtYXRpb24gSUQgZnJvbSBleGVjdXRlVHJhZGUgcmVzcG9uc2VcbiAgICogQHJldHVybnMgRmluYWwgdHJhZGUgZXhlY3V0aW9uIHJlc3VsdFxuICAgKi9cbiAgYXN5bmMgY29uZmlybVRyYWRlKGNvbmZpcm1hdGlvbklkOiBzdHJpbmcpOiBQcm9taXNlPFRyYWRlRXhlY3V0aW9uUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLnBvc3QoJy9hcGkvdHJhZGluZy9jb25maXJtJywge1xuICAgICAgICBjb25maXJtYXRpb25faWQ6IGNvbmZpcm1hdGlvbklkXG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdUcmFkZSBjb25maXJtYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdUcmFkZSBjb25maXJtYXRpb24gZmFpbGVkJ1xuICAgICAgKTtcbiAgICB9XG4gIH0sXG4gIFxuICAvKipcbiAgICogQ2xvc2UgYW4gZXhpc3RpbmcgcG9zaXRpb24gKGxldmVyYWdlIG9yIHNwb3QpXG4gICAqIEBwYXJhbSBwYXJhbXMgUG9zaXRpb24gcGFyYW1ldGVycyB0byBjbG9zZVxuICAgKiBAcmV0dXJucyBQb3NpdGlvbiBjbG9zaW5nIHJlc3VsdFxuICAgKi9cbiAgYXN5bmMgY2xvc2VQb3NpdGlvbihwYXJhbXM6IHtcbiAgICBtYXJrZXQ6IHN0cmluZztcbiAgICBwb3NpdGlvbl9pZD86IHN0cmluZztcbiAgICBzaXplPzogbnVtYmVyO1xuICAgIHByaWNlPzogbnVtYmVyO1xuICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdCgnL2FwaS90cmFkaW5nL3NlbGwtcG9zaXRpb24nLCBwYXJhbXMpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Bvc2l0aW9uIGNsb3NpbmcgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdGYWlsZWQgdG8gY2xvc2UgcG9zaXRpb24nXG4gICAgICApO1xuICAgIH1cbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBTZWxsIGEgc3BvdCB0b2tlbiBmb3IgYW5vdGhlciB0b2tlbiAodXN1YWxseSBVU0RDKVxuICAgKiBAcGFyYW0gcGFyYW1zIFRva2VuIHNlbGxpbmcgcGFyYW1ldGVyc1xuICAgKiBAcmV0dXJucyBUb2tlbiBzZWxsaW5nIHJlc3VsdFxuICAgKi9cbiAgYXN5bmMgc2VsbFRva2VuKHBhcmFtczoge1xuICAgIHRva2VuOiBzdHJpbmc7XG4gICAgYW1vdW50OiBudW1iZXIgfCBzdHJpbmc7XG4gICAgdGFyZ2V0X3Rva2VuPzogc3RyaW5nO1xuICAgIHByaWNlPzogbnVtYmVyO1xuICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdCgnL2FwaS90cmFkaW5nL3NlbGwtdG9rZW4nLCB7XG4gICAgICAgIC4uLnBhcmFtcyxcbiAgICAgICAgYW1vdW50OiBwYXJhbXMuYW1vdW50LnRvU3RyaW5nKClcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rva2VuIHNlbGxpbmcgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdGYWlsZWQgdG8gc2VsbCB0b2tlbidcbiAgICAgICk7XG4gICAgfVxuICB9LFxuICBcbiAgLyoqXG4gICAqIFNlbGwgb3IgY2xvc2UgYSBwb3NpdGlvbiAoZnVsbCBvciBwYXJ0aWFsKVxuICAgKiBAcGFyYW0gcGFyYW1zIFBvc2l0aW9uIHNlbGxpbmcgcGFyYW1ldGVyc1xuICAgKiBAcmV0dXJucyBSZXN1bHQgb2YgdGhlIHBvc2l0aW9uIHNhbGVcbiAgICovXG4gIGFzeW5jIHNlbGxQb3NpdGlvbihwYXJhbXM6IHtcbiAgICBwb3NpdGlvbklkOiBzdHJpbmc7XG4gICAgdG9rZW46IHN0cmluZztcbiAgICBhbW91bnQ6IG51bWJlcjtcbiAgICB0eXBlOiAnc3BvdCcgfCAnbGV2ZXJhZ2UnO1xuICAgIHBlcmNlbnRhZ2U/OiBudW1iZXI7IC8vIE9wdGlvbmFsOiBwZXJjZW50YWdlIG9mIHBvc2l0aW9uIHRvIGNsb3NlICgwLTEwMClcbiAgfSk6IFByb21pc2U8e3N1Y2Nlc3M6IGJvb2xlYW47IG1lc3NhZ2U/OiBzdHJpbmc7IGVycm9yPzogc3RyaW5nfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXF1ZXN0RGF0YSA9IHsuLi5wYXJhbXN9O1xuICAgICAgXG4gICAgICAvLyBJZiBwZXJjZW50YWdlIGlzIHByb3ZpZGVkLCBhZGp1c3QgdGhlIGFtb3VudCBhY2NvcmRpbmdseVxuICAgICAgaWYgKHBhcmFtcy5wZXJjZW50YWdlICYmIHBhcmFtcy5wZXJjZW50YWdlID4gMCAmJiBwYXJhbXMucGVyY2VudGFnZSA8IDEwMCkge1xuICAgICAgICByZXF1ZXN0RGF0YS5hbW91bnQgPSAocGFyYW1zLmFtb3VudCAqIHBhcmFtcy5wZXJjZW50YWdlIC8gMTAwKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdChBUElfRU5EUE9JTlRTLlRSQURJTkcuU0VMTF9QT1NJVElPTiwgcmVxdWVzdERhdGEpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjbG9zZSBwb3NpdGlvbjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGVycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvciB8fCAnRmFpbGVkIHRvIGNsb3NlIHBvc2l0aW9uJ1xuICAgICAgKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldCB1c2VyJ3MgbGV2ZXJhZ2UgcG9zaXRpb25zIGZyb20gTWFuZ28gVjNcbiAgICogQHJldHVybnMgVXNlcidzIGxldmVyYWdlIHBvc2l0aW9ucyB3aXRoIHN1Y2Nlc3MvZXJyb3Igc3RhdHVzXG4gICAqL1xuICBhc3luYyBnZXRVc2VyTGV2ZXJhZ2VQb3NpdGlvbnMoKTogUHJvbWlzZTxVc2VyUG9zaXRpb25zUmVzcG9uc2U+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZ2V0PFVzZXJQb3NpdGlvbnNSZXNwb25zZSB8IGFueVtdPihBUElfRU5EUE9JTlRTLlVTRVIuTEVWRVJBR0VfUE9TSVRJT05TKTtcbiAgICAgIFxuICAgICAgLy8gSWYgcmVzcG9uc2UgYWxyZWFkeSBoYXMgdGhlIHJpZ2h0IGZvcm1hdCwgcmV0dXJuIGl0IGRpcmVjdGx5XG4gICAgICBpZiAocmVzcG9uc2UuZGF0YSAmJiB0eXBlb2YgcmVzcG9uc2UuZGF0YSA9PT0gJ29iamVjdCcgJiYgJ3N1Y2Nlc3MnIGluIHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEgYXMgVXNlclBvc2l0aW9uc1Jlc3BvbnNlO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBPdGhlcndpc2UgZm9ybWF0IGFjY29yZGluZyB0byBNYW5nbyBWMyBzcGVjXG4gICAgICBjb25zdCBwb3NpdGlvbnMgPSBBcnJheS5pc0FycmF5KHJlc3BvbnNlLmRhdGEpID8gcmVzcG9uc2UuZGF0YSA6IFtdO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgcG9zaXRpb25zLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHRvdGFsX3Bvc2l0aW9uczogcG9zaXRpb25zLmxlbmd0aCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBsZXZlcmFnZSBwb3NpdGlvbnM6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIHBvc2l0aW9uczogW10sXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGZldGNoIGxldmVyYWdlIHBvc2l0aW9ucycsXG4gICAgICAgICAgY29kZTogJ1BPU0lUSU9OX0ZFVENIX0VSUk9SJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogR2V0IHVzZXIncyBzcG90IHBvc2l0aW9ucyBmcm9tIHdhbGxldCBiYWxhbmNlc1xuICAgKiBAcmV0dXJucyBVc2VyJ3Mgc3BvdCBwb3NpdGlvbnMgd2l0aCBzdWNjZXNzL2Vycm9yIHN0YXR1c1xuICAgKi9cbiAgYXN5bmMgZ2V0VXNlclNwb3RQb3NpdGlvbnMoKTogUHJvbWlzZTxVc2VyUG9zaXRpb25zUmVzcG9uc2U+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZ2V0PFVzZXJQb3NpdGlvbnNSZXNwb25zZSB8IGFueVtdPihBUElfRU5EUE9JTlRTLlVTRVIuU1BPVF9QT1NJVElPTlMpO1xuICAgICAgXG4gICAgICAvLyBJZiByZXNwb25zZSBhbHJlYWR5IGhhcyB0aGUgcmlnaHQgZm9ybWF0LCByZXR1cm4gaXQgZGlyZWN0bHlcbiAgICAgIGlmIChyZXNwb25zZS5kYXRhICYmIHR5cGVvZiByZXNwb25zZS5kYXRhID09PSAnb2JqZWN0JyAmJiAnc3VjY2VzcycgaW4gcmVzcG9uc2UuZGF0YSkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YSBhcyBVc2VyUG9zaXRpb25zUmVzcG9uc2U7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIE90aGVyd2lzZSBmb3JtYXQgYWNjb3JkaW5nIHRvIE1hbmdvIFYzIHNwZWNcbiAgICAgIGNvbnN0IHBvc2l0aW9ucyA9IEFycmF5LmlzQXJyYXkocmVzcG9uc2UuZGF0YSkgPyByZXNwb25zZS5kYXRhIDogW107XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBwb3NpdGlvbnMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdG90YWxfcG9zaXRpb25zOiBwb3NpdGlvbnMubGVuZ3RoLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHNwb3QgcG9zaXRpb25zOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBwb3NpdGlvbnM6IFtdLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBzcG90IHBvc2l0aW9ucycsXG4gICAgICAgICAgY29kZTogJ1BPU0lUSU9OX0ZFVENIX0VSUk9SJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogR2V0IHBvc2l0aW9uIGhpc3RvcnkgZm9yIGEgdXNlciB3aXRoIHBhZ2luYXRpb24gYW5kIGZpbHRlcmluZ1xuICAgKiBAcGFyYW0gcGFyYW1zIFF1ZXJ5IHBhcmFtZXRlcnMgZm9yIGZpbHRlcmluZyBwb3NpdGlvbiBoaXN0b3J5XG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCBwb3NpdGlvbiBoaXN0b3J5IGRhdGFcbiAgICovXG4gIGdldFBvc2l0aW9uSGlzdG9yeTogYXN5bmMgKHBhcmFtcz86IHtcbiAgICBtYXJrZXQ/OiBzdHJpbmc7XG4gICAgc3RhcnRUaW1lPzogc3RyaW5nIHwgbnVtYmVyO1xuICAgIGVuZFRpbWU/OiBzdHJpbmcgfCBudW1iZXI7XG4gICAgaW50ZXJ2YWw/OiBzdHJpbmc7XG4gICAgaW5jbHVkZVBubD86IGJvb2xlYW47XG4gICAgaW5jbHVkZUxpdmVQbmw/OiBib29sZWFuO1xuICAgIGN1cnNvcj86IHN0cmluZztcbiAgICBsaW1pdD86IG51bWJlcjtcbiAgfSk6IFByb21pc2U8UG9zaXRpb25IaXN0b3J5UmVzcG9uc2U+ID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQnVpbGQgcXVlcnkgcGFyYW1ldGVyc1xuICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICBcbiAgICAgIGlmIChwYXJhbXM/Lm1hcmtldCkgcXVlcnlQYXJhbXMuYXBwZW5kKCdtYXJrZXQnLCBwYXJhbXMubWFya2V0KTtcbiAgICAgIGlmIChwYXJhbXM/LnN0YXJ0VGltZSkgcXVlcnlQYXJhbXMuYXBwZW5kKCdzdGFydF90aW1lJywgU3RyaW5nKHBhcmFtcy5zdGFydFRpbWUpKTtcbiAgICAgIGlmIChwYXJhbXM/LmVuZFRpbWUpIHF1ZXJ5UGFyYW1zLmFwcGVuZCgnZW5kX3RpbWUnLCBTdHJpbmcocGFyYW1zLmVuZFRpbWUpKTtcbiAgICAgIGlmIChwYXJhbXM/LmludGVydmFsKSBxdWVyeVBhcmFtcy5hcHBlbmQoJ2ludGVydmFsJywgcGFyYW1zLmludGVydmFsKTtcbiAgICAgIGlmIChwYXJhbXM/LmluY2x1ZGVQbmwgIT09IHVuZGVmaW5lZCkgcXVlcnlQYXJhbXMuYXBwZW5kKCdpbmNsdWRlX3BubCcsIFN0cmluZyhwYXJhbXMuaW5jbHVkZVBubCkpO1xuICAgICAgaWYgKHBhcmFtcz8uaW5jbHVkZUxpdmVQbmwpIHF1ZXJ5UGFyYW1zLmFwcGVuZCgnaW5jbHVkZV9saXZlX3BubCcsICd0cnVlJyk7XG4gICAgICBpZiAocGFyYW1zPy5jdXJzb3IpIHF1ZXJ5UGFyYW1zLmFwcGVuZCgnY3Vyc29yJywgcGFyYW1zLmN1cnNvcik7XG4gICAgICBpZiAocGFyYW1zPy5saW1pdCkgcXVlcnlQYXJhbXMuYXBwZW5kKCdsaW1pdCcsIFN0cmluZyhwYXJhbXMubGltaXQpKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtBUElfRU5EUE9JTlRTLlVTRVIuUE9TSVRJT05fSElTVE9SWX0/JHtxdWVyeVBhcmFtcy50b1N0cmluZygpfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7Z2V0QXV0aFRva2VuKCl9YFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgLy8gSGFuZGxlIGVycm9yIHJlc3BvbnNlc1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBkYXRhPy5lcnJvciB8fCB7fTtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIGVycm9yRGF0YS5tZXNzYWdlIHx8IGBIVFRQIGVycm9yISBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWAsXG4gICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvZGU6IGVycm9yRGF0YS5jb2RlIHx8ICdhcGlfZXJyb3InLFxuICAgICAgICAgICAgc3RhdHVzOiBlcnJvckRhdGEuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZXJyb3JEYXRhLnRpbWVzdGFtcCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAuLi4oZXJyb3JEYXRhLmRldGFpbHMgJiYgeyBkZXRhaWxzOiBlcnJvckRhdGEuZGV0YWlscyB9KVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVHJhbnNmb3JtIHRoZSBzdWNjZXNzZnVsIHJlc3BvbnNlIHRvIG1hdGNoIHRoZSBQb3NpdGlvbkhpc3RvcnlSZXNwb25zZSB0eXBlXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBkYXRhLnN1Y2Nlc3MsXG4gICAgICAgIHBvc2l0aW9uX2hpc3Rvcnk6IGRhdGEucG9zaXRpb25faGlzdG9yeSB8fCBbXSxcbiAgICAgICAgcG5sX292ZXJfdGltZTogZGF0YS5wbmxfb3Zlcl90aW1lIHx8IFtdLFxuICAgICAgICBwYWdpbmF0aW9uOiBkYXRhLnBhZ2luYXRpb24gfHwge1xuICAgICAgICAgIGhhc19tb3JlOiBkYXRhLm1ldGFkYXRhPy5oYXNfbW9yZSB8fCBmYWxzZSxcbiAgICAgICAgICBuZXh0X2N1cnNvcjogZGF0YS5tZXRhZGF0YT8uY3Vyc29yLFxuICAgICAgICAgIGxpbWl0OiBwYXJhbXM/LmxpbWl0IHx8IDEwMCxcbiAgICAgICAgICB0b3RhbDogZGF0YS5tZXRhZGF0YT8udG90YWwgfHwgMFxuICAgICAgICB9LFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHVzZXJfaWRlbnRpZmllcjogZGF0YS5tZXRhZGF0YT8udXNlcl9pZGVudGlmaWVyIHx8ICcnLFxuICAgICAgICAgIG1hcmtldDogcGFyYW1zPy5tYXJrZXQgfHwgJ2FsbCcsXG4gICAgICAgICAgc3RhcnRfdGltZTogZGF0YS5tZXRhZGF0YT8uc3RhcnRfdGltZSB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgZW5kX3RpbWU6IGRhdGEubWV0YWRhdGE/LmVuZF90aW1lIHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBpbnRlcnZhbDogcGFyYW1zPy5pbnRlcnZhbCB8fCAnMWQnLFxuICAgICAgICAgIHRvdGFsX3Bvc2l0aW9uczogZGF0YS5tZXRhZGF0YT8udG90YWwgfHwgMCxcbiAgICAgICAgICBoYXNfbW9yZTogZGF0YS5tZXRhZGF0YT8uaGFzX21vcmUgfHwgZmFsc2UsXG4gICAgICAgICAgY3Vyc29yOiBkYXRhLm1ldGFkYXRhPy5jdXJzb3JcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcG9zaXRpb24gaGlzdG9yeTonLCBlcnJvcik7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBBcGlFcnJvciBpbnN0YW5jZXNcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEFwaUVycm9yKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgcG9zaXRpb25faGlzdG9yeTogW10sXG4gICAgICAgICAgcG5sX292ZXJfdGltZTogW10sXG4gICAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgICAgaGFzX21vcmU6IGZhbHNlLFxuICAgICAgICAgICAgbmV4dF9jdXJzb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGxpbWl0OiBwYXJhbXM/LmxpbWl0IHx8IDEwMCxcbiAgICAgICAgICAgIHRvdGFsOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgdXNlcl9pZGVudGlmaWVyOiAnJyxcbiAgICAgICAgICAgIG1hcmtldDogcGFyYW1zPy5tYXJrZXQgfHwgJ2FsbCcsXG4gICAgICAgICAgICBzdGFydF90aW1lOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBlbmRfdGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgaW50ZXJ2YWw6IHBhcmFtcz8uaW50ZXJ2YWwgfHwgJzFkJyxcbiAgICAgICAgICAgIHRvdGFsX3Bvc2l0aW9uczogMCxcbiAgICAgICAgICAgIGhhc19tb3JlOiBmYWxzZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgZXJyb3JfZGV0YWlsczogZXJyb3IuZGF0YVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBIYW5kbGUgb3RoZXIgdHlwZXMgb2YgZXJyb3JzXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgcG9zaXRpb25faGlzdG9yeTogW10sXG4gICAgICAgIHBubF9vdmVyX3RpbWU6IFtdLFxuICAgICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgICAgaGFzX21vcmU6IGZhbHNlLFxuICAgICAgICAgIG5leHRfY3Vyc29yOiB1bmRlZmluZWQsXG4gICAgICAgICAgbGltaXQ6IHBhcmFtcz8ubGltaXQgfHwgMTAwLFxuICAgICAgICAgIHRvdGFsOiAwXG4gICAgICAgIH0sXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdXNlcl9pZGVudGlmaWVyOiAnJyxcbiAgICAgICAgICBtYXJrZXQ6IHBhcmFtcz8ubWFya2V0IHx8ICdhbGwnLFxuICAgICAgICAgIHN0YXJ0X3RpbWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBlbmRfdGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIGludGVydmFsOiBwYXJhbXM/LmludGVydmFsIHx8ICcxZCcsXG4gICAgICAgICAgdG90YWxfcG9zaXRpb25zOiAwLFxuICAgICAgICAgIGhhc19tb3JlOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgIGVycm9yX2RldGFpbHM6IHtcbiAgICAgICAgICBjb2RlOiAndW5leHBlY3RlZF9lcnJvcicsXG4gICAgICAgICAgc3RhdHVzOiA1MDAsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldCBkZXRhaWxlZCBwb3NpdGlvbiBoaXN0b3J5IGZvciBhIHNwZWNpZmljIHBvc2l0aW9uXG4gICAqIEBwYXJhbSBwb3NpdGlvbklkIElEIG9mIHRoZSBwb3NpdGlvbiB0byBnZXQgaGlzdG9yeSBmb3JcbiAgICogQHBhcmFtIHBhcmFtcyBBZGRpdGlvbmFsIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICogQHJldHVybnMgUHJvbWlzZSB3aXRoIGRldGFpbGVkIHBvc2l0aW9uIGhpc3RvcnlcbiAgICovXG4gIGdldFBvc2l0aW9uRGV0YWlsczogYXN5bmMgKFxuICAgIHBvc2l0aW9uSWQ6IHN0cmluZyxcbiAgICBwYXJhbXM/OiB7XG4gICAgICBzdGFydFRpbWU/OiBzdHJpbmcgfCBudW1iZXI7XG4gICAgICBlbmRUaW1lPzogc3RyaW5nIHwgbnVtYmVyO1xuICAgICAgaW50ZXJ2YWw/OiBzdHJpbmc7XG4gICAgfVxuICApOiBQcm9taXNlPFBvc2l0aW9uSGlzdG9yeUVudHJ5PiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENvbnZlcnQgcGFyYW1zIHRvIHF1ZXJ5IHN0cmluZ1xuICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgcG9zaXRpb25JZCB9KTtcbiAgICAgIGlmIChwYXJhbXM/LnN0YXJ0VGltZSkgcXVlcnlQYXJhbXMuYXBwZW5kKCdzdGFydFRpbWUnLCBTdHJpbmcocGFyYW1zLnN0YXJ0VGltZSkpO1xuICAgICAgaWYgKHBhcmFtcz8uZW5kVGltZSkgcXVlcnlQYXJhbXMuYXBwZW5kKCdlbmRUaW1lJywgU3RyaW5nKHBhcmFtcy5lbmRUaW1lKSk7XG4gICAgICBpZiAocGFyYW1zPy5pbnRlcnZhbCkgcXVlcnlQYXJhbXMuYXBwZW5kKCdpbnRlcnZhbCcsIHBhcmFtcy5pbnRlcnZhbCk7XG5cbiAgICAgIGNvbnN0IGVuZHBvaW50ID0gYCR7QVBJX0VORFBPSU5UUy5VU0VSLlBPU0lUSU9OX0hJU1RPUll9L2RldGFpbHM/JHtxdWVyeVBhcmFtcy50b1N0cmluZygpfWA7XG4gICAgICAvLyBDcmVhdGUgaGVhZGVycyBvYmplY3Qgd2l0aCBwcm9wZXIgdHlwaW5nXG4gICAgICBjb25zdCBhdXRoSGVhZGVycyA9IGFkZEF1dGhIZWFkZXJzKCk7XG4gICAgICBjb25zdCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgIGhlYWRlcnMuYXBwZW5kKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgXG4gICAgICAvLyBBZGQgYXV0aCBoZWFkZXJzIGlmIHRoZXkgZXhpc3RcbiAgICAgIGlmIChhdXRoSGVhZGVycykge1xuICAgICAgICBPYmplY3QuZW50cmllcyhhdXRoSGVhZGVycykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgaWYgKHZhbHVlKSBoZWFkZXJzLmFwcGVuZChrZXksIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmdldDx7IHN1Y2Nlc3M6IGJvb2xlYW47IGRhdGE6IFBvc2l0aW9uSGlzdG9yeUVudHJ5IH0+KGVuZHBvaW50LCB7IGhlYWRlcnMgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzcG9uc2UuZXJyb3IgfHwgJ0ZhaWxlZCB0byBmZXRjaCBwb3NpdGlvbiBkZXRhaWxzJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAocmVzcG9uc2UuZGF0YSBhcyBhbnkpLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHBvc2l0aW9uIGRldGFpbHM6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBhcGk7XG4iXSwibmFtZXMiOlsiQVBJX0JBU0VfVVJMIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0FQSV9VUkwiLCJyZXNvbHZlQmFzZVVybCIsImVudlVybCIsInRyaW0iLCJlbmRzV2l0aCIsInNsaWNlIiwiQVVUSF9UT0tFTl9LRVkiLCJBTFRfVE9LRU5fS0VZIiwiZ2V0QXV0aFRva2VuIiwic2Vzc2lvblN0b3JhZ2UiLCJnZXRJdGVtIiwibG9jYWxTdG9yYWdlIiwic2F2ZUF1dGhUb2tlbiIsInRva2VuIiwic2V0SXRlbSIsInJlbW92ZUF1dGhUb2tlbiIsInJlbW92ZUl0ZW0iLCJhZGRBdXRoSGVhZGVycyIsIm9wdGlvbnMiLCJoZWFkZXJzIiwiQXBpRXJyb3IiLCJFcnJvciIsInN0YXR1c0NvZGUiLCJkYXRhIiwibWVzc2FnZSIsIm5hbWUiLCJnZXRCYXNlVXJsIiwiYmFzZSIsIkFQSV9FTkRQT0lOVFMiLCJBVVRIIiwiTE9HSU4iLCJSRUdJU1RFUiIsIlZFUklGWV9UT0tFTiIsIkxPR09VVCIsIlJFRlJFU0hfVE9LRU4iLCJGT1JHT1RfUEFTU1dPUkQiLCJSRVNFVF9QQVNTV09SRCIsIlVTRVIiLCJQUk9GSUxFIiwiTEVWRVJBR0VfUE9TSVRJT05TIiwiU1BPVF9QT1NJVElPTlMiLCJQT1NJVElPTl9ISVNUT1JZIiwiVFJBREVfSElTVE9SWSIsIkxJTUlUX09SREVSUyIsIldBTExFVCIsIkRBVEEiLCJJTkZPIiwiTUFOR09fQkFMQU5DRSIsIkdFTkVSQVRFIiwiU0VORCIsIkNPTk5FQ1RfUEhBTlRPTSIsIkNPTVBMRVRFX1BIQU5UT00iLCJESVNDT05ORUNUX1BIQU5UT00iLCJCQUxBTkNFIiwiVFJBTlNBQ1RJT05TIiwiQ0hBVCIsIlNFU1NJT05TIiwiTkVXX1NFU1NJT04iLCJISVNUT1JZIiwic2Vzc2lvbklkIiwiTUVTU0FHRSIsIlNPQ0lBTCIsIlNFTlRJTUVOVCIsIlRSRU5ESU5HIiwiSU5GTFVFTlRJQUwiLCJUV0VFVFMiLCJNQU5HTyIsIkJBU0UiLCJPSExDViIsIk1BUktFVFMiLCJPUkRFUl9CT09LIiwiVFJBREVTIiwiTUFSS0VUX1NUQVRTIiwiQ09NTVVOSVRJRVMiLCJFTlRJVElFUyIsIkZFRUQiLCJDT05ORUNUSU9OUyIsIlRSQURJTkciLCJFWEVDVVRFIiwiQ09ORklSTSIsIlNNQVJUX1NFVFRJTkdTIiwiVE9LRU5TIiwiUFJJQ0VfQ0hBUlQiLCJTV0FQIiwiU0VMTF9QT1NJVElPTiIsIlVTRVJfUE9TSVRJT05TIiwiU0VUVElOR1MiLCJOT1RJRklDQVRJT05TIiwiVFJBRElOR19TRVRUSU5HUyIsIm5vcm1hbGl6ZVJlc3BvbnNlIiwicmVzcG9uc2VEYXRhIiwicmVzdCIsInN1Y2Nlc3MiLCJyZXN1bHRzIiwidW5kZWZpbmVkIiwicHJvY2Vzc1Jlc3BvbnNlIiwicmVzcG9uc2UiLCJyZXNwb25zZUNsb25lIiwiY2xvbmUiLCJib2R5VGV4dCIsInRleHQiLCJKU09OIiwicGFyc2UiLCJlIiwib2siLCJlcnJvciIsInN0YXR1cyIsInJhd1Jlc3BvbnNlIiwiY29uc29sZSIsImFwaVJlcXVlc3QiLCJlbmRwb2ludCIsImJhc2VVcmwiLCJ1cmwiLCJzdGFydHNXaXRoIiwibG9nIiwicmVxdWVzdE9wdGlvbnMiLCJjcmVkZW50aWFscyIsImZldGNoIiwic3RhdHVzVGV4dCIsImFwaSIsImdldCIsIm1ldGhvZCIsInBvc3QiLCJib2R5Iiwic3RyaW5naWZ5IiwicHV0IiwiZGVsZXRlIiwiQ2hhdEFwaSIsImdldFNlc3Npb25zIiwibGltaXQiLCJvZmZzZXQiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJhcHBlbmQiLCJ0b1N0cmluZyIsInF1ZXJ5Iiwic2Vzc2lvbnMiLCJ0b3RhbCIsImhhc19tb3JlIiwiZXJyb3JNZXNzYWdlIiwidXNpbmdGYWxsYmFjayIsInVzaW5nX2ZhbGxiYWNrIiwiY3JlYXRlU2Vzc2lvbiIsInRpdGxlIiwic2Vzc2lvbl9pZCIsImdldEhpc3RvcnkiLCJtZXNzYWdlcyIsInNlbmRNZXNzYWdlIiwibWV0YWRhdGEiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJtZXNzYWdlX2lkIiwibm93IiwiVHJhZGluZ0FwaSIsImV4ZWN1dGVUcmFkZSIsImFtb3VudCIsImNvbmZpcm1UcmFkZSIsImNvbmZpcm1hdGlvbklkIiwiY29uZmlybWF0aW9uX2lkIiwiY2xvc2VQb3NpdGlvbiIsInNlbGxUb2tlbiIsInNlbGxQb3NpdGlvbiIsInJlcXVlc3REYXRhIiwicGVyY2VudGFnZSIsImdldFVzZXJMZXZlcmFnZVBvc2l0aW9ucyIsInBvc2l0aW9ucyIsIkFycmF5IiwiaXNBcnJheSIsInRvdGFsX3Bvc2l0aW9ucyIsImxlbmd0aCIsImNvZGUiLCJnZXRVc2VyU3BvdFBvc2l0aW9ucyIsImdldFBvc2l0aW9uSGlzdG9yeSIsInF1ZXJ5UGFyYW1zIiwibWFya2V0Iiwic3RhcnRUaW1lIiwiU3RyaW5nIiwiZW5kVGltZSIsImludGVydmFsIiwiaW5jbHVkZVBubCIsImluY2x1ZGVMaXZlUG5sIiwiY3Vyc29yIiwianNvbiIsImVycm9yRGF0YSIsImRldGFpbHMiLCJwb3NpdGlvbl9oaXN0b3J5IiwicG5sX292ZXJfdGltZSIsInBhZ2luYXRpb24iLCJuZXh0X2N1cnNvciIsInVzZXJfaWRlbnRpZmllciIsInN0YXJ0X3RpbWUiLCJlbmRfdGltZSIsImVycm9yX2RldGFpbHMiLCJnZXRQb3NpdGlvbkRldGFpbHMiLCJwb3NpdGlvbklkIiwiYXV0aEhlYWRlcnMiLCJIZWFkZXJzIiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWx1ZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./api/apiClient.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./components/AuthContext.tsx":
/*!************************************!*\
  !*** ./components/AuthContext.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthProvider: () => (/* binding */ AuthProvider),\n/* harmony export */   useAuth: () => (/* binding */ useAuth)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _api_apiClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../api/apiClient */ \"(pages-dir-node)/./api/apiClient.ts\");\n/* harmony import */ var _utils_devAuth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/devAuth */ \"(pages-dir-node)/./utils/devAuth.ts\");\n/* harmony import */ var _utils_authUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/authUtils */ \"(pages-dir-node)/./utils/authUtils.ts\");\n// src/ui/components/AuthContext.tsx\n\n\n\n\n// Import admin backdoor utilities\n\n// Import standardized auth utils\n\nconst TOKEN_EXPIRY_KEY = 'grace_token_expiry';\nconst REFRESH_TOKEN_KEY = 'grace_refresh_token';\nconst TOKEN_VERIFY_INTERVAL = 60000; // Check token validity every 60 seconds\n// Improved session persistence utility to avoid conflicts with form state\nconst SessionPersistence = {\n    STORAGE_KEY: 'GRACE_SESSION_SNAPSHOT',\n    // Safely capture session snapshot with minimal data to avoid interference\n    captureSnapshot (user, token) {\n        try {\n            if (!user || !token) {\n                this.clearSnapshot();\n                return;\n            }\n            // Store only essential user identification data\n            // Avoid storing complete state that might conflict with forms\n            const snapshot = {\n                timestamp: Date.now(),\n                user: {\n                    id: user.id,\n                    username: user.username,\n                    email: user.email\n                },\n                // Don't store the actual token, just indicate authentication\n                authenticated: true\n            };\n            // Use sessionStorage instead of localStorage to avoid persisting between browser sessions\n            // This helps prevent stale data from affecting forms on future visits\n            sessionStorage.setItem(this.STORAGE_KEY, JSON.stringify(snapshot));\n        } catch (error) {\n            console.warn('Failed to capture session snapshot', error);\n        // Silently fail - don't let snapshot errors affect the application\n        }\n    },\n    // Retrieve session snapshot with validation\n    retrieveSnapshot () {\n        try {\n            const snapshotStr = sessionStorage.getItem(this.STORAGE_KEY);\n            if (!snapshotStr) return {\n                user: null,\n                token: null\n            };\n            const snapshot = JSON.parse(snapshotStr);\n            // Validate snapshot with expiration check (30 minutes)\n            const MAX_AGE = 30 * 60 * 1000; // 30 minutes in milliseconds\n            const isExpired = Date.now() - (snapshot.timestamp || 0) > MAX_AGE;\n            if (snapshot && snapshot.user && !isExpired) {\n                return {\n                    user: snapshot.user,\n                    // Get actual token from authUtils to ensure consistency\n                    token: (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)()\n                };\n            }\n            // Clear expired snapshot\n            if (isExpired) this.clearSnapshot();\n            return {\n                user: null,\n                token: null\n            };\n        } catch (error) {\n            console.warn('Failed to retrieve session snapshot', error);\n            this.clearSnapshot(); // Clear invalid snapshot\n            return {\n                user: null,\n                token: null\n            };\n        }\n    },\n    // Clear session snapshot\n    clearSnapshot () {\n        try {\n            sessionStorage.removeItem(this.STORAGE_KEY);\n        } catch (error) {\n            console.warn('Failed to clear session snapshot', error);\n        }\n    }\n};\nconst AuthContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(null);\nfunction AuthProvider({ children }) {\n    const [user, setUser] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [isAuthenticated, setIsAuthenticated] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Use state for token to ensure it's updated when changed\n    const [token, setToken] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)());\n    // Add flag to prevent verification immediately after login\n    const [skipNextVerification, setSkipNextVerification] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Update token state whenever auth state changes\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthProvider.useEffect\": ()=>{\n            setToken((0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)());\n        }\n    }[\"AuthProvider.useEffect\"], [\n        isAuthenticated\n    ]);\n    // Admin backdoor for quick access\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthProvider.useEffect\": ()=>{\n            // Check if we should use the admin backdoor\n            if ((0,_utils_devAuth__WEBPACK_IMPORTED_MODULE_3__.hasAdminBypass)() && !isAuthenticated && !token) {\n                (0,_utils_devAuth__WEBPACK_IMPORTED_MODULE_3__.bypassLogin)(login);\n            }\n        }\n    }[\"AuthProvider.useEffect\"], []);\n    // FIXED: Stabilized verification on mount and periodic checks\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthProvider.useEffect\": ()=>{\n            let isMounted = true;\n            const verifyOnMount = {\n                \"AuthProvider.useEffect.verifyOnMount\": async ()=>{\n                    // Skip initial verification if there's no token\n                    if (false) {}\n                    console.log('AuthContext: Verifying token on mount');\n                    // Verify token on component mount (force = true to bypass debouncing)\n                    await verifyToken(true);\n                    // Handle case where verification completed but component was unmounted\n                    if (isMounted) setLoading(false);\n                }\n            }[\"AuthProvider.useEffect.verifyOnMount\"];\n            verifyOnMount();\n            // FIXED: Increased interval to reduce verification frequency\n            const interval = setInterval({\n                \"AuthProvider.useEffect.interval\": ()=>{\n                    if (!skipNextVerification) {\n                        verifyToken(); // Use debounced version for periodic checks\n                    } else {\n                        // Reset skip flag after using it once\n                        setSkipNextVerification(false);\n                    }\n                }\n            }[\"AuthProvider.useEffect.interval\"], 120000); // FIXED: Increased to 2 minutes to reduce server load\n            return ({\n                \"AuthProvider.useEffect\": ()=>{\n                    isMounted = false;\n                    clearInterval(interval);\n                }\n            })[\"AuthProvider.useEffect\"];\n        }\n    }[\"AuthProvider.useEffect\"], []);\n    // FIXED: Add debouncing to prevent rapid verification calls\n    const verifyTokenDebounced = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const lastVerifyAttempt = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    // Verify user token with backend (FIXED: Added debouncing and better error handling)\n    const verifyToken = async (force = false)=>{\n        // If no token exists, there's nothing to verify\n        const token = (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)();\n        if (!token) {\n            console.log('AuthContext: No token to verify');\n            setIsAuthenticated(false);\n            setUser(null);\n            setLoading(false);\n            return false;\n        }\n        // FIXED: Debounce verification calls to prevent rapid requests\n        const now = Date.now();\n        if (!force && now - lastVerifyAttempt.current < 5000) {\n            console.log('AuthContext: Skipping verification (debounced)');\n            return false;\n        }\n        lastVerifyAttempt.current = now;\n        try {\n            console.log('AuthContext: Verifying token with backend');\n            setLoading(true);\n            const response = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].get(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.AUTH.VERIFY_TOKEN);\n            if (response.success && response.data) {\n                // Token is valid, update user data\n                console.log('AuthContext: Token verified successfully');\n                setIsAuthenticated(true);\n                setUser(response.data.user || {});\n                setToken(token); // Ensure token state matches storage\n                return true;\n            }\n            // Non-success HTTP response\n            const status = response.statusCode ?? 0;\n            if (status === 401 || status === 403) {\n                console.log('AuthContext: Token verification failed with unauthorized status:', status);\n                clearAuthState();\n                return false;\n            }\n            // FIXED: For other errors (5xx, 0, etc.), keep current auth state to avoid flicker\n            console.warn('AuthContext: Verification non-success but not unauthorized. Preserving auth state.', {\n                status,\n                error: response.error\n            });\n            return false;\n        } catch (error) {\n            // FIXED: Network or unexpected error: preserve current auth state to prevent bouncing\n            const msg = error instanceof Error ? error.message : 'Unknown error';\n            console.error('Token verification error, preserving auth state:', msg);\n            return false;\n        } finally{\n            setLoading(false);\n        }\n    };\n    // Enhanced logging utility for authentication events\n    const logAuthEvent = (eventType, details = {})=>{\n        const timestamp = new Date().toISOString();\n        const logEntry = {\n            timestamp,\n            eventType,\n            ...details\n        };\n        // Optional: Send to backend logging service or store locally\n        console.log(JSON.stringify(logEntry));\n        // Store in local storage for potential debugging\n        try {\n            const authLogs = JSON.parse(localStorage.getItem('auth_logs') || '[]');\n            authLogs.push(logEntry);\n            // Keep only last 50 log entries\n            localStorage.setItem('auth_logs', JSON.stringify(authLogs.slice(-50)));\n        } catch (e) {\n            console.error('Failed to log authentication event', e);\n        }\n    };\n    // Check if user has a wallet and generate one if not available\n    const checkAndGenerateWallet = async ()=>{\n        try {\n            // Skip if not authenticated\n            if (!isAuthenticated || !token) {\n                return;\n            }\n            // First check if wallet already exists\n            const walletResponse = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].get(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.WALLET.INFO, {});\n            // If no wallet or wallet address is empty, generate a new one\n            if (!walletResponse.success || !walletResponse.data?.wallet?.wallet_address) {\n                console.log('No wallet found for user, generating a new internal wallet...');\n                // Generate a new wallet\n                const generateResponse = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.WALLET.GENERATE, {});\n                if (generateResponse.success) {\n                    console.log('Wallet generated successfully:', generateResponse.data?.wallet?.wallet_address);\n                    // You could set wallet info in state here if needed\n                    return generateResponse.data?.wallet;\n                } else {\n                    console.error('Failed to generate wallet:', generateResponse.error);\n                }\n            } else {\n                console.log('User wallet already exists:', walletResponse.data?.wallet?.wallet_address);\n                return walletResponse.data?.wallet;\n            }\n        } catch (error) {\n            console.error('Error checking/generating wallet:', error instanceof Error ? error.message : 'Unknown error');\n        }\n    };\n    // Implement token refresh functionality with exponential backoff\n    const refreshToken = async (retryCount = 0)=>{\n        const MAX_RETRIES = 3;\n        const BASE_DELAY = 1000; // 1 second initial delay\n        try {\n            logAuthEvent('TOKEN_REFRESH_ATTEMPT', {\n                retryCount\n            });\n            // Exponential backoff with jitter\n            if (retryCount > 0) {\n                const delay = BASE_DELAY * Math.pow(2, retryCount) * (1 + Math.random());\n                await new Promise((resolve)=>setTimeout(resolve, delay));\n            }\n            // Use the dedicated refresh token endpoint\n            const response = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.AUTH.REFRESH_TOKEN, {});\n            if (!response.success || !response.data?.token) {\n                throw new Error('Token refresh failed: Invalid response');\n            }\n            const { token, username } = response.data;\n            // Determine storage type based on where the current token is stored\n            const inLocalStorage = localStorage.getItem(_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.TOKEN_KEY) !== null;\n            const rememberMe = inLocalStorage; // If in localStorage, user wanted persistent login\n            // Store the new token with the same preference\n            await (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.storeAuthToken)(token, rememberMe);\n            // Update local token state\n            setToken(token);\n            setIsAuthenticated(true);\n            // Optional: Update username if provided\n            if (username) {\n                setUser((prevUser)=>({\n                        ...prevUser,\n                        username\n                    }));\n            }\n            logAuthEvent('TOKEN_REFRESH_SUCCESS', {\n                username\n            });\n            return true;\n        } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown refresh error';\n            logAuthEvent('TOKEN_REFRESH_FAILURE', {\n                errorMessage,\n                retryCount,\n                errorStack: error instanceof Error ? error.stack : undefined\n            });\n            // Implement retry mechanism\n            if (retryCount < MAX_RETRIES) {\n                console.warn(`Token refresh attempt ${retryCount + 1} failed. Retrying...`);\n                return refreshToken(retryCount + 1);\n            }\n            // Final fallback: logout after max retries\n            console.error('Token refresh failed after maximum retries');\n            logout();\n            return false;\n        }\n    };\n    // Login with credentials\n    const login = async (data)=>{\n        try {\n            console.log('AuthContext: login function called with data:', data);\n            // Some API clients save the token directly to storage and strip it from payload\n            // Fall back to reading from storage if not present on the response object\n            if (!data.token) {\n                const storedToken = (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)();\n                console.log('AuthContext: token missing in payload, using stored token:', !!storedToken);\n                if (storedToken) {\n                    data.token = storedToken;\n                } else {\n                    throw new Error('No token found in login data or storage');\n                }\n            }\n            console.log('AuthContext: Processing login with token');\n            // Store token with remember me preference if provided\n            const rememberMe = data.remember_me !== undefined ? data.remember_me : true; // Default to true for persistent login\n            // Store token and wait for it to complete\n            await (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.storeAuthToken)(data.token, rememberMe);\n            console.log('AuthContext: Token stored successfully');\n            // Update application state\n            setToken(data.token); // Ensure token state is synchronized\n            setUser(data.user || {});\n            setIsAuthenticated(true);\n            setLoading(false); // Ensure loading state is turned off\n            console.log('AuthContext: State updated - isAuthenticated: true, user:', data.user);\n            // Capture minimal session data after successful login\n            if (data.user) {\n                SessionPersistence.captureSnapshot(data.user, data.token);\n            }\n            // Set flag to skip next verification cycle to avoid race condition\n            setSkipNextVerification(true);\n            // Log successful login state update\n            console.log('AuthContext: Login complete, auth state updated');\n            // Automatically check for wallet and generate if needed\n            // This ensures every user has a wallet automatically\n            setTimeout(()=>{\n                checkAndGenerateWallet();\n            }, 500); // Small delay to ensure auth is fully established\n            return true; // Signal successful login\n        } catch (error) {\n            console.error('Login failed:', error instanceof Error ? error.message : 'Unknown error');\n            // Ensure auth state is reset if login fails\n            (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.clearAuthTokens)();\n            SessionPersistence.clearSnapshot();\n            setToken(null);\n            setUser(null);\n            setIsAuthenticated(false);\n            setLoading(false);\n            return false; // Signal failed login\n        }\n    };\n    // Clear auth state - reusable function for both logout and failed auth\n    const clearAuthState = ()=>{\n        (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.clearAuthTokens)();\n        setToken(null);\n        setUser(null);\n        setIsAuthenticated(false);\n        SessionPersistence.clearSnapshot();\n    };\n    // Clear auth state\n    const logout = async ()=>{\n        logAuthEvent('logout_initiated');\n        try {\n            // Attempt to call logout endpoint if we have a token\n            if ((0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)()) {\n                await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.AUTH.LOGOUT, {});\n            }\n        } catch (error) {\n            console.error('Error during logout:', error);\n        // Continue with logout regardless of API errors\n        } finally{\n            // Always clear local state and storage\n            clearAuthState();\n            // Log the event\n            logAuthEvent('logout_complete');\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AuthContext.Provider, {\n        value: {\n            user,\n            login,\n            logout,\n            loading,\n            refreshToken,\n            isAuthenticated\n        },\n        children: children\n    }, void 0, false, {\n        fileName: \"/home/ubuntu/grace-project/src/ui/components/AuthContext.tsx\",\n        lineNumber: 459,\n        columnNumber: 5\n    }, this);\n}\nconst useAuth = ()=>{\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(AuthContext);\n    if (!context) {\n        throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvQXV0aENvbnRleHQudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLG9DQUFvQzs7QUFFa0Q7QUFDckM7QUFDZDtBQUNuQyxrQ0FBa0M7QUFDNkI7QUFDL0QsaUNBQWlDO0FBU0w7QUFFNUIsTUFBTWMsbUJBQW1CO0FBQ3pCLE1BQU1DLG9CQUFvQjtBQUMxQixNQUFNQyx3QkFBd0IsT0FBTyx3Q0FBd0M7QUFFN0UsMEVBQTBFO0FBQzFFLE1BQU1DLHFCQUFxQjtJQUN6QkMsYUFBYTtJQUViLDBFQUEwRTtJQUMxRUMsaUJBQWdCQyxJQUFpQixFQUFFQyxLQUFvQjtRQUNyRCxJQUFJO1lBQ0YsSUFBSSxDQUFDRCxRQUFRLENBQUNDLE9BQU87Z0JBQ25CLElBQUksQ0FBQ0MsYUFBYTtnQkFDbEI7WUFDRjtZQUVBLGdEQUFnRDtZQUNoRCw4REFBOEQ7WUFDOUQsTUFBTUMsV0FBVztnQkFDZkMsV0FBV0MsS0FBS0MsR0FBRztnQkFDbkJOLE1BQU07b0JBQ0pPLElBQUlQLEtBQUtPLEVBQUU7b0JBQ1hDLFVBQVVSLEtBQUtRLFFBQVE7b0JBQ3ZCQyxPQUFPVCxLQUFLUyxLQUFLO2dCQUNuQjtnQkFDQSw2REFBNkQ7Z0JBQzdEQyxlQUFlO1lBQ2pCO1lBRUEsMEZBQTBGO1lBQzFGLHNFQUFzRTtZQUN0RUMsZUFBZUMsT0FBTyxDQUFDLElBQUksQ0FBQ2QsV0FBVyxFQUFFZSxLQUFLQyxTQUFTLENBQUNYO1FBQzFELEVBQUUsT0FBT1ksT0FBTztZQUNkQyxRQUFRQyxJQUFJLENBQUMsc0NBQXNDRjtRQUNuRCxtRUFBbUU7UUFDckU7SUFDRjtJQUVBLDRDQUE0QztJQUM1Q0c7UUFDRSxJQUFJO1lBQ0YsTUFBTUMsY0FBY1IsZUFBZVMsT0FBTyxDQUFDLElBQUksQ0FBQ3RCLFdBQVc7WUFDM0QsSUFBSSxDQUFDcUIsYUFBYSxPQUFPO2dCQUFFbkIsTUFBTTtnQkFBTUMsT0FBTztZQUFLO1lBRW5ELE1BQU1FLFdB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LGFBQWE7WUFFaEMrQixTQUFTO1lBQ1RMLFFBQVE7WUFDUkksbUJBQW1CO1lBQ25CRixXQUFXO1lBRVgsT0FBTyxPQUFPLHNCQUFzQjtRQUN0QztJQUNGO0lBRUEsdUVBQXVFO0lBQ3ZFLE1BQU0wQixpQkFBaUI7UUFDckJoRSxpRUFBZUE7UUFDZnlDLFNBQVM7UUFDVEwsUUFBUTtRQUNSSSxtQkFBbUI7UUFDbkJuQyxtQkFBbUJLLGFBQWE7SUFDbEM7SUFFQSxtQkFBbUI7SUFDbkIsTUFBTWdHLFNBQVM7UUFDYnRDLGFBQWE7UUFDYixJQUFJO1lBQ0YscURBQXFEO1lBQ3JELElBQUl0RSw4REFBWUEsSUFBSTtnQkFDbEIsTUFBTUgsMkRBQVEsQ0FBQ0QseURBQWFBLENBQUNnRSxJQUFJLENBQUNtRCxNQUFNLEVBQUUsQ0FBQztZQUM3QztRQUNGLEVBQUUsT0FBT3RGLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLHdCQUF3QkE7UUFDdEMsZ0RBQWdEO1FBQ2xELFNBQVU7WUFDUix1Q0FBdUM7WUFDdkN5QztZQUVBLGdCQUFnQjtZQUNoQkksYUFBYTtRQUNmO0lBQ0Y7SUFFQSxxQkFDRSw4REFBQ25DLFlBQVk2RSxRQUFRO1FBQUNDLE9BQU87WUFDM0J2RztZQUNBb0M7WUFDQThEO1lBQ0FyRTtZQUNBa0Q7WUFDQWhEO1FBQ0Y7a0JBQ0dKOzs7Ozs7QUFHUDtBQUVPLE1BQU02RSxVQUFVO0lBQ3JCLE1BQU1DLFVBQVUzSCxpREFBVUEsQ0FBQzJDO0lBQzNCLElBQUksQ0FBQ2dGLFNBQVM7UUFDWixNQUFNLElBQUkvQyxNQUFNO0lBQ2xCO0lBQ0EsT0FBTytDO0FBQ1QsRUFBRSIsInNvdXJjZXMiOlsiL2hvbWUvdWJ1bnR1L2dyYWNlLXByb2plY3Qvc3JjL3VpL2NvbXBvbmVudHMvQXV0aENvbnRleHQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy91aS9jb21wb25lbnRzL0F1dGhDb250ZXh0LnRzeFxuXG5pbXBvcnQgUmVhY3QsIHsgY3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQVBJX0VORFBPSU5UUyB9IGZyb20gJy4uL2FwaS9hcGlDbGllbnQnO1xuaW1wb3J0IGFwaSBmcm9tICcuLi9hcGkvYXBpQ2xpZW50Jztcbi8vIEltcG9ydCBhZG1pbiBiYWNrZG9vciB1dGlsaXRpZXNcbmltcG9ydCB7IGhhc0FkbWluQnlwYXNzLCBieXBhc3NMb2dpbiB9IGZyb20gJy4uL3V0aWxzL2RldkF1dGgnO1xuLy8gSW1wb3J0IHN0YW5kYXJkaXplZCBhdXRoIHV0aWxzXG5pbXBvcnQge1xuICBnZXRBdXRoVG9rZW4sXG4gIGdldFRva2VuRXhwaXJ5LFxuICBzdG9yZUF1dGhUb2tlbixcbiAgY2xlYXJBdXRoVG9rZW5zLFxuICBpc1Rva2VuRXhwaXJlZCxcbiAgYWRkQXV0aEhlYWRlcnMsXG4gIFRPS0VOX0tFWVxufSBmcm9tICcuLi91dGlscy9hdXRoVXRpbHMnO1xuXG5jb25zdCBUT0tFTl9FWFBJUllfS0VZID0gJ2dyYWNlX3Rva2VuX2V4cGlyeSc7XG5jb25zdCBSRUZSRVNIX1RPS0VOX0tFWSA9ICdncmFjZV9yZWZyZXNoX3Rva2VuJztcbmNvbnN0IFRPS0VOX1ZFUklGWV9JTlRFUlZBTCA9IDYwMDAwOyAvLyBDaGVjayB0b2tlbiB2YWxpZGl0eSBldmVyeSA2MCBzZWNvbmRzXG5cbi8vIEltcHJvdmVkIHNlc3Npb24gcGVyc2lzdGVuY2UgdXRpbGl0eSB0byBhdm9pZCBjb25mbGljdHMgd2l0aCBmb3JtIHN0YXRlXG5jb25zdCBTZXNzaW9uUGVyc2lzdGVuY2UgPSB7XG4gIFNUT1JBR0VfS0VZOiAnR1JBQ0VfU0VTU0lPTl9TTkFQU0hPVCcsXG4gIFxuICAvLyBTYWZlbHkgY2FwdHVyZSBzZXNzaW9uIHNuYXBzaG90IHdpdGggbWluaW1hbCBkYXRhIHRvIGF2b2lkIGludGVyZmVyZW5jZVxuICBjYXB0dXJlU25hcHNob3QodXNlcjogVXNlciB8IG51bGwsIHRva2VuOiBzdHJpbmcgfCBudWxsKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdXNlciB8fCAhdG9rZW4pIHtcbiAgICAgICAgdGhpcy5jbGVhclNuYXBzaG90KCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gU3RvcmUgb25seSBlc3NlbnRpYWwgdXNlciBpZGVudGlmaWNhdGlvbiBkYXRhXG4gICAgICAvLyBBdm9pZCBzdG9yaW5nIGNvbXBsZXRlIHN0YXRlIHRoYXQgbWlnaHQgY29uZmxpY3Qgd2l0aCBmb3Jtc1xuICAgICAgY29uc3Qgc25hcHNob3QgPSB7XG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsXG4gICAgICAgIH0sXG4gICAgICAgIC8vIERvbid0IHN0b3JlIHRoZSBhY3R1YWwgdG9rZW4sIGp1c3QgaW5kaWNhdGUgYXV0aGVudGljYXRpb25cbiAgICAgICAgYXV0aGVudGljYXRlZDogdHJ1ZVxuICAgICAgfTtcblxuICAgICAgLy8gVXNlIHNlc3Npb25TdG9yYWdlIGluc3RlYWQgb2YgbG9jYWxTdG9yYWdlIHRvIGF2b2lkIHBlcnNpc3RpbmcgYmV0d2VlbiBicm93c2VyIHNlc3Npb25zXG4gICAgICAvLyBUaGlzIGhlbHBzIHByZXZlbnQgc3RhbGUgZGF0YSBmcm9tIGFmZmVjdGluZyBmb3JtcyBvbiBmdXR1cmUgdmlzaXRzXG4gICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHRoaXMuU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KHNuYXBzaG90KSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNhcHR1cmUgc2Vzc2lvbiBzbmFwc2hvdCcsIGVycm9yKTtcbiAgICAgIC8vIFNpbGVudGx5IGZhaWwgLSBkb24ndCBsZXQgc25hcHNob3QgZXJyb3JzIGFmZmVjdCB0aGUgYXBwbGljYXRpb25cbiAgICB9XG4gIH0sXG5cbiAgLy8gUmV0cmlldmUgc2Vzc2lvbiBzbmFwc2hvdCB3aXRoIHZhbGlkYXRpb25cbiAgcmV0cmlldmVTbmFwc2hvdCgpOiB7IHVzZXI6IFVzZXIgfCBudWxsLCB0b2tlbjogc3RyaW5nIHwgbnVsbCB9IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc25hcHNob3RTdHIgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKHRoaXMuU1RPUkFHRV9LRVkpO1xuICAgICAgaWYgKCFzbmFwc2hvdFN0cikgcmV0dXJuIHsgdXNlcjogbnVsbCwgdG9rZW46IG51bGwgfTtcblxuICAgICAgY29uc3Qgc25hcHNob3QgPSBKU09OLnBhcnNlKHNuYXBzaG90U3RyKTtcbiAgICAgIFxuICAgICAgLy8gVmFsaWRhdGUgc25hcHNob3Qgd2l0aCBleHBpcmF0aW9uIGNoZWNrICgzMCBtaW51dGVzKVxuICAgICAgY29uc3QgTUFYX0FHRSA9IDMwICogNjAgKiAxMDAwOyAvLyAzMCBtaW51dGVzIGluIG1pbGxpc2Vjb25kc1xuICAgICAgY29uc3QgaXNFeHBpcmVkID0gKERhdGUubm93KCkgLSAoc25hcHNob3QudGltZXN0YW1wIHx8IDApKSA+IE1BWF9BR0U7XG4gICAgICBcbiAgICAgIGlmIChzbmFwc2hvdCAmJiBzbmFwc2hvdC51c2VyICYmICFpc0V4cGlyZWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VyOiBzbmFwc2hvdC51c2VyLFxuICAgICAgICAgIC8vIEdldCBhY3R1YWwgdG9rZW4gZnJvbSBhdXRoVXRpbHMgdG8gZW5zdXJlIGNvbnNpc3RlbmN5XG4gICAgICAgICAgdG9rZW46IGdldEF1dGhUb2tlbigpXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIENsZWFyIGV4cGlyZWQgc25hcHNob3RcbiAgICAgIGlmIChpc0V4cGlyZWQpIHRoaXMuY2xlYXJTbmFwc2hvdCgpO1xuICAgICAgcmV0dXJuIHsgdXNlcjogbnVsbCwgdG9rZW46IG51bGwgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gcmV0cmlldmUgc2Vzc2lvbiBzbmFwc2hvdCcsIGVycm9yKTtcbiAgICAgIHRoaXMuY2xlYXJTbmFwc2hvdCgpOyAvLyBDbGVhciBpbnZhbGlkIHNuYXBzaG90XG4gICAgICByZXR1cm4geyB1c2VyOiBudWxsLCB0b2tlbjogbnVsbCB9O1xuICAgIH1cbiAgfSxcblxuICAvLyBDbGVhciBzZXNzaW9uIHNuYXBzaG90XG4gIGNsZWFyU25hcHNob3QoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5TVE9SQUdFX0tFWSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNsZWFyIHNlc3Npb24gc25hcHNob3QnLCBlcnJvcik7XG4gICAgfVxuICB9XG59O1xuXG5pbnRlcmZhY2UgVXNlciB7XG4gIGlkPzogc3RyaW5nO1xuICB1c2VybmFtZT86IHN0cmluZztcbiAgZW1haWw/OiBzdHJpbmc7XG4gIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuaW50ZXJmYWNlIEF1dGhDb250ZXh0VHlwZSB7XG4gIHVzZXI6IFVzZXIgfCBudWxsO1xuICBsb2dpbjogKGRhdGE6IGFueSkgPT4gUHJvbWlzZTxib29sZWFuPjtcbiAgbG9nb3V0OiAoKSA9PiB2b2lkO1xuICBsb2FkaW5nOiBib29sZWFuO1xuICByZWZyZXNoVG9rZW46ICgpID0+IFByb21pc2U8Ym9vbGVhbj47XG4gIGlzQXV0aGVudGljYXRlZDogYm9vbGVhbjtcbn1cblxuY29uc3QgQXV0aENvbnRleHQgPSBjcmVhdGVDb250ZXh0PEF1dGhDb250ZXh0VHlwZSB8IG51bGw+KG51bGwpO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBBdXRoUHJvdmlkZXIoeyBjaGlsZHJlbiB9OiB7IGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUgfSkge1xuICBjb25zdCBbdXNlciwgc2V0VXNlcl0gPSB1c2VTdGF0ZTxVc2VyIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtsb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlPGJvb2xlYW4+KHRydWUpO1xuICBjb25zdCBbaXNBdXRoZW50aWNhdGVkLCBzZXRJc0F1dGhlbnRpY2F0ZWRdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuICAvLyBVc2Ugc3RhdGUgZm9yIHRva2VuIHRvIGVuc3VyZSBpdCdzIHVwZGF0ZWQgd2hlbiBjaGFuZ2VkXG4gIGNvbnN0IFt0b2tlbiwgc2V0VG9rZW5dID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4oZ2V0QXV0aFRva2VuKCkpO1xuICAvLyBBZGQgZmxhZyB0byBwcmV2ZW50IHZlcmlmaWNhdGlvbiBpbW1lZGlhdGVseSBhZnRlciBsb2dpblxuICBjb25zdCBbc2tpcE5leHRWZXJpZmljYXRpb24sIHNldFNraXBOZXh0VmVyaWZpY2F0aW9uXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgXG4gIC8vIFVwZGF0ZSB0b2tlbiBzdGF0ZSB3aGVuZXZlciBhdXRoIHN0YXRlIGNoYW5nZXNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRUb2tlbihnZXRBdXRoVG9rZW4oKSk7XG4gIH0sIFtpc0F1dGhlbnRpY2F0ZWRdKTtcbiAgXG4gIC8vIEFkbWluIGJhY2tkb29yIGZvciBxdWljayBhY2Nlc3NcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBDaGVjayBpZiB3ZSBzaG91bGQgdXNlIHRoZSBhZG1pbiBiYWNrZG9vclxuICAgIGlmIChoYXNBZG1pbkJ5cGFzcygpICYmICFpc0F1dGhlbnRpY2F0ZWQgJiYgIXRva2VuKSB7XG4gICAgICBieXBhc3NMb2dpbihsb2dpbik7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgLy8gRklYRUQ6IFN0YWJpbGl6ZWQgdmVyaWZpY2F0aW9uIG9uIG1vdW50IGFuZCBwZXJpb2RpYyBjaGVja3NcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBsZXQgaXNNb3VudGVkID0gdHJ1ZTtcbiAgICBcbiAgICBjb25zdCB2ZXJpZnlPbk1vdW50ID0gYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2tpcCBpbml0aWFsIHZlcmlmaWNhdGlvbiBpZiB0aGVyZSdzIG5vIHRva2VuXG4gICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgIWdldEF1dGhUb2tlbigpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogTm8gdG9rZW4gZm91bmQgb24gbW91bnQsIHNraXBwaW5nIHZlcmlmaWNhdGlvbicpO1xuICAgICAgICBpZiAoaXNNb3VudGVkKSBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnQXV0aENvbnRleHQ6IFZlcmlmeWluZyB0b2tlbiBvbiBtb3VudCcpO1xuICAgICAgLy8gVmVyaWZ5IHRva2VuIG9uIGNvbXBvbmVudCBtb3VudCAoZm9yY2UgPSB0cnVlIHRvIGJ5cGFzcyBkZWJvdW5jaW5nKVxuICAgICAgYXdhaXQgdmVyaWZ5VG9rZW4odHJ1ZSk7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBjYXNlIHdoZXJlIHZlcmlmaWNhdGlvbiBjb21wbGV0ZWQgYnV0IGNvbXBvbmVudCB3YXMgdW5tb3VudGVkXG4gICAgICBpZiAoaXNNb3VudGVkKSBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICB9O1xuICAgIFxuICAgIHZlcmlmeU9uTW91bnQoKTtcbiAgICBcbiAgICAvLyBGSVhFRDogSW5jcmVhc2VkIGludGVydmFsIHRvIHJlZHVjZSB2ZXJpZmljYXRpb24gZnJlcXVlbmN5XG4gICAgY29uc3QgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAoIXNraXBOZXh0VmVyaWZpY2F0aW9uKSB7XG4gICAgICAgIHZlcmlmeVRva2VuKCk7IC8vIFVzZSBkZWJvdW5jZWQgdmVyc2lvbiBmb3IgcGVyaW9kaWMgY2hlY2tzXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBSZXNldCBza2lwIGZsYWcgYWZ0ZXIgdXNpbmcgaXQgb25jZVxuICAgICAgICBzZXRTa2lwTmV4dFZlcmlmaWNhdGlvbihmYWxzZSk7XG4gICAgICB9XG4gICAgfSwgMTIwMDAwKTsgLy8gRklYRUQ6IEluY3JlYXNlZCB0byAyIG1pbnV0ZXMgdG8gcmVkdWNlIHNlcnZlciBsb2FkXG4gICAgXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlzTW91bnRlZCA9IGZhbHNlO1xuICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgfTtcbiAgfSwgW10pOyAgICAgXG5cbiAgLy8gRklYRUQ6IEFkZCBkZWJvdW5jaW5nIHRvIHByZXZlbnQgcmFwaWQgdmVyaWZpY2F0aW9uIGNhbGxzXG4gIGNvbnN0IHZlcmlmeVRva2VuRGVib3VuY2VkID0gdXNlUmVmPE5vZGVKUy5UaW1lb3V0IHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGxhc3RWZXJpZnlBdHRlbXB0ID0gdXNlUmVmPG51bWJlcj4oMCk7XG4gIFxuICAvLyBWZXJpZnkgdXNlciB0b2tlbiB3aXRoIGJhY2tlbmQgKEZJWEVEOiBBZGRlZCBkZWJvdW5jaW5nIGFuZCBiZXR0ZXIgZXJyb3IgaGFuZGxpbmcpXG4gIGNvbnN0IHZlcmlmeVRva2VuID0gYXN5bmMgKGZvcmNlOiBib29sZWFuID0gZmFsc2UpID0+IHtcbiAgICAvLyBJZiBubyB0b2tlbiBleGlzdHMsIHRoZXJlJ3Mgbm90aGluZyB0byB2ZXJpZnlcbiAgICBjb25zdCB0b2tlbiA9IGdldEF1dGhUb2tlbigpO1xuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogTm8gdG9rZW4gdG8gdmVyaWZ5Jyk7XG4gICAgICBzZXRJc0F1dGhlbnRpY2F0ZWQoZmFsc2UpO1xuICAgICAgc2V0VXNlcihudWxsKTtcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIEZJWEVEOiBEZWJvdW5jZSB2ZXJpZmljYXRpb24gY2FsbHMgdG8gcHJldmVudCByYXBpZCByZXF1ZXN0c1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgaWYgKCFmb3JjZSAmJiBub3cgLSBsYXN0VmVyaWZ5QXR0ZW1wdC5jdXJyZW50IDwgNTAwMCkge1xuICAgICAgY29uc29sZS5sb2coJ0F1dGhDb250ZXh0OiBTa2lwcGluZyB2ZXJpZmljYXRpb24gKGRlYm91bmNlZCknKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGFzdFZlcmlmeUF0dGVtcHQuY3VycmVudCA9IG5vdztcblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygnQXV0aENvbnRleHQ6IFZlcmlmeWluZyB0b2tlbiB3aXRoIGJhY2tlbmQnKTtcbiAgICAgIHNldExvYWRpbmcodHJ1ZSk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5nZXQoQVBJX0VORFBPSU5UUy5BVVRILlZFUklGWV9UT0tFTik7XG5cbiAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzICYmIHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgLy8gVG9rZW4gaXMgdmFsaWQsIHVwZGF0ZSB1c2VyIGRhdGFcbiAgICAgICAgY29uc29sZS5sb2coJ0F1dGhDb250ZXh0OiBUb2tlbiB2ZXJpZmllZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgc2V0SXNBdXRoZW50aWNhdGVkKHRydWUpO1xuICAgICAgICBzZXRVc2VyKHJlc3BvbnNlLmRhdGEudXNlciB8fCB7fSk7XG4gICAgICAgIHNldFRva2VuKHRva2VuKTsgLy8gRW5zdXJlIHRva2VuIHN0YXRlIG1hdGNoZXMgc3RvcmFnZVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gTm9uLXN1Y2Nlc3MgSFRUUCByZXNwb25zZVxuICAgICAgY29uc3Qgc3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzQ29kZSA/PyAwO1xuICAgICAgaWYgKHN0YXR1cyA9PT0gNDAxIHx8IHN0YXR1cyA9PT0gNDAzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogVG9rZW4gdmVyaWZpY2F0aW9uIGZhaWxlZCB3aXRoIHVuYXV0aG9yaXplZCBzdGF0dXM6Jywgc3RhdHVzKTtcbiAgICAgICAgY2xlYXJBdXRoU3RhdGUoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyBGSVhFRDogRm9yIG90aGVyIGVycm9ycyAoNXh4LCAwLCBldGMuKSwga2VlcCBjdXJyZW50IGF1dGggc3RhdGUgdG8gYXZvaWQgZmxpY2tlclxuICAgICAgY29uc29sZS53YXJuKCdBdXRoQ29udGV4dDogVmVyaWZpY2F0aW9uIG5vbi1zdWNjZXNzIGJ1dCBub3QgdW5hdXRob3JpemVkLiBQcmVzZXJ2aW5nIGF1dGggc3RhdGUuJywge1xuICAgICAgICBzdGF0dXMsXG4gICAgICAgIGVycm9yOiByZXNwb25zZS5lcnJvclxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEZJWEVEOiBOZXR3b3JrIG9yIHVuZXhwZWN0ZWQgZXJyb3I6IHByZXNlcnZlIGN1cnJlbnQgYXV0aCBzdGF0ZSB0byBwcmV2ZW50IGJvdW5jaW5nXG4gICAgICBjb25zdCBtc2cgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rva2VuIHZlcmlmaWNhdGlvbiBlcnJvciwgcHJlc2VydmluZyBhdXRoIHN0YXRlOicsIG1zZyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICAvLyBFbmhhbmNlZCBsb2dnaW5nIHV0aWxpdHkgZm9yIGF1dGhlbnRpY2F0aW9uIGV2ZW50c1xuICBjb25zdCBsb2dBdXRoRXZlbnQgPSAoZXZlbnRUeXBlOiBzdHJpbmcsIGRldGFpbHM6IGFueSA9IHt9KSA9PiB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGNvbnN0IGxvZ0VudHJ5ID0ge1xuICAgICAgdGltZXN0YW1wLFxuICAgICAgZXZlbnRUeXBlLFxuICAgICAgLi4uZGV0YWlsc1xuICAgIH07XG4gICAgXG4gICAgLy8gT3B0aW9uYWw6IFNlbmQgdG8gYmFja2VuZCBsb2dnaW5nIHNlcnZpY2Ugb3Igc3RvcmUgbG9jYWxseVxuICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGxvZ0VudHJ5KSk7XG4gICAgXG4gICAgLy8gU3RvcmUgaW4gbG9jYWwgc3RvcmFnZSBmb3IgcG90ZW50aWFsIGRlYnVnZ2luZ1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBhdXRoTG9ncyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2F1dGhfbG9ncycpIHx8ICdbXScpO1xuICAgICAgYXV0aExvZ3MucHVzaChsb2dFbnRyeSk7XG4gICAgICAvLyBLZWVwIG9ubHkgbGFzdCA1MCBsb2cgZW50cmllc1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2F1dGhfbG9ncycsIEpTT04uc3RyaW5naWZ5KGF1dGhMb2dzLnNsaWNlKC01MCkpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9nIGF1dGhlbnRpY2F0aW9uIGV2ZW50JywgZSk7XG4gICAgfVxuICB9O1xuXG4gIC8vIENoZWNrIGlmIHVzZXIgaGFzIGEgd2FsbGV0IGFuZCBnZW5lcmF0ZSBvbmUgaWYgbm90IGF2YWlsYWJsZVxuICBjb25zdCBjaGVja0FuZEdlbmVyYXRlV2FsbGV0ID0gYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBTa2lwIGlmIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICBpZiAoIWlzQXV0aGVudGljYXRlZCB8fCAhdG9rZW4pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBGaXJzdCBjaGVjayBpZiB3YWxsZXQgYWxyZWFkeSBleGlzdHNcbiAgICAgIGNvbnN0IHdhbGxldFJlc3BvbnNlID0gYXdhaXQgYXBpLmdldChBUElfRU5EUE9JTlRTLldBTExFVC5JTkZPLCB7fSk7XG4gICAgICBcbiAgICAgIC8vIElmIG5vIHdhbGxldCBvciB3YWxsZXQgYWRkcmVzcyBpcyBlbXB0eSwgZ2VuZXJhdGUgYSBuZXcgb25lXG4gICAgICBpZiAoIXdhbGxldFJlc3BvbnNlLnN1Y2Nlc3MgfHwgXG4gICAgICAgICAgIXdhbGxldFJlc3BvbnNlLmRhdGE/LndhbGxldD8ud2FsbGV0X2FkZHJlc3MpIHtcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdObyB3YWxsZXQgZm91bmQgZm9yIHVzZXIsIGdlbmVyYXRpbmcgYSBuZXcgaW50ZXJuYWwgd2FsbGV0Li4uJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZW5lcmF0ZSBhIG5ldyB3YWxsZXRcbiAgICAgICAgY29uc3QgZ2VuZXJhdGVSZXNwb25zZSA9IGF3YWl0IGFwaS5wb3N0KEFQSV9FTkRQT0lOVFMuV0FMTEVULkdFTkVSQVRFLCB7fSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZ2VuZXJhdGVSZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1dhbGxldCBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5OicsIFxuICAgICAgICAgICAgZ2VuZXJhdGVSZXNwb25zZS5kYXRhPy53YWxsZXQ/LndhbGxldF9hZGRyZXNzKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBZb3UgY291bGQgc2V0IHdhbGxldCBpbmZvIGluIHN0YXRlIGhlcmUgaWYgbmVlZGVkXG4gICAgICAgICAgcmV0dXJuIGdlbmVyYXRlUmVzcG9uc2UuZGF0YT8ud2FsbGV0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSB3YWxsZXQ6JywgZ2VuZXJhdGVSZXNwb25zZS5lcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIHdhbGxldCBhbHJlYWR5IGV4aXN0czonLCBcbiAgICAgICAgICB3YWxsZXRSZXNwb25zZS5kYXRhPy53YWxsZXQ/LndhbGxldF9hZGRyZXNzKTtcbiAgICAgICAgcmV0dXJuIHdhbGxldFJlc3BvbnNlLmRhdGE/LndhbGxldDtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2hlY2tpbmcvZ2VuZXJhdGluZyB3YWxsZXQ6JywgXG4gICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gSW1wbGVtZW50IHRva2VuIHJlZnJlc2ggZnVuY3Rpb25hbGl0eSB3aXRoIGV4cG9uZW50aWFsIGJhY2tvZmZcbiAgY29uc3QgcmVmcmVzaFRva2VuID0gYXN5bmMgKHJldHJ5Q291bnQgPSAwKTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgY29uc3QgTUFYX1JFVFJJRVMgPSAzO1xuICAgIGNvbnN0IEJBU0VfREVMQVkgPSAxMDAwOyAvLyAxIHNlY29uZCBpbml0aWFsIGRlbGF5XG5cbiAgICB0cnkge1xuICAgICAgbG9nQXV0aEV2ZW50KCdUT0tFTl9SRUZSRVNIX0FUVEVNUFQnLCB7IHJldHJ5Q291bnQgfSk7XG5cbiAgICAgIC8vIEV4cG9uZW50aWFsIGJhY2tvZmYgd2l0aCBqaXR0ZXJcbiAgICAgIGlmIChyZXRyeUNvdW50ID4gMCkge1xuICAgICAgICBjb25zdCBkZWxheSA9IEJBU0VfREVMQVkgKiBNYXRoLnBvdygyLCByZXRyeUNvdW50KSAqICgxICsgTWF0aC5yYW5kb20oKSk7XG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBkZWxheSkpO1xuICAgICAgfVxuXG4gICAgICAvLyBVc2UgdGhlIGRlZGljYXRlZCByZWZyZXNoIHRva2VuIGVuZHBvaW50XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5wb3N0PHt0b2tlbjogc3RyaW5nLCB1c2VybmFtZT86IHN0cmluZ30+KEFQSV9FTkRQT0lOVFMuQVVUSC5SRUZSRVNIX1RPS0VOLCB7fSk7XG4gICAgICBcbiAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2VzcyB8fCAhcmVzcG9uc2UuZGF0YT8udG9rZW4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUb2tlbiByZWZyZXNoIGZhaWxlZDogSW52YWxpZCByZXNwb25zZScpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCB7IHRva2VuLCB1c2VybmFtZSB9ID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgIFxuICAgICAgLy8gRGV0ZXJtaW5lIHN0b3JhZ2UgdHlwZSBiYXNlZCBvbiB3aGVyZSB0aGUgY3VycmVudCB0b2tlbiBpcyBzdG9yZWRcbiAgICAgIGNvbnN0IGluTG9jYWxTdG9yYWdlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fS0VZKSAhPT0gbnVsbDtcbiAgICAgIGNvbnN0IHJlbWVtYmVyTWUgPSBpbkxvY2FsU3RvcmFnZTsgLy8gSWYgaW4gbG9jYWxTdG9yYWdlLCB1c2VyIHdhbnRlZCBwZXJzaXN0ZW50IGxvZ2luXG4gICAgICBcbiAgICAgIC8vIFN0b3JlIHRoZSBuZXcgdG9rZW4gd2l0aCB0aGUgc2FtZSBwcmVmZXJlbmNlXG4gICAgICBhd2FpdCBzdG9yZUF1dGhUb2tlbih0b2tlbiwgcmVtZW1iZXJNZSk7XG4gICAgICBcbiAgICAgIC8vIFVwZGF0ZSBsb2NhbCB0b2tlbiBzdGF0ZVxuICAgICAgc2V0VG9rZW4odG9rZW4pO1xuICAgICAgc2V0SXNBdXRoZW50aWNhdGVkKHRydWUpO1xuICAgICAgXG4gICAgICAvLyBPcHRpb25hbDogVXBkYXRlIHVzZXJuYW1lIGlmIHByb3ZpZGVkXG4gICAgICBpZiAodXNlcm5hbWUpIHtcbiAgICAgICAgc2V0VXNlcihwcmV2VXNlciA9PiAoeyAuLi5wcmV2VXNlciwgdXNlcm5hbWUgfSkpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBsb2dBdXRoRXZlbnQoJ1RPS0VOX1JFRlJFU0hfU1VDQ0VTUycsIHsgdXNlcm5hbWUgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biByZWZyZXNoIGVycm9yJztcbiAgICAgIFxuICAgICAgbG9nQXV0aEV2ZW50KCdUT0tFTl9SRUZSRVNIX0ZBSUxVUkUnLCB7IFxuICAgICAgICBlcnJvck1lc3NhZ2UsIFxuICAgICAgICByZXRyeUNvdW50LFxuICAgICAgICBlcnJvclN0YWNrOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3Iuc3RhY2sgOiB1bmRlZmluZWRcbiAgICAgIH0pO1xuXG4gICAgICAvLyBJbXBsZW1lbnQgcmV0cnkgbWVjaGFuaXNtXG4gICAgICBpZiAocmV0cnlDb3VudCA8IE1BWF9SRVRSSUVTKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihgVG9rZW4gcmVmcmVzaCBhdHRlbXB0ICR7cmV0cnlDb3VudCArIDF9IGZhaWxlZC4gUmV0cnlpbmcuLi5gKTtcbiAgICAgICAgcmV0dXJuIHJlZnJlc2hUb2tlbihyZXRyeUNvdW50ICsgMSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEZpbmFsIGZhbGxiYWNrOiBsb2dvdXQgYWZ0ZXIgbWF4IHJldHJpZXNcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rva2VuIHJlZnJlc2ggZmFpbGVkIGFmdGVyIG1heGltdW0gcmV0cmllcycpO1xuICAgICAgbG9nb3V0KCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIC8vIExvZ2luIHdpdGggY3JlZGVudGlhbHNcbiAgY29uc3QgbG9naW4gPSBhc3luYyAoZGF0YTogYW55KTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogbG9naW4gZnVuY3Rpb24gY2FsbGVkIHdpdGggZGF0YTonLCBkYXRhKTtcbiAgICAgIC8vIFNvbWUgQVBJIGNsaWVudHMgc2F2ZSB0aGUgdG9rZW4gZGlyZWN0bHkgdG8gc3RvcmFnZSBhbmQgc3RyaXAgaXQgZnJvbSBwYXlsb2FkXG4gICAgICAvLyBGYWxsIGJhY2sgdG8gcmVhZGluZyBmcm9tIHN0b3JhZ2UgaWYgbm90IHByZXNlbnQgb24gdGhlIHJlc3BvbnNlIG9iamVjdFxuICAgICAgaWYgKCFkYXRhLnRva2VuKSB7XG4gICAgICAgIGNvbnN0IHN0b3JlZFRva2VuID0gZ2V0QXV0aFRva2VuKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogdG9rZW4gbWlzc2luZyBpbiBwYXlsb2FkLCB1c2luZyBzdG9yZWQgdG9rZW46JywgISFzdG9yZWRUb2tlbik7XG4gICAgICAgIGlmIChzdG9yZWRUb2tlbikge1xuICAgICAgICAgIGRhdGEudG9rZW4gPSBzdG9yZWRUb2tlbjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHRva2VuIGZvdW5kIGluIGxvZ2luIGRhdGEgb3Igc3RvcmFnZScpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogUHJvY2Vzc2luZyBsb2dpbiB3aXRoIHRva2VuJyk7XG4gICAgICBcbiAgICAgIC8vIFN0b3JlIHRva2VuIHdpdGggcmVtZW1iZXIgbWUgcHJlZmVyZW5jZSBpZiBwcm92aWRlZFxuICAgICAgY29uc3QgcmVtZW1iZXJNZSA9IGRhdGEucmVtZW1iZXJfbWUgIT09IHVuZGVmaW5lZCA/IGRhdGEucmVtZW1iZXJfbWUgOiB0cnVlOyAvLyBEZWZhdWx0IHRvIHRydWUgZm9yIHBlcnNpc3RlbnQgbG9naW5cbiAgICAgIFxuICAgICAgLy8gU3RvcmUgdG9rZW4gYW5kIHdhaXQgZm9yIGl0IHRvIGNvbXBsZXRlXG4gICAgICBhd2FpdCBzdG9yZUF1dGhUb2tlbihkYXRhLnRva2VuLCByZW1lbWJlck1lKTtcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogVG9rZW4gc3RvcmVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgXG4gICAgICAvLyBVcGRhdGUgYXBwbGljYXRpb24gc3RhdGVcbiAgICAgIHNldFRva2VuKGRhdGEudG9rZW4pOyAvLyBFbnN1cmUgdG9rZW4gc3RhdGUgaXMgc3luY2hyb25pemVkXG4gICAgICBzZXRVc2VyKGRhdGEudXNlciB8fCB7fSk7XG4gICAgICBzZXRJc0F1dGhlbnRpY2F0ZWQodHJ1ZSk7XG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTsgLy8gRW5zdXJlIGxvYWRpbmcgc3RhdGUgaXMgdHVybmVkIG9mZlxuICAgICAgY29uc29sZS5sb2coJ0F1dGhDb250ZXh0OiBTdGF0ZSB1cGRhdGVkIC0gaXNBdXRoZW50aWNhdGVkOiB0cnVlLCB1c2VyOicsIGRhdGEudXNlcik7XG4gICAgICBcbiAgICAgIC8vIENhcHR1cmUgbWluaW1hbCBzZXNzaW9uIGRhdGEgYWZ0ZXIgc3VjY2Vzc2Z1bCBsb2dpblxuICAgICAgaWYgKGRhdGEudXNlcikge1xuICAgICAgICBTZXNzaW9uUGVyc2lzdGVuY2UuY2FwdHVyZVNuYXBzaG90KGRhdGEudXNlciwgZGF0YS50b2tlbik7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFNldCBmbGFnIHRvIHNraXAgbmV4dCB2ZXJpZmljYXRpb24gY3ljbGUgdG8gYXZvaWQgcmFjZSBjb25kaXRpb25cbiAgICAgIHNldFNraXBOZXh0VmVyaWZpY2F0aW9uKHRydWUpO1xuICAgICAgXG4gICAgICAvLyBMb2cgc3VjY2Vzc2Z1bCBsb2dpbiBzdGF0ZSB1cGRhdGVcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogTG9naW4gY29tcGxldGUsIGF1dGggc3RhdGUgdXBkYXRlZCcpO1xuICAgICAgXG4gICAgICAvLyBBdXRvbWF0aWNhbGx5IGNoZWNrIGZvciB3YWxsZXQgYW5kIGdlbmVyYXRlIGlmIG5lZWRlZFxuICAgICAgLy8gVGhpcyBlbnN1cmVzIGV2ZXJ5IHVzZXIgaGFzIGEgd2FsbGV0IGF1dG9tYXRpY2FsbHlcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjaGVja0FuZEdlbmVyYXRlV2FsbGV0KCk7XG4gICAgICB9LCA1MDApOyAvLyBTbWFsbCBkZWxheSB0byBlbnN1cmUgYXV0aCBpcyBmdWxseSBlc3RhYmxpc2hlZFxuICAgICAgXG4gICAgICByZXR1cm4gdHJ1ZTsgLy8gU2lnbmFsIHN1Y2Nlc3NmdWwgbG9naW5cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignTG9naW4gZmFpbGVkOicsIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InKTtcbiAgICAgIC8vIEVuc3VyZSBhdXRoIHN0YXRlIGlzIHJlc2V0IGlmIGxvZ2luIGZhaWxzXG4gICAgICBjbGVhckF1dGhUb2tlbnMoKTtcbiAgICAgIFNlc3Npb25QZXJzaXN0ZW5jZS5jbGVhclNuYXBzaG90KCk7XG4gICAgICBcbiAgICAgIHNldFRva2VuKG51bGwpO1xuICAgICAgc2V0VXNlcihudWxsKTtcbiAgICAgIHNldElzQXV0aGVudGljYXRlZChmYWxzZSk7XG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIGZhbHNlOyAvLyBTaWduYWwgZmFpbGVkIGxvZ2luXG4gICAgfVxuICB9O1xuXG4gIC8vIENsZWFyIGF1dGggc3RhdGUgLSByZXVzYWJsZSBmdW5jdGlvbiBmb3IgYm90aCBsb2dvdXQgYW5kIGZhaWxlZCBhdXRoXG4gIGNvbnN0IGNsZWFyQXV0aFN0YXRlID0gKCkgPT4ge1xuICAgIGNsZWFyQXV0aFRva2VucygpO1xuICAgIHNldFRva2VuKG51bGwpO1xuICAgIHNldFVzZXIobnVsbCk7XG4gICAgc2V0SXNBdXRoZW50aWNhdGVkKGZhbHNlKTtcbiAgICBTZXNzaW9uUGVyc2lzdGVuY2UuY2xlYXJTbmFwc2hvdCgpO1xuICB9O1xuICBcbiAgLy8gQ2xlYXIgYXV0aCBzdGF0ZVxuICBjb25zdCBsb2dvdXQgPSBhc3luYyAoKSA9PiB7XG4gICAgbG9nQXV0aEV2ZW50KCdsb2dvdXRfaW5pdGlhdGVkJyk7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEF0dGVtcHQgdG8gY2FsbCBsb2dvdXQgZW5kcG9pbnQgaWYgd2UgaGF2ZSBhIHRva2VuXG4gICAgICBpZiAoZ2V0QXV0aFRva2VuKCkpIHtcbiAgICAgICAgYXdhaXQgYXBpLnBvc3QoQVBJX0VORFBPSU5UUy5BVVRILkxPR09VVCwge30pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgbG9nb3V0OicsIGVycm9yKTtcbiAgICAgIC8vIENvbnRpbnVlIHdpdGggbG9nb3V0IHJlZ2FyZGxlc3Mgb2YgQVBJIGVycm9yc1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBBbHdheXMgY2xlYXIgbG9jYWwgc3RhdGUgYW5kIHN0b3JhZ2VcbiAgICAgIGNsZWFyQXV0aFN0YXRlKCk7XG4gICAgICBcbiAgICAgIC8vIExvZyB0aGUgZXZlbnRcbiAgICAgIGxvZ0F1dGhFdmVudCgnbG9nb3V0X2NvbXBsZXRlJyk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPEF1dGhDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt7IFxuICAgICAgdXNlciwgXG4gICAgICBsb2dpbiwgXG4gICAgICBsb2dvdXQsIFxuICAgICAgbG9hZGluZyxcbiAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgIGlzQXV0aGVudGljYXRlZFxuICAgIH19PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvQXV0aENvbnRleHQuUHJvdmlkZXI+XG4gICk7XG59XG5cbmV4cG9ydCBjb25zdCB1c2VBdXRoID0gKCk6IEF1dGhDb250ZXh0VHlwZSA9PiB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KEF1dGhDb250ZXh0KTtcbiAgaWYgKCFjb250ZXh0KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCd1c2VBdXRoIG11c3QgYmUgdXNlZCB3aXRoaW4gYW4gQXV0aFByb3ZpZGVyJyk7XG4gIH1cbiAgcmV0dXJuIGNvbnRleHQ7XG59O1xuIl0sIm5hbWVzIjpbIlJlYWN0IiwiY3JlYXRlQ29udGV4dCIsInVzZUNvbnRleHQiLCJ1c2VFZmZlY3QiLCJ1c2VTdGF0ZSIsInVzZVJlZiIsIkFQSV9FTkRQT0lOVFMiLCJhcGkiLCJoYXNBZG1pbkJ5cGFzcyIsImJ5cGFzc0xvZ2luIiwiZ2V0QXV0aFRva2VuIiwic3RvcmVBdXRoVG9rZW4iLCJjbGVhckF1dGhUb2tlbnMiLCJUT0tFTl9LRVkiLCJUT0tFTl9FWFBJUllfS0VZIiwiUkVGUkVTSF9UT0tFTl9LRVkiLCJUT0tFTl9WRVJJRllfSU5URVJWQUwiLCJTZXNzaW9uUGVyc2lzdGVuY2UiLCJTVE9SQUdFX0tFWSIsImNhcHR1cmVTbmFwc2hvdCIsInVzZXIiLCJ0b2tlbiIsImNsZWFyU25hcHNob3QiLCJzbmFwc2hvdCIsInRpbWVzdGFtcCIsIkRhdGUiLCJub3ciLCJpZCIsInVzZXJuYW1lIiwiZW1haWwiLCJhdXRoZW50aWNhdGVkIiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwiY29uc29sZSIsIndhcm4iLCJyZXRyaWV2ZVNuYXBzaG90Iiwic25hcHNob3RTdHIiLCJnZXRJdGVtIiwicGFyc2UiLCJNQVhfQUdFIiwiaXNFeHBpcmVkIiwicmVtb3ZlSXRlbSIsIkF1dGhDb250ZXh0IiwiQXV0aFByb3ZpZGVyIiwiY2hpbGRyZW4iLCJzZXRVc2VyIiwibG9hZGluZyIsInNldExvYWRpbmciLCJpc0F1dGhlbnRpY2F0ZWQiLCJzZXRJc0F1dGhlbnRpY2F0ZWQiLCJzZXRUb2tlbiIsInNraXBOZXh0VmVyaWZpY2F0aW9uIiwic2V0U2tpcE5leHRWZXJpZmljYXRpb24iLCJsb2dpbiIsImlzTW91bnRlZCIsInZlcmlmeU9uTW91bnQiLCJsb2ciLCJ2ZXJpZnlUb2tlbiIsImludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJjbGVhckludGVydmFsIiwidmVyaWZ5VG9rZW5EZWJvdW5jZWQiLCJsYXN0VmVyaWZ5QXR0ZW1wdCIsImZvcmNlIiwiY3VycmVudCIsInJlc3BvbnNlIiwiZ2V0IiwiQVVUSCIsIlZFUklGWV9UT0tFTiIsInN1Y2Nlc3MiLCJkYXRhIiwic3RhdHVzIiwic3RhdHVzQ29kZSIsImNsZWFyQXV0aFN0YXRlIiwibXNnIiwiRXJyb3IiLCJtZXNzYWdlIiwibG9nQXV0aEV2ZW50IiwiZXZlbnRUeXBlIiwiZGV0YWlscyIsInRvSVNPU3RyaW5nIiwibG9nRW50cnkiLCJhdXRoTG9ncyIsImxvY2FsU3RvcmFnZSIsInB1c2giLCJzbGljZSIsImUiLCJjaGVja0FuZEdlbmVyYXRlV2FsbGV0Iiwid2FsbGV0UmVzcG9uc2UiLCJXQUxMRVQiLCJJTkZPIiwid2FsbGV0Iiwid2FsbGV0X2FkZHJlc3MiLCJnZW5lcmF0ZVJlc3BvbnNlIiwicG9zdCIsIkdFTkVSQVRFIiwicmVmcmVzaFRva2VuIiwicmV0cnlDb3VudCIsIk1BWF9SRVRSSUVTIiwiQkFTRV9ERUxBWSIsImRlbGF5IiwiTWF0aCIsInBvdyIsInJhbmRvbSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIlJFRlJFU0hfVE9LRU4iLCJpbkxvY2FsU3RvcmFnZSIsInJlbWVtYmVyTWUiLCJwcmV2VXNlciIsImVycm9yTWVzc2FnZSIsImVycm9yU3RhY2siLCJzdGFjayIsInVuZGVmaW5lZCIsImxvZ291dCIsInN0b3JlZFRva2VuIiwicmVtZW1iZXJfbWUiLCJMT0dPVVQiLCJQcm92aWRlciIsInZhbHVlIiwidXNlQXV0aCIsImNvbnRleHQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/AuthContext.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/ErrorBoundary.tsx":
/*!**************************************!*\
  !*** ./components/ErrorBoundary.tsx ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\nclass ErrorBoundary extends react__WEBPACK_IMPORTED_MODULE_1__.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            hasError: false,\n            error: null\n        };\n    }\n    static getDerivedStateFromError(error) {\n        return {\n            hasError: true,\n            error\n        };\n    }\n    componentDidCatch(error, errorInfo) {\n        console.error(`Error in component ${this.props.componentName || 'unknown'}:`, error, errorInfo);\n        if (this.props.onError) {\n            this.props.onError(error, errorInfo);\n        }\n    }\n    render() {\n        if (this.state.hasError) {\n            if (this.props.fallback) {\n                return this.props.fallback;\n            }\n            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"error-boundary p-4 m-2 bg-red-100 border border-red-400 text-red-700 rounded\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                        className: \"font-bold\",\n                        children: [\n                            \"Something went wrong in \",\n                            this.props.componentName || 'this component'\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                        lineNumber: 43,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"details\", {\n                        className: \"whitespace-pre-wrap text-sm mt-2\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"summary\", {\n                                children: \"View error details\"\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                                lineNumber: 45,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                className: \"mt-1\",\n                                children: this.state.error?.toString()\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                                lineNumber: 46,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                        lineNumber: 44,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/ubuntu/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                lineNumber: 42,\n                columnNumber: 9\n            }, this);\n        }\n        return this.props.children;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ErrorBoundary);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvRXJyb3JCb3VuZGFyeS50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQStEO0FBYy9ELE1BQU1FLHNCQUFzQkQsNENBQVNBO0lBQ25DLFlBQVlFLEtBQVksQ0FBRTtRQUN4QixLQUFLLENBQUNBO1FBQ04sSUFBSSxDQUFDQyxLQUFLLEdBQUc7WUFDWEMsVUFBVTtZQUNWQyxPQUFPO1FBQ1Q7SUFDRjtJQUVBLE9BQU9DLHlCQUF5QkQsS0FBWSxFQUFTO1FBQ25ELE9BQU87WUFBRUQsVUFBVTtZQUFNQztRQUFNO0lBQ2pDO0lBRUFFLGtCQUFrQkYsS0FBWSxFQUFFRyxTQUFvQixFQUFRO1FBQzFEQyxRQUFRSixLQUFLLENBQUMsQ0FBQyxtQkFBbUIsRUFBRSxJQUFJLENBQUNILEtBQUssQ0FBQ1EsYUFBYSxJQUFJLFVBQVUsQ0FBQyxDQUFDLEVBQUVMLE9BQU9HO1FBQ3JGLElBQUksSUFBSSxDQUFDTixLQUFLLENBQUNTLE9BQU8sRUFBRTtZQUN0QixJQUFJLENBQUNULEtBQUssQ0FBQ1MsT0FBTyxDQUFDTixPQUFPRztRQUM1QjtJQUNGO0lBRUFJLFNBQW9CO1FBQ2xCLElBQUksSUFBSSxDQUFDVCxLQUFLLENBQUNDLFFBQVEsRUFBRTtZQUN2QixJQUFJLElBQUksQ0FBQ0YsS0FBSyxDQUFDVyxRQUFRLEVBQUU7Z0JBQ3ZCLE9BQU8sSUFBSSxDQUFDWCxLQUFLLENBQUNXLFFBQVE7WUFDNUI7WUFFQSxxQkFDRSw4REFBQ0M7Z0JBQUlDLFdBQVU7O2tDQUNiLDhEQUFDQzt3QkFBR0QsV0FBVTs7NEJBQVk7NEJBQXlCLElBQUksQ0FBQ2IsS0FBSyxDQUFDUSxhQUFhLElBQUk7Ozs7Ozs7a0NBQy9FLDhEQUFDTzt3QkFBUUYsV0FBVTs7MENBQ2pCLDhEQUFDRzswQ0FBUTs7Ozs7OzBDQUNULDhEQUFDQztnQ0FBRUosV0FBVTswQ0FBUSxJQUFJLENBQUNaLEtBQUssQ0FBQ0UsS0FBSyxFQUFFZTs7Ozs7Ozs7Ozs7Ozs7Ozs7O1FBSS9DO1FBRUEsT0FBTyxJQUFJLENBQUNsQixLQUFLLENBQUNtQixRQUFRO0lBQzVCO0FBQ0Y7QUFFQSxpRUFBZXBCLGFBQWFBLEVBQUMiLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9ncmFjZS1wcm9qZWN0L3NyYy91aS9jb21wb25lbnRzL0Vycm9yQm91bmRhcnkudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQsIEVycm9ySW5mbywgUmVhY3ROb2RlIH0gZnJvbSAncmVhY3QnO1xuXG5pbnRlcmZhY2UgUHJvcHMge1xuICBjaGlsZHJlbjogUmVhY3ROb2RlO1xuICBmYWxsYmFjaz86IFJlYWN0Tm9kZTtcbiAgb25FcnJvcj86IChlcnJvcjogRXJyb3IsIGVycm9ySW5mbzogRXJyb3JJbmZvKSA9PiB2b2lkO1xuICBjb21wb25lbnROYW1lPzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgU3RhdGUge1xuICBoYXNFcnJvcjogYm9vbGVhbjtcbiAgZXJyb3I6IEVycm9yIHwgbnVsbDtcbn1cblxuY2xhc3MgRXJyb3JCb3VuZGFyeSBleHRlbmRzIENvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7IFxuICAgICAgaGFzRXJyb3I6IGZhbHNlLFxuICAgICAgZXJyb3I6IG51bGxcbiAgICB9O1xuICB9XG5cbiAgc3RhdGljIGdldERlcml2ZWRTdGF0ZUZyb21FcnJvcihlcnJvcjogRXJyb3IpOiBTdGF0ZSB7XG4gICAgcmV0dXJuIHsgaGFzRXJyb3I6IHRydWUsIGVycm9yIH07XG4gIH1cblxuICBjb21wb25lbnREaWRDYXRjaChlcnJvcjogRXJyb3IsIGVycm9ySW5mbzogRXJyb3JJbmZvKTogdm9pZCB7XG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgaW4gY29tcG9uZW50ICR7dGhpcy5wcm9wcy5jb21wb25lbnROYW1lIHx8ICd1bmtub3duJ306YCwgZXJyb3IsIGVycm9ySW5mbyk7XG4gICAgaWYgKHRoaXMucHJvcHMub25FcnJvcikge1xuICAgICAgdGhpcy5wcm9wcy5vbkVycm9yKGVycm9yLCBlcnJvckluZm8pO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpOiBSZWFjdE5vZGUge1xuICAgIGlmICh0aGlzLnN0YXRlLmhhc0Vycm9yKSB7XG4gICAgICBpZiAodGhpcy5wcm9wcy5mYWxsYmFjaykge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5mYWxsYmFjaztcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJlcnJvci1ib3VuZGFyeSBwLTQgbS0yIGJnLXJlZC0xMDAgYm9yZGVyIGJvcmRlci1yZWQtNDAwIHRleHQtcmVkLTcwMCByb3VuZGVkXCI+XG4gICAgICAgICAgPGgzIGNsYXNzTmFtZT1cImZvbnQtYm9sZFwiPlNvbWV0aGluZyB3ZW50IHdyb25nIGluIHt0aGlzLnByb3BzLmNvbXBvbmVudE5hbWUgfHwgJ3RoaXMgY29tcG9uZW50J308L2gzPlxuICAgICAgICAgIDxkZXRhaWxzIGNsYXNzTmFtZT1cIndoaXRlc3BhY2UtcHJlLXdyYXAgdGV4dC1zbSBtdC0yXCI+XG4gICAgICAgICAgICA8c3VtbWFyeT5WaWV3IGVycm9yIGRldGFpbHM8L3N1bW1hcnk+XG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJtdC0xXCI+e3RoaXMuc3RhdGUuZXJyb3I/LnRvU3RyaW5nKCl9PC9wPlxuICAgICAgICAgIDwvZGV0YWlscz5cbiAgICAgICAgPC9kaXY+XG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnByb3BzLmNoaWxkcmVuO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEVycm9yQm91bmRhcnk7XG4iXSwibmFtZXMiOlsiUmVhY3QiLCJDb21wb25lbnQiLCJFcnJvckJvdW5kYXJ5IiwicHJvcHMiLCJzdGF0ZSIsImhhc0Vycm9yIiwiZXJyb3IiLCJnZXREZXJpdmVkU3RhdGVGcm9tRXJyb3IiLCJjb21wb25lbnREaWRDYXRjaCIsImVycm9ySW5mbyIsImNvbnNvbGUiLCJjb21wb25lbnROYW1lIiwib25FcnJvciIsInJlbmRlciIsImZhbGxiYWNrIiwiZGl2IiwiY2xhc3NOYW1lIiwiaDMiLCJkZXRhaWxzIiwic3VtbWFyeSIsInAiLCJ0b1N0cmluZyIsImNoaWxkcmVuIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/ErrorBoundary.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/LoadingPage.tsx":
/*!************************************!*\
  !*** ./components/LoadingPage.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ LoadingPage)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\n/**\n * LoadingPage component\n * \n * Displays a consistent loading animation for transitions between pages\n * or during authentication processes.\n */ function LoadingPage({ message = 'Loading...', showLogo = true }) {\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"flex min-h-screen items-center justify-center bg-black text-white p-4\",\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"text-center\",\n            children: [\n                showLogo && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"mb-4 text-red-500 text-xl font-bold\",\n                    children: \"Grace\"\n                }, void 0, false, {\n                    fileName: \"/home/ubuntu/grace-project/src/ui/components/LoadingPage.tsx\",\n                    lineNumber: 22,\n                    columnNumber: 11\n                }, this),\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"flex items-center justify-center\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                            className: \"mr-2\",\n                            children: message\n                        }, void 0, false, {\n                            fileName: \"/home/ubuntu/grace-project/src/ui/components/LoadingPage.tsx\",\n                            lineNumber: 25,\n                            columnNumber: 11\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"animate-pulse\",\n                            children: \"...\"\n                        }, void 0, false, {\n                            fileName: \"/home/ubuntu/grace-project/src/ui/components/LoadingPage.tsx\",\n                            lineNumber: 26,\n                            columnNumber: 11\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/home/ubuntu/grace-project/src/ui/components/LoadingPage.tsx\",\n                    lineNumber: 24,\n                    columnNumber: 9\n                }, this)\n            ]\n        }, void 0, true, {\n            fileName: \"/home/ubuntu/grace-project/src/ui/components/LoadingPage.tsx\",\n            lineNumber: 20,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/home/ubuntu/grace-project/src/ui/components/LoadingPage.tsx\",\n        lineNumber: 19,\n        columnNumber: 5\n    }, this);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvTG9hZGluZ1BhZ2UudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUEwQjtBQU8xQjs7Ozs7Q0FLQyxHQUNjLFNBQVNDLFlBQVksRUFDbENDLFVBQVUsWUFBWSxFQUN0QkMsV0FBVyxJQUFJLEVBQ0U7SUFDakIscUJBQ0UsOERBQUNDO1FBQUlDLFdBQVU7a0JBQ2IsNEVBQUNEO1lBQUlDLFdBQVU7O2dCQUNaRiwwQkFDQyw4REFBQ0M7b0JBQUlDLFdBQVU7OEJBQXNDOzs7Ozs7OEJBRXZELDhEQUFDRDtvQkFBSUMsV0FBVTs7c0NBQ2IsOERBQUNDOzRCQUFLRCxXQUFVO3NDQUFRSDs7Ozs7O3NDQUN4Qiw4REFBQ0U7NEJBQUlDLFdBQVU7c0NBQWdCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUt6QyIsInNvdXJjZXMiOlsiL2hvbWUvdWJ1bnR1L2dyYWNlLXByb2plY3Qvc3JjL3VpL2NvbXBvbmVudHMvTG9hZGluZ1BhZ2UudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cbmludGVyZmFjZSBMb2FkaW5nUGFnZVByb3BzIHtcbiAgbWVzc2FnZT86IHN0cmluZztcbiAgc2hvd0xvZ28/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIExvYWRpbmdQYWdlIGNvbXBvbmVudFxuICogXG4gKiBEaXNwbGF5cyBhIGNvbnNpc3RlbnQgbG9hZGluZyBhbmltYXRpb24gZm9yIHRyYW5zaXRpb25zIGJldHdlZW4gcGFnZXNcbiAqIG9yIGR1cmluZyBhdXRoZW50aWNhdGlvbiBwcm9jZXNzZXMuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIExvYWRpbmdQYWdlKHsgXG4gIG1lc3NhZ2UgPSAnTG9hZGluZy4uLicsIFxuICBzaG93TG9nbyA9IHRydWUgXG59OiBMb2FkaW5nUGFnZVByb3BzKSB7XG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IG1pbi1oLXNjcmVlbiBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgYmctYmxhY2sgdGV4dC13aGl0ZSBwLTRcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cbiAgICAgICAge3Nob3dMb2dvICYmIChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm1iLTQgdGV4dC1yZWQtNTAwIHRleHQteGwgZm9udC1ib2xkXCI+R3JhY2U8L2Rpdj5cbiAgICAgICAgKX1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm1yLTJcIj57bWVzc2FnZX08L3NwYW4+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXB1bHNlXCI+Li4uPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59XG4iXSwibmFtZXMiOlsiUmVhY3QiLCJMb2FkaW5nUGFnZSIsIm1lc3NhZ2UiLCJzaG93TG9nbyIsImRpdiIsImNsYXNzTmFtZSIsInNwYW4iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/LoadingPage.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/LogoutButton.tsx":
/*!*************************************!*\
  !*** ./components/LogoutButton.tsx ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ LogoutButton)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/router */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/router.js\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _AuthContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n/* harmony import */ var _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/StatePersistence */ \"(pages-dir-node)/./utils/StatePersistence.ts\");\n// src/components/LogoutButton.tsx\n\n\n\n\n\nfunction LogoutButton() {\n    const router = (0,next_router__WEBPACK_IMPORTED_MODULE_2__.useRouter)();\n    const { logout } = (0,_AuthContext__WEBPACK_IMPORTED_MODULE_3__.useAuth)(); // Use the standardized logout function from AuthContext\n    const handleLogout = async ()=>{\n        try {\n            // Clear persistent state snapshot\n            _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_4__[\"default\"].clearSnapshot();\n            // Use the standardized logout function that handles everything\n            await logout();\n            // After successful logout, redirect to login page\n            router.push('/login');\n        } catch (err) {\n            console.error('Logout failed:', err);\n            // Still navigate to login even if the API call fails\n            router.push('/login');\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n        onClick: handleLogout,\n        className: \"transition-all hover:text-red-400 pb-1 text-white\",\n        children: \"Logout\"\n    }, void 0, false, {\n        fileName: \"/home/ubuntu/grace-project/src/ui/components/LogoutButton.tsx\",\n        lineNumber: 32,\n        columnNumber: 5\n    }, this);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvTG9nb3V0QnV0dG9uLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSxrQ0FBa0M7O0FBRVI7QUFDYztBQUNBO0FBR3dCO0FBRWpELFNBQVNJO0lBQ3RCLE1BQU1DLFNBQVNKLHNEQUFTQTtJQUN4QixNQUFNLEVBQUVLLE1BQU0sRUFBRSxHQUFHSixxREFBT0EsSUFBSSx3REFBd0Q7SUFFdEYsTUFBTUssZUFBZTtRQUNuQixJQUFJO1lBQ0Ysa0NBQWtDO1lBQ2xDSiw2RUFBcUM7WUFFckMsK0RBQStEO1lBQy9ELE1BQU1HO1lBRU4sa0RBQWtEO1lBQ2xERCxPQUFPSSxJQUFJLENBQUM7UUFDZCxFQUFFLE9BQU9DLEtBQUs7WUFDWkMsUUFBUUMsS0FBSyxDQUFDLGtCQUFrQkY7WUFDaEMscURBQXFEO1lBQ3JETCxPQUFPSSxJQUFJLENBQUM7UUFDZDtJQUNGO0lBRUEscUJBQ0UsOERBQUNJO1FBQ0NDLFNBQVNQO1FBQ1RRLFdBQVU7a0JBQ1g7Ozs7OztBQUlMIiwic291cmNlcyI6WyIvaG9tZS91YnVudHUvZ3JhY2UtcHJvamVjdC9zcmMvdWkvY29tcG9uZW50cy9Mb2dvdXRCdXR0b24udHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9jb21wb25lbnRzL0xvZ291dEJ1dHRvbi50c3hcblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuL0F1dGhDb250ZXh0JztcbmltcG9ydCBhcGkgZnJvbSAnLi4vYXBpL2FwaUNsaWVudCc7XG5pbXBvcnQgeyBBUElfRU5EUE9JTlRTIH0gZnJvbSAnLi4vYXBpL2FwaUNsaWVudCc7XG5pbXBvcnQgU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXIgZnJvbSAnLi4vdXRpbHMvU3RhdGVQZXJzaXN0ZW5jZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIExvZ291dEJ1dHRvbigpIHtcbiAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XG4gIGNvbnN0IHsgbG9nb3V0IH0gPSB1c2VBdXRoKCk7IC8vIFVzZSB0aGUgc3RhbmRhcmRpemVkIGxvZ291dCBmdW5jdGlvbiBmcm9tIEF1dGhDb250ZXh0XG5cbiAgY29uc3QgaGFuZGxlTG9nb3V0ID0gYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDbGVhciBwZXJzaXN0ZW50IHN0YXRlIHNuYXBzaG90XG4gICAgICBTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlci5jbGVhclNuYXBzaG90KCk7XG4gICAgICBcbiAgICAgIC8vIFVzZSB0aGUgc3RhbmRhcmRpemVkIGxvZ291dCBmdW5jdGlvbiB0aGF0IGhhbmRsZXMgZXZlcnl0aGluZ1xuICAgICAgYXdhaXQgbG9nb3V0KCk7XG4gICAgICBcbiAgICAgIC8vIEFmdGVyIHN1Y2Nlc3NmdWwgbG9nb3V0LCByZWRpcmVjdCB0byBsb2dpbiBwYWdlXG4gICAgICByb3V0ZXIucHVzaCgnL2xvZ2luJyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdMb2dvdXQgZmFpbGVkOicsIGVycik7XG4gICAgICAvLyBTdGlsbCBuYXZpZ2F0ZSB0byBsb2dpbiBldmVuIGlmIHRoZSBBUEkgY2FsbCBmYWlsc1xuICAgICAgcm91dGVyLnB1c2goJy9sb2dpbicpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxidXR0b25cbiAgICAgIG9uQ2xpY2s9e2hhbmRsZUxvZ291dH1cbiAgICAgIGNsYXNzTmFtZT1cInRyYW5zaXRpb24tYWxsIGhvdmVyOnRleHQtcmVkLTQwMCBwYi0xIHRleHQtd2hpdGVcIlxuICAgID5cbiAgICAgIExvZ291dFxuICAgIDwvYnV0dG9uPlxuICApO1xufVxuIl0sIm5hbWVzIjpbIlJlYWN0IiwidXNlUm91dGVyIiwidXNlQXV0aCIsIlN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyIiwiTG9nb3V0QnV0dG9uIiwicm91dGVyIiwibG9nb3V0IiwiaGFuZGxlTG9nb3V0IiwiY2xlYXJTbmFwc2hvdCIsInB1c2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJidXR0b24iLCJvbkNsaWNrIiwiY2xhc3NOYW1lIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/LogoutButton.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/StateLoader.tsx":
/*!************************************!*\
  !*** ./components/StateLoader.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _context_AppStateContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../context/AppStateContext */ \"(pages-dir-node)/./context/AppStateContext.tsx\");\n/* harmony import */ var _utils_StateBackupService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/StateBackupService */ \"(pages-dir-node)/./utils/StateBackupService.ts\");\n/* harmony import */ var _AuthContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n\n\n\n\n\nconst StateLoader = ({ children })=>{\n    const { isStateLoading, isStateHydrated, isStateRecovered, isStateSyncing, dispatch } = (0,_context_AppStateContext__WEBPACK_IMPORTED_MODULE_2__.useAppState)();\n    const { user, isAuthenticated } = (0,_AuthContext__WEBPACK_IMPORTED_MODULE_4__.useAuth)();\n    const [showSyncNotice, setShowSyncNotice] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [showHydrationNotice, setShowHydrationNotice] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [showRecoveryAttempt, setShowRecoveryAttempt] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const isInitialMount = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(true);\n    const backupService = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const recoveryAttemptMade = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    // Handle sync notice display and auto-hide\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"StateLoader.useEffect\": ()=>{\n            if (isStateSyncing) {\n                setShowSyncNotice(true);\n                // Auto-hide sync notice after 3 seconds\n                const timer = setTimeout({\n                    \"StateLoader.useEffect.timer\": ()=>setShowSyncNotice(false)\n                }[\"StateLoader.useEffect.timer\"], 3000);\n                return ({\n                    \"StateLoader.useEffect\": ()=>clearTimeout(timer)\n                })[\"StateLoader.useEffect\"];\n            }\n        }\n    }[\"StateLoader.useEffect\"], [\n        isStateSyncing\n    ]);\n    // Initialize the state backup service\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"StateLoader.useEffect\": ()=>{\n            if (isAuthenticated && user) {\n                try {\n                    // Initialize the backup service\n                    const service = _utils_StateBackupService__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance();\n                    backupService.current = service;\n                    service.initialize().then({\n                        \"StateLoader.useEffect\": (success)=>{\n                            console.log(`State backup service initialized: ${success ? 'success' : 'fallback mode'}`);\n                        }\n                    }[\"StateLoader.useEffect\"]);\n                } catch (error) {\n                    console.error('Failed to initialize state backup service:', error);\n                }\n            }\n            return ({\n                \"StateLoader.useEffect\": ()=>{\n                    // Clean up backup service on unmount\n                    if (backupService.current) {\n                        backupService.current.stopPeriodicBackup();\n                    }\n                }\n            })[\"StateLoader.useEffect\"];\n        }\n    }[\"StateLoader.useEffect\"], [\n        isAuthenticated,\n        user\n    ]);\n    // Attempt recovery if needed\n    const attemptStateRecovery = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"StateLoader.useCallback[attemptStateRecovery]\": async ()=>{\n            if (!isStateHydrated && !isStateLoading && !recoveryAttemptMade.current) {\n                recoveryAttemptMade.current = true;\n                setShowRecoveryAttempt(true);\n                try {\n                    if (backupService.current) {\n                        const recoveredState = await backupService.current.attemptRecovery();\n                        if (recoveredState) {\n                            console.log('Successfully recovered state from backup source');\n                            dispatch({\n                                type: 'HYDRATE_STATE',\n                                payload: recoveredState\n                            });\n                            setShowHydrationNotice(true);\n                            setTimeout({\n                                \"StateLoader.useCallback[attemptStateRecovery]\": ()=>setShowHydrationNotice(false)\n                            }[\"StateLoader.useCallback[attemptStateRecovery]\"], 3000);\n                        }\n                    }\n                } catch (error) {\n                    console.error('Error during state recovery attempt:', error);\n                } finally{\n                    setShowRecoveryAttempt(false);\n                }\n            }\n        }\n    }[\"StateLoader.useCallback[attemptStateRecovery]\"], [\n        dispatch,\n        isStateHydrated,\n        isStateLoading\n    ]);\n    // Trigger recovery attempt if state is not hydrated\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"StateLoader.useEffect\": ()=>{\n            if (isAuthenticated && !isStateHydrated && !isStateLoading) {\n                const timer = setTimeout({\n                    \"StateLoader.useEffect.timer\": ()=>{\n                        attemptStateRecovery();\n                    }\n                }[\"StateLoader.useEffect.timer\"], 1000); // Wait 1 second before attempting recovery\n                return ({\n                    \"StateLoader.useEffect\": ()=>clearTimeout(timer)\n                })[\"StateLoader.useEffect\"];\n            }\n        }\n    }[\"StateLoader.useEffect\"], [\n        isAuthenticated,\n        isStateHydrated,\n        isStateLoading,\n        attemptStateRecovery\n    ]);\n    // Handle hydration notice only for non-initial state hydrations\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"StateLoader.useEffect\": ()=>{\n            // Skip the initial mount effect - this prevents showing notification on first load\n            if (isInitialMount.current) {\n                isInitialMount.current = false;\n                return;\n            }\n            // Only show hydration notice for subsequent hydrations\n            if (isStateHydrated && !isStateLoading) {\n                setShowHydrationNotice(true);\n                const timer = setTimeout({\n                    \"StateLoader.useEffect.timer\": ()=>setShowHydrationNotice(false)\n                }[\"StateLoader.useEffect.timer\"], 3000);\n                return ({\n                    \"StateLoader.useEffect\": ()=>clearTimeout(timer)\n                })[\"StateLoader.useEffect\"];\n            }\n        }\n    }[\"StateLoader.useEffect\"], [\n        isStateHydrated,\n        isStateLoading\n    ]);\n    if (isStateLoading || showRecoveryAttempt) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-gray-900 p-6 rounded-lg shadow-lg text-center\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-gold mx-auto mb-4\"\n                    }, void 0, false, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 108,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                        className: \"text-xl font-semibold text-gold mb-2\",\n                        children: showRecoveryAttempt ? 'Recovering Your Data' : 'Loading Your Trading State'\n                    }, void 0, false, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 109,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-gray-400\",\n                        children: showRecoveryAttempt ? 'Attempting to recover your session data...' : 'Restoring your previous session...'\n                    }, void 0, false, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 112,\n                        columnNumber: 11\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                lineNumber: 107,\n                columnNumber: 9\n            }, undefined)\n        }, void 0, false, {\n            fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n            lineNumber: 106,\n            columnNumber: 7\n        }, undefined);\n    }\n    // Show recovery notification if state was recovered from corruption\n    if (isStateRecovered) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"fixed bottom-4 right-4 bg-gray-900 text-yellow-500 px-4 py-2 rounded shadow-lg  border border-yellow-600 transition-opacity duration-1000 z-40\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                xmlns: \"http://www.w3.org/2000/svg\",\n                                className: \"h-5 w-5 mr-2\",\n                                fill: \"none\",\n                                viewBox: \"0 0 24 24\",\n                                stroke: \"currentColor\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                    strokeLinecap: \"round\",\n                                    strokeLinejoin: \"round\",\n                                    strokeWidth: 2,\n                                    d: \"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n                                }, void 0, false, {\n                                    fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                    lineNumber: 130,\n                                    columnNumber: 15\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 129,\n                                columnNumber: 13\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                children: \"Session was partially recovered due to data corruption\"\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 132,\n                                columnNumber: 13\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 128,\n                        columnNumber: 11\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                    lineNumber: 126,\n                    columnNumber: 9\n                }, undefined),\n                children\n            ]\n        }, void 0, true);\n    }\n    // Show a brief flash notification when state is hydrated but not on initial load\n    if (showHydrationNotice) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"fixed bottom-4 right-4 bg-gray-900 text-green-400 px-4 py-2 rounded shadow-lg  transition-opacity duration-1000 z-40\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                xmlns: \"http://www.w3.org/2000/svg\",\n                                className: \"h-5 w-5 mr-2\",\n                                fill: \"none\",\n                                viewBox: \"0 0 24 24\",\n                                stroke: \"currentColor\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                    strokeLinecap: \"round\",\n                                    strokeLinejoin: \"round\",\n                                    strokeWidth: 2,\n                                    d: \"M5 13l4 4L19 7\"\n                                }, void 0, false, {\n                                    fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                    lineNumber: 148,\n                                    columnNumber: 15\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 147,\n                                columnNumber: 13\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                children: \"Session restored successfully\"\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 150,\n                                columnNumber: 13\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 146,\n                        columnNumber: 11\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                    lineNumber: 144,\n                    columnNumber: 9\n                }, undefined),\n                children\n            ]\n        }, void 0, true);\n    }\n    // Show cross-tab sync notification\n    if (showSyncNotice) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"fixed bottom-4 right-4 bg-gray-800 text-blue-400 px-4 py-2 rounded shadow-lg  transition-opacity duration-300 z-40 border border-blue-600\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                xmlns: \"http://www.w3.org/2000/svg\",\n                                className: \"h-5 w-5 mr-2 animate-pulse\",\n                                fill: \"none\",\n                                viewBox: \"0 0 24 24\",\n                                stroke: \"currentColor\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                    strokeLinecap: \"round\",\n                                    strokeLinejoin: \"round\",\n                                    strokeWidth: 2,\n                                    d: \"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\n                                }, void 0, false, {\n                                    fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                    lineNumber: 166,\n                                    columnNumber: 15\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 165,\n                                columnNumber: 13\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                children: \"Syncing state from another tab...\"\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 168,\n                                columnNumber: 13\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 164,\n                        columnNumber: 11\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/home/ubuntu/grace-project/src/ui/components/StateLoader.tsx\",\n                    lineNumber: 162,\n                    columnNumber: 9\n                }, undefined),\n                children\n            ]\n        }, void 0, true);\n    }\n    // Default render\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: children\n    }, void 0, false);\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StateLoader);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvU3RhdGVMb2FkZXIudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF3RTtBQUNmO0FBQ0k7QUFDckI7QUFNeEMsTUFBTVEsY0FBMEMsQ0FBQyxFQUFFQyxRQUFRLEVBQUU7SUFDM0QsTUFBTSxFQUFFQyxjQUFjLEVBQUVDLGVBQWUsRUFBRUMsZ0JBQWdCLEVBQUVDLGNBQWMsRUFBRUMsUUFBUSxFQUFFLEdBQUdULHFFQUFXQTtJQUNuRyxNQUFNLEVBQUVVLElBQUksRUFBRUMsZUFBZSxFQUFFLEdBQUdULHFEQUFPQTtJQUN6QyxNQUFNLENBQUNVLGdCQUFnQkMsa0JBQWtCLEdBQUdoQiwrQ0FBUUEsQ0FBQztJQUNyRCxNQUFNLENBQUNpQixxQkFBcUJDLHVCQUF1QixHQUFHbEIsK0NBQVFBLENBQUM7SUFDL0QsTUFBTSxDQUFDbUIscUJBQXFCQyx1QkFBdUIsR0FBR3BCLCtDQUFRQSxDQUFDO0lBQy9ELE1BQU1xQixpQkFBaUJwQiw2Q0FBTUEsQ0FBQztJQUM5QixNQUFNcUIsZ0JBQWdCckIsNkNBQU1BLENBQTRCO0lBQ3hELE1BQU1zQixzQkFBc0J0Qiw2Q0FBTUEsQ0FBQztJQUVuQywyQ0FBMkM7SUFDM0NGLGdEQUFTQTtpQ0FBQztZQUNSLElBQUlZLGdCQUFnQjtnQkFDbEJLLGtCQUFrQjtnQkFDbEIsd0NBQXdDO2dCQUN4QyxNQUFNUSxRQUFRQzttREFBVyxJQUFNVCxrQkFBa0I7a0RBQVE7Z0JBQ3pEOzZDQUFPLElBQU1VLGFBQWFGOztZQUM1QjtRQUNGO2dDQUFHO1FBQUNiO0tBQWU7SUFFbkIsc0NBQXNDO0lBQ3RDWixnREFBU0E7aUNBQUM7WUFDUixJQUFJZSxtQkFBbUJELE1BQU07Z0JBQzNCLElBQUk7b0JBQ0YsZ0NBQWdDO29CQUNoQyxNQUFNYyxVQUFVdkIsNkVBQThCO29CQUM5Q2tCLGNBQWNPLE9BQU8sR0FBR0Y7b0JBQ3hCQSxRQUFRRyxVQUFVLEdBQUdDLElBQUk7aURBQUNDLENBQUFBOzRCQUN4QkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLEVBQUVGLFVBQVUsWUFBWSxpQkFBaUI7d0JBQzFGOztnQkFDRixFQUFFLE9BQU9HLE9BQU87b0JBQ2RGLFFBQVFFLEtBQUssQ0FBQyw4Q0FBOENBO2dCQUM5RDtZQUNGO1lBRUE7eUNBQU87b0JBQ0wscUNBQXFDO29CQUNyQyxJQUFJYixjQUFjTyxPQUFPLEVBQUU7d0JBQ3pCUCxjQUFjTyxPQUFPLENBQUNPLGtCQUFrQjtvQkFDMUM7Z0JBQ0Y7O1FBQ0Y7Z0NBQUc7UUFBQ3RCO1FBQWlCRDtLQUFLO0lBRTFCLDZCQUE2QjtJQUM3QixNQUFNd0IsdUJBQXVCbkMsa0RBQVdBO3lEQUFDO1lBQ3ZDLElBQUksQ0FBQ08sbUJBQW1CLENBQUNELGtCQUFrQixDQUFDZSxvQkFBb0JNLE9BQU8sRUFBRTtnQkFDdkVOLG9CQUFvQk0sT0FBTyxHQUFHO2dCQUM5QlQsdUJBQXVCO2dCQUV2QixJQUFJO29CQUNGLElBQUlFLGNBQWNPLE9BQU8sRUFBRTt3QkFDekIsTUFBTVMsaUJBQWlCLE1BQU1oQixjQUFjTyxPQUFPLENBQUNVLGVBQWU7d0JBQ2xFLElBQUlELGdCQUFnQjs0QkFDbEJMLFFBQVFDLEdBQUcsQ0FBQzs0QkFDWnRCLFNBQVM7Z0NBQUU0QixNQUFNO2dDQUFpQkMsU0FBU0g7NEJBQWU7NEJBQzFEcEIsdUJBQXVCOzRCQUN2Qk87aUZBQVcsSUFBTVAsdUJBQXVCO2dGQUFRO3dCQUNsRDtvQkFDRjtnQkFDRixFQUFFLE9BQU9pQixPQUFPO29CQUNkRixRQUFRRSxLQUFLLENBQUMsd0NBQXdDQTtnQkFDeEQsU0FBVTtvQkFDUmYsdUJBQXVCO2dCQUN6QjtZQUNGO1FBQ0Y7d0RBQUc7UUFBQ1I7UUFBVUg7UUFBaUJEO0tBQWU7SUFFOUMsb0RBQW9EO0lBQ3BEVCxnREFBU0E7aUNBQUM7WUFDUixJQUFJZSxtQkFBbUIsQ0FBQ0wsbUJBQW1CLENBQUNELGdCQUFnQjtnQkFDMUQsTUFBTWdCLFFBQVFDO21EQUFXO3dCQUN2Qlk7b0JBQ0Y7a0RBQUcsT0FBTywyQ0FBMkM7Z0JBRXJEOzZDQUFPLElBQU1YLGFBQWFGOztZQUM1QjtRQUNGO2dDQUFHO1FBQUNWO1FBQWlCTDtRQUFpQkQ7UUFBZ0I2QjtLQUFxQjtJQUUzRSxnRUFBZ0U7SUFDaEV0QyxnREFBU0E7aUNBQUM7WUFDUixtRkFBbUY7WUFDbkYsSUFBSXNCLGVBQWVRLE9BQU8sRUFBRTtnQkFDMUJSLGVBQWVRLE9BQU8sR0FBRztnQkFDekI7WUFDRjtZQUVBLHVEQUF1RDtZQUN2RCxJQUFJcEIsbUJBQW1CLENBQUNELGdCQUFnQjtnQkFDdENVLHVCQUF1QjtnQkFDdkIsTUFBTU0sUUFBUUM7bURBQVcsSUFBTVAsdUJBQXVCO2tEQUFRO2dCQUM5RDs2Q0FBTyxJQUFNUSxhQUFhRjs7WUFDNUI7UUFDRjtnQ0FBRztRQUFDZjtRQUFpQkQ7S0FBZTtJQUVwQyxJQUFJQSxrQkFBa0JXLHFCQUFxQjtRQUN6QyxxQkFDRSw4REFBQ3VCO1lBQUlDLFdBQVU7c0JBQ2IsNEVBQUNEO2dCQUFJQyxXQUFVOztrQ0FDYiw4REFBQ0Q7d0JBQUlDLFdBQVU7Ozs7OztrQ0FDZiw4REFBQ0M7d0JBQUdELFdBQVU7a0NBQ1h4QixzQkFBc0IseUJBQXlCOzs7Ozs7a0NBRWxELDhEQUFDMEI7d0JBQUVGLFdBQVU7a0NBQ1Z4QixzQkFDRywrQ0FDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFLZDtJQUVBLG9FQUFvRTtJQUNwRSxJQUFJVCxrQkFBa0I7UUFDcEIscUJBQ0U7OzhCQUNFLDhEQUFDZ0M7b0JBQUlDLFdBQVU7OEJBRWIsNEVBQUNEO3dCQUFJQyxXQUFVOzswQ0FDYiw4REFBQ0c7Z0NBQUlDLE9BQU07Z0NBQTZCSixXQUFVO2dDQUFlSyxNQUFLO2dDQUFPQyxTQUFRO2dDQUFZQyxRQUFPOzBDQUN0Ryw0RUFBQ0M7b0NBQUtDLGVBQWM7b0NBQVFDLGdCQUFlO29DQUFRQyxhQUFhO29DQUFHQyxHQUFFOzs7Ozs7Ozs7OzswQ0FFdkUsOERBQUNDOzBDQUFLOzs7Ozs7Ozs7Ozs7Ozs7OztnQkFHVGpEOzs7SUFHUDtJQUVBLGlGQUFpRjtJQUNqRixJQUFJVSxxQkFBcUI7UUFDdkIscUJBQ0U7OzhCQUNFLDhEQUFDeUI7b0JBQUlDLFdBQVU7OEJBRWIsNEVBQUNEO3dCQUFJQyxXQUFVOzswQ0FDYiw4REFBQ0c7Z0NBQUlDLE9BQU07Z0NBQTZCSixXQUFVO2dDQUFlSyxNQUFLO2dDQUFPQyxTQUFRO2dDQUFZQyxRQUFPOzBDQUN0Ryw0RUFBQ0M7b0NBQUtDLGVBQWM7b0NBQVFDLGdCQUFlO29DQUFRQyxhQUFhO29DQUFHQyxHQUFFOzs7Ozs7Ozs7OzswQ0FFdkUsOERBQUNDOzBDQUFLOzs7Ozs7Ozs7Ozs7Ozs7OztnQkFHVGpEOzs7SUFHUDtJQUVBLG1DQUFtQztJQUNuQyxJQUFJUSxnQkFBZ0I7UUFDbEIscUJBQ0U7OzhCQUNFLDhEQUFDMkI7b0JBQUlDLFdBQVU7OEJBRWIsNEVBQUNEO3dCQUFJQyxXQUFVOzswQ0FDYiw4REFBQ0c7Z0NBQUlDLE9BQU07Z0NBQTZCSixXQUFVO2dDQUE2QkssTUFBSztnQ0FBT0MsU0FBUTtnQ0FBWUMsUUFBTzswQ0FDcEgsNEVBQUNDO29DQUFLQyxlQUFjO29DQUFRQyxnQkFBZTtvQ0FBUUMsYUFBYTtvQ0FBR0MsR0FBRTs7Ozs7Ozs7Ozs7MENBRXZFLDhEQUFDQzswQ0FBSzs7Ozs7Ozs7Ozs7Ozs7Ozs7Z0JBR1RqRDs7O0lBR1A7SUFFQSxpQkFBaUI7SUFDakIscUJBQU87a0JBQUdBOztBQUNaO0FBRUEsaUVBQWVELFdBQVdBLEVBQUMiLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9ncmFjZS1wcm9qZWN0L3NyYy91aS9jb21wb25lbnRzL1N0YXRlTG9hZGVyLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VDYWxsYmFjayB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZUFwcFN0YXRlIH0gZnJvbSAnLi4vY29udGV4dC9BcHBTdGF0ZUNvbnRleHQnO1xuaW1wb3J0IFN0YXRlQmFja3VwU2VydmljZSBmcm9tICcuLi91dGlscy9TdGF0ZUJhY2t1cFNlcnZpY2UnO1xuaW1wb3J0IHsgdXNlQXV0aCB9IGZyb20gJy4vQXV0aENvbnRleHQnO1xuXG5pbnRlcmZhY2UgU3RhdGVMb2FkZXJQcm9wcyB7XG4gIGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7XG59XG5cbmNvbnN0IFN0YXRlTG9hZGVyOiBSZWFjdC5GQzxTdGF0ZUxvYWRlclByb3BzPiA9ICh7IGNoaWxkcmVuIH0pID0+IHtcbiAgY29uc3QgeyBpc1N0YXRlTG9hZGluZywgaXNTdGF0ZUh5ZHJhdGVkLCBpc1N0YXRlUmVjb3ZlcmVkLCBpc1N0YXRlU3luY2luZywgZGlzcGF0Y2ggfSA9IHVzZUFwcFN0YXRlKCk7XG4gIGNvbnN0IHsgdXNlciwgaXNBdXRoZW50aWNhdGVkIH0gPSB1c2VBdXRoKCk7XG4gIGNvbnN0IFtzaG93U3luY05vdGljZSwgc2V0U2hvd1N5bmNOb3RpY2VdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd0h5ZHJhdGlvbk5vdGljZSwgc2V0U2hvd0h5ZHJhdGlvbk5vdGljZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtzaG93UmVjb3ZlcnlBdHRlbXB0LCBzZXRTaG93UmVjb3ZlcnlBdHRlbXB0XSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgaXNJbml0aWFsTW91bnQgPSB1c2VSZWYodHJ1ZSk7XG4gIGNvbnN0IGJhY2t1cFNlcnZpY2UgPSB1c2VSZWY8U3RhdGVCYWNrdXBTZXJ2aWNlIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IHJlY292ZXJ5QXR0ZW1wdE1hZGUgPSB1c2VSZWYoZmFsc2UpO1xuICBcbiAgLy8gSGFuZGxlIHN5bmMgbm90aWNlIGRpc3BsYXkgYW5kIGF1dG8taGlkZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpc1N0YXRlU3luY2luZykge1xuICAgICAgc2V0U2hvd1N5bmNOb3RpY2UodHJ1ZSk7XG4gICAgICAvLyBBdXRvLWhpZGUgc3luYyBub3RpY2UgYWZ0ZXIgMyBzZWNvbmRzXG4gICAgICBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4gc2V0U2hvd1N5bmNOb3RpY2UoZmFsc2UpLCAzMDAwKTtcbiAgICAgIHJldHVybiAoKSA9PiBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgIH1cbiAgfSwgW2lzU3RhdGVTeW5jaW5nXSk7XG4gIFxuICAvLyBJbml0aWFsaXplIHRoZSBzdGF0ZSBiYWNrdXAgc2VydmljZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpc0F1dGhlbnRpY2F0ZWQgJiYgdXNlcikge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgYmFja3VwIHNlcnZpY2VcbiAgICAgICAgY29uc3Qgc2VydmljZSA9IFN0YXRlQmFja3VwU2VydmljZS5nZXRJbnN0YW5jZSgpO1xuICAgICAgICBiYWNrdXBTZXJ2aWNlLmN1cnJlbnQgPSBzZXJ2aWNlO1xuICAgICAgICBzZXJ2aWNlLmluaXRpYWxpemUoKS50aGVuKHN1Y2Nlc3MgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBTdGF0ZSBiYWNrdXAgc2VydmljZSBpbml0aWFsaXplZDogJHtzdWNjZXNzID8gJ3N1Y2Nlc3MnIDogJ2ZhbGxiYWNrIG1vZGUnfWApO1xuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIHN0YXRlIGJhY2t1cCBzZXJ2aWNlOicsIGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIC8vIENsZWFuIHVwIGJhY2t1cCBzZXJ2aWNlIG9uIHVubW91bnRcbiAgICAgIGlmIChiYWNrdXBTZXJ2aWNlLmN1cnJlbnQpIHtcbiAgICAgICAgYmFja3VwU2VydmljZS5jdXJyZW50LnN0b3BQZXJpb2RpY0JhY2t1cCgpO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtpc0F1dGhlbnRpY2F0ZWQsIHVzZXJdKTtcbiAgXG4gIC8vIEF0dGVtcHQgcmVjb3ZlcnkgaWYgbmVlZGVkXG4gIGNvbnN0IGF0dGVtcHRTdGF0ZVJlY292ZXJ5ID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGlmICghaXNTdGF0ZUh5ZHJhdGVkICYmICFpc1N0YXRlTG9hZGluZyAmJiAhcmVjb3ZlcnlBdHRlbXB0TWFkZS5jdXJyZW50KSB7XG4gICAgICByZWNvdmVyeUF0dGVtcHRNYWRlLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgc2V0U2hvd1JlY292ZXJ5QXR0ZW1wdCh0cnVlKTtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKGJhY2t1cFNlcnZpY2UuY3VycmVudCkge1xuICAgICAgICAgIGNvbnN0IHJlY292ZXJlZFN0YXRlID0gYXdhaXQgYmFja3VwU2VydmljZS5jdXJyZW50LmF0dGVtcHRSZWNvdmVyeSgpO1xuICAgICAgICAgIGlmIChyZWNvdmVyZWRTdGF0ZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1N1Y2Nlc3NmdWxseSByZWNvdmVyZWQgc3RhdGUgZnJvbSBiYWNrdXAgc291cmNlJyk7XG4gICAgICAgICAgICBkaXNwYXRjaCh7IHR5cGU6ICdIWURSQVRFX1NUQVRFJywgcGF5bG9hZDogcmVjb3ZlcmVkU3RhdGUgfSk7XG4gICAgICAgICAgICBzZXRTaG93SHlkcmF0aW9uTm90aWNlKHRydWUpO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBzZXRTaG93SHlkcmF0aW9uTm90aWNlKGZhbHNlKSwgMzAwMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgc3RhdGUgcmVjb3ZlcnkgYXR0ZW1wdDonLCBlcnJvcik7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBzZXRTaG93UmVjb3ZlcnlBdHRlbXB0KGZhbHNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtkaXNwYXRjaCwgaXNTdGF0ZUh5ZHJhdGVkLCBpc1N0YXRlTG9hZGluZ10pO1xuICBcbiAgLy8gVHJpZ2dlciByZWNvdmVyeSBhdHRlbXB0IGlmIHN0YXRlIGlzIG5vdCBoeWRyYXRlZFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpc0F1dGhlbnRpY2F0ZWQgJiYgIWlzU3RhdGVIeWRyYXRlZCAmJiAhaXNTdGF0ZUxvYWRpbmcpIHtcbiAgICAgIGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGF0dGVtcHRTdGF0ZVJlY292ZXJ5KCk7XG4gICAgICB9LCAxMDAwKTsgLy8gV2FpdCAxIHNlY29uZCBiZWZvcmUgYXR0ZW1wdGluZyByZWNvdmVyeVxuICAgICAgXG4gICAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICB9XG4gIH0sIFtpc0F1dGhlbnRpY2F0ZWQsIGlzU3RhdGVIeWRyYXRlZCwgaXNTdGF0ZUxvYWRpbmcsIGF0dGVtcHRTdGF0ZVJlY292ZXJ5XSk7XG5cbiAgLy8gSGFuZGxlIGh5ZHJhdGlvbiBub3RpY2Ugb25seSBmb3Igbm9uLWluaXRpYWwgc3RhdGUgaHlkcmF0aW9uc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFNraXAgdGhlIGluaXRpYWwgbW91bnQgZWZmZWN0IC0gdGhpcyBwcmV2ZW50cyBzaG93aW5nIG5vdGlmaWNhdGlvbiBvbiBmaXJzdCBsb2FkXG4gICAgaWYgKGlzSW5pdGlhbE1vdW50LmN1cnJlbnQpIHtcbiAgICAgIGlzSW5pdGlhbE1vdW50LmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgLy8gT25seSBzaG93IGh5ZHJhdGlvbiBub3RpY2UgZm9yIHN1YnNlcXVlbnQgaHlkcmF0aW9uc1xuICAgIGlmIChpc1N0YXRlSHlkcmF0ZWQgJiYgIWlzU3RhdGVMb2FkaW5nKSB7XG4gICAgICBzZXRTaG93SHlkcmF0aW9uTm90aWNlKHRydWUpO1xuICAgICAgY29uc3QgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHNldFNob3dIeWRyYXRpb25Ob3RpY2UoZmFsc2UpLCAzMDAwKTtcbiAgICAgIHJldHVybiAoKSA9PiBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgIH1cbiAgfSwgW2lzU3RhdGVIeWRyYXRlZCwgaXNTdGF0ZUxvYWRpbmddKTtcblxuICBpZiAoaXNTdGF0ZUxvYWRpbmcgfHwgc2hvd1JlY292ZXJ5QXR0ZW1wdCkge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpeGVkIGluc2V0LTAgYmctYmxhY2sgYmctb3BhY2l0eS03NSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciB6LTUwXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctZ3JheS05MDAgcC02IHJvdW5kZWQtbGcgc2hhZG93LWxnIHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXNwaW4gcm91bmRlZC1mdWxsIGgtMTIgdy0xMiBib3JkZXItdC0yIGJvcmRlci1iLTIgYm9yZGVyLWdvbGQgbXgtYXV0byBtYi00XCI+PC9kaXY+XG4gICAgICAgICAgPGgzIGNsYXNzTmFtZT1cInRleHQteGwgZm9udC1zZW1pYm9sZCB0ZXh0LWdvbGQgbWItMlwiPlxuICAgICAgICAgICAge3Nob3dSZWNvdmVyeUF0dGVtcHQgPyAnUmVjb3ZlcmluZyBZb3VyIERhdGEnIDogJ0xvYWRpbmcgWW91ciBUcmFkaW5nIFN0YXRlJ31cbiAgICAgICAgICA8L2gzPlxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtZ3JheS00MDBcIj5cbiAgICAgICAgICAgIHtzaG93UmVjb3ZlcnlBdHRlbXB0IFxuICAgICAgICAgICAgICA/ICdBdHRlbXB0aW5nIHRvIHJlY292ZXIgeW91ciBzZXNzaW9uIGRhdGEuLi4nIFxuICAgICAgICAgICAgICA6ICdSZXN0b3JpbmcgeW91ciBwcmV2aW91cyBzZXNzaW9uLi4uJ31cbiAgICAgICAgICA8L3A+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIC8vIFNob3cgcmVjb3Zlcnkgbm90aWZpY2F0aW9uIGlmIHN0YXRlIHdhcyByZWNvdmVyZWQgZnJvbSBjb3JydXB0aW9uXG4gIGlmIChpc1N0YXRlUmVjb3ZlcmVkKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDw+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZml4ZWQgYm90dG9tLTQgcmlnaHQtNCBiZy1ncmF5LTkwMCB0ZXh0LXllbGxvdy01MDAgcHgtNCBweS0yIHJvdW5kZWQgc2hhZG93LWxnIFxuICAgICAgICAgICAgICAgICAgICAgIGJvcmRlciBib3JkZXIteWVsbG93LTYwMCB0cmFuc2l0aW9uLW9wYWNpdHkgZHVyYXRpb24tMTAwMCB6LTQwXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3NOYW1lPVwiaC01IHctNSBtci0yXCIgZmlsbD1cIm5vbmVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCI+XG4gICAgICAgICAgICAgIDxwYXRoIHN0cm9rZUxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZUxpbmVqb2luPVwicm91bmRcIiBzdHJva2VXaWR0aD17Mn0gZD1cIk0xMiA5djJtMCA0aC4wMW0tNi45MzggNGgxMy44NTZjMS41NCAwIDIuNTAyLTEuNjY3IDEuNzMyLTNMMTMuNzMyIDRjLS43Ny0xLjMzMy0yLjY5NC0xLjMzMy0zLjQ2NCAwTDMuMzQgMTZjLS43NyAxLjMzMy4xOTIgMyAxLjczMiAzelwiIC8+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgIDxzcGFuPlNlc3Npb24gd2FzIHBhcnRpYWxseSByZWNvdmVyZWQgZHVlIHRvIGRhdGEgY29ycnVwdGlvbjwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIHtjaGlsZHJlbn1cbiAgICAgIDwvPlxuICAgICk7XG4gIH1cbiAgXG4gIC8vIFNob3cgYSBicmllZiBmbGFzaCBub3RpZmljYXRpb24gd2hlbiBzdGF0ZSBpcyBoeWRyYXRlZCBidXQgbm90IG9uIGluaXRpYWwgbG9hZFxuICBpZiAoc2hvd0h5ZHJhdGlvbk5vdGljZSkge1xuICAgIHJldHVybiAoXG4gICAgICA8PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpeGVkIGJvdHRvbS00IHJpZ2h0LTQgYmctZ3JheS05MDAgdGV4dC1ncmVlbi00MDAgcHgtNCBweS0yIHJvdW5kZWQgc2hhZG93LWxnIFxuICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uLW9wYWNpdHkgZHVyYXRpb24tMTAwMCB6LTQwXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3NOYW1lPVwiaC01IHctNSBtci0yXCIgZmlsbD1cIm5vbmVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCI+XG4gICAgICAgICAgICAgIDxwYXRoIHN0cm9rZUxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZUxpbmVqb2luPVwicm91bmRcIiBzdHJva2VXaWR0aD17Mn0gZD1cIk01IDEzbDQgNEwxOSA3XCIgLz5cbiAgICAgICAgICAgIDwvc3ZnPlxuICAgICAgICAgICAgPHNwYW4+U2Vzc2lvbiByZXN0b3JlZCBzdWNjZXNzZnVsbHk8L3NwYW4+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICB7Y2hpbGRyZW59XG4gICAgICA8Lz5cbiAgICApO1xuICB9XG4gIFxuICAvLyBTaG93IGNyb3NzLXRhYiBzeW5jIG5vdGlmaWNhdGlvblxuICBpZiAoc2hvd1N5bmNOb3RpY2UpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPD5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBib3R0b20tNCByaWdodC00IGJnLWdyYXktODAwIHRleHQtYmx1ZS00MDAgcHgtNCBweS0yIHJvdW5kZWQgc2hhZG93LWxnIFxuICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uLW9wYWNpdHkgZHVyYXRpb24tMzAwIHotNDAgYm9yZGVyIGJvcmRlci1ibHVlLTYwMFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzTmFtZT1cImgtNSB3LTUgbXItMiBhbmltYXRlLXB1bHNlXCIgZmlsbD1cIm5vbmVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCI+XG4gICAgICAgICAgICAgIDxwYXRoIHN0cm9rZUxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZUxpbmVqb2luPVwicm91bmRcIiBzdHJva2VXaWR0aD17Mn0gZD1cIk00IDR2NWguNTgybTE1LjM1NiAyQTguMDAxIDguMDAxIDAgMDA0LjU4MiA5bTAgMEg5bTExIDExdi01aC0uNTgxbTAgMGE4LjAwMyA4LjAwMyAwIDAxLTE1LjM1Ny0ybTE1LjM1NyAySDE1XCIgLz5cbiAgICAgICAgICAgIDwvc3ZnPlxuICAgICAgICAgICAgPHNwYW4+U3luY2luZyBzdGF0ZSBmcm9tIGFub3RoZXIgdGFiLi4uPC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgPC8+XG4gICAgKTtcbiAgfVxuXG4gIC8vIERlZmF1bHQgcmVuZGVyXG4gIHJldHVybiA8PntjaGlsZHJlbn08Lz47XG59O1xuXG5leHBvcnQgZGVmYXVsdCBTdGF0ZUxvYWRlcjtcbiJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZUVmZmVjdCIsInVzZVN0YXRlIiwidXNlUmVmIiwidXNlQ2FsbGJhY2siLCJ1c2VBcHBTdGF0ZSIsIlN0YXRlQmFja3VwU2VydmljZSIsInVzZUF1dGgiLCJTdGF0ZUxvYWRlciIsImNoaWxkcmVuIiwiaXNTdGF0ZUxvYWRpbmciLCJpc1N0YXRlSHlkcmF0ZWQiLCJpc1N0YXRlUmVjb3ZlcmVkIiwiaXNTdGF0ZVN5bmNpbmciLCJkaXNwYXRjaCIsInVzZXIiLCJpc0F1dGhlbnRpY2F0ZWQiLCJzaG93U3luY05vdGljZSIsInNldFNob3dTeW5jTm90aWNlIiwic2hvd0h5ZHJhdGlvbk5vdGljZSIsInNldFNob3dIeWRyYXRpb25Ob3RpY2UiLCJzaG93UmVjb3ZlcnlBdHRlbXB0Iiwic2V0U2hvd1JlY292ZXJ5QXR0ZW1wdCIsImlzSW5pdGlhbE1vdW50IiwiYmFja3VwU2VydmljZSIsInJlY292ZXJ5QXR0ZW1wdE1hZGUiLCJ0aW1lciIsInNldFRpbWVvdXQiLCJjbGVhclRpbWVvdXQiLCJzZXJ2aWNlIiwiZ2V0SW5zdGFuY2UiLCJjdXJyZW50IiwiaW5pdGlhbGl6ZSIsInRoZW4iLCJzdWNjZXNzIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwic3RvcFBlcmlvZGljQmFja3VwIiwiYXR0ZW1wdFN0YXRlUmVjb3ZlcnkiLCJyZWNvdmVyZWRTdGF0ZSIsImF0dGVtcHRSZWNvdmVyeSIsInR5cGUiLCJwYXlsb2FkIiwiZGl2IiwiY2xhc3NOYW1lIiwiaDMiLCJwIiwic3ZnIiwieG1sbnMiLCJmaWxsIiwidmlld0JveCIsInN0cm9rZSIsInBhdGgiLCJzdHJva2VMaW5lY2FwIiwic3Ryb2tlTGluZWpvaW4iLCJzdHJva2VXaWR0aCIsImQiLCJzcGFuIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/StateLoader.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./context/AppStateContext.tsx":
/*!*************************************!*\
  !*** ./context/AppStateContext.tsx ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppStateProvider: () => (/* binding */ AppStateProvider),\n/* harmony export */   useAppState: () => (/* binding */ useAppState)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StatePersistence */ \"(pages-dir-node)/./utils/StatePersistence.ts\");\n/* harmony import */ var _components_AuthContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n\n\n\n\n// Initial state object\nconst initialState = {\n    timestamp: Date.now(),\n    userSession: {},\n    authSession: {},\n    // Standard chatContext from DynamicStateSnapshot\n    chatContext: {\n        currentConversationId: undefined,\n        draftMessage: '',\n        lastMessageTimestamp: 0\n    },\n    // Extended chat state\n    chatState: {\n        activeSessions: [],\n        sessions: {},\n        draftMessages: {}\n    },\n    pageState: {},\n    widgetStates: {},\n    // State metadata\n    isHydrated: false,\n    isLoading: false,\n    lastSaved: 0,\n    // Extended state\n    tradingState: {},\n    walletState: {},\n    socialState: {},\n    uiState: {\n        darkMode: true,\n        sidebarOpen: true\n    },\n    xfeed: {\n        followedAccounts: [],\n        lastUpdated: undefined\n    }\n};\n// State reducer\nfunction appStateReducer(state, action) {\n    switch(action.type){\n        case 'SET_TRADING_STATE':\n            return {\n                ...state,\n                tradingState: {\n                    ...state.tradingState,\n                    ...action.payload\n                }\n            };\n        case 'SET_WALLET_STATE':\n            return {\n                ...state,\n                walletState: {\n                    ...state.walletState,\n                    ...action.payload\n                }\n            };\n        case 'SET_CHAT_STATE':\n            return {\n                ...state,\n                chatState: {\n                    ...state.chatState,\n                    ...action.payload\n                }\n            };\n        case 'SET_SOCIAL_STATE':\n            return {\n                ...state,\n                socialState: {\n                    ...state.socialState,\n                    ...action.payload\n                }\n            };\n        case 'SET_UI_STATE':\n            return {\n                ...state,\n                uiState: {\n                    ...state.uiState,\n                    ...action.payload\n                }\n            };\n        case 'SET_PAGE_STATE':\n            return {\n                ...state,\n                pageState: {\n                    ...state.pageState,\n                    ...action.payload\n                }\n            };\n        case 'SET_WIDGET_STATES':\n            return {\n                ...state,\n                widgetStates: {\n                    ...state.widgetStates,\n                    ...action.payload\n                }\n            };\n        case 'SET_CHAT_CONTEXT':\n            return {\n                ...state,\n                chatContext: {\n                    ...state.chatContext,\n                    ...action.payload\n                }\n            };\n        case 'SET_USER_SESSION':\n            return {\n                ...state,\n                userSession: {\n                    ...state.userSession,\n                    ...action.payload\n                }\n            };\n        case 'UPDATE_AUTH':\n            const { user, token } = action.payload;\n            return {\n                ...state,\n                userSession: {\n                    ...state.userSession,\n                    token: token || '',\n                    username: user?.username || ''\n                },\n                authSession: {\n                    ...state.authSession,\n                    token: token || '',\n                    expiresAt: token ? Math.floor(Date.now() / 1000) + 24 * 60 * 60 : undefined\n                }\n            };\n        case 'UPDATE_XFEED':\n            return {\n                ...state,\n                xfeed: {\n                    ...state.xfeed,\n                    ...action.payload,\n                    lastUpdated: Date.now()\n                }\n            };\n        case 'HYDRATE_STATE':\n            return {\n                ...action.payload\n            };\n        case 'RESET_STATE':\n            return initialState;\n        // Compatibility aliases\n        case 'HYDRATE':\n            return {\n                ...action.payload\n            };\n        case 'RESET':\n            return initialState;\n        default:\n            return state;\n    }\n}\nconst AppStateContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(undefined);\nfunction AppStateProvider({ children }) {\n    const [state, dispatch] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useReducer)(appStateReducer, initialState);\n    const [isStateLoading, setIsStateLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [isStateHydrated, setIsStateHydrated] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [isStateRecovered, setIsStateRecovered] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [isStateSyncing, setIsStateSyncing] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const isUpdatingFromStorage = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    // Get auth state from AuthContext\n    const { user, isAuthenticated } = (0,_components_AuthContext__WEBPACK_IMPORTED_MODULE_3__.useAuth)();\n    // Sync auth state with AppState\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AppStateProvider.useEffect\": ()=>{\n            dispatch({\n                type: 'UPDATE_AUTH',\n                payload: {\n                    user: isAuthenticated ? user : null,\n                    token: isAuthenticated ? localStorage.getItem('authToken') : null\n                }\n            });\n        }\n    }[\"AppStateProvider.useEffect\"], [\n        user,\n        isAuthenticated\n    ]);\n    // Hydrate state from storage on initial load\n    const hydrateFromStorage = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"AppStateProvider.useCallback[hydrateFromStorage]\": async (navigate)=>{\n            try {\n                setIsStateLoading(true);\n                // Get the stored state using the synchronous retrieveSnapshot method\n                const storedState = _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_2__[\"default\"].retrieveSnapshot();\n                if (!storedState) {\n                    console.log('No stored state found');\n                    setIsStateHydrated(true);\n                    return;\n                }\n                console.log('Hydrating state from storage:', storedState);\n                // Create a clean state object with proper defaults\n                const hydratedState = {\n                    // Required fields from AppState\n                    timestamp: storedState.timestamp || Date.now(),\n                    isHydrated: true,\n                    lastSaved: 0,\n                    // Map user session\n                    userSession: {\n                        token: storedState.userSession?.token || '',\n                        username: storedState.userSession?.username || ''\n                    },\n                    // Map chat context (required by DynamicStateSnapshot)\n                    chatContext: {\n                        currentConversationId: storedState.chatContext?.currentConversationId,\n                        draftMessage: storedState.chatContext?.draftMessage || '',\n                        lastMessageTimestamp: storedState.chatContext?.lastMessageTimestamp || 0\n                    },\n                    // Map page state\n                    pageState: {\n                        lastVisitedPath: storedState.pageState?.lastVisitedPath || '/',\n                        scrollPositions: storedState.pageState?.scrollPositions || {}\n                    },\n                    // Map widget states\n                    widgetStates: {\n                        tradingPositions: storedState.widgetStates?.tradingPositions || [],\n                        walletBalance: storedState.widgetStates?.walletBalance || 0\n                    },\n                    // Map extended chat state\n                    chatState: {\n                        activeSessions: storedState.chatState?.activeSessions || [],\n                        currentSessionId: storedState.chatState?.currentSessionId,\n                        sessions: storedState.chatState?.sessions || {},\n                        draftMessages: storedState.chatState?.draftMessages || {}\n                    },\n                    // Map trading state\n                    tradingState: storedState.tradingState ? {\n                        selectedToken: storedState.tradingState.selectedToken,\n                        watchlist: storedState.tradingState.watchlist || [],\n                        tradeHistory: storedState.tradingState.tradeHistory || [],\n                        tradeForm: storedState.tradingState.tradeForm,\n                        resolution: storedState.tradingState.resolution,\n                        search: storedState.tradingState.search,\n                        positions: storedState.tradingState.positions || []\n                    } : {},\n                    // Map wallet state\n                    walletState: storedState.walletState ? {\n                        connectedWallets: storedState.walletState.connectedWallets || [],\n                        transactions: storedState.walletState.transactions || []\n                    } : {},\n                    // Map social state\n                    socialState: storedState.socialState ? {\n                        posts: storedState.socialState.posts || [],\n                        following: storedState.socialState.following || [],\n                        notifications: storedState.socialState.notifications || []\n                    } : {},\n                    // Map UI state with defaults\n                    uiState: {\n                        darkMode: storedState.uiState?.darkMode ?? true,\n                        sidebarOpen: storedState.uiState?.sidebarOpen ?? true,\n                        activeTabs: storedState.uiState?.activeTabs || {}\n                    },\n                    // Initialize xfeed with default values since it's not in DynamicStateSnapshot\n                    xfeed: {\n                        followedAccounts: [],\n                        lastUpdated: undefined\n                    }\n                };\n                // Apply the hydrated state\n                dispatch({\n                    type: 'HYDRATE_STATE',\n                    payload: hydratedState\n                });\n                // Handle navigation if needed\n                if (navigate && hydratedState.pageState?.lastVisitedPath) {\n                    navigate(hydratedState.pageState.lastVisitedPath);\n                    // Restore scroll position after a small delay\n                    if (hydratedState.pageState.scrollPositions) {\n                        setTimeout({\n                            \"AppStateProvider.useCallback[hydrateFromStorage]\": ()=>{\n                                const scrollY = hydratedState.pageState?.scrollPositions?.[hydratedState.pageState.lastVisitedPath || ''];\n                                if (typeof scrollY === 'number') {\n                                    window.scrollTo(0, scrollY);\n                                }\n                            }\n                        }[\"AppStateProvider.useCallback[hydrateFromStorage]\"], 100);\n                    }\n                }\n                // Check for active session in localStorage\n                const activeSessionId = localStorage.getItem('activeSessionId');\n                if (activeSessionId && !hydratedState.chatContext?.currentConversationId) {\n                    dispatch({\n                        type: 'SET_CHAT_CONTEXT',\n                        payload: {\n                            ...hydratedState.chatContext,\n                            currentConversationId: activeSessionId\n                        }\n                    });\n                }\n                // Mark as hydrated\n                setIsStateHydrated(true);\n            } catch (error) {\n                console.error('Error hydrating state:', error);\n                // Even if there's an error, we should mark as hydrated to prevent infinite loading\n                setIsStateHydrated(true);\n            } finally{\n                setIsStateLoading(false);\n            }\n        }\n    }[\"AppStateProvider.useCallback[hydrateFromStorage]\"], []);\n    // Initial hydration on mount\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AppStateProvider.useEffect\": ()=>{\n            // Set loading state\n            dispatch({\n                type: 'SET_UI_STATE',\n                payload: {\n                    isLoading: true\n                }\n            });\n            // Small delay to allow UI to render loading state\n            const timer = setTimeout({\n                \"AppStateProvider.useEffect.timer\": ()=>{\n                    hydrateFromStorage();\n                    dispatch({\n                        type: 'SET_UI_STATE',\n                        payload: {\n                            isLoading: false\n                        }\n                    });\n                }\n            }[\"AppStateProvider.useEffect.timer\"], 300);\n            return ({\n                \"AppStateProvider.useEffect\": ()=>clearTimeout(timer)\n            })[\"AppStateProvider.useEffect\"];\n        }\n    }[\"AppStateProvider.useEffect\"], [\n        hydrateFromStorage\n    ]);\n    // Listen for changes from other tabs\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AppStateProvider.useEffect\": ()=>{\n            const handleStorageChange = {\n                \"AppStateProvider.useEffect.handleStorageChange\": (event)=>{\n                    // Only process events for our storage key\n                    const STORAGE_KEY = 'GRACE_DYNAMIC_SNAPSHOT'; // Must match the key in StatePersistenceManager\n                    if (event.key === STORAGE_KEY) {\n                        // Prevent processing our own updates\n                        if (isUpdatingFromStorage.current) {\n                            return;\n                        }\n                        console.log('State changed in another tab, synchronizing...');\n                        try {\n                            // Update flag to prevent circular updates\n                            isUpdatingFromStorage.current = true;\n                            // Parse new state from storage\n                            const newState = event.newValue ? JSON.parse(event.newValue) : null;\n                            // Validate state before applying\n                            if (newState && typeof newState === 'object' && newState.timestamp) {\n                                // Signal that we're syncing from another tab\n                                setIsStateSyncing(true);\n                                // Only apply if the timestamp is newer\n                                if (!state.timestamp || newState.timestamp > state.timestamp) {\n                                    dispatch({\n                                        type: 'HYDRATE_STATE',\n                                        payload: newState\n                                    });\n                                    console.log('State synchronized from another tab');\n                                }\n                            }\n                            // Reset syncing state after a delay\n                            setTimeout({\n                                \"AppStateProvider.useEffect.handleStorageChange\": ()=>setIsStateSyncing(false)\n                            }[\"AppStateProvider.useEffect.handleStorageChange\"], 1000);\n                        } catch (error) {\n                            console.error('Error synchronizing state from another tab:', error);\n                        } finally{\n                            // Reset flag after a short delay\n                            setTimeout({\n                                \"AppStateProvider.useEffect.handleStorageChange\": ()=>{\n                                    isUpdatingFromStorage.current = false;\n                                }\n                            }[\"AppStateProvider.useEffect.handleStorageChange\"], 100);\n                        }\n                    }\n                }\n            }[\"AppStateProvider.useEffect.handleStorageChange\"];\n            // Add event listener for storage events\n            window.addEventListener('storage', handleStorageChange);\n            // Cleanup event listener on unmount\n            return ({\n                \"AppStateProvider.useEffect\": ()=>{\n                    window.removeEventListener('storage', handleStorageChange);\n                }\n            })[\"AppStateProvider.useEffect\"];\n        }\n    }[\"AppStateProvider.useEffect\"], [\n        state.timestamp\n    ]);\n    // Save state to storage whenever it changes with debounce to prevent race conditions\n    const debouncedSaveTimeout = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const lastSavedTimestamp = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AppStateProvider.useEffect\": ()=>{\n            // Skip initial render to avoid overwriting with empty state\n            // Only proceed if we have some meaningful state to save\n            const hasContent = Object.keys(state.tradingState || {}).length > 0 || Object.keys(state.walletState || {}).length > 0 || Object.keys(state.chatContext || {}).length > 0 || Object.keys(state.chatState?.sessions || {}).length > 0;\n            if (hasContent) {\n                // Clear any existing timeout to debounce frequent updates\n                if (debouncedSaveTimeout.current !== null) {\n                    clearTimeout(debouncedSaveTimeout.current);\n                }\n                // Debounce state saves to prevent excessive writes and race conditions\n                debouncedSaveTimeout.current = window.setTimeout({\n                    \"AppStateProvider.useEffect\": ()=>{\n                        // Only save if we're not currently processing an update from storage\n                        if (!isUpdatingFromStorage.current) {\n                            // Don't save too frequently - at most once every 2 seconds\n                            const now = Date.now();\n                            if (now - lastSavedTimestamp.current > 2000) {\n                                lastSavedTimestamp.current = now;\n                                // Ensure timestamp is updated\n                                const stateToSave = {\n                                    ...state,\n                                    timestamp: now\n                                };\n                                // Add metadata for debugging\n                                if (state.chatContext?.currentConversationId) {\n                                    console.log(`Saving state with active conversation: ${state.chatContext.currentConversationId}`);\n                                }\n                                try {\n                                    ({\n                                        \"AppStateProvider.useEffect\": async ()=>{\n                                            try {\n                                                await _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_2__[\"default\"].captureSnapshot(stateToSave);\n                                                console.log('State saved to localStorage', new Date().toISOString());\n                                                // Also ensure the activeSessionId is set in localStorage if we have a current conversation\n                                                if (state.chatContext?.currentConversationId) {\n                                                    localStorage.setItem('activeSessionId', state.chatContext.currentConversationId);\n                                                }\n                                            } catch (error) {\n                                                console.error('Error saving state to localStorage:', error);\n                                            }\n                                        }\n                                    })[\"AppStateProvider.useEffect\"]();\n                                } catch (error) {\n                                    console.error('Error in state persistence flow:', error);\n                                }\n                            }\n                        }\n                        debouncedSaveTimeout.current = null;\n                    }\n                }[\"AppStateProvider.useEffect\"], 300); // 300ms debounce time\n            }\n            // Cleanup timeout on unmount\n            return ({\n                \"AppStateProvider.useEffect\": ()=>{\n                    if (debouncedSaveTimeout.current !== null) {\n                        clearTimeout(debouncedSaveTimeout.current);\n                    }\n                }\n            })[\"AppStateProvider.useEffect\"];\n        }\n    }[\"AppStateProvider.useEffect\"], [\n        state\n    ]);\n    const contextValue = {\n        state,\n        dispatch,\n        isStateLoading,\n        isStateHydrated,\n        isStateRecovered,\n        isStateSyncing,\n        hydrateFromStorage\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AppStateContext.Provider, {\n        value: contextValue,\n        children: children\n    }, void 0, false, {\n        fileName: \"/home/ubuntu/grace-project/src/ui/context/AppStateContext.tsx\",\n        lineNumber: 548,\n        columnNumber: 5\n    }, this);\n}\n// Custom hook for using the app state\nfunction useAppState() {\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(AppStateContext);\n    if (context === undefined) {\n        throw new Error('useAppState must be used within an AppStateProvider');\n    }\n    return context;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbnRleHQvQXBwU3RhdGVDb250ZXh0LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBMEg7QUFDaEM7QUFFdEM7QUF5R3BELHVCQUF1QjtBQUN2QixNQUFNVSxlQUF5QjtJQUM3QkMsV0FBV0MsS0FBS0MsR0FBRztJQUNuQkMsYUFBYSxDQUFDO0lBQ2RDLGFBQWEsQ0FBQztJQUNkLGlEQUFpRDtJQUNqREMsYUFBYTtRQUNYQyx1QkFBdUJDO1FBQ3ZCQyxjQUFjO1FBQ2RDLHNCQUFzQjtJQUN4QjtJQUNBLHNCQUFzQjtJQUN0QkMsV0FBVztRQUNUQyxnQkFBZ0IsRUFBRTtRQUNsQkMsVUFBVSxDQUFDO1FBQ1hDLGVBQWUsQ0FBQztJQUNsQjtJQUNBQyxXQUFXLENBQUM7SUFDWkMsY0FBYyxDQUFDO0lBQ2YsaUJBQWlCO0lBQ2pCQyxZQUFZO0lBQ1pDLFdBQVc7SUFDWEMsV0FBVztJQUNYLGlCQUFpQjtJQUNqQkMsY0FBYyxDQUFDO0lBQ2ZDLGFBQWEsQ0FBQztJQUNkQyxhQUFhLENBQUM7SUFDZEMsU0FBUztRQUNQQyxVQUFVO1FBQ1ZDLGFBQWE7SUFDZjtJQUNBQyxPQUFPO1FBQ0xDLGtCQUFrQixFQUFFO1FBQ3BCQyxhQUFhcEI7SUFDZjtBQUNGO0FBb0JBLGdCQUFnQjtBQUNoQixTQUFTcUIsZ0JBQWdCQyxLQUFlLEVBQUVDLE1BQWtCO0lBQzFELE9BQVFBLE9BQU9DLElBQUk7UUFDakIsS0FBSztZQUNILE9BQU87Z0JBQUUsR0FBR0YsS0FBSztnQkFBRVYsY0FBYztvQkFBRSxHQUFHVSxNQUFNVixZQUFZO29CQUFFLEdBQUdXLE9BQU9FLE9BQU87Z0JBQUM7WUFBRTtRQUNoRixLQUFLO1lBQ0gsT0FBTztnQkFBRSxHQUFHSCxLQUFLO2dCQUFFVCxhQUFhO29CQUFFLEdBQUdTLE1BQU1ULFdBQVc7b0JBQUUsR0FBR1UsT0FBT0UsT0FBTztnQkFBQztZQUFFO1FBQzlFLEtBQUs7WUFDSCxPQUFPO2dCQUFFLEdBQUdI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QUFFLE9BQU8rRSxPQUFPO2dEQUNkMUIsUUFBUTBCLEtBQUssQ0FBQyx1Q0FBdUNBOzRDQUN2RDt3Q0FDRjs7Z0NBQ0YsRUFBRSxPQUFPQSxPQUFPO29DQUNkMUIsUUFBUTBCLEtBQUssQ0FBQyxvQ0FBb0NBO2dDQUNwRDs0QkFDRjt3QkFDRjt3QkFDQWMscUJBQXFCUCxPQUFPLEdBQUc7b0JBQ2pDO2lEQUFHLE1BQU0sc0JBQXNCO1lBQ2pDO1lBRUEsNkJBQTZCO1lBQzdCOzhDQUFPO29CQUNMLElBQUlPLHFCQUFxQlAsT0FBTyxLQUFLLE1BQU07d0JBQ3pDTCxhQUFhWSxxQkFBcUJQLE9BQU87b0JBQzNDO2dCQUNGOztRQUNGO3FDQUFHO1FBQUMvRDtLQUFNO0lBR1YsTUFBTWdGLGVBQW9DO1FBQ3hDaEY7UUFDQWE7UUFDQUM7UUFDQUU7UUFDQUU7UUFDQUU7UUFDQU07SUFDRjtJQUVBLHFCQUNFLDhEQUFDaEIsZ0JBQWdCdUUsUUFBUTtRQUFDQyxPQUFPRjtrQkFDOUJwRTs7Ozs7O0FBR1A7QUFFQSxzQ0FBc0M7QUFDL0IsU0FBU3VFO0lBQ2QsTUFBTUMsVUFBVTFILGlEQUFVQSxDQUFDZ0Q7SUFDM0IsSUFBSTBFLFlBQVkxRyxXQUFXO1FBQ3pCLE1BQU0sSUFBSTJHLE1BQU07SUFDbEI7SUFDQSxPQUFPRDtBQUNUIiwic291cmNlcyI6WyIvaG9tZS91YnVudHUvZ3JhY2UtcHJvamVjdC9zcmMvdWkvY29udGV4dC9BcHBTdGF0ZUNvbnRleHQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0LCB1c2VSZWR1Y2VyLCB1c2VFZmZlY3QsIHVzZVJlZiwgdXNlU3RhdGUsIFJlYWN0Tm9kZSwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXIsIHsgRHluYW1pY1N0YXRlU25hcHNob3QgfSBmcm9tICcuLi91dGlscy9TdGF0ZVBlcnNpc3RlbmNlJztcbmltcG9ydCB7IE5hdmlnYXRlRnVuY3Rpb24gfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuLi9jb21wb25lbnRzL0F1dGhDb250ZXh0JztcblxuLy8gRXh0ZW5kIHRoZSBEeW5hbWljU3RhdGVTbmFwc2hvdCBpbnRlcmZhY2UgdG8gaW5jbHVkZSBvdXIgYWRkaXRpb25hbCBhcHAgc3RhdGVcbi8vIE91ciBleHRlbmRlZCBhcHAgc3RhdGUgaW50ZXJmYWNlIHRoYXQgbWFpbnRhaW5zIGNvbXBhdGliaWxpdHkgd2l0aCBEeW5hbWljU3RhdGVTbmFwc2hvdFxuZXhwb3J0IGludGVyZmFjZSBBcHBTdGF0ZSB7XG4gIC8vIEZyb20gRHluYW1pY1N0YXRlU25hcHNob3QgYmFzZVxuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgdXNlclNlc3Npb246IHtcbiAgICB0b2tlbj86IHN0cmluZztcbiAgICB1c2VybmFtZT86IHN0cmluZztcbiAgfTtcbiAgcGFnZVN0YXRlOiB7XG4gICAgbGFzdFZpc2l0ZWRQYXRoPzogc3RyaW5nO1xuICAgIHNjcm9sbFBvc2l0aW9ucz86IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIH07XG4gIHdpZGdldFN0YXRlczoge1xuICAgIHRyYWRpbmdQb3NpdGlvbnM/OiBhbnlbXTtcbiAgICB3YWxsZXRCYWxhbmNlPzogbnVtYmVyO1xuICB9O1xuICBcbiAgLy8gQ29yZSBEeW5hbWljU3RhdGVTbmFwc2hvdCBjaGF0Q29udGV4dCAtIHdlIG11c3QgbWFpbnRhaW4gdGhpcyBleGFjdCBzdHJ1Y3R1cmVcbiAgY2hhdENvbnRleHQ6IHtcbiAgICBjdXJyZW50Q29udmVyc2F0aW9uSWQ/OiBzdHJpbmc7XG4gICAgZHJhZnRNZXNzYWdlPzogc3RyaW5nO1xuICAgIGxhc3RNZXNzYWdlVGltZXN0YW1wPzogbnVtYmVyO1xuICB9O1xuICBcbiAgLy8gQXBwbGljYXRpb24gc3RhdGUgbWV0YWRhdGFcbiAgaXNIeWRyYXRlZD86IGJvb2xlYW47XG4gIGlzTG9hZGluZz86IGJvb2xlYW47XG4gIGxhc3RTYXZlZD86IG51bWJlcjtcbiAgXG4gIC8vIEF1dGggYW5kIHVzZXIgc2Vzc2lvbiBzdGF0ZSAtIGFsaWducyB3aXRoIEF1dGhDb250ZXh0XG4gIGF1dGhTZXNzaW9uPzoge1xuICAgIHRva2VuPzogc3RyaW5nO1xuICAgIGV4cGlyZXNBdD86IG51bWJlcjtcbiAgICByZWZyZXNoVG9rZW4/OiBzdHJpbmc7XG4gIH07XG4gIFxuICAvLyBUcmFkaW5nIHN0YXRlIGV4dGVuc2lvbnNcbiAgdHJhZGluZ1N0YXRlPzoge1xuICAgIHNlbGVjdGVkVG9rZW4/OiBhbnk7XG4gICAgd2F0Y2hsaXN0Pzogc3RyaW5nW107XG4gICAgdHJhZGVIaXN0b3J5PzogYW55W107XG4gICAgdHJhZGVGb3JtPzogYW55O1xuICAgIHJlc29sdXRpb24/OiBzdHJpbmc7XG4gICAgc2VhcmNoPzogc3RyaW5nO1xuICAgIHBvc2l0aW9ucz86IGFueVtdO1xuICB9O1xuICBcbiAgLy8gU29jaWFsIG1lZGlhIGZlZWQgc2V0dGluZ3NcbiAgeGZlZWQ/OiB7XG4gICAgZm9sbG93ZWRBY2NvdW50czogc3RyaW5nW107XG4gICAgbGFzdFVwZGF0ZWQ/OiBudW1iZXI7XG4gIH07XG4gIFxuICAvLyBXYWxsZXQgc3RhdGUgZXh0ZW5zaW9uc1xuICB3YWxsZXRTdGF0ZT86IHtcbiAgICBjb25uZWN0ZWRXYWxsZXRzPzogYW55W107XG4gICAgdHJhbnNhY3Rpb25zPzogYW55W107XG4gIH07XG4gIFxuICAvLyBFeHRlbmRlZCBjaGF0IHN0YXRlIC0gc2VwYXJhdGUgZnJvbSB0aGUgYmFzZSBjaGF0Q29udGV4dCB0byBhdm9pZCB0eXBlIGNvbmZsaWN0c1xuICAvLyBXaWxsIGJlIHN5bmNlZCB3aXRoIHRoZSBtYWluIGNoYXRDb250ZXh0IGFzIG5lZWRlZFxuICBjaGF0U3RhdGU/OiB7XG4gICAgYWN0aXZlU2Vzc2lvbnM/OiBzdHJpbmdbXTtcbiAgICBjdXJyZW50U2Vzc2lvbklkPzogc3RyaW5nO1xuICAgIHNlc3Npb25zPzoge1xuICAgICAgW3Nlc3Npb25JZDogc3RyaW5nXToge1xuICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICB0b3BpYz86IHN0cmluZztcbiAgICAgICAgbmFtZT86IHN0cmluZztcbiAgICAgICAgY3JlYXRlZF9hdD86IHN0cmluZztcbiAgICAgICAgdXBkYXRlZF9hdD86IHN0cmluZztcbiAgICAgICAgcHJldmlld19tZXNzYWdlPzogc3RyaW5nO1xuICAgICAgICBtZXNzYWdlcz86IEFycmF5PHtcbiAgICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICAgICAgICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nO1xuICAgICAgICAgIHRpbWVzdGFtcDogc3RyaW5nO1xuICAgICAgICB9PjtcbiAgICAgICAgdW5yZWFkX2NvdW50PzogbnVtYmVyO1xuICAgICAgICBzY3JvbGxQb3NpdGlvbj86IG51bWJlcjtcbiAgICAgIH07XG4gICAgfTtcbiAgICBkcmFmdE1lc3NhZ2VzPzoge1xuICAgICAgW3Nlc3Npb25JZDogc3RyaW5nXTogc3RyaW5nO1xuICAgIH07XG4gIH07XG4gIFxuICAvLyBTb2NpYWwgc3RhdGVcbiAgc29jaWFsU3RhdGU/OiB7XG4gICAgcG9zdHM/OiBhbnlbXTtcbiAgICBmb2xsb3dpbmc/OiBzdHJpbmdbXTtcbiAgICBub3RpZmljYXRpb25zPzogYW55W107XG4gIH07XG4gIFxuICAvLyBVSSBzdGF0ZVxuICB1aVN0YXRlPzoge1xuICAgIGRhcmtNb2RlPzogYm9vbGVhbjtcbiAgICBzaWRlYmFyT3Blbj86IGJvb2xlYW47XG4gICAgYWN0aXZlVGFicz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIH07XG59XG5cbi8vIEluaXRpYWwgc3RhdGUgb2JqZWN0XG5jb25zdCBpbml0aWFsU3RhdGU6IEFwcFN0YXRlID0ge1xuICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gIHVzZXJTZXNzaW9uOiB7fSxcbiAgYXV0aFNlc3Npb246IHt9LFxuICAvLyBTdGFuZGFyZCBjaGF0Q29udGV4dCBmcm9tIER5bmFtaWNTdGF0ZVNuYXBzaG90XG4gIGNoYXRDb250ZXh0OiB7XG4gICAgY3VycmVudENvbnZlcnNhdGlvbklkOiB1bmRlZmluZWQsXG4gICAgZHJhZnRNZXNzYWdlOiAnJyxcbiAgICBsYXN0TWVzc2FnZVRpbWVzdGFtcDogMFxuICB9LFxuICAvLyBFeHRlbmRlZCBjaGF0IHN0YXRlXG4gIGNoYXRTdGF0ZToge1xuICAgIGFjdGl2ZVNlc3Npb25zOiBbXSxcbiAgICBzZXNzaW9uczoge30sXG4gICAgZHJhZnRNZXNzYWdlczoge31cbiAgfSxcbiAgcGFnZVN0YXRlOiB7fSxcbiAgd2lkZ2V0U3RhdGVzOiB7fSxcbiAgLy8gU3RhdGUgbWV0YWRhdGFcbiAgaXNIeWRyYXRlZDogZmFsc2UsXG4gIGlzTG9hZGluZzogZmFsc2UsXG4gIGxhc3RTYXZlZDogMCxcbiAgLy8gRXh0ZW5kZWQgc3RhdGVcbiAgdHJhZGluZ1N0YXRlOiB7fSxcbiAgd2FsbGV0U3RhdGU6IHt9LFxuICBzb2NpYWxTdGF0ZToge30sXG4gIHVpU3RhdGU6IHtcbiAgICBkYXJrTW9kZTogdHJ1ZSxcbiAgICBzaWRlYmFyT3BlbjogdHJ1ZSxcbiAgfSxcbiAgeGZlZWQ6IHtcbiAgICBmb2xsb3dlZEFjY291bnRzOiBbXSxcbiAgICBsYXN0VXBkYXRlZDogdW5kZWZpbmVkXG4gIH1cbn07XG5cbi8vIEFjdGlvbiB0eXBlc1xudHlwZSBBY3Rpb25UeXBlID1cbiAgfCB7IHR5cGU6ICdTRVRfVFJBRElOR19TVEFURSc7IHBheWxvYWQ6IGFueSB9XG4gIHwgeyB0eXBlOiAnU0VUX1dBTExFVF9TVEFURSc7IHBheWxvYWQ6IGFueSB9XG4gIHwgeyB0eXBlOiAnU0VUX0NIQVRfQ09OVEVYVCc7IHBheWxvYWQ6IGFueSB9XG4gIHwgeyB0eXBlOiAnU0VUX0NIQVRfU1RBVEUnOyBwYXlsb2FkOiBhbnkgfVxuICB8IHsgdHlwZTogJ1NFVF9TT0NJQUxfU1RBVEUnOyBwYXlsb2FkOiBhbnkgfVxuICB8IHsgdHlwZTogJ1NFVF9VSV9TVEFURSc7IHBheWxvYWQ6IGFueSB9XG4gIHwgeyB0eXBlOiAnU0VUX1BBR0VfU1RBVEUnOyBwYXlsb2FkOiBhbnkgfVxuICB8IHsgdHlwZTogJ1NFVF9XSURHRVRfU1RBVEVTJzsgcGF5bG9hZDogYW55IH1cbiAgfCB7IHR5cGU6ICdTRVRfVVNFUl9TRVNTSU9OJzsgcGF5bG9hZDogYW55IH1cbiAgfCB7IHR5cGU6ICdVUERBVEVfWEZFRUQnOyBwYXlsb2FkOiBhbnkgfVxuICB8IHsgdHlwZTogJ0hZRFJBVEVfU1RBVEUnOyBwYXlsb2FkOiBBcHBTdGF0ZSB9XG4gIHwgeyB0eXBlOiAnUkVTRVRfU1RBVEUnIH1cbiAgfCB7IHR5cGU6ICdIWURSQVRFJzsgcGF5bG9hZDogQXBwU3RhdGUgfVxuICB8IHsgdHlwZTogJ1JFU0VUJyB9XG4gIHwgeyB0eXBlOiAnVVBEQVRFX0FVVEgnOyBwYXlsb2FkOiB7IHVzZXI6IGFueTsgdG9rZW46IHN0cmluZyB8IG51bGwgfSB9O1xuXG4vLyBTdGF0ZSByZWR1Y2VyXG5mdW5jdGlvbiBhcHBTdGF0ZVJlZHVjZXIoc3RhdGU6IEFwcFN0YXRlLCBhY3Rpb246IEFjdGlvblR5cGUpOiBBcHBTdGF0ZSB7XG4gIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICBjYXNlICdTRVRfVFJBRElOR19TVEFURSc6XG4gICAgICByZXR1cm4geyAuLi5zdGF0ZSwgdHJhZGluZ1N0YXRlOiB7IC4uLnN0YXRlLnRyYWRpbmdTdGF0ZSwgLi4uYWN0aW9uLnBheWxvYWQgfSB9O1xuICAgIGNhc2UgJ1NFVF9XQUxMRVRfU1RBVEUnOlxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIHdhbGxldFN0YXRlOiB7IC4uLnN0YXRlLndhbGxldFN0YXRlLCAuLi5hY3Rpb24ucGF5bG9hZCB9IH07XG4gICAgY2FzZSAnU0VUX0NIQVRfU1RBVEUnOlxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIGNoYXRTdGF0ZTogeyAuLi5zdGF0ZS5jaGF0U3RhdGUsIC4uLmFjdGlvbi5wYXlsb2FkIH0gfTtcbiAgICBjYXNlICdTRVRfU09DSUFMX1NUQVRFJzpcbiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCBzb2NpYWxTdGF0ZTogeyAuLi5zdGF0ZS5zb2NpYWxTdGF0ZSwgLi4uYWN0aW9uLnBheWxvYWQgfSB9O1xuICAgIGNhc2UgJ1NFVF9VSV9TVEFURSc6XG4gICAgICByZXR1cm4geyAuLi5zdGF0ZSwgdWlTdGF0ZTogeyAuLi5zdGF0ZS51aVN0YXRlLCAuLi5hY3Rpb24ucGF5bG9hZCB9IH07XG4gICAgY2FzZSAnU0VUX1BBR0VfU1RBVEUnOlxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIHBhZ2VTdGF0ZTogeyAuLi5zdGF0ZS5wYWdlU3RhdGUsIC4uLmFjdGlvbi5wYXlsb2FkIH0gfTtcbiAgICBjYXNlICdTRVRfV0lER0VUX1NUQVRFUyc6XG4gICAgICByZXR1cm4geyAuLi5zdGF0ZSwgd2lkZ2V0U3RhdGVzOiB7IC4uLnN0YXRlLndpZGdldFN0YXRlcywgLi4uYWN0aW9uLnBheWxvYWQgfSB9O1xuICAgIGNhc2UgJ1NFVF9DSEFUX0NPTlRFWFQnOlxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIGNoYXRDb250ZXh0OiB7IC4uLnN0YXRlLmNoYXRDb250ZXh0LCAuLi5hY3Rpb24ucGF5bG9hZCB9IH07XG4gICAgY2FzZSAnU0VUX1VTRVJfU0VTU0lPTic6XG4gICAgICByZXR1cm4geyAuLi5zdGF0ZSwgdXNlclNlc3Npb246IHsgLi4uc3RhdGUudXNlclNlc3Npb24sIC4uLmFjdGlvbi5wYXlsb2FkIH0gfTtcbiAgICBjYXNlICdVUERBVEVfQVVUSCc6XG4gICAgICBjb25zdCB7IHVzZXIsIHRva2VuIH0gPSBhY3Rpb24ucGF5bG9hZDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICB1c2VyU2Vzc2lvbjoge1xuICAgICAgICAgIC4uLnN0YXRlLnVzZXJTZXNzaW9uLFxuICAgICAgICAgIHRva2VuOiB0b2tlbiB8fCAnJyxcbiAgICAgICAgICB1c2VybmFtZTogdXNlcj8udXNlcm5hbWUgfHwgJydcbiAgICAgICAgfSxcbiAgICAgICAgYXV0aFNlc3Npb246IHtcbiAgICAgICAgICAuLi5zdGF0ZS5hdXRoU2Vzc2lvbixcbiAgICAgICAgICB0b2tlbjogdG9rZW4gfHwgJycsXG4gICAgICAgICAgZXhwaXJlc0F0OiB0b2tlbiA/IE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApICsgKDI0ICogNjAgKiA2MCkgOiB1bmRlZmluZWRcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICBjYXNlICdVUERBVEVfWEZFRUQnOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIHhmZWVkOiB7XG4gICAgICAgICAgLi4uc3RhdGUueGZlZWQsXG4gICAgICAgICAgLi4uYWN0aW9uLnBheWxvYWQsXG4gICAgICAgICAgbGFzdFVwZGF0ZWQ6IERhdGUubm93KClcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICBjYXNlICdIWURSQVRFX1NUQVRFJzpcbiAgICAgIHJldHVybiB7IC4uLmFjdGlvbi5wYXlsb2FkIH07XG4gICAgY2FzZSAnUkVTRVRfU1RBVEUnOlxuICAgICAgcmV0dXJuIGluaXRpYWxTdGF0ZTtcbiAgICAvLyBDb21wYXRpYmlsaXR5IGFsaWFzZXNcbiAgICBjYXNlICdIWURSQVRFJzpcbiAgICAgIHJldHVybiB7IC4uLmFjdGlvbi5wYXlsb2FkIH07XG4gICAgY2FzZSAnUkVTRVQnOlxuICAgICAgcmV0dXJuIGluaXRpYWxTdGF0ZTtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHN0YXRlO1xuICB9XG59XG5cbi8vIENyZWF0ZSBjb250ZXh0XG5pbnRlcmZhY2UgQXBwU3RhdGVDb250ZXh0VHlwZSB7XG4gIHN0YXRlOiBBcHBTdGF0ZTtcbiAgZGlzcGF0Y2g6IFJlYWN0LkRpc3BhdGNoPEFjdGlvblR5cGU+O1xuICBpc1N0YXRlTG9hZGluZzogYm9vbGVhbjtcbiAgaXNTdGF0ZUh5ZHJhdGVkOiBib29sZWFuO1xuICBpc1N0YXRlUmVjb3ZlcmVkOiBib29sZWFuO1xuICBpc1N0YXRlU3luY2luZzogYm9vbGVhbjtcbiAgaHlkcmF0ZUZyb21TdG9yYWdlOiAobmF2aWdhdGU/OiBOYXZpZ2F0ZUZ1bmN0aW9uKSA9PiBQcm9taXNlPHZvaWQ+O1xufVxuXG5jb25zdCBBcHBTdGF0ZUNvbnRleHQgPSBjcmVhdGVDb250ZXh0PEFwcFN0YXRlQ29udGV4dFR5cGUgfCB1bmRlZmluZWQ+KHVuZGVmaW5lZCk7XG5cbi8vIFByb3ZpZGVyIGNvbXBvbmVudFxuaW50ZXJmYWNlIEFwcFN0YXRlUHJvdmlkZXJQcm9wcyB7XG4gIGNoaWxkcmVuOiBSZWFjdE5vZGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBBcHBTdGF0ZVByb3ZpZGVyKHsgY2hpbGRyZW4gfTogQXBwU3RhdGVQcm92aWRlclByb3BzKSB7XG4gIGNvbnN0IFtzdGF0ZSwgZGlzcGF0Y2hdID0gdXNlUmVkdWNlcihhcHBTdGF0ZVJlZHVjZXIsIGluaXRpYWxTdGF0ZSk7XG4gIGNvbnN0IFtpc1N0YXRlTG9hZGluZywgc2V0SXNTdGF0ZUxvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XG4gIGNvbnN0IFtpc1N0YXRlSHlkcmF0ZWQsIHNldElzU3RhdGVIeWRyYXRlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtpc1N0YXRlUmVjb3ZlcmVkLCBzZXRJc1N0YXRlUmVjb3ZlcmVkXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2lzU3RhdGVTeW5jaW5nLCBzZXRJc1N0YXRlU3luY2luZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGlzVXBkYXRpbmdGcm9tU3RvcmFnZSA9IHVzZVJlZihmYWxzZSk7XG4gIFxuICAvLyBHZXQgYXV0aCBzdGF0ZSBmcm9tIEF1dGhDb250ZXh0XG4gIGNvbnN0IHsgdXNlciwgaXNBdXRoZW50aWNhdGVkIH0gPSB1c2VBdXRoKCk7XG5cbiAgLy8gU3luYyBhdXRoIHN0YXRlIHdpdGggQXBwU3RhdGVcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiAnVVBEQVRFX0FVVEgnLFxuICAgICAgcGF5bG9hZDoge1xuICAgICAgICB1c2VyOiBpc0F1dGhlbnRpY2F0ZWQgPyB1c2VyIDogbnVsbCxcbiAgICAgICAgdG9rZW46IGlzQXV0aGVudGljYXRlZCA/IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhdXRoVG9rZW4nKSA6IG51bGxcbiAgICAgIH1cbiAgICB9KTtcbiAgfSwgW3VzZXIsIGlzQXV0aGVudGljYXRlZF0pO1xuXG4gIC8vIEh5ZHJhdGUgc3RhdGUgZnJvbSBzdG9yYWdlIG9uIGluaXRpYWwgbG9hZFxuICBjb25zdCBoeWRyYXRlRnJvbVN0b3JhZ2UgPSB1c2VDYWxsYmFjayhhc3luYyAobmF2aWdhdGU/OiBOYXZpZ2F0ZUZ1bmN0aW9uKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIHNldElzU3RhdGVMb2FkaW5nKHRydWUpO1xuICAgICAgXG4gICAgICAvLyBHZXQgdGhlIHN0b3JlZCBzdGF0ZSB1c2luZyB0aGUgc3luY2hyb25vdXMgcmV0cmlldmVTbmFwc2hvdCBtZXRob2RcbiAgICAgIGNvbnN0IHN0b3JlZFN0YXRlID0gU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXIucmV0cmlldmVTbmFwc2hvdCgpO1xuICAgICAgXG4gICAgICBpZiAoIXN0b3JlZFN0YXRlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdObyBzdG9yZWQgc3RhdGUgZm91bmQnKTtcbiAgICAgICAgc2V0SXNTdGF0ZUh5ZHJhdGVkKHRydWUpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdIeWRyYXRpbmcgc3RhdGUgZnJvbSBzdG9yYWdlOicsIHN0b3JlZFN0YXRlKTtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIGEgY2xlYW4gc3RhdGUgb2JqZWN0IHdpdGggcHJvcGVyIGRlZmF1bHRzXG4gICAgICBjb25zdCBoeWRyYXRlZFN0YXRlOiBBcHBTdGF0ZSA9IHtcbiAgICAgICAgLy8gUmVxdWlyZWQgZmllbGRzIGZyb20gQXBwU3RhdGVcbiAgICAgICAgdGltZXN0YW1wOiBzdG9yZWRTdGF0ZS50aW1lc3RhbXAgfHwgRGF0ZS5ub3coKSxcbiAgICAgICAgaXNIeWRyYXRlZDogdHJ1ZSxcbiAgICAgICAgbGFzdFNhdmVkOiAwLCAvLyBXaWxsIGJlIHVwZGF0ZWQgb24gbmV4dCBzYXZlXG4gICAgICAgIFxuICAgICAgICAvLyBNYXAgdXNlciBzZXNzaW9uXG4gICAgICAgIHVzZXJTZXNzaW9uOiB7XG4gICAgICAgICAgdG9rZW46IHN0b3JlZFN0YXRlLnVzZXJTZXNzaW9uPy50b2tlbiB8fCAnJyxcbiAgICAgICAgICB1c2VybmFtZTogc3RvcmVkU3RhdGUudXNlclNlc3Npb24/LnVzZXJuYW1lIHx8ICcnXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBNYXAgY2hhdCBjb250ZXh0IChyZXF1aXJlZCBieSBEeW5hbWljU3RhdGVTbmFwc2hvdClcbiAgICAgICAgY2hhdENvbnRleHQ6IHtcbiAgICAgICAgICBjdXJyZW50Q29udmVyc2F0aW9uSWQ6IHN0b3JlZFN0YXRlLmNoYXRDb250ZXh0Py5jdXJyZW50Q29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgZHJhZnRNZXNzYWdlOiBzdG9yZWRTdGF0ZS5jaGF0Q29udGV4dD8uZHJhZnRNZXNzYWdlIHx8ICcnLFxuICAgICAgICAgIGxhc3RNZXNzYWdlVGltZXN0YW1wOiBzdG9yZWRTdGF0ZS5jaGF0Q29udGV4dD8ubGFzdE1lc3NhZ2VUaW1lc3RhbXAgfHwgMFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy8gTWFwIHBhZ2Ugc3RhdGVcbiAgICAgICAgcGFnZVN0YXRlOiB7XG4gICAgICAgICAgbGFzdFZpc2l0ZWRQYXRoOiBzdG9yZWRTdGF0ZS5wYWdlU3RhdGU/Lmxhc3RWaXNpdGVkUGF0aCB8fCAnLycsXG4gICAgICAgICAgc2Nyb2xsUG9zaXRpb25zOiBzdG9yZWRTdGF0ZS5wYWdlU3RhdGU/LnNjcm9sbFBvc2l0aW9ucyB8fCB7fVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy8gTWFwIHdpZGdldCBzdGF0ZXNcbiAgICAgICAgd2lkZ2V0U3RhdGVzOiB7XG4gICAgICAgICAgdHJhZGluZ1Bvc2l0aW9uczogc3RvcmVkU3RhdGUud2lkZ2V0U3RhdGVzPy50cmFkaW5nUG9zaXRpb25zIHx8IFtdLFxuICAgICAgICAgIHdhbGxldEJhbGFuY2U6IHN0b3JlZFN0YXRlLndpZGdldFN0YXRlcz8ud2FsbGV0QmFsYW5jZSB8fCAwXG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBNYXAgZXh0ZW5kZWQgY2hhdCBzdGF0ZVxuICAgICAgICBjaGF0U3RhdGU6IHtcbiAgICAgICAgICBhY3RpdmVTZXNzaW9uczogc3RvcmVkU3RhdGUuY2hhdFN0YXRlPy5hY3RpdmVTZXNzaW9ucyB8fCBbXSxcbiAgICAgICAgICBjdXJyZW50U2Vzc2lvbklkOiBzdG9yZWRTdGF0ZS5jaGF0U3RhdGU/LmN1cnJlbnRTZXNzaW9uSWQsXG4gICAgICAgICAgc2Vzc2lvbnM6IHN0b3JlZFN0YXRlLmNoYXRTdGF0ZT8uc2Vzc2lvbnMgfHwge30sXG4gICAgICAgICAgZHJhZnRNZXNzYWdlczogc3RvcmVkU3RhdGUuY2hhdFN0YXRlPy5kcmFmdE1lc3NhZ2VzIHx8IHt9XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBNYXAgdHJhZGluZyBzdGF0ZVxuICAgICAgICB0cmFkaW5nU3RhdGU6IHN0b3JlZFN0YXRlLnRyYWRpbmdTdGF0ZSA/IHtcbiAgICAgICAgICBzZWxlY3RlZFRva2VuOiBzdG9yZWRTdGF0ZS50cmFkaW5nU3RhdGUuc2VsZWN0ZWRUb2tlbixcbiAgICAgICAgICB3YXRjaGxpc3Q6IHN0b3JlZFN0YXRlLnRyYWRpbmdTdGF0ZS53YXRjaGxpc3QgfHwgW10sXG4gICAgICAgICAgdHJhZGVIaXN0b3J5OiBzdG9yZWRTdGF0ZS50cmFkaW5nU3RhdGUudHJhZGVIaXN0b3J5IHx8IFtdLFxuICAgICAgICAgIHRyYWRlRm9ybTogc3RvcmVkU3RhdGUudHJhZGluZ1N0YXRlLnRyYWRlRm9ybSxcbiAgICAgICAgICByZXNvbHV0aW9uOiBzdG9yZWRTdGF0ZS50cmFkaW5nU3RhdGUucmVzb2x1dGlvbixcbiAgICAgICAgICBzZWFyY2g6IHN0b3JlZFN0YXRlLnRyYWRpbmdTdGF0ZS5zZWFyY2gsXG4gICAgICAgICAgcG9zaXRpb25zOiBzdG9yZWRTdGF0ZS50cmFkaW5nU3RhdGUucG9zaXRpb25zIHx8IFtdXG4gICAgICAgIH0gOiB7fSxcbiAgICAgICAgXG4gICAgICAgIC8vIE1hcCB3YWxsZXQgc3RhdGVcbiAgICAgICAgd2FsbGV0U3RhdGU6IHN0b3JlZFN0YXRlLndhbGxldFN0YXRlID8ge1xuICAgICAgICAgIGNvbm5lY3RlZFdhbGxldHM6IHN0b3JlZFN0YXRlLndhbGxldFN0YXRlLmNvbm5lY3RlZFdhbGxldHMgfHwgW10sXG4gICAgICAgICAgdHJhbnNhY3Rpb25zOiBzdG9yZWRTdGF0ZS53YWxsZXRTdGF0ZS50cmFuc2FjdGlvbnMgfHwgW11cbiAgICAgICAgfSA6IHt9LFxuICAgICAgICBcbiAgICAgICAgLy8gTWFwIHNvY2lhbCBzdGF0ZVxuICAgICAgICBzb2NpYWxTdGF0ZTogc3RvcmVkU3RhdGUuc29jaWFsU3RhdGUgPyB7XG4gICAgICAgICAgcG9zdHM6IHN0b3JlZFN0YXRlLnNvY2lhbFN0YXRlLnBvc3RzIHx8IFtdLFxuICAgICAgICAgIGZvbGxvd2luZzogc3RvcmVkU3RhdGUuc29jaWFsU3RhdGUuZm9sbG93aW5nIHx8IFtdLFxuICAgICAgICAgIG5vdGlmaWNhdGlvbnM6IHN0b3JlZFN0YXRlLnNvY2lhbFN0YXRlLm5vdGlmaWNhdGlvbnMgfHwgW11cbiAgICAgICAgfSA6IHt9LFxuICAgICAgICBcbiAgICAgICAgLy8gTWFwIFVJIHN0YXRlIHdpdGggZGVmYXVsdHNcbiAgICAgICAgdWlTdGF0ZToge1xuICAgICAgICAgIGRhcmtNb2RlOiBzdG9yZWRTdGF0ZS51aVN0YXRlPy5kYXJrTW9kZSA/PyB0cnVlLFxuICAgICAgICAgIHNpZGViYXJPcGVuOiBzdG9yZWRTdGF0ZS51aVN0YXRlPy5zaWRlYmFyT3BlbiA/PyB0cnVlLFxuICAgICAgICAgIGFjdGl2ZVRhYnM6IHN0b3JlZFN0YXRlLnVpU3RhdGU/LmFjdGl2ZVRhYnMgfHwge31cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vIEluaXRpYWxpemUgeGZlZWQgd2l0aCBkZWZhdWx0IHZhbHVlcyBzaW5jZSBpdCdzIG5vdCBpbiBEeW5hbWljU3RhdGVTbmFwc2hvdFxuICAgICAgICB4ZmVlZDoge1xuICAgICAgICAgIGZvbGxvd2VkQWNjb3VudHM6IFtdLFxuICAgICAgICAgIGxhc3RVcGRhdGVkOiB1bmRlZmluZWRcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIFxuICAgICAgLy8gQXBwbHkgdGhlIGh5ZHJhdGVkIHN0YXRlXG4gICAgICBkaXNwYXRjaCh7IHR5cGU6ICdIWURSQVRFX1NUQVRFJywgcGF5bG9hZDogaHlkcmF0ZWRTdGF0ZSB9KTtcbiAgICAgIFxuICAgICAgLy8gSGFuZGxlIG5hdmlnYXRpb24gaWYgbmVlZGVkXG4gICAgICBpZiAobmF2aWdhdGUgJiYgaHlkcmF0ZWRTdGF0ZS5wYWdlU3RhdGU/Lmxhc3RWaXNpdGVkUGF0aCkge1xuICAgICAgICBuYXZpZ2F0ZShoeWRyYXRlZFN0YXRlLnBhZ2VTdGF0ZS5sYXN0VmlzaXRlZFBhdGgpO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVzdG9yZSBzY3JvbGwgcG9zaXRpb24gYWZ0ZXIgYSBzbWFsbCBkZWxheVxuICAgICAgICBpZiAoaHlkcmF0ZWRTdGF0ZS5wYWdlU3RhdGUuc2Nyb2xsUG9zaXRpb25zKSB7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzY3JvbGxZID0gaHlkcmF0ZWRTdGF0ZS5wYWdlU3RhdGU/LnNjcm9sbFBvc2l0aW9ucz8uW2h5ZHJhdGVkU3RhdGUucGFnZVN0YXRlLmxhc3RWaXNpdGVkUGF0aCB8fCAnJ107XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNjcm9sbFkgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCBzY3JvbGxZKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCAxMDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENoZWNrIGZvciBhY3RpdmUgc2Vzc2lvbiBpbiBsb2NhbFN0b3JhZ2VcbiAgICAgIGNvbnN0IGFjdGl2ZVNlc3Npb25JZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY3RpdmVTZXNzaW9uSWQnKTtcbiAgICAgIGlmIChhY3RpdmVTZXNzaW9uSWQgJiYgIWh5ZHJhdGVkU3RhdGUuY2hhdENvbnRleHQ/LmN1cnJlbnRDb252ZXJzYXRpb25JZCkge1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogJ1NFVF9DSEFUX0NPTlRFWFQnLFxuICAgICAgICAgIHBheWxvYWQ6IHtcbiAgICAgICAgICAgIC4uLmh5ZHJhdGVkU3RhdGUuY2hhdENvbnRleHQsXG4gICAgICAgICAgICBjdXJyZW50Q29udmVyc2F0aW9uSWQ6IGFjdGl2ZVNlc3Npb25JZFxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIE1hcmsgYXMgaHlkcmF0ZWRcbiAgICAgIHNldElzU3RhdGVIeWRyYXRlZCh0cnVlKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaHlkcmF0aW5nIHN0YXRlOicsIGVycm9yKTtcbiAgICAgIC8vIEV2ZW4gaWYgdGhlcmUncyBhbiBlcnJvciwgd2Ugc2hvdWxkIG1hcmsgYXMgaHlkcmF0ZWQgdG8gcHJldmVudCBpbmZpbml0ZSBsb2FkaW5nXG4gICAgICBzZXRJc1N0YXRlSHlkcmF0ZWQodHJ1ZSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzU3RhdGVMb2FkaW5nKGZhbHNlKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICAvLyBJbml0aWFsIGh5ZHJhdGlvbiBvbiBtb3VudFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFNldCBsb2FkaW5nIHN0YXRlXG4gICAgZGlzcGF0Y2goeyB0eXBlOiAnU0VUX1VJX1NUQVRFJywgcGF5bG9hZDogeyBpc0xvYWRpbmc6IHRydWUgfSB9KTtcbiAgICBcbiAgICAvLyBTbWFsbCBkZWxheSB0byBhbGxvdyBVSSB0byByZW5kZXIgbG9hZGluZyBzdGF0ZVxuICAgIGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBoeWRyYXRlRnJvbVN0b3JhZ2UoKTtcbiAgICAgIGRpc3BhdGNoKHsgdHlwZTogJ1NFVF9VSV9TVEFURScsIHBheWxvYWQ6IHsgaXNMb2FkaW5nOiBmYWxzZSB9IH0pO1xuICAgIH0sIDMwMCk7XG4gICAgXG4gICAgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0aW1lcik7XG4gIH0sIFtoeWRyYXRlRnJvbVN0b3JhZ2VdKTtcbiAgXG4gIC8vIExpc3RlbiBmb3IgY2hhbmdlcyBmcm9tIG90aGVyIHRhYnNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVTdG9yYWdlQ2hhbmdlID0gKGV2ZW50OiBTdG9yYWdlRXZlbnQpID0+IHtcbiAgICAgIC8vIE9ubHkgcHJvY2VzcyBldmVudHMgZm9yIG91ciBzdG9yYWdlIGtleVxuICAgICAgY29uc3QgU1RPUkFHRV9LRVkgPSAnR1JBQ0VfRFlOQU1JQ19TTkFQU0hPVCc7IC8vIE11c3QgbWF0Y2ggdGhlIGtleSBpbiBTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlclxuICAgICAgaWYgKGV2ZW50LmtleSA9PT0gU1RPUkFHRV9LRVkpIHtcbiAgICAgICAgLy8gUHJldmVudCBwcm9jZXNzaW5nIG91ciBvd24gdXBkYXRlc1xuICAgICAgICBpZiAoaXNVcGRhdGluZ0Zyb21TdG9yYWdlLmN1cnJlbnQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdTdGF0ZSBjaGFuZ2VkIGluIGFub3RoZXIgdGFiLCBzeW5jaHJvbml6aW5nLi4uJyk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gVXBkYXRlIGZsYWcgdG8gcHJldmVudCBjaXJjdWxhciB1cGRhdGVzXG4gICAgICAgICAgaXNVcGRhdGluZ0Zyb21TdG9yYWdlLmN1cnJlbnQgPSB0cnVlO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFBhcnNlIG5ldyBzdGF0ZSBmcm9tIHN0b3JhZ2VcbiAgICAgICAgICBjb25zdCBuZXdTdGF0ZSA9IGV2ZW50Lm5ld1ZhbHVlID8gSlNPTi5wYXJzZShldmVudC5uZXdWYWx1ZSkgOiBudWxsO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFZhbGlkYXRlIHN0YXRlIGJlZm9yZSBhcHBseWluZ1xuICAgICAgICAgIGlmIChuZXdTdGF0ZSAmJiB0eXBlb2YgbmV3U3RhdGUgPT09ICdvYmplY3QnICYmIG5ld1N0YXRlLnRpbWVzdGFtcCkge1xuICAgICAgICAgICAgLy8gU2lnbmFsIHRoYXQgd2UncmUgc3luY2luZyBmcm9tIGFub3RoZXIgdGFiXG4gICAgICAgICAgICBzZXRJc1N0YXRlU3luY2luZyh0cnVlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gT25seSBhcHBseSBpZiB0aGUgdGltZXN0YW1wIGlzIG5ld2VyXG4gICAgICAgICAgICBpZiAoIXN0YXRlLnRpbWVzdGFtcCB8fCBuZXdTdGF0ZS50aW1lc3RhbXAgPiBzdGF0ZS50aW1lc3RhbXApIHtcbiAgICAgICAgICAgICAgZGlzcGF0Y2goeyB0eXBlOiAnSFlEUkFURV9TVEFURScsIHBheWxvYWQ6IG5ld1N0YXRlIH0pO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3RhdGUgc3luY2hyb25pemVkIGZyb20gYW5vdGhlciB0YWInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gUmVzZXQgc3luY2luZyBzdGF0ZSBhZnRlciBhIGRlbGF5XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBzZXRJc1N0YXRlU3luY2luZyhmYWxzZSksIDEwMDApO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN5bmNocm9uaXppbmcgc3RhdGUgZnJvbSBhbm90aGVyIHRhYjonLCBlcnJvcik7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgLy8gUmVzZXQgZmxhZyBhZnRlciBhIHNob3J0IGRlbGF5XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBpc1VwZGF0aW5nRnJvbVN0b3JhZ2UuY3VycmVudCA9IGZhbHNlO1xuICAgICAgICAgIH0sIDEwMCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lciBmb3Igc3RvcmFnZSBldmVudHNcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIGhhbmRsZVN0b3JhZ2VDaGFuZ2UpO1xuICAgIFxuICAgIC8vIENsZWFudXAgZXZlbnQgbGlzdGVuZXIgb24gdW5tb3VudFxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RvcmFnZScsIGhhbmRsZVN0b3JhZ2VDaGFuZ2UpO1xuICAgIH07XG4gIH0sIFtzdGF0ZS50aW1lc3RhbXBdKTtcbiAgXG4gIC8vIFNhdmUgc3RhdGUgdG8gc3RvcmFnZSB3aGVuZXZlciBpdCBjaGFuZ2VzIHdpdGggZGVib3VuY2UgdG8gcHJldmVudCByYWNlIGNvbmRpdGlvbnNcbiAgY29uc3QgZGVib3VuY2VkU2F2ZVRpbWVvdXQgPSB1c2VSZWY8bnVtYmVyIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IGxhc3RTYXZlZFRpbWVzdGFtcCA9IHVzZVJlZjxudW1iZXI+KDApO1xuICBcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBTa2lwIGluaXRpYWwgcmVuZGVyIHRvIGF2b2lkIG92ZXJ3cml0aW5nIHdpdGggZW1wdHkgc3RhdGVcbiAgICAvLyBPbmx5IHByb2NlZWQgaWYgd2UgaGF2ZSBzb21lIG1lYW5pbmdmdWwgc3RhdGUgdG8gc2F2ZVxuICAgIGNvbnN0IGhhc0NvbnRlbnQgPSBcbiAgICAgIE9iamVjdC5rZXlzKHN0YXRlLnRyYWRpbmdTdGF0ZSB8fCB7fSkubGVuZ3RoID4gMCB8fCBcbiAgICAgIE9iamVjdC5rZXlzKHN0YXRlLndhbGxldFN0YXRlIHx8IHt9KS5sZW5ndGggPiAwIHx8XG4gICAgICBPYmplY3Qua2V5cyhzdGF0ZS5jaGF0Q29udGV4dCB8fCB7fSkubGVuZ3RoID4gMCB8fFxuICAgICAgT2JqZWN0LmtleXMoc3RhdGUuY2hhdFN0YXRlPy5zZXNzaW9ucyB8fCB7fSkubGVuZ3RoID4gMDtcbiAgICBcbiAgICBpZiAoaGFzQ29udGVudCkge1xuICAgICAgLy8gQ2xlYXIgYW55IGV4aXN0aW5nIHRpbWVvdXQgdG8gZGVib3VuY2UgZnJlcXVlbnQgdXBkYXRlc1xuICAgICAgaWYgKGRlYm91bmNlZFNhdmVUaW1lb3V0LmN1cnJlbnQgIT09IG51bGwpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGRlYm91bmNlZFNhdmVUaW1lb3V0LmN1cnJlbnQpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBEZWJvdW5jZSBzdGF0ZSBzYXZlcyB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSB3cml0ZXMgYW5kIHJhY2UgY29uZGl0aW9uc1xuICAgICAgZGVib3VuY2VkU2F2ZVRpbWVvdXQuY3VycmVudCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgLy8gT25seSBzYXZlIGlmIHdlJ3JlIG5vdCBjdXJyZW50bHkgcHJvY2Vzc2luZyBhbiB1cGRhdGUgZnJvbSBzdG9yYWdlXG4gICAgICAgIGlmICghaXNVcGRhdGluZ0Zyb21TdG9yYWdlLmN1cnJlbnQpIHtcbiAgICAgICAgICAvLyBEb24ndCBzYXZlIHRvbyBmcmVxdWVudGx5IC0gYXQgbW9zdCBvbmNlIGV2ZXJ5IDIgc2Vjb25kc1xuICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgICAgaWYgKG5vdyAtIGxhc3RTYXZlZFRpbWVzdGFtcC5jdXJyZW50ID4gMjAwMCkge1xuICAgICAgICAgICAgbGFzdFNhdmVkVGltZXN0YW1wLmN1cnJlbnQgPSBub3c7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEVuc3VyZSB0aW1lc3RhbXAgaXMgdXBkYXRlZFxuICAgICAgICAgICAgY29uc3Qgc3RhdGVUb1NhdmUgPSB7XG4gICAgICAgICAgICAgIC4uLnN0YXRlLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IG5vd1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIG1ldGFkYXRhIGZvciBkZWJ1Z2dpbmdcbiAgICAgICAgICAgIGlmIChzdGF0ZS5jaGF0Q29udGV4dD8uY3VycmVudENvbnZlcnNhdGlvbklkKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBTYXZpbmcgc3RhdGUgd2l0aCBhY3RpdmUgY29udmVyc2F0aW9uOiAke3N0YXRlLmNoYXRDb250ZXh0LmN1cnJlbnRDb252ZXJzYXRpb25JZH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgLy8gQ29udmVydCB0byBhc3luYy9hd2FpdCBwYXR0ZXJuIHRvIHByb3Blcmx5IGhhbmRsZSBQcm9taXNlXG4gICAgICAgICAgICAgIChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIGF3YWl0IFN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyLmNhcHR1cmVTbmFwc2hvdChzdGF0ZVRvU2F2ZSk7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3RhdGUgc2F2ZWQgdG8gbG9jYWxTdG9yYWdlJywgbmV3IERhdGUoKS50b0lTT1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgLy8gQWxzbyBlbnN1cmUgdGhlIGFjdGl2ZVNlc3Npb25JZCBpcyBzZXQgaW4gbG9jYWxTdG9yYWdlIGlmIHdlIGhhdmUgYSBjdXJyZW50IGNvbnZlcnNhdGlvblxuICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLmNoYXRDb250ZXh0Py5jdXJyZW50Q29udmVyc2F0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZVNlc3Npb25JZCcsIHN0YXRlLmNoYXRDb250ZXh0LmN1cnJlbnRDb252ZXJzYXRpb25JZCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBzdGF0ZSB0byBsb2NhbFN0b3JhZ2U6JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHN0YXRlIHBlcnNpc3RlbmNlIGZsb3c6JywgZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBkZWJvdW5jZWRTYXZlVGltZW91dC5jdXJyZW50ID0gbnVsbDtcbiAgICAgIH0sIDMwMCk7IC8vIDMwMG1zIGRlYm91bmNlIHRpbWVcbiAgICB9XG4gICAgXG4gICAgLy8gQ2xlYW51cCB0aW1lb3V0IG9uIHVubW91bnRcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKGRlYm91bmNlZFNhdmVUaW1lb3V0LmN1cnJlbnQgIT09IG51bGwpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGRlYm91bmNlZFNhdmVUaW1lb3V0LmN1cnJlbnQpO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtzdGF0ZV0pO1xuICBcbiAgXG4gIGNvbnN0IGNvbnRleHRWYWx1ZTogQXBwU3RhdGVDb250ZXh0VHlwZSA9IHtcbiAgICBzdGF0ZSxcbiAgICBkaXNwYXRjaCxcbiAgICBpc1N0YXRlTG9hZGluZyxcbiAgICBpc1N0YXRlSHlkcmF0ZWQsXG4gICAgaXNTdGF0ZVJlY292ZXJlZCxcbiAgICBpc1N0YXRlU3luY2luZyxcbiAgICBoeWRyYXRlRnJvbVN0b3JhZ2UsXG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8QXBwU3RhdGVDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtjb250ZXh0VmFsdWV9PlxuICAgICAge2NoaWxkcmVufVxuICAgIDwvQXBwU3RhdGVDb250ZXh0LlByb3ZpZGVyPlxuICApO1xufVxuXG4vLyBDdXN0b20gaG9vayBmb3IgdXNpbmcgdGhlIGFwcCBzdGF0ZVxuZXhwb3J0IGZ1bmN0aW9uIHVzZUFwcFN0YXRlKCkge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChBcHBTdGF0ZUNvbnRleHQpO1xuICBpZiAoY29udGV4dCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCd1c2VBcHBTdGF0ZSBtdXN0IGJlIHVzZWQgd2l0aGluIGFuIEFwcFN0YXRlUHJvdmlkZXInKTtcbiAgfVxuICByZXR1cm4gY29udGV4dDtcbn1cbiJdLCJuYW1lcyI6WyJSZWFjdCIsImNyZWF0ZUNvbnRleHQiLCJ1c2VDb250ZXh0IiwidXNlUmVkdWNlciIsInVzZUVmZmVjdCIsInVzZVJlZiIsInVzZVN0YXRlIiwidXNlQ2FsbGJhY2siLCJTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlciIsInVzZUF1dGgiLCJpbml0aWFsU3RhdGUiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwidXNlclNlc3Npb24iLCJhdXRoU2Vzc2lvbiIsImNoYXRDb250ZXh0IiwiY3VycmVudENvbnZlcnNhdGlvbklkIiwidW5kZWZpbmVkIiwiZHJhZnRNZXNzYWdlIiwibGFzdE1lc3NhZ2VUaW1lc3RhbXAiLCJjaGF0U3RhdGUiLCJhY3RpdmVTZXNzaW9ucyIsInNlc3Npb25zIiwiZHJhZnRNZXNzYWdlcyIsInBhZ2VTdGF0ZSIsIndpZGdldFN0YXRlcyIsImlzSHlkcmF0ZWQiLCJpc0xvYWRpbmciLCJsYXN0U2F2ZWQiLCJ0cmFkaW5nU3RhdGUiLCJ3YWxsZXRTdGF0ZSIsInNvY2lhbFN0YXRlIiwidWlTdGF0ZSIsImRhcmtNb2RlIiwic2lkZWJhck9wZW4iLCJ4ZmVlZCIsImZvbGxvd2VkQWNjb3VudHMiLCJsYXN0VXBkYXRlZCIsImFwcFN0YXRlUmVkdWNlciIsInN0YXRlIiwiYWN0aW9uIiwidHlwZSIsInBheWxvYWQiLCJ1c2VyIiwidG9rZW4iLCJ1c2VybmFtZSIsImV4cGlyZXNBdCIsIk1hdGgiLCJmbG9vciIsIkFwcFN0YXRlQ29udGV4dCIsIkFwcFN0YXRlUHJvdmlkZXIiLCJjaGlsZHJlbiIsImRpc3BhdGNoIiwiaXNTdGF0ZUxvYWRpbmciLCJzZXRJc1N0YXRlTG9hZGluZyIsImlzU3RhdGVIeWRyYXRlZCIsInNldElzU3RhdGVIeWRyYXRlZCIsImlzU3RhdGVSZWNvdmVyZWQiLCJzZXRJc1N0YXRlUmVjb3ZlcmVkIiwiaXNTdGF0ZVN5bmNpbmciLCJzZXRJc1N0YXRlU3luY2luZyIsImlzVXBkYXRpbmdGcm9tU3RvcmFnZSIsImlzQXV0aGVudGljYXRlZCIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJoeWRyYXRlRnJvbVN0b3JhZ2UiLCJuYXZpZ2F0ZSIsInN0b3JlZFN0YXRlIiwicmV0cmlldmVTbmFwc2hvdCIsImNvbnNvbGUiLCJsb2ciLCJoeWRyYXRlZFN0YXRlIiwibGFzdFZpc2l0ZWRQYXRoIiwic2Nyb2xsUG9zaXRpb25zIiwidHJhZGluZ1Bvc2l0aW9ucyIsIndhbGxldEJhbGFuY2UiLCJjdXJyZW50U2Vzc2lvbklkIiwic2VsZWN0ZWRUb2tlbiIsIndhdGNobGlzdCIsInRyYWRlSGlzdG9yeSIsInRyYWRlRm9ybSIsInJlc29sdXRpb24iLCJzZWFyY2giLCJwb3NpdGlvbnMiLCJjb25uZWN0ZWRXYWxsZXRzIiwidHJhbnNhY3Rpb25zIiwicG9zdHMiLCJmb2xsb3dpbmciLCJub3RpZmljYXRpb25zIiwiYWN0aXZlVGFicyIsInNldFRpbWVvdXQiLCJzY3JvbGxZIiwid2luZG93Iiwic2Nyb2xsVG8iLCJhY3RpdmVTZXNzaW9uSWQiLCJlcnJvciIsInRpbWVyIiwiY2xlYXJUaW1lb3V0IiwiaGFuZGxlU3RvcmFnZUNoYW5nZSIsImV2ZW50IiwiU1RPUkFHRV9LRVkiLCJrZXkiLCJjdXJyZW50IiwibmV3U3RhdGUiLCJuZXdWYWx1ZSIsIkpTT04iLCJwYXJzZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZGVib3VuY2VkU2F2ZVRpbWVvdXQiLCJsYXN0U2F2ZWRUaW1lc3RhbXAiLCJoYXNDb250ZW50IiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInN0YXRlVG9TYXZlIiwiY2FwdHVyZVNuYXBzaG90IiwidG9JU09TdHJpbmciLCJzZXRJdGVtIiwiY29udGV4dFZhbHVlIiwiUHJvdmlkZXIiLCJ2YWx1ZSIsInVzZUFwcFN0YXRlIiwiY29udGV4dCIsIkVycm9yIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./context/AppStateContext.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./index.css":
/*!*******************!*\
  !*** ./index.css ***!
  \*******************/
/***/ (() => {



/***/ }),

/***/ "(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2F&preferredRegion=&absolutePagePath=.%2Fpages%2Findex.tsx&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2F&preferredRegion=&absolutePagePath=.%2Fpages%2Findex.tsx&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getServerSideProps: () => (/* binding */ getServerSideProps),\n/* harmony export */   getStaticPaths: () => (/* binding */ getStaticPaths),\n/* harmony export */   getStaticProps: () => (/* binding */ getStaticProps),\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   reportWebVitals: () => (/* binding */ reportWebVitals),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   unstable_getServerProps: () => (/* binding */ unstable_getServerProps),\n/* harmony export */   unstable_getServerSideProps: () => (/* binding */ unstable_getServerSideProps),\n/* harmony export */   unstable_getStaticParams: () => (/* binding */ unstable_getStaticParams),\n/* harmony export */   unstable_getStaticPaths: () => (/* binding */ unstable_getStaticPaths),\n/* harmony export */   unstable_getStaticProps: () => (/* binding */ unstable_getStaticProps)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages/module.compiled */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/route-modules/pages/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/format-url */ \"next/dist/shared/lib/router/utils/format-url\");\n/* harmony import */ var next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_app_render_interop_default__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/app-render/interop-default */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/app-render/interop-default.js\");\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_shared_lib_page_path_normalize_data_path__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/shared/lib/page-path/normalize-data-path */ \"next/dist/shared/lib/page-path/normalize-data-path\");\n/* harmony import */ var next_dist_shared_lib_page_path_normalize_data_path__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_page_path_normalize_data_path__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var private_next_pages_document__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! private-next-pages/_document */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/pages/_document.js\");\n/* harmony import */ var private_next_pages_document__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(private_next_pages_document__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var private_next_pages_app__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! private-next-pages/_app */ \"(pages-dir-node)/./pages/_app.tsx\");\n/* harmony import */ var _pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./pages/index.tsx */ \"(pages-dir-node)/./pages/index.tsx\");\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_shared_lib_utils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/shared/lib/utils */ \"next/dist/shared/lib/utils\");\n/* harmony import */ var next_dist_shared_lib_utils__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_utils__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var next_dist_lib_redirect_status__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! next/dist/lib/redirect-status */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/lib/redirect-status.js\");\n/* harmony import */ var next_dist_lib_redirect_status__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_redirect_status__WEBPACK_IMPORTED_MODULE_16__);\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! next/dist/lib/constants */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_17__);\n/* harmony import */ var next_dist_server_send_payload__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! next/dist/server/send-payload */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/send-payload.js\");\n/* harmony import */ var next_dist_server_send_payload__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_send_payload__WEBPACK_IMPORTED_MODULE_18__);\n/* harmony import */ var next_dist_server_render_result__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! next/dist/server/render-result */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/render-result.js\");\n/* harmony import */ var next_dist_server_response_cache_utils__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! next/dist/server/response-cache/utils */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/response-cache/utils.js\");\n/* harmony import */ var next_dist_server_response_cache_utils__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache_utils__WEBPACK_IMPORTED_MODULE_20__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21__);\n/* harmony import */ var next_dist_client_components_redirect_status_code__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! next/dist/client/components/redirect-status-code */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/client/components/redirect-status-code.js\");\n/* harmony import */ var next_dist_client_components_redirect_status_code__WEBPACK_IMPORTED_MODULE_22___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_redirect_status_code__WEBPACK_IMPORTED_MODULE_22__);\n/* harmony import */ var next_dist_shared_lib_router_utils_is_bot__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/is-bot */ \"next/dist/shared/lib/router/utils/is-bot\");\n/* harmony import */ var next_dist_shared_lib_router_utils_is_bot__WEBPACK_IMPORTED_MODULE_23___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_is_bot__WEBPACK_IMPORTED_MODULE_23__);\n/* harmony import */ var next_dist_shared_lib_router_utils_add_path_prefix__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/add-path-prefix */ \"next/dist/shared/lib/router/utils/add-path-prefix\");\n/* harmony import */ var next_dist_shared_lib_router_utils_add_path_prefix__WEBPACK_IMPORTED_MODULE_24___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_add_path_prefix__WEBPACK_IMPORTED_MODULE_24__);\n/* harmony import */ var next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/remove-trailing-slash */ \"next/dist/shared/lib/router/utils/remove-trailing-slash\");\n/* harmony import */ var next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([private_next_pages_app__WEBPACK_IMPORTED_MODULE_12__]);\nprivate_next_pages_app__WEBPACK_IMPORTED_MODULE_12__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\n// Import the app and document modules.\n\n\n// Import the userland code.\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Re-export the component (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'default'));\n// Re-export methods.\nconst getStaticProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'getStaticProps');\nconst getStaticPaths = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'getStaticPaths');\nconst getServerSideProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'getServerSideProps');\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'config');\nconst reportWebVitals = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'reportWebVitals');\n// Re-export legacy methods.\nconst unstable_getStaticProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getStaticProps');\nconst unstable_getStaticPaths = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getStaticPaths');\nconst unstable_getStaticParams = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getStaticParams');\nconst unstable_getServerProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getServerProps');\nconst unstable_getServerSideProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getServerSideProps');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES,\n        page: \"/index\",\n        pathname: \"/\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    distDir: \".next\" || 0,\n    projectDir:  false || '',\n    components: {\n        // default export might not exist when optimized for data only\n        App: private_next_pages_app__WEBPACK_IMPORTED_MODULE_12__[\"default\"],\n        Document: (private_next_pages_document__WEBPACK_IMPORTED_MODULE_11___default())\n    },\n    userland: _pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__\n});\nasync function handler(req, res, ctx) {\n    var _serverFilesManifest_config_experimental, _serverFilesManifest_config;\n    let srcPage = \"/index\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = \"false\";\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { buildId, query, params, parsedUrl, originalQuery, originalPathname, buildManifest, nextFontManifest, serverFilesManifest, reactLoadableManifest, prerenderManifest, isDraftMode, isOnDemandRevalidate, revalidateOnlyGenerated, locale, locales, defaultLocale, routerServerContext, nextConfig, resolvedPathname } = prepareResult;\n    const isExperimentalCompile = serverFilesManifest == null ? void 0 : (_serverFilesManifest_config = serverFilesManifest.config) == null ? void 0 : (_serverFilesManifest_config_experimental = _serverFilesManifest_config.experimental) == null ? void 0 : _serverFilesManifest_config_experimental.isExperimentalCompile;\n    const hasServerProps = Boolean(getServerSideProps);\n    const hasStaticProps = Boolean(getStaticProps);\n    const hasStaticPaths = Boolean(getStaticPaths);\n    const hasGetInitialProps = Boolean((_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__[\"default\"] || _pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__).getInitialProps);\n    const isAmp = query.amp && config.amp;\n    let cacheKey = null;\n    let isIsrFallback = false;\n    let isNextDataRequest = prepareResult.isNextDataRequest && (hasStaticProps || hasServerProps);\n    const is404Page = srcPage === '/404';\n    const is500Page = srcPage === '/500';\n    const isErrorPage = srcPage === '/_error';\n    if (!routeModule.isDev && !isDraftMode && hasStaticProps) {\n        cacheKey = `${locale ? `/${locale}` : ''}${(srcPage === '/' || resolvedPathname === '/') && locale ? '' : resolvedPathname}${isAmp ? '.amp' : ''}`;\n        if (is404Page || is500Page || isErrorPage) {\n            cacheKey = `${locale ? `/${locale}` : ''}${srcPage}${isAmp ? '.amp' : ''}`;\n        }\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    if (hasStaticPaths && !isDraftMode) {\n        const decodedPathname = (0,next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25__.removeTrailingSlash)(locale ? (0,next_dist_shared_lib_router_utils_add_path_prefix__WEBPACK_IMPORTED_MODULE_24__.addPathPrefix)(resolvedPathname, `/${locale}`) : resolvedPathname);\n        const isPrerendered = Boolean(prerenderManifest.routes[decodedPathname]) || prerenderManifest.notFoundRoutes.includes(decodedPathname);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[srcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21__.NoFallbackError();\n            }\n            if (typeof prerenderInfo.fallback === 'string' && !isPrerendered && !isNextDataRequest) {\n                isIsrFallback = true;\n            }\n        }\n    }\n    // When serving a bot request, we want to serve a blocking render and not\n    // the prerendered page. This ensures that the correct content is served\n    // to the bot in the head.\n    if (isIsrFallback && (0,next_dist_shared_lib_router_utils_is_bot__WEBPACK_IMPORTED_MODULE_23__.isBot)(req.headers['user-agent'] || '') || (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'minimalMode')) {\n        isIsrFallback = false;\n    }\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    try {\n        const method = req.method || 'GET';\n        const resolvedUrl = (0,next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4__.formatUrl)({\n            pathname: nextConfig.trailingSlash ? parsedUrl.pathname : (0,next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25__.removeTrailingSlash)(parsedUrl.pathname || '/'),\n            // make sure to only add query values from original URL\n            query: hasStaticProps ? {} : originalQuery\n        });\n        const publicRuntimeConfig = (routerServerContext == null ? void 0 : routerServerContext.publicRuntimeConfig) || nextConfig.publicRuntimeConfig;\n        const handleResponse = async (span)=>{\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                var _previousCacheEntry_value;\n                const doRender = async ()=>{\n                    try {\n                        var _nextConfig_i18n, _nextConfig_experimental_amp, _nextConfig_experimental_amp1;\n                        return await routeModule.render(req, res, {\n                            query: hasStaticProps && !isExperimentalCompile ? {\n                                ...params,\n                                ...isAmp ? {\n                                    amp: query.amp\n                                } : {}\n                            } : {\n                                ...query,\n                                ...params\n                            },\n                            params,\n                            page: srcPage,\n                            renderContext: {\n                                isDraftMode,\n                                isFallback: isIsrFallback,\n                                developmentNotFoundSourcePage: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'developmentNotFoundSourcePage')\n                            },\n                            sharedContext: {\n                                buildId,\n                                customServer: Boolean(routerServerContext == null ? void 0 : routerServerContext.isCustomServer) || undefined,\n                                deploymentId: false\n                            },\n                            renderOpts: {\n                                params,\n                                routeModule,\n                                page: srcPage,\n                                pageConfig: config || {},\n                                Component: (0,next_dist_server_app_render_interop_default__WEBPACK_IMPORTED_MODULE_6__.interopDefault)(_pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__),\n                                ComponentMod: _pages_index_tsx__WEBPACK_IMPORTED_MODULE_13__,\n                                getStaticProps,\n                                getStaticPaths,\n                                getServerSideProps,\n                                supportsDynamicResponse: !hasStaticProps,\n                                buildManifest,\n                                nextFontManifest,\n                                reactLoadableManifest,\n                                assetPrefix: nextConfig.assetPrefix,\n                                strictNextHead: nextConfig.experimental.strictNextHead ?? true,\n                                previewProps: prerenderManifest.preview,\n                                images: nextConfig.images,\n                                nextConfigOutput: nextConfig.output,\n                                optimizeCss: Boolean(nextConfig.experimental.optimizeCss),\n                                nextScriptWorkers: Boolean(nextConfig.experimental.nextScriptWorkers),\n                                domainLocales: (_nextConfig_i18n = nextConfig.i18n) == null ? void 0 : _nextConfig_i18n.domains,\n                                crossOrigin: nextConfig.crossOrigin,\n                                multiZoneDraftMode,\n                                basePath: nextConfig.basePath,\n                                canonicalBase: nextConfig.amp.canonicalBase || '',\n                                ampOptimizerConfig: (_nextConfig_experimental_amp = nextConfig.experimental.amp) == null ? void 0 : _nextConfig_experimental_amp.optimizer,\n                                disableOptimizedLoading: nextConfig.experimental.disableOptimizedLoading,\n                                largePageDataBytes: nextConfig.experimental.largePageDataBytes,\n                                // Only the `publicRuntimeConfig` key is exposed to the client side\n                                // It'll be rendered as part of __NEXT_DATA__ on the client side\n                                runtimeConfig: Object.keys(publicRuntimeConfig).length > 0 ? publicRuntimeConfig : undefined,\n                                isExperimentalCompile,\n                                experimental: {\n                                    clientTraceMetadata: nextConfig.experimental.clientTraceMetadata || []\n                                },\n                                locale,\n                                locales,\n                                defaultLocale,\n                                setIsrStatus: routerServerContext == null ? void 0 : routerServerContext.setIsrStatus,\n                                isNextDataRequest: isNextDataRequest && (hasServerProps || hasStaticProps),\n                                resolvedUrl,\n                                // For getServerSideProps and getInitialProps we need to ensure we use the original URL\n                                // and not the resolved URL to prevent a hydration mismatch on\n                                // asPath\n                                resolvedAsPath: hasServerProps || hasGetInitialProps ? (0,next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4__.formatUrl)({\n                                    // we use the original URL pathname less the _next/data prefix if\n                                    // present\n                                    pathname: isNextDataRequest ? (0,next_dist_shared_lib_page_path_normalize_data_path__WEBPACK_IMPORTED_MODULE_8__.normalizeDataPath)(originalPathname) : originalPathname,\n                                    query: originalQuery\n                                }) : resolvedUrl,\n                                isOnDemandRevalidate,\n                                ErrorDebug: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'PagesErrorDebug'),\n                                err: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'invokeError'),\n                                dev: routeModule.isDev,\n                                // needed for experimental.optimizeCss feature\n                                distDir: `${routeModule.projectDir}/${routeModule.distDir}`,\n                                ampSkipValidation: (_nextConfig_experimental_amp1 = nextConfig.experimental.amp) == null ? void 0 : _nextConfig_experimental_amp1.skipValidation,\n                                ampValidator: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'ampValidator')\n                            }\n                        }).then((renderResult)=>{\n                            const { metadata } = renderResult;\n                            let cacheControl = metadata.cacheControl;\n                            if ('isNotFound' in metadata && metadata.isNotFound) {\n                                return {\n                                    value: null,\n                                    cacheControl\n                                };\n                            }\n                            // Handle `isRedirect`.\n                            if (metadata.isRedirect) {\n                                return {\n                                    value: {\n                                        kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.REDIRECT,\n                                        props: metadata.pageData ?? metadata.flightData\n                                    },\n                                    cacheControl\n                                };\n                            }\n                            return {\n                                value: {\n                                    kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.PAGES,\n                                    html: renderResult,\n                                    pageData: renderResult.metadata.pageData,\n                                    headers: renderResult.metadata.headers,\n                                    status: renderResult.metadata.statusCode\n                                },\n                                cacheControl\n                            };\n                        }).finally(()=>{\n                            if (!span) return;\n                            span.setAttributes({\n                                'http.status_code': res.statusCode,\n                                'next.rsc': false\n                            });\n                            const rootSpanAttributes = tracer.getRootSpanAttributes();\n                            // We were unable to get attributes, probably OTEL is not enabled\n                            if (!rootSpanAttributes) {\n                                return;\n                            }\n                            if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2__.BaseServerSpan.handleRequest) {\n                                console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                                return;\n                            }\n                            const route = rootSpanAttributes.get('next.route');\n                            if (route) {\n                                const name = `${method} ${route}`;\n                                span.setAttributes({\n                                    'next.route': route,\n                                    'http.route': route,\n                                    'next.span_name': name\n                                });\n                                span.updateName(name);\n                            } else {\n                                span.updateName(`${method} ${req.url}`);\n                            }\n                        });\n                    } catch (err) {\n                        // if this is a background revalidate we need to report\n                        // the request error here as it won't be bubbled\n                        if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                            await routeModule.onRequestError(req, err, {\n                                routerKind: 'Pages Router',\n                                routePath: srcPage,\n                                routeType: 'render',\n                                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_7__.getRevalidateReason)({\n                                    isRevalidate: hasStaticProps,\n                                    isOnDemandRevalidate\n                                })\n                            }, routerServerContext);\n                        }\n                        throw err;\n                    }\n                };\n                // if we've already generated this page we no longer\n                // serve the fallback\n                if (previousCacheEntry) {\n                    isIsrFallback = false;\n                }\n                if (isIsrFallback) {\n                    const fallbackResponse = await routeModule.getResponseCache(req).get(routeModule.isDev ? null : locale ? `/${locale}${srcPage}` : srcPage, async ({ previousCacheEntry: previousFallbackCacheEntry = null })=>{\n                        if (!routeModule.isDev) {\n                            return (0,next_dist_server_response_cache_utils__WEBPACK_IMPORTED_MODULE_20__.toResponseCacheEntry)(previousFallbackCacheEntry);\n                        }\n                        return doRender();\n                    }, {\n                        routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES,\n                        isFallback: true,\n                        isRoutePPREnabled: false,\n                        isOnDemandRevalidate: false,\n                        incrementalCache: await routeModule.getIncrementalCache(req, nextConfig, prerenderManifest),\n                        waitUntil: ctx.waitUntil\n                    });\n                    if (fallbackResponse) {\n                        // Remove the cache control from the response to prevent it from being\n                        // used in the surrounding cache.\n                        delete fallbackResponse.cacheControl;\n                        fallbackResponse.isMiss = true;\n                        return fallbackResponse;\n                    }\n                }\n                if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                    res.statusCode = 404;\n                    // on-demand revalidate always sets this header\n                    res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                    res.end('This page could not be found');\n                    return null;\n                }\n                if (isIsrFallback && (previousCacheEntry == null ? void 0 : (_previousCacheEntry_value = previousCacheEntry.value) == null ? void 0 : _previousCacheEntry_value.kind) === next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.PAGES) {\n                    return {\n                        value: {\n                            kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.PAGES,\n                            html: new next_dist_server_render_result__WEBPACK_IMPORTED_MODULE_19__[\"default\"](Buffer.from(previousCacheEntry.value.html), {\n                                contentType: 'text/html;utf-8',\n                                metadata: {\n                                    statusCode: previousCacheEntry.value.status,\n                                    headers: previousCacheEntry.value.headers\n                                }\n                            }),\n                            pageData: {},\n                            status: previousCacheEntry.value.status,\n                            headers: previousCacheEntry.value.headers\n                        },\n                        cacheControl: {\n                            revalidate: 0,\n                            expire: undefined\n                        }\n                    };\n                }\n                return doRender();\n            };\n            const result = await routeModule.handleResponse({\n                cacheKey,\n                req,\n                nextConfig,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                waitUntil: ctx.waitUntil,\n                responseGenerator: responseGenerator,\n                prerenderManifest\n            });\n            // if we got a cache hit this wasn't an ISR fallback\n            // but it wasn't generated during build so isn't in the\n            // prerender-manifest\n            if (isIsrFallback && !(result == null ? void 0 : result.isMiss)) {\n                isIsrFallback = false;\n            }\n            // response is finished is no cache entry\n            if (!result) {\n                return;\n            }\n            if (hasStaticProps && !(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : result.isMiss ? 'MISS' : result.isStale ? 'STALE' : 'HIT');\n            }\n            let cacheControl;\n            if (!hasStaticProps || isIsrFallback) {\n                if (!res.getHeader('Cache-Control')) {\n                    cacheControl = {\n                        revalidate: 0,\n                        expire: undefined\n                    };\n                }\n            } else if (is404Page) {\n                const notFoundRevalidate = (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'notFoundRevalidate');\n                cacheControl = {\n                    revalidate: typeof notFoundRevalidate === 'undefined' ? 0 : notFoundRevalidate,\n                    expire: undefined\n                };\n            } else if (is500Page) {\n                cacheControl = {\n                    revalidate: 0,\n                    expire: undefined\n                };\n            } else if (result.cacheControl) {\n                // If the cache entry has a cache control with a revalidate value that's\n                // a number, use it.\n                if (typeof result.cacheControl.revalidate === 'number') {\n                    var _result_cacheControl;\n                    if (result.cacheControl.revalidate < 1) {\n                        throw Object.defineProperty(new Error(`Invalid revalidate configuration provided: ${result.cacheControl.revalidate} < 1`), \"__NEXT_ERROR_CODE\", {\n                            value: \"E22\",\n                            enumerable: false,\n                            configurable: true\n                        });\n                    }\n                    cacheControl = {\n                        revalidate: result.cacheControl.revalidate,\n                        expire: ((_result_cacheControl = result.cacheControl) == null ? void 0 : _result_cacheControl.expire) ?? nextConfig.expireTime\n                    };\n                } else {\n                    // revalidate: false\n                    cacheControl = {\n                        revalidate: next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_17__.CACHE_ONE_YEAR,\n                        expire: undefined\n                    };\n                }\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheControl && !res.getHeader('Cache-Control')) {\n                res.setHeader('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_14__.getCacheControlHeader)(cacheControl));\n            }\n            // notFound: true case\n            if (!result.value) {\n                var _result_cacheControl1;\n                // add revalidate metadata before rendering 404 page\n                // so that we can use this as source of truth for the\n                // cache-control header instead of what the 404 page returns\n                // for the revalidate value\n                (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.addRequestMeta)(req, 'notFoundRevalidate', (_result_cacheControl1 = result.cacheControl) == null ? void 0 : _result_cacheControl1.revalidate);\n                res.statusCode = 404;\n                if (isNextDataRequest) {\n                    res.end('{\"notFound\":true}');\n                    return;\n                }\n                // TODO: should route-module itself handle rendering the 404\n                if (routerServerContext == null ? void 0 : routerServerContext.render404) {\n                    await routerServerContext.render404(req, res, parsedUrl, false);\n                } else {\n                    res.end('This page could not be found');\n                }\n                return;\n            }\n            if (result.value.kind === next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.REDIRECT) {\n                if (isNextDataRequest) {\n                    res.setHeader('content-type', 'application/json');\n                    res.end(JSON.stringify(result.value.props));\n                    return;\n                } else {\n                    const handleRedirect = (pageData)=>{\n                        const redirect = {\n                            destination: pageData.pageProps.__N_REDIRECT,\n                            statusCode: pageData.pageProps.__N_REDIRECT_STATUS,\n                            basePath: pageData.pageProps.__N_REDIRECT_BASE_PATH\n                        };\n                        const statusCode = (0,next_dist_lib_redirect_status__WEBPACK_IMPORTED_MODULE_16__.getRedirectStatus)(redirect);\n                        const { basePath } = nextConfig;\n                        if (basePath && redirect.basePath !== false && redirect.destination.startsWith('/')) {\n                            redirect.destination = `${basePath}${redirect.destination}`;\n                        }\n                        if (redirect.destination.startsWith('/')) {\n                            redirect.destination = (0,next_dist_shared_lib_utils__WEBPACK_IMPORTED_MODULE_15__.normalizeRepeatedSlashes)(redirect.destination);\n                        }\n                        res.statusCode = statusCode;\n                        res.setHeader('Location', redirect.destination);\n                        if (statusCode === next_dist_client_components_redirect_status_code__WEBPACK_IMPORTED_MODULE_22__.RedirectStatusCode.PermanentRedirect) {\n                            res.setHeader('Refresh', `0;url=${redirect.destination}`);\n                        }\n                        res.end(redirect.destination);\n                    };\n                    await handleRedirect(result.value.props);\n                    return null;\n                }\n            }\n            if (result.value.kind !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.PAGES) {\n                throw Object.defineProperty(new Error(`Invariant: received non-pages cache entry in pages handler`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E695\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            // In dev, we should not cache pages for any reason.\n            if (routeModule.isDev) {\n                res.setHeader('Cache-Control', 'no-store, must-revalidate');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            // when invoking _error before pages/500 we don't actually\n            // send the _error response\n            if ((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'customErrorRender') || isErrorPage && (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'minimalMode') && res.statusCode === 500) {\n                return null;\n            }\n            await (0,next_dist_server_send_payload__WEBPACK_IMPORTED_MODULE_18__.sendRenderResult)({\n                req,\n                res,\n                // If we are rendering the error page it's not a data request\n                // anymore\n                result: isNextDataRequest && !isErrorPage && !is500Page ? new next_dist_server_render_result__WEBPACK_IMPORTED_MODULE_19__[\"default\"](Buffer.from(JSON.stringify(result.value.pageData)), {\n                    contentType: 'application/json',\n                    metadata: result.value.html.metadata\n                }) : result.value.html,\n                generateEtags: nextConfig.generateEtags,\n                poweredByHeader: nextConfig.poweredByHeader,\n                cacheControl: routeModule.isDev ? undefined : cacheControl,\n                type: isNextDataRequest ? 'json' : 'html'\n            });\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse();\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'Pages Router',\n                routePath: srcPage,\n                routeType: 'render',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_7__.getRevalidateReason)({\n                    isRevalidate: hasStaticProps,\n                    isOnDemandRevalidate\n                })\n            }, routerServerContext);\n        }\n        // rethrow so that we can handle serving error page\n        throw err;\n    }\n}\n\n//# sourceMappingURL=pages.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9uZXh0QDE1LjQuNV9AYmFiZWwrY29yZUA3LjI4LjBfcmVhY3QtZG9tQDE5LjEuMV9yZWFjdEAxOS4xLjFfX3JlYWN0QDE5LjEuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTJnBhZ2U9JTJGJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZpbmRleC50c3gmYWJzb2x1dGVBcHBQYXRoPXByaXZhdGUtbmV4dC1wYWdlcyUyRl9hcHAmYWJzb2x1dGVEb2N1bWVudFBhdGg9cHJpdmF0ZS1uZXh0LXBhZ2VzJTJGX2RvY3VtZW50Jm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd0Y7QUFDaEM7QUFDYztBQUNFO0FBQ0M7QUFDTTtBQUNGO0FBQ0E7QUFDVTtBQUNyQjtBQUNSO0FBQzFEO0FBQ3lEO0FBQ1Y7QUFDL0M7QUFDOEM7QUFDNkI7QUFDTDtBQUNKO0FBQ1Q7QUFDUTtBQUNQO0FBQ21CO0FBQ0s7QUFDSTtBQUNyQjtBQUNpQjtBQUNZO0FBQzlGO0FBQ0EsaUVBQWUseUVBQUssQ0FBQyw4Q0FBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyx1QkFBdUIseUVBQUssQ0FBQyw4Q0FBUTtBQUNyQyx1QkFBdUIseUVBQUssQ0FBQyw4Q0FBUTtBQUNyQywyQkFBMkIseUVBQUssQ0FBQyw4Q0FBUTtBQUN6QyxlQUFlLHlFQUFLLENBQUMsOENBQVE7QUFDN0Isd0JBQXdCLHlFQUFLLENBQUMsOENBQVE7QUFDN0M7QUFDTyxnQ0FBZ0MseUVBQUssQ0FBQyw4Q0FBUTtBQUM5QyxnQ0FBZ0MseUVBQUssQ0FBQyw4Q0FBUTtBQUM5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c0MsNEVBQWU7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw2RUFBYyw2Q0FBNkMsNkVBQWM7QUFDekY7QUFDQTtBQUNBLGtCQUFrQixnRkFBZ0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RUFBOEUsdUVBQVk7QUFDMUY7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOLDZCQUE2Qiw2RkFBZTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQyIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgQmFzZVNlcnZlclNwYW4gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBnZXRUcmFjZXIsIFNwYW5LaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL3RyYWNlclwiO1xuaW1wb3J0IHsgZm9ybWF0VXJsIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9mb3JtYXQtdXJsXCI7XG5pbXBvcnQgeyBhZGRSZXF1ZXN0TWV0YSwgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGludGVyb3BEZWZhdWx0IH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYXBwLXJlbmRlci9pbnRlcm9wLWRlZmF1bHRcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZURhdGFQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3BhZ2UtcGF0aC9ub3JtYWxpemUtZGF0YS1wYXRoXCI7XG5pbXBvcnQgeyBDYWNoZWRSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXNwb25zZS1jYWNoZVwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIGFwcCBhbmQgZG9jdW1lbnQgbW9kdWxlcy5cbmltcG9ydCAqIGFzIGRvY3VtZW50IGZyb20gXCJwcml2YXRlLW5leHQtcGFnZXMvX2RvY3VtZW50XCI7XG5pbXBvcnQgKiBhcyBhcHAgZnJvbSBcInByaXZhdGUtbmV4dC1wYWdlcy9fYXBwXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9pbmRleC50c3hcIjtcbmltcG9ydCB7IGdldENhY2hlQ29udHJvbEhlYWRlciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9jYWNoZS1jb250cm9sXCI7XG5pbXBvcnQgeyBub3JtYWxpemVSZXBlYXRlZFNsYXNoZXMgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvdXRpbHNcIjtcbmltcG9ydCB7IGdldFJlZGlyZWN0U3RhdHVzIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvcmVkaXJlY3Qtc3RhdHVzXCI7XG5pbXBvcnQgeyBDQUNIRV9PTkVfWUVBUiB9IGZyb20gXCJuZXh0L2Rpc3QvbGliL2NvbnN0YW50c1wiO1xuaW1wb3J0IHsgc2VuZFJlbmRlclJlc3VsdCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcGF5bG9hZFwiO1xuaW1wb3J0IFJlbmRlclJlc3VsdCBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZW5kZXItcmVzdWx0XCI7XG5pbXBvcnQgeyB0b1Jlc3BvbnNlQ2FjaGVFbnRyeSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlL3V0aWxzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IFJlZGlyZWN0U3RhdHVzQ29kZSB9IGZyb20gXCJuZXh0L2Rpc3QvY2xpZW50L2NvbXBvbmVudHMvcmVkaXJlY3Qtc3RhdHVzLWNvZGVcIjtcbmltcG9ydCB7IGlzQm90IH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9pcy1ib3RcIjtcbmltcG9ydCB7IGFkZFBhdGhQcmVmaXggfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2FkZC1wYXRoLXByZWZpeFwiO1xuaW1wb3J0IHsgcmVtb3ZlVHJhaWxpbmdTbGFzaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9yb3V0ZXIvdXRpbHMvcmVtb3ZlLXRyYWlsaW5nLXNsYXNoXCI7XG4vLyBSZS1leHBvcnQgdGhlIGNvbXBvbmVudCAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBtZXRob2RzLlxuZXhwb3J0IGNvbnN0IGdldFN0YXRpY1Byb3BzID0gaG9pc3QodXNlcmxhbmQsICdnZXRTdGF0aWNQcm9wcycpO1xuZXhwb3J0IGNvbnN0IGdldFN0YXRpY1BhdGhzID0gaG9pc3QodXNlcmxhbmQsICdnZXRTdGF0aWNQYXRocycpO1xuZXhwb3J0IGNvbnN0IGdldFNlcnZlclNpZGVQcm9wcyA9IGhvaXN0KHVzZXJsYW5kLCAnZ2V0U2VydmVyU2lkZVByb3BzJyk7XG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbmV4cG9ydCBjb25zdCByZXBvcnRXZWJWaXRhbHMgPSBob2lzdCh1c2VybGFuZCwgJ3JlcG9ydFdlYlZpdGFscycpO1xuLy8gUmUtZXhwb3J0IGxlZ2FjeSBtZXRob2RzLlxuZXhwb3J0IGNvbnN0IHVuc3RhYmxlX2dldFN0YXRpY1Byb3BzID0gaG9pc3QodXNlcmxhbmQsICd1bnN0YWJsZV9nZXRTdGF0aWNQcm9wcycpO1xuZXhwb3J0IGNvbnN0IHVuc3RhYmxlX2dldFN0YXRpY1BhdGhzID0gaG9pc3QodXNlcmxhbmQsICd1bnN0YWJsZV9nZXRTdGF0aWNQYXRocycpO1xuZXhwb3J0IGNvbnN0IHVuc3RhYmxlX2dldFN0YXRpY1BhcmFtcyA9IGhvaXN0KHVzZXJsYW5kLCAndW5zdGFibGVfZ2V0U3RhdGljUGFyYW1zJyk7XG5leHBvcnQgY29uc3QgdW5zdGFibGVfZ2V0U2VydmVyUHJvcHMgPSBob2lzdCh1c2VybGFuZCwgJ3Vuc3RhYmxlX2dldFNlcnZlclByb3BzJyk7XG5leHBvcnQgY29uc3QgdW5zdGFibGVfZ2V0U2VydmVyU2lkZVByb3BzID0gaG9pc3QodXNlcmxhbmQsICd1bnN0YWJsZV9nZXRTZXJ2ZXJTaWRlUHJvcHMnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTLFxuICAgICAgICBwYWdlOiBcIi9pbmRleFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogJycsXG4gICAgICAgIGZpbGVuYW1lOiAnJ1xuICAgIH0sXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHByb2plY3REaXI6IHByb2Nlc3MuZW52Ll9fTkVYVF9SRUxBVElWRV9QUk9KRUNUX0RJUiB8fCAnJyxcbiAgICBjb21wb25lbnRzOiB7XG4gICAgICAgIC8vIGRlZmF1bHQgZXhwb3J0IG1pZ2h0IG5vdCBleGlzdCB3aGVuIG9wdGltaXplZCBmb3IgZGF0YSBvbmx5XG4gICAgICAgIEFwcDogYXBwLmRlZmF1bHQsXG4gICAgICAgIERvY3VtZW50OiBkb2N1bWVudC5kZWZhdWx0XG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcywgY3R4KSB7XG4gICAgdmFyIF9zZXJ2ZXJGaWxlc01hbmlmZXN0X2NvbmZpZ19leHBlcmltZW50YWwsIF9zZXJ2ZXJGaWxlc01hbmlmZXN0X2NvbmZpZztcbiAgICBsZXQgc3JjUGFnZSA9IFwiL2luZGV4XCI7XG4gICAgLy8gdHVyYm9wYWNrIGRvZXNuJ3Qgbm9ybWFsaXplIGAvaW5kZXhgIGluIHRoZSBwYWdlIG5hbWVcbiAgICAvLyBzbyB3ZSBuZWVkIHRvIHRvIHByb2Nlc3MgZHluYW1pYyByb3V0ZXMgcHJvcGVybHlcbiAgICAvLyBUT0RPOiBmaXggdHVyYm9wYWNrIHByb3ZpZGluZyBkaWZmZXJpbmcgdmFsdWUgZnJvbSB3ZWJwYWNrXG4gICAgaWYgKHByb2Nlc3MuZW52LlRVUkJPUEFDSykge1xuICAgICAgICBzcmNQYWdlID0gc3JjUGFnZS5yZXBsYWNlKC9cXC9pbmRleCQvLCAnJykgfHwgJy8nO1xuICAgIH0gZWxzZSBpZiAoc3JjUGFnZSA9PT0gJy9pbmRleCcpIHtcbiAgICAgICAgLy8gd2UgYWx3YXlzIG5vcm1hbGl6ZSAvaW5kZXggc3BlY2lmaWNhbGx5XG4gICAgICAgIHNyY1BhZ2UgPSAnLyc7XG4gICAgfVxuICAgIGNvbnN0IG11bHRpWm9uZURyYWZ0TW9kZSA9IHByb2Nlc3MuZW52Ll9fTkVYVF9NVUxUSV9aT05FX0RSQUZUX01PREU7XG4gICAgY29uc3QgcHJlcGFyZVJlc3VsdCA9IGF3YWl0IHJvdXRlTW9kdWxlLnByZXBhcmUocmVxLCByZXMsIHtcbiAgICAgICAgc3JjUGFnZSxcbiAgICAgICAgbXVsdGlab25lRHJhZnRNb2RlXG4gICAgfSk7XG4gICAgaWYgKCFwcmVwYXJlUmVzdWx0KSB7XG4gICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDAwO1xuICAgICAgICByZXMuZW5kKCdCYWQgUmVxdWVzdCcpO1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgeyBidWlsZElkLCBxdWVyeSwgcGFyYW1zLCBwYXJzZWRVcmwsIG9yaWdpbmFsUXVlcnksIG9yaWdpbmFsUGF0aG5hbWUsIGJ1aWxkTWFuaWZlc3QsIG5leHRGb250TWFuaWZlc3QsIHNlcnZlckZpbGVzTWFuaWZlc3QsIHJlYWN0TG9hZGFibGVNYW5pZmVzdCwgcHJlcmVuZGVyTWFuaWZlc3QsIGlzRHJhZnRNb2RlLCBpc09uRGVtYW5kUmV2YWxpZGF0ZSwgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsIGxvY2FsZSwgbG9jYWxlcywgZGVmYXVsdExvY2FsZSwgcm91dGVyU2VydmVyQ29udGV4dCwgbmV4dENvbmZpZywgcmVzb2x2ZWRQYXRobmFtZSB9ID0gcHJlcGFyZVJlc3VsdDtcbiAgICBjb25zdCBpc0V4cGVyaW1lbnRhbENvbXBpbGUgPSBzZXJ2ZXJGaWxlc01hbmlmZXN0ID09IG51bGwgPyB2b2lkIDAgOiAoX3NlcnZlckZpbGVzTWFuaWZlc3RfY29uZmlnID0gc2VydmVyRmlsZXNNYW5pZmVzdC5jb25maWcpID09IG51bGwgPyB2b2lkIDAgOiAoX3NlcnZlckZpbGVzTWFuaWZlc3RfY29uZmlnX2V4cGVyaW1lbnRhbCA9IF9zZXJ2ZXJGaWxlc01hbmlmZXN0X2NvbmZpZy5leHBlcmltZW50YWwpID09IG51bGwgPyB2b2lkIDAgOiBfc2VydmVyRmlsZXNNYW5pZmVzdF9jb25maWdfZXhwZXJpbWVudGFsLmlzRXhwZXJpbWVudGFsQ29tcGlsZTtcbiAgICBjb25zdCBoYXNTZXJ2ZXJQcm9wcyA9IEJvb2xlYW4oZ2V0U2VydmVyU2lkZVByb3BzKTtcbiAgICBjb25zdCBoYXNTdGF0aWNQcm9wcyA9IEJvb2xlYW4oZ2V0U3RhdGljUHJvcHMpO1xuICAgIGNvbnN0IGhhc1N0YXRpY1BhdGhzID0gQm9vbGVhbihnZXRTdGF0aWNQYXRocyk7XG4gICAgY29uc3QgaGFzR2V0SW5pdGlhbFByb3BzID0gQm9vbGVhbigodXNlcmxhbmQuZGVmYXVsdCB8fCB1c2VybGFuZCkuZ2V0SW5pdGlhbFByb3BzKTtcbiAgICBjb25zdCBpc0FtcCA9IHF1ZXJ5LmFtcCAmJiBjb25maWcuYW1wO1xuICAgIGxldCBjYWNoZUtleSA9IG51bGw7XG4gICAgbGV0IGlzSXNyRmFsbGJhY2sgPSBmYWxzZTtcbiAgICBsZXQgaXNOZXh0RGF0YVJlcXVlc3QgPSBwcmVwYXJlUmVzdWx0LmlzTmV4dERhdGFSZXF1ZXN0ICYmIChoYXNTdGF0aWNQcm9wcyB8fCBoYXNTZXJ2ZXJQcm9wcyk7XG4gICAgY29uc3QgaXM0MDRQYWdlID0gc3JjUGFnZSA9PT0gJy80MDQnO1xuICAgIGNvbnN0IGlzNTAwUGFnZSA9IHNyY1BhZ2UgPT09ICcvNTAwJztcbiAgICBjb25zdCBpc0Vycm9yUGFnZSA9IHNyY1BhZ2UgPT09ICcvX2Vycm9yJztcbiAgICBpZiAoIXJvdXRlTW9kdWxlLmlzRGV2ICYmICFpc0RyYWZ0TW9kZSAmJiBoYXNTdGF0aWNQcm9wcykge1xuICAgICAgICBjYWNoZUtleSA9IGAke2xvY2FsZSA/IGAvJHtsb2NhbGV9YCA6ICcnfSR7KHNyY1BhZ2UgPT09ICcvJyB8fCByZXNvbHZlZFBhdGhuYW1lID09PSAnLycpICYmIGxvY2FsZSA/ICcnIDogcmVzb2x2ZWRQYXRobmFtZX0ke2lzQW1wID8gJy5hbXAnIDogJyd9YDtcbiAgICAgICAgaWYgKGlzNDA0UGFnZSB8fCBpczUwMFBhZ2UgfHwgaXNFcnJvclBhZ2UpIHtcbiAgICAgICAgICAgIGNhY2hlS2V5ID0gYCR7bG9jYWxlID8gYC8ke2xvY2FsZX1gIDogJyd9JHtzcmNQYWdlfSR7aXNBbXAgPyAnLmFtcCcgOiAnJ31gO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVuc3VyZSAvaW5kZXggYW5kIC8gaXMgbm9ybWFsaXplZCB0byBvbmUga2V5XG4gICAgICAgIGNhY2hlS2V5ID0gY2FjaGVLZXkgPT09ICcvaW5kZXgnID8gJy8nIDogY2FjaGVLZXk7XG4gICAgfVxuICAgIGlmIChoYXNTdGF0aWNQYXRocyAmJiAhaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgY29uc3QgZGVjb2RlZFBhdGhuYW1lID0gcmVtb3ZlVHJhaWxpbmdTbGFzaChsb2NhbGUgPyBhZGRQYXRoUHJlZml4KHJlc29sdmVkUGF0aG5hbWUsIGAvJHtsb2NhbGV9YCkgOiByZXNvbHZlZFBhdGhuYW1lKTtcbiAgICAgICAgY29uc3QgaXNQcmVyZW5kZXJlZCA9IEJvb2xlYW4ocHJlcmVuZGVyTWFuaWZlc3Qucm91dGVzW2RlY29kZWRQYXRobmFtZV0pIHx8IHByZXJlbmRlck1hbmlmZXN0Lm5vdEZvdW5kUm91dGVzLmluY2x1ZGVzKGRlY29kZWRQYXRobmFtZSk7XG4gICAgICAgIGNvbnN0IHByZXJlbmRlckluZm8gPSBwcmVyZW5kZXJNYW5pZmVzdC5keW5hbWljUm91dGVzW3NyY1BhZ2VdO1xuICAgICAgICBpZiAocHJlcmVuZGVySW5mbykge1xuICAgICAgICAgICAgaWYgKHByZXJlbmRlckluZm8uZmFsbGJhY2sgPT09IGZhbHNlICYmICFpc1ByZXJlbmRlcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vRmFsbGJhY2tFcnJvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwcmVyZW5kZXJJbmZvLmZhbGxiYWNrID09PSAnc3RyaW5nJyAmJiAhaXNQcmVyZW5kZXJlZCAmJiAhaXNOZXh0RGF0YVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICBpc0lzckZhbGxiYWNrID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBXaGVuIHNlcnZpbmcgYSBib3QgcmVxdWVzdCwgd2Ugd2FudCB0byBzZXJ2ZSBhIGJsb2NraW5nIHJlbmRlciBhbmQgbm90XG4gICAgLy8gdGhlIHByZXJlbmRlcmVkIHBhZ2UuIFRoaXMgZW5zdXJlcyB0aGF0IHRoZSBjb3JyZWN0IGNvbnRlbnQgaXMgc2VydmVkXG4gICAgLy8gdG8gdGhlIGJvdCBpbiB0aGUgaGVhZC5cbiAgICBpZiAoaXNJc3JGYWxsYmFjayAmJiBpc0JvdChyZXEuaGVhZGVyc1sndXNlci1hZ2VudCddIHx8ICcnKSB8fCBnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpKSB7XG4gICAgICAgIGlzSXNyRmFsbGJhY2sgPSBmYWxzZTtcbiAgICB9XG4gICAgY29uc3QgdHJhY2VyID0gZ2V0VHJhY2VyKCk7XG4gICAgY29uc3QgYWN0aXZlU3BhbiA9IHRyYWNlci5nZXRBY3RpdmVTY29wZVNwYW4oKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBtZXRob2QgPSByZXEubWV0aG9kIHx8ICdHRVQnO1xuICAgICAgICBjb25zdCByZXNvbHZlZFVybCA9IGZvcm1hdFVybCh7XG4gICAgICAgICAgICBwYXRobmFtZTogbmV4dENvbmZpZy50cmFpbGluZ1NsYXNoID8gcGFyc2VkVXJsLnBhdGhuYW1lIDogcmVtb3ZlVHJhaWxpbmdTbGFzaChwYXJzZWRVcmwucGF0aG5hbWUgfHwgJy8nKSxcbiAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0byBvbmx5IGFkZCBxdWVyeSB2YWx1ZXMgZnJvbSBvcmlnaW5hbCBVUkxcbiAgICAgICAgICAgIHF1ZXJ5OiBoYXNTdGF0aWNQcm9wcyA/IHt9IDogb3JpZ2luYWxRdWVyeVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcHVibGljUnVudGltZUNvbmZpZyA9IChyb3V0ZXJTZXJ2ZXJDb250ZXh0ID09IG51bGwgPyB2b2lkIDAgOiByb3V0ZXJTZXJ2ZXJDb250ZXh0LnB1YmxpY1J1bnRpbWVDb25maWcpIHx8IG5leHRDb25maWcucHVibGljUnVudGltZUNvbmZpZztcbiAgICAgICAgY29uc3QgaGFuZGxlUmVzcG9uc2UgPSBhc3luYyAoc3Bhbik9PntcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlR2VuZXJhdG9yID0gYXN5bmMgKHsgcHJldmlvdXNDYWNoZUVudHJ5IH0pPT57XG4gICAgICAgICAgICAgICAgdmFyIF9wcmV2aW91c0NhY2hlRW50cnlfdmFsdWU7XG4gICAgICAgICAgICAgICAgY29uc3QgZG9SZW5kZXIgPSBhc3luYyAoKT0+e1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9uZXh0Q29uZmlnX2kxOG4sIF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbF9hbXAsIF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbF9hbXAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHJvdXRlTW9kdWxlLnJlbmRlcihyZXEsIHJlcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5OiBoYXNTdGF0aWNQcm9wcyAmJiAhaXNFeHBlcmltZW50YWxDb21waWxlID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5wYXJhbXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmlzQW1wID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1wOiBxdWVyeS5hbXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IHt9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4ucXVlcnksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2U6IHNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyQ29udGV4dDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0RyYWZ0TW9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNGYWxsYmFjazogaXNJc3JGYWxsYmFjayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2ZWxvcG1lbnROb3RGb3VuZFNvdXJjZVBhZ2U6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2RldmVsb3BtZW50Tm90Rm91bmRTb3VyY2VQYWdlJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZENvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGRJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tU2VydmVyOiBCb29sZWFuKHJvdXRlclNlcnZlckNvbnRleHQgPT0gbnVsbCA/IHZvaWQgMCA6IHJvdXRlclNlcnZlckNvbnRleHQuaXNDdXN0b21TZXJ2ZXIpIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwbG95bWVudElkOiBwcm9jZXNzLmVudi5ORVhUX0RFUExPWU1FTlRfSURcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlck9wdHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZU1vZHVsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZTogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUNvbmZpZzogY29uZmlnIHx8IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb21wb25lbnQ6IGludGVyb3BEZWZhdWx0KHVzZXJsYW5kKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29tcG9uZW50TW9kOiB1c2VybGFuZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0U3RhdGljUHJvcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFN0YXRpY1BhdGhzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRTZXJ2ZXJTaWRlUHJvcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlOiAhaGFzU3RhdGljUHJvcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkTWFuaWZlc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRGb250TWFuaWZlc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWN0TG9hZGFibGVNYW5pZmVzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzZXRQcmVmaXg6IG5leHRDb25maWcuYXNzZXRQcmVmaXgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmljdE5leHRIZWFkOiBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5zdHJpY3ROZXh0SGVhZCA/PyB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3UHJvcHM6IHByZXJlbmRlck1hbmlmZXN0LnByZXZpZXcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlczogbmV4dENvbmZpZy5pbWFnZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDb25maWdPdXRwdXQ6IG5leHRDb25maWcub3V0cHV0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpbWl6ZUNzczogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5vcHRpbWl6ZUNzcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRTY3JpcHRXb3JrZXJzOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLm5leHRTY3JpcHRXb3JrZXJzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9tYWluTG9jYWxlczogKF9uZXh0Q29uZmlnX2kxOG4gPSBuZXh0Q29uZmlnLmkxOG4pID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19pMThuLmRvbWFpbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyb3NzT3JpZ2luOiBuZXh0Q29uZmlnLmNyb3NzT3JpZ2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtdWx0aVpvbmVEcmFmdE1vZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VQYXRoOiBuZXh0Q29uZmlnLmJhc2VQYXRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW5vbmljYWxCYXNlOiBuZXh0Q29uZmlnLmFtcC5jYW5vbmljYWxCYXNlIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBPcHRpbWl6ZXJDb25maWc6IChfbmV4dENvbmZpZ19leHBlcmltZW50YWxfYW1wID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwuYW1wKSA9PSBudWxsID8gdm9pZCAwIDogX25leHRDb25maWdfZXhwZXJpbWVudGFsX2FtcC5vcHRpbWl6ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVPcHRpbWl6ZWRMb2FkaW5nOiBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5kaXNhYmxlT3B0aW1pemVkTG9hZGluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFyZ2VQYWdlRGF0YUJ5dGVzOiBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5sYXJnZVBhZ2VEYXRhQnl0ZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9ubHkgdGhlIGBwdWJsaWNSdW50aW1lQ29uZmlnYCBrZXkgaXMgZXhwb3NlZCB0byB0aGUgY2xpZW50IHNpZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSXQnbGwgYmUgcmVuZGVyZWQgYXMgcGFydCBvZiBfX05FWFRfREFUQV9fIG9uIHRoZSBjbGllbnQgc2lkZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW50aW1lQ29uZmlnOiBPYmplY3Qua2V5cyhwdWJsaWNSdW50aW1lQ29uZmlnKS5sZW5ndGggPiAwID8gcHVibGljUnVudGltZUNvbmZpZyA6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNFeHBlcmltZW50YWxDb21waWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBlcmltZW50YWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudFRyYWNlTWV0YWRhdGE6IG5leHRDb25maWcuZXhwZXJpbWVudGFsLmNsaWVudFRyYWNlTWV0YWRhdGEgfHwgW11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0TG9jYWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRJc3JTdGF0dXM6IHJvdXRlclNlcnZlckNvbnRleHQgPT0gbnVsbCA/IHZvaWQgMCA6IHJvdXRlclNlcnZlckNvbnRleHQuc2V0SXNyU3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc05leHREYXRhUmVxdWVzdDogaXNOZXh0RGF0YVJlcXVlc3QgJiYgKGhhc1NlcnZlclByb3BzIHx8IGhhc1N0YXRpY1Byb3BzKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBnZXRTZXJ2ZXJTaWRlUHJvcHMgYW5kIGdldEluaXRpYWxQcm9wcyB3ZSBuZWVkIHRvIGVuc3VyZSB3ZSB1c2UgdGhlIG9yaWdpbmFsIFVSTFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgbm90IHRoZSByZXNvbHZlZCBVUkwgdG8gcHJldmVudCBhIGh5ZHJhdGlvbiBtaXNtYXRjaCBvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhc1BhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZWRBc1BhdGg6IGhhc1NlcnZlclByb3BzIHx8IGhhc0dldEluaXRpYWxQcm9wcyA/IGZvcm1hdFVybCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSB1c2UgdGhlIG9yaWdpbmFsIFVSTCBwYXRobmFtZSBsZXNzIHRoZSBfbmV4dC9kYXRhIHByZWZpeCBpZlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJlc2VudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aG5hbWU6IGlzTmV4dERhdGFSZXF1ZXN0ID8gbm9ybWFsaXplRGF0YVBhdGgob3JpZ2luYWxQYXRobmFtZSkgOiBvcmlnaW5hbFBhdGhuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnk6IG9yaWdpbmFsUXVlcnlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgOiByZXNvbHZlZFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEVycm9yRGVidWc6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ1BhZ2VzRXJyb3JEZWJ1ZycpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnI6IGdldFJlcXVlc3RNZXRhKHJlcSwgJ2ludm9rZUVycm9yJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldjogcm91dGVNb2R1bGUuaXNEZXYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5lZWRlZCBmb3IgZXhwZXJpbWVudGFsLm9wdGltaXplQ3NzIGZlYXR1cmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdERpcjogYCR7cm91dGVNb2R1bGUucHJvamVjdERpcn0vJHtyb3V0ZU1vZHVsZS5kaXN0RGlyfWAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcFNraXBWYWxpZGF0aW9uOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsX2FtcDEgPSBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5hbXApID09IG51bGwgPyB2b2lkIDAgOiBfbmV4dENvbmZpZ19leHBlcmltZW50YWxfYW1wMS5za2lwVmFsaWRhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1wVmFsaWRhdG9yOiBnZXRSZXF1ZXN0TWV0YShyZXEsICdhbXBWYWxpZGF0b3InKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlbmRlclJlc3VsdCk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG1ldGFkYXRhIH0gPSByZW5kZXJSZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNhY2hlQ29udHJvbCA9IG1ldGFkYXRhLmNhY2hlQ29udHJvbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ2lzTm90Rm91bmQnIGluIG1ldGFkYXRhICYmIG1ldGFkYXRhLmlzTm90Rm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVDb250cm9sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhhbmRsZSBgaXNSZWRpcmVjdGAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhLmlzUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLlJFRElSRUNULFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzOiBtZXRhZGF0YS5wYWdlRGF0YSA/PyBtZXRhZGF0YS5mbGlnaHREYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVDb250cm9sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBDYWNoZWRSb3V0ZUtpbmQuUEFHRVMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sOiByZW5kZXJSZXN1bHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlRGF0YTogcmVuZGVyUmVzdWx0Lm1ldGFkYXRhLnBhZ2VEYXRhLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogcmVuZGVyUmVzdWx0Lm1ldGFkYXRhLmhlYWRlcnMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHJlbmRlclJlc3VsdC5tZXRhZGF0YS5zdGF0dXNDb2RlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5maW5hbGx5KCgpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzcGFuKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAuc3RhdHVzX2NvZGUnOiByZXMuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucnNjJzogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb290U3BhbkF0dHJpYnV0ZXMgPSB0cmFjZXIuZ2V0Um9vdFNwYW5BdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2Ugd2VyZSB1bmFibGUgdG8gZ2V0IGF0dHJpYnV0ZXMsIHByb2JhYmx5IE9URUwgaXMgbm90IGVuYWJsZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJvb3RTcGFuQXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpICE9PSBCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihgVW5leHBlY3RlZCByb290IHNwYW4gdHlwZSAnJHtyb290U3BhbkF0dHJpYnV0ZXMuZ2V0KCduZXh0LnNwYW5fdHlwZScpfScuIFBsZWFzZSByZXBvcnQgdGhpcyBOZXh0LmpzIGlzc3VlIGh0dHBzOi8vZ2l0aHViLmNvbS92ZXJjZWwvbmV4dC5qc2ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvdXRlID0gcm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5yb3V0ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyb3V0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gYCR7bWV0aG9kfSAke3JvdXRlfWA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5yb3V0ZSc6IHJvdXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnNwYW5fbmFtZSc6IG5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW4udXBkYXRlTmFtZShuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUoYCR7bWV0aG9kfSAke3JlcS51cmx9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhIGJhY2tncm91bmQgcmV2YWxpZGF0ZSB3ZSBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHJlcXVlc3QgZXJyb3IgaGVyZSBhcyBpdCB3b24ndCBiZSBidWJibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNDYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiBwcmV2aW91c0NhY2hlRW50cnkuaXNTdGFsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlTW9kdWxlLm9uUmVxdWVzdEVycm9yKHJlcSwgZXJyLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlcktpbmQ6ICdQYWdlcyBSb3V0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IHNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlVHlwZTogJ3JlbmRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGVSZWFzb246IGdldFJldmFsaWRhdGVSZWFzb24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNSZXZhbGlkYXRlOiBoYXNTdGF0aWNQcm9wcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIC8vIGlmIHdlJ3ZlIGFscmVhZHkgZ2VuZXJhdGVkIHRoaXMgcGFnZSB3ZSBubyBsb25nZXJcbiAgICAgICAgICAgICAgICAvLyBzZXJ2ZSB0aGUgZmFsbGJhY2tcbiAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNDYWNoZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlzSXNyRmFsbGJhY2sgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzSXNyRmFsbGJhY2spIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmFsbGJhY2tSZXNwb25zZSA9IGF3YWl0IHJvdXRlTW9kdWxlLmdldFJlc3BvbnNlQ2FjaGUocmVxKS5nZXQocm91dGVNb2R1bGUuaXNEZXYgPyBudWxsIDogbG9jYWxlID8gYC8ke2xvY2FsZX0ke3NyY1BhZ2V9YCA6IHNyY1BhZ2UsIGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeTogcHJldmlvdXNGYWxsYmFja0NhY2hlRW50cnkgPSBudWxsIH0pPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJvdXRlTW9kdWxlLmlzRGV2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvUmVzcG9uc2VDYWNoZUVudHJ5KHByZXZpb3VzRmFsbGJhY2tDYWNoZUVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkb1JlbmRlcigpO1xuICAgICAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICByb3V0ZUtpbmQ6IFJvdXRlS2luZC5QQUdFUyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRmFsbGJhY2s6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1JvdXRlUFBSRW5hYmxlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnRhbENhY2hlOiBhd2FpdCByb3V0ZU1vZHVsZS5nZXRJbmNyZW1lbnRhbENhY2hlKHJlcSwgbmV4dENvbmZpZywgcHJlcmVuZGVyTWFuaWZlc3QpLFxuICAgICAgICAgICAgICAgICAgICAgICAgd2FpdFVudGlsOiBjdHgud2FpdFVudGlsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZmFsbGJhY2tSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBjYWNoZSBjb250cm9sIGZyb20gdGhlIHJlc3BvbnNlIHRvIHByZXZlbnQgaXQgZnJvbSBiZWluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlZCBpbiB0aGUgc3Vycm91bmRpbmcgY2FjaGUuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgZmFsbGJhY2tSZXNwb25zZS5jYWNoZUNvbnRyb2w7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYWxsYmFja1Jlc3BvbnNlLmlzTWlzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsbGJhY2tSZXNwb25zZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgaXNPbkRlbWFuZFJldmFsaWRhdGUgJiYgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQgJiYgIXByZXZpb3VzQ2FjaGVFbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICAgICAgLy8gb24tZGVtYW5kIHJldmFsaWRhdGUgYWx3YXlzIHNldHMgdGhpcyBoZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcigneC1uZXh0anMtY2FjaGUnLCAnUkVWQUxJREFURUQnKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGlzSXNyRmFsbGJhY2sgJiYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogKF9wcmV2aW91c0NhY2hlRW50cnlfdmFsdWUgPSBwcmV2aW91c0NhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfcHJldmlvdXNDYWNoZUVudHJ5X3ZhbHVlLmtpbmQpID09PSBDYWNoZWRSb3V0ZUtpbmQuUEFHRVMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLlBBR0VTLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWw6IG5ldyBSZW5kZXJSZXN1bHQoQnVmZmVyLmZyb20ocHJldmlvdXNDYWNoZUVudHJ5LnZhbHVlLmh0bWwpLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAndGV4dC9odG1sO3V0Zi04JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6IHByZXZpb3VzQ2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBwcmV2aW91c0NhY2hlRW50cnkudmFsdWUuaGVhZGVyc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZURhdGE6IHt9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogcHJldmlvdXNDYWNoZUVudHJ5LnZhbHVlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBwcmV2aW91c0NhY2hlRW50cnkudmFsdWUuaGVhZGVyc1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRvUmVuZGVyKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcm91dGVNb2R1bGUuaGFuZGxlUmVzcG9uc2Uoe1xuICAgICAgICAgICAgICAgIGNhY2hlS2V5LFxuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBuZXh0Q29uZmlnLFxuICAgICAgICAgICAgICAgIHJvdXRlS2luZDogUm91dGVLaW5kLlBBR0VTLFxuICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLFxuICAgICAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbCxcbiAgICAgICAgICAgICAgICByZXNwb25zZUdlbmVyYXRvcjogcmVzcG9uc2VHZW5lcmF0b3IsXG4gICAgICAgICAgICAgICAgcHJlcmVuZGVyTWFuaWZlc3RcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gaWYgd2UgZ290IGEgY2FjaGUgaGl0IHRoaXMgd2Fzbid0IGFuIElTUiBmYWxsYmFja1xuICAgICAgICAgICAgLy8gYnV0IGl0IHdhc24ndCBnZW5lcmF0ZWQgZHVyaW5nIGJ1aWxkIHNvIGlzbid0IGluIHRoZVxuICAgICAgICAgICAgLy8gcHJlcmVuZGVyLW1hbmlmZXN0XG4gICAgICAgICAgICBpZiAoaXNJc3JGYWxsYmFjayAmJiAhKHJlc3VsdCA9PSBudWxsID8gdm9pZCAwIDogcmVzdWx0LmlzTWlzcykpIHtcbiAgICAgICAgICAgICAgICBpc0lzckZhbGxiYWNrID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyByZXNwb25zZSBpcyBmaW5pc2hlZCBpcyBubyBjYWNoZSBlbnRyeVxuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFzU3RhdGljUHJvcHMgJiYgIWdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCd4LW5leHRqcy1jYWNoZScsIGlzT25EZW1hbmRSZXZhbGlkYXRlID8gJ1JFVkFMSURBVEVEJyA6IHJlc3VsdC5pc01pc3MgPyAnTUlTUycgOiByZXN1bHQuaXNTdGFsZSA/ICdTVEFMRScgOiAnSElUJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgY2FjaGVDb250cm9sO1xuICAgICAgICAgICAgaWYgKCFoYXNTdGF0aWNQcm9wcyB8fCBpc0lzckZhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXMuZ2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJykpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVDb250cm9sID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZTogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChpczQwNFBhZ2UpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBub3RGb3VuZFJldmFsaWRhdGUgPSBnZXRSZXF1ZXN0TWV0YShyZXEsICdub3RGb3VuZFJldmFsaWRhdGUnKTtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbnRyb2wgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGU6IHR5cGVvZiBub3RGb3VuZFJldmFsaWRhdGUgPT09ICd1bmRlZmluZWQnID8gMCA6IG5vdEZvdW5kUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgZXhwaXJlOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpczUwMFBhZ2UpIHtcbiAgICAgICAgICAgICAgICBjYWNoZUNvbnRyb2wgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGU6IDAsXG4gICAgICAgICAgICAgICAgICAgIGV4cGlyZTogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LmNhY2hlQ29udHJvbCkge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBjYWNoZSBlbnRyeSBoYXMgYSBjYWNoZSBjb250cm9sIHdpdGggYSByZXZhbGlkYXRlIHZhbHVlIHRoYXQnc1xuICAgICAgICAgICAgICAgIC8vIGEgbnVtYmVyLCB1c2UgaXQuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiByZXN1bHQuY2FjaGVDb250cm9sLnJldmFsaWRhdGUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfcmVzdWx0X2NhY2hlQ29udHJvbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jYWNoZUNvbnRyb2wucmV2YWxpZGF0ZSA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXcgRXJyb3IoYEludmFsaWQgcmV2YWxpZGF0ZSBjb25maWd1cmF0aW9uIHByb3ZpZGVkOiAke3Jlc3VsdC5jYWNoZUNvbnRyb2wucmV2YWxpZGF0ZX0gPCAxYCksIFwiX19ORVhUX0VSUk9SX0NPREVcIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBcIkUyMlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FjaGVDb250cm9sID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZTogcmVzdWx0LmNhY2hlQ29udHJvbC5yZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlOiAoKF9yZXN1bHRfY2FjaGVDb250cm9sID0gcmVzdWx0LmNhY2hlQ29udHJvbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9yZXN1bHRfY2FjaGVDb250cm9sLmV4cGlyZSkgPz8gbmV4dENvbmZpZy5leHBpcmVUaW1lXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV2YWxpZGF0ZTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgY2FjaGVDb250cm9sID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV2YWxpZGF0ZTogQ0FDSEVfT05FX1lFQVIsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmU6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIGNhY2hlIGNvbnRyb2wgaXMgYWxyZWFkeSBzZXQgb24gdGhlIHJlc3BvbnNlIHdlIGRvbid0XG4gICAgICAgICAgICAvLyBvdmVycmlkZSBpdCB0byBhbGxvdyB1c2VycyB0byBjdXN0b21pemUgaXQgdmlhIG5leHQuY29uZmlnXG4gICAgICAgICAgICBpZiAoY2FjaGVDb250cm9sICYmICFyZXMuZ2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJykpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgZ2V0Q2FjaGVDb250cm9sSGVhZGVyKGNhY2hlQ29udHJvbCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbm90Rm91bmQ6IHRydWUgY2FzZVxuICAgICAgICAgICAgaWYgKCFyZXN1bHQudmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3Jlc3VsdF9jYWNoZUNvbnRyb2wxO1xuICAgICAgICAgICAgICAgIC8vIGFkZCByZXZhbGlkYXRlIG1ldGFkYXRhIGJlZm9yZSByZW5kZXJpbmcgNDA0IHBhZ2VcbiAgICAgICAgICAgICAgICAvLyBzbyB0aGF0IHdlIGNhbiB1c2UgdGhpcyBhcyBzb3VyY2Ugb2YgdHJ1dGggZm9yIHRoZVxuICAgICAgICAgICAgICAgIC8vIGNhY2hlLWNvbnRyb2wgaGVhZGVyIGluc3RlYWQgb2Ygd2hhdCB0aGUgNDA0IHBhZ2UgcmV0dXJuc1xuICAgICAgICAgICAgICAgIC8vIGZvciB0aGUgcmV2YWxpZGF0ZSB2YWx1ZVxuICAgICAgICAgICAgICAgIGFkZFJlcXVlc3RNZXRhKHJlcSwgJ25vdEZvdW5kUmV2YWxpZGF0ZScsIChfcmVzdWx0X2NhY2hlQ29udHJvbDEgPSByZXN1bHQuY2FjaGVDb250cm9sKSA9PSBudWxsID8gdm9pZCAwIDogX3Jlc3VsdF9jYWNoZUNvbnRyb2wxLnJldmFsaWRhdGUpO1xuICAgICAgICAgICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDA0O1xuICAgICAgICAgICAgICAgIGlmIChpc05leHREYXRhUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICByZXMuZW5kKCd7XCJub3RGb3VuZFwiOnRydWV9Jyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogc2hvdWxkIHJvdXRlLW1vZHVsZSBpdHNlbGYgaGFuZGxlIHJlbmRlcmluZyB0aGUgNDA0XG4gICAgICAgICAgICAgICAgaWYgKHJvdXRlclNlcnZlckNvbnRleHQgPT0gbnVsbCA/IHZvaWQgMCA6IHJvdXRlclNlcnZlckNvbnRleHQucmVuZGVyNDA0KSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHJvdXRlclNlcnZlckNvbnRleHQucmVuZGVyNDA0KHJlcSwgcmVzLCBwYXJzZWRVcmwsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXMuZW5kKCdUaGlzIHBhZ2UgY291bGQgbm90IGJlIGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUua2luZCA9PT0gQ2FjaGVkUm91dGVLaW5kLlJFRElSRUNUKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzTmV4dERhdGFSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoSlNPTi5zdHJpbmdpZnkocmVzdWx0LnZhbHVlLnByb3BzKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBoYW5kbGVSZWRpcmVjdCA9IChwYWdlRGF0YSk9PntcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZGlyZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uOiBwYWdlRGF0YS5wYWdlUHJvcHMuX19OX1JFRElSRUNULFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6IHBhZ2VEYXRhLnBhZ2VQcm9wcy5fX05fUkVESVJFQ1RfU1RBVFVTLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhc2VQYXRoOiBwYWdlRGF0YS5wYWdlUHJvcHMuX19OX1JFRElSRUNUX0JBU0VfUEFUSFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXR1c0NvZGUgPSBnZXRSZWRpcmVjdFN0YXR1cyhyZWRpcmVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGJhc2VQYXRoIH0gPSBuZXh0Q29uZmlnO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2VQYXRoICYmIHJlZGlyZWN0LmJhc2VQYXRoICE9PSBmYWxzZSAmJiByZWRpcmVjdC5kZXN0aW5hdGlvbi5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdC5kZXN0aW5hdGlvbiA9IGAke2Jhc2VQYXRofSR7cmVkaXJlY3QuZGVzdGluYXRpb259YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWRpcmVjdC5kZXN0aW5hdGlvbi5zdGFydHNXaXRoKCcvJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdC5kZXN0aW5hdGlvbiA9IG5vcm1hbGl6ZVJlcGVhdGVkU2xhc2hlcyhyZWRpcmVjdC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdMb2NhdGlvbicsIHJlZGlyZWN0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGF0dXNDb2RlID09PSBSZWRpcmVjdFN0YXR1c0NvZGUuUGVybWFuZW50UmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdSZWZyZXNoJywgYDA7dXJsPSR7cmVkaXJlY3QuZGVzdGluYXRpb259YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuZW5kKHJlZGlyZWN0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgaGFuZGxlUmVkaXJlY3QocmVzdWx0LnZhbHVlLnByb3BzKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdC52YWx1ZS5raW5kICE9PSBDYWNoZWRSb3V0ZUtpbmQuUEFHRVMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3IEVycm9yKGBJbnZhcmlhbnQ6IHJlY2VpdmVkIG5vbi1wYWdlcyBjYWNoZSBlbnRyeSBpbiBwYWdlcyBoYW5kbGVyYCksIFwiX19ORVhUX0VSUk9SX0NPREVcIiwge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJFNjk1XCIsXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEluIGRldiwgd2Ugc2hvdWxkIG5vdCBjYWNoZSBwYWdlcyBmb3IgYW55IHJlYXNvbi5cbiAgICAgICAgICAgIGlmIChyb3V0ZU1vZHVsZS5pc0Rldikge1xuICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ0NhY2hlLUNvbnRyb2wnLCAnbm8tc3RvcmUsIG11c3QtcmV2YWxpZGF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRHJhZnQgbW9kZSBzaG91bGQgbmV2ZXIgYmUgY2FjaGVkXG4gICAgICAgICAgICBpZiAoaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ3ByaXZhdGUsIG5vLWNhY2hlLCBuby1zdG9yZSwgbWF4LWFnZT0wLCBtdXN0LXJldmFsaWRhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHdoZW4gaW52b2tpbmcgX2Vycm9yIGJlZm9yZSBwYWdlcy81MDAgd2UgZG9uJ3QgYWN0dWFsbHlcbiAgICAgICAgICAgIC8vIHNlbmQgdGhlIF9lcnJvciByZXNwb25zZVxuICAgICAgICAgICAgaWYgKGdldFJlcXVlc3RNZXRhKHJlcSwgJ2N1c3RvbUVycm9yUmVuZGVyJykgfHwgaXNFcnJvclBhZ2UgJiYgZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSAmJiByZXMuc3RhdHVzQ29kZSA9PT0gNTAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhd2FpdCBzZW5kUmVuZGVyUmVzdWx0KHtcbiAgICAgICAgICAgICAgICByZXEsXG4gICAgICAgICAgICAgICAgcmVzLFxuICAgICAgICAgICAgICAgIC8vIElmIHdlIGFyZSByZW5kZXJpbmcgdGhlIGVycm9yIHBhZ2UgaXQncyBub3QgYSBkYXRhIHJlcXVlc3RcbiAgICAgICAgICAgICAgICAvLyBhbnltb3JlXG4gICAgICAgICAgICAgICAgcmVzdWx0OiBpc05leHREYXRhUmVxdWVzdCAmJiAhaXNFcnJvclBhZ2UgJiYgIWlzNTAwUGFnZSA/IG5ldyBSZW5kZXJSZXN1bHQoQnVmZmVyLmZyb20oSlNPTi5zdHJpbmdpZnkocmVzdWx0LnZhbHVlLnBhZ2VEYXRhKSksIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGE6IHJlc3VsdC52YWx1ZS5odG1sLm1ldGFkYXRhXG4gICAgICAgICAgICAgICAgfSkgOiByZXN1bHQudmFsdWUuaHRtbCxcbiAgICAgICAgICAgICAgICBnZW5lcmF0ZUV0YWdzOiBuZXh0Q29uZmlnLmdlbmVyYXRlRXRhZ3MsXG4gICAgICAgICAgICAgICAgcG93ZXJlZEJ5SGVhZGVyOiBuZXh0Q29uZmlnLnBvd2VyZWRCeUhlYWRlcixcbiAgICAgICAgICAgICAgICBjYWNoZUNvbnRyb2w6IHJvdXRlTW9kdWxlLmlzRGV2ID8gdW5kZWZpbmVkIDogY2FjaGVDb250cm9sLFxuICAgICAgICAgICAgICAgIHR5cGU6IGlzTmV4dERhdGFSZXF1ZXN0ID8gJ2pzb24nIDogJ2h0bWwnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gVE9ETzogYWN0aXZlU3BhbiBjb2RlIHBhdGggaXMgZm9yIHdoZW4gd3JhcHBlZCBieVxuICAgICAgICAvLyBuZXh0LXNlcnZlciBjYW4gYmUgcmVtb3ZlZCB3aGVuIHRoaXMgaXMgbm8gbG9uZ2VyIHVzZWRcbiAgICAgICAgaWYgKGFjdGl2ZVNwYW4pIHtcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlc3BvbnNlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0cmFjZXIud2l0aFByb3BhZ2F0ZWRDb250ZXh0KHJlcS5oZWFkZXJzLCAoKT0+dHJhY2VyLnRyYWNlKEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbk5hbWU6IGAke21ldGhvZH0gJHtyZXEudXJsfWAsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAubWV0aG9kJzogbWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaGFuZGxlUmVzcG9uc2UpKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBOb0ZhbGxiYWNrRXJyb3IpKSB7XG4gICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xuICAgICAgICAgICAgICAgIHJvdXRlcktpbmQ6ICdQYWdlcyBSb3V0ZXInLFxuICAgICAgICAgICAgICAgIHJvdXRlUGF0aDogc3JjUGFnZSxcbiAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyZW5kZXInLFxuICAgICAgICAgICAgICAgIHJldmFsaWRhdGVSZWFzb246IGdldFJldmFsaWRhdGVSZWFzb24oe1xuICAgICAgICAgICAgICAgICAgICBpc1JldmFsaWRhdGU6IGhhc1N0YXRpY1Byb3BzLFxuICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9LCByb3V0ZXJTZXJ2ZXJDb250ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZXRocm93IHNvIHRoYXQgd2UgY2FuIGhhbmRsZSBzZXJ2aW5nIGVycm9yIHBhZ2VcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbn1cblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2F&preferredRegion=&absolutePagePath=.%2Fpages%2Findex.tsx&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(pages-dir-node)/./pages/Layout.tsx":
/*!**************************!*\
  !*** ./pages/Layout.tsx ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Layout)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_link__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/link */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/link.js\");\n/* harmony import */ var next_link__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_link__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/router */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/router.js\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _components_AuthContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n/* harmony import */ var _context_AppStateContext__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../context/AppStateContext */ \"(pages-dir-node)/./context/AppStateContext.tsx\");\n/* harmony import */ var _components_LogoutButton__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/LogoutButton */ \"(pages-dir-node)/./components/LogoutButton.tsx\");\n// src/ui/pages/Layout.tsx\n\n\n\n\n\n\n\n// Use a static public path for the logo to avoid bundling object URLs\nconst logoPath = '/assets/grace_logo_gold.png';\nfunction Layout({ children }) {\n    const router = (0,next_router__WEBPACK_IMPORTED_MODULE_3__.useRouter)();\n    const { pathname } = router;\n    const { user } = (0,_components_AuthContext__WEBPACK_IMPORTED_MODULE_4__.useAuth)();\n    const [mobileMenuOpen, setMobileMenuOpen] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Use the AppState context\n    const { dispatch, hydrateFromStorage } = (0,_context_AppStateContext__WEBPACK_IMPORTED_MODULE_5__.useAppState)();\n    // Capture page state on path change\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Layout.useEffect\": ()=>{\n            if (user) {\n                dispatch({\n                    type: 'SET_PAGE_STATE',\n                    payload: {\n                        lastVisitedPath: pathname\n                    }\n                });\n            }\n        }\n    }[\"Layout.useEffect\"], [\n        pathname,\n        user,\n        dispatch\n    ]);\n    // Removed beforeunload prompt to allow smooth navigation\n    // Hydrate state on initial load\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Layout.useEffect\": ()=>{\n            if (user) {\n                hydrateFromStorage({\n                    \"Layout.useEffect\": (path)=>{\n                        router.push(path);\n                    }\n                }[\"Layout.useEffect\"]);\n            }\n        }\n    }[\"Layout.useEffect\"], [\n        user,\n        router,\n        hydrateFromStorage\n    ]);\n    const navLinks = [\n        {\n            name: 'Chat',\n            path: '/chat'\n        },\n        {\n            name: 'Wallet',\n            path: '/wallet'\n        },\n        {\n            name: 'Trading',\n            path: '/trading'\n        },\n        {\n            name: 'Social',\n            path: '/social'\n        },\n        {\n            name: 'Settings',\n            path: '/settings'\n        }\n    ];\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"min-h-screen bg-gradient-to-b from-[#140000] to-black text-white flex flex-col items-center\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"header\", {\n                className: \"w-full max-w-screen-md text-center border-b border-red-700 pb-1 mb-2\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                        src: logoPath,\n                        alt: \"Grace Logo\",\n                        className: \"w-48 md:w-56 mx-auto mt-2 mb-1\"\n                    }, void 0, false, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                        lineNumber: 56,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        className: \"md:hidden absolute right-4 top-6 text-white p-2\",\n                        onClick: ()=>setMobileMenuOpen(!mobileMenuOpen),\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                            xmlns: \"http://www.w3.org/2000/svg\",\n                            className: \"h-6 w-6\",\n                            fill: \"none\",\n                            viewBox: \"0 0 24 24\",\n                            stroke: \"currentColor\",\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                strokeLinecap: \"round\",\n                                strokeLinejoin: \"round\",\n                                strokeWidth: 2,\n                                d: mobileMenuOpen ? \"M6 18L18 6M6 6l12 12\" : \"M4 6h16M4 12h16M4 18h16\"\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                                lineNumber: 64,\n                                columnNumber: 13\n                            }, this)\n                        }, void 0, false, {\n                            fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                            lineNumber: 63,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                        lineNumber: 59,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"nav\", {\n                        className: `\n          ${mobileMenuOpen ? 'flex' : 'hidden'} \n          md:flex \n          flex-col md:flex-row \n          justify-center \n          md:space-x-6 md:space-y-0 \n          space-y-4 \n          text-red-300 text-lg md:text-xl font-mono\n          w-full \n          pb-1\n        `,\n                        children: [\n                            navLinks.map((link)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)((next_link__WEBPACK_IMPORTED_MODULE_2___default()), {\n                                    href: link.path,\n                                    onClick: ()=>setMobileMenuOpen(false),\n                                    className: `transition-all hover:text-red-400 pb-1 ${pathname === link.path ? 'text-red-300 border-b border-red-500' : 'text-white'}`,\n                                    children: link.name\n                                }, link.path, false, {\n                                    fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                                    lineNumber: 81,\n                                    columnNumber: 13\n                                }, this)),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LogoutButton__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {}, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                                lineNumber: 90,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                        lineNumber: 69,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                lineNumber: 55,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"main\", {\n                className: \"w-full max-w-screen-md px-4 py-3 flex-grow\",\n                children: children\n            }, void 0, false, {\n                fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n                lineNumber: 93,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"/home/ubuntu/grace-project/src/ui/pages/Layout.tsx\",\n        lineNumber: 54,\n        columnNumber: 5\n    }, this);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3BhZ2VzL0xheW91dC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMEJBQTBCOztBQUVvQztBQUNqQztBQUNXO0FBQ1k7QUFDSztBQUNIO0FBRXRELHNFQUFzRTtBQUN0RSxNQUFNUSxXQUFXO0FBTUYsU0FBU0MsT0FBTyxFQUFFQyxRQUFRLEVBQWU7SUFDdEQsTUFBTUMsU0FBU1Asc0RBQVNBO0lBQ3hCLE1BQU0sRUFBRVEsUUFBUSxFQUFFLEdBQUdEO0lBQ3JCLE1BQU0sRUFBRUUsSUFBSSxFQUFFLEdBQUdSLGdFQUFPQTtJQUN4QixNQUFNLENBQUNTLGdCQUFnQkMsa0JBQWtCLEdBQUdkLCtDQUFRQSxDQUFDO0lBRXJELDJCQUEyQjtJQUMzQixNQUFNLEVBQUVlLFFBQVEsRUFBRUMsa0JBQWtCLEVBQUUsR0FBR1gscUVBQVdBO0lBRXBELG9DQUFvQztJQUNwQ0osZ0RBQVNBOzRCQUFDO1lBQ1IsSUFBSVcsTUFBTTtnQkFDUkcsU0FBUztvQkFDUEUsTUFBTTtvQkFDTkMsU0FBUzt3QkFBRUMsaUJBQWlCUjtvQkFBUztnQkFDdkM7WUFDRjtRQUNGOzJCQUFHO1FBQUNBO1FBQVVDO1FBQU1HO0tBQVM7SUFFN0IseURBQXlEO0lBRXpELGdDQUFnQztJQUNoQ2QsZ0RBQVNBOzRCQUFDO1lBQ1IsSUFBSVcsTUFBTTtnQkFDUkk7d0NBQW1CLENBQUNJO3dCQUFXVixPQUFPVyxJQUFJLENBQUNEO29CQUFPOztZQUNwRDtRQUNGOzJCQUFHO1FBQUNSO1FBQU1GO1FBQVFNO0tBQW1CO0lBRXJDLE1BQU1NLFdBQVc7UUFDZjtZQUFFQyxNQUFNO1lBQVFILE1BQU07UUFBUTtRQUM5QjtZQUFFRyxNQUFNO1lBQVVILE1BQU07UUFBVTtRQUNsQztZQUFFRyxNQUFNO1lBQVdILE1BQU07UUFBVztRQUNwQztZQUFFRyxNQUFNO1lBQVVILE1BQU07UUFBVTtRQUNsQztZQUFFRyxNQUFNO1lBQVlILE1BQU07UUFBWTtLQUN2QztJQUVELHFCQUNFLDhEQUFDSTtRQUFJQyxXQUFVOzswQkFDYiw4REFBQ0M7Z0JBQU9ELFdBQVU7O2tDQUNoQiw4REFBQ0U7d0JBQUlDLEtBQUtyQjt3QkFBVXNCLEtBQUk7d0JBQWFKLFdBQVU7Ozs7OztrQ0FHL0MsOERBQUNLO3dCQUNDTCxXQUFVO3dCQUNWTSxTQUFTLElBQU1qQixrQkFBa0IsQ0FBQ0Q7a0NBRWxDLDRFQUFDbUI7NEJBQUlDLE9BQU07NEJBQTZCUixXQUFVOzRCQUFVUyxNQUFLOzRCQUFPQyxTQUFROzRCQUFZQyxRQUFPO3NDQUNqRyw0RUFBQ2hCO2dDQUFLaUIsZUFBYztnQ0FBUUMsZ0JBQWU7Z0NBQVFDLGFBQWE7Z0NBQUdDLEdBQUczQixpQkFBaUIseUJBQXlCOzs7Ozs7Ozs7Ozs7Ozs7O2tDQUtwSCw4REFBQzRCO3dCQUFJaEIsV0FBVyxDQUFDO1VBQ2YsRUFBRVosaUJBQWlCLFNBQVMsU0FBUzs7Ozs7Ozs7O1FBU3ZDLENBQUM7OzRCQUNFUyxTQUFTb0IsR0FBRyxDQUFDLENBQUNDLHFCQUNiLDhEQUFDekMsa0RBQUlBO29DQUVIMEMsTUFBTUQsS0FBS3ZCLElBQUk7b0NBQ2ZXLFNBQVMsSUFBTWpCLGtCQUFrQjtvQ0FDakNXLFdBQVcsQ0FBQyx1Q0FBdUMsRUFBRWQsYUFBYWdDLEtBQUt2QixJQUFJLEdBQUcseUNBQXlDLGNBQWM7OENBRXBJdUIsS0FBS3BCLElBQUk7bUNBTExvQixLQUFLdkIsSUFBSTs7Ozs7MENBUWxCLDhEQUFDZCxnRUFBWUE7Ozs7Ozs7Ozs7Ozs7Ozs7OzBCQUdqQiw4REFBQ3VDO2dCQUFLcEIsV0FBVTswQkFDYmhCOzs7Ozs7Ozs7Ozs7QUFJVCIsInNvdXJjZXMiOlsiL2hvbWUvdWJ1bnR1L2dyYWNlLXByb2plY3Qvc3JjL3VpL3BhZ2VzL0xheW91dC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3VpL3BhZ2VzL0xheW91dC50c3hcblxuaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIFJlYWN0Tm9kZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBMaW5rIGZyb20gJ25leHQvbGluayc7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcic7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnLi4vY29tcG9uZW50cy9BdXRoQ29udGV4dCc7XG5pbXBvcnQgeyB1c2VBcHBTdGF0ZSB9IGZyb20gJy4uL2NvbnRleHQvQXBwU3RhdGVDb250ZXh0JztcbmltcG9ydCBMb2dvdXRCdXR0b24gZnJvbSAnLi4vY29tcG9uZW50cy9Mb2dvdXRCdXR0b24nO1xuXG4vLyBVc2UgYSBzdGF0aWMgcHVibGljIHBhdGggZm9yIHRoZSBsb2dvIHRvIGF2b2lkIGJ1bmRsaW5nIG9iamVjdCBVUkxzXG5jb25zdCBsb2dvUGF0aCA9ICcvYXNzZXRzL2dyYWNlX2xvZ29fZ29sZC5wbmcnO1xuXG5pbnRlcmZhY2UgTGF5b3V0UHJvcHMge1xuICBjaGlsZHJlbj86IFJlYWN0Tm9kZTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gTGF5b3V0KHsgY2hpbGRyZW4gfTogTGF5b3V0UHJvcHMpIHtcbiAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XG4gIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHJvdXRlcjtcbiAgY29uc3QgeyB1c2VyIH0gPSB1c2VBdXRoKCk7XG4gIGNvbnN0IFttb2JpbGVNZW51T3Blbiwgc2V0TW9iaWxlTWVudU9wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIFVzZSB0aGUgQXBwU3RhdGUgY29udGV4dFxuICBjb25zdCB7IGRpc3BhdGNoLCBoeWRyYXRlRnJvbVN0b3JhZ2UgfSA9IHVzZUFwcFN0YXRlKCk7XG4gIFxuICAvLyBDYXB0dXJlIHBhZ2Ugc3RhdGUgb24gcGF0aCBjaGFuZ2VcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAodXNlcikge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiAnU0VUX1BBR0VfU1RBVEUnLFxuICAgICAgICBwYXlsb2FkOiB7IGxhc3RWaXNpdGVkUGF0aDogcGF0aG5hbWUgfVxuICAgICAgfSk7XG4gICAgfVxuICB9LCBbcGF0aG5hbWUsIHVzZXIsIGRpc3BhdGNoXSk7XG5cbiAgLy8gUmVtb3ZlZCBiZWZvcmV1bmxvYWQgcHJvbXB0IHRvIGFsbG93IHNtb290aCBuYXZpZ2F0aW9uXG5cbiAgLy8gSHlkcmF0ZSBzdGF0ZSBvbiBpbml0aWFsIGxvYWRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAodXNlcikge1xuICAgICAgaHlkcmF0ZUZyb21TdG9yYWdlKChwYXRoKSA9PiB7IHJvdXRlci5wdXNoKHBhdGgpOyB9KTtcbiAgICB9XG4gIH0sIFt1c2VyLCByb3V0ZXIsIGh5ZHJhdGVGcm9tU3RvcmFnZV0pO1xuXG4gIGNvbnN0IG5hdkxpbmtzID0gW1xuICAgIHsgbmFtZTogJ0NoYXQnLCBwYXRoOiAnL2NoYXQnIH0sXG4gICAgeyBuYW1lOiAnV2FsbGV0JywgcGF0aDogJy93YWxsZXQnIH0sXG4gICAgeyBuYW1lOiAnVHJhZGluZycsIHBhdGg6ICcvdHJhZGluZycgfSxcbiAgICB7IG5hbWU6ICdTb2NpYWwnLCBwYXRoOiAnL3NvY2lhbCcgfSxcbiAgICB7IG5hbWU6ICdTZXR0aW5ncycsIHBhdGg6ICcvc2V0dGluZ3MnIH0sXG4gIF07XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT1cIm1pbi1oLXNjcmVlbiBiZy1ncmFkaWVudC10by1iIGZyb20tWyMxNDAwMDBdIHRvLWJsYWNrIHRleHQtd2hpdGUgZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXJcIj5cbiAgICAgIDxoZWFkZXIgY2xhc3NOYW1lPVwidy1mdWxsIG1heC13LXNjcmVlbi1tZCB0ZXh0LWNlbnRlciBib3JkZXItYiBib3JkZXItcmVkLTcwMCBwYi0xIG1iLTJcIj5cbiAgICAgICAgPGltZyBzcmM9e2xvZ29QYXRofSBhbHQ9XCJHcmFjZSBMb2dvXCIgY2xhc3NOYW1lPVwidy00OCBtZDp3LTU2IG14LWF1dG8gbXQtMiBtYi0xXCIgLz5cbiAgICAgICAgXG4gICAgICAgIHsvKiBNb2JpbGUgaGFtYnVyZ2VyIGJ1dHRvbiAqL31cbiAgICAgICAgPGJ1dHRvbiBcbiAgICAgICAgICBjbGFzc05hbWU9XCJtZDpoaWRkZW4gYWJzb2x1dGUgcmlnaHQtNCB0b3AtNiB0ZXh0LXdoaXRlIHAtMlwiIFxuICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldE1vYmlsZU1lbnVPcGVuKCFtb2JpbGVNZW51T3Blbil9XG4gICAgICAgID5cbiAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBjbGFzc05hbWU9XCJoLTYgdy02XCIgZmlsbD1cIm5vbmVcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCI+XG4gICAgICAgICAgICA8cGF0aCBzdHJva2VMaW5lY2FwPVwicm91bmRcIiBzdHJva2VMaW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlV2lkdGg9ezJ9IGQ9e21vYmlsZU1lbnVPcGVuID8gXCJNNiAxOEwxOCA2TTYgNmwxMiAxMlwiIDogXCJNNCA2aDE2TTQgMTJoMTZNNCAxOGgxNlwifSAvPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgXG4gICAgICAgIHsvKiBEZXNrdG9wIG5hdiBiYXIgKi99XG4gICAgICAgIDxuYXYgY2xhc3NOYW1lPXtgXG4gICAgICAgICAgJHttb2JpbGVNZW51T3BlbiA/ICdmbGV4JyA6ICdoaWRkZW4nfSBcbiAgICAgICAgICBtZDpmbGV4IFxuICAgICAgICAgIGZsZXgtY29sIG1kOmZsZXgtcm93IFxuICAgICAgICAgIGp1c3RpZnktY2VudGVyIFxuICAgICAgICAgIG1kOnNwYWNlLXgtNiBtZDpzcGFjZS15LTAgXG4gICAgICAgICAgc3BhY2UteS00IFxuICAgICAgICAgIHRleHQtcmVkLTMwMCB0ZXh0LWxnIG1kOnRleHQteGwgZm9udC1tb25vXG4gICAgICAgICAgdy1mdWxsIFxuICAgICAgICAgIHBiLTFcbiAgICAgICAgYH0+XG4gICAgICAgICAge25hdkxpbmtzLm1hcCgobGluaykgPT4gKFxuICAgICAgICAgICAgPExpbmtcbiAgICAgICAgICAgICAga2V5PXtsaW5rLnBhdGh9XG4gICAgICAgICAgICAgIGhyZWY9e2xpbmsucGF0aH1cbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0TW9iaWxlTWVudU9wZW4oZmFsc2UpfVxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2B0cmFuc2l0aW9uLWFsbCBob3Zlcjp0ZXh0LXJlZC00MDAgcGItMSAke3BhdGhuYW1lID09PSBsaW5rLnBhdGggPyAndGV4dC1yZWQtMzAwIGJvcmRlci1iIGJvcmRlci1yZWQtNTAwJyA6ICd0ZXh0LXdoaXRlJ31gfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7bGluay5uYW1lfVxuICAgICAgICAgICAgPC9MaW5rPlxuICAgICAgICAgICkpfVxuICAgICAgICAgIDxMb2dvdXRCdXR0b24gLz5cbiAgICAgICAgPC9uYXY+XG4gICAgICA8L2hlYWRlcj5cbiAgICAgIDxtYWluIGNsYXNzTmFtZT1cInctZnVsbCBtYXgtdy1zY3JlZW4tbWQgcHgtNCBweS0zIGZsZXgtZ3Jvd1wiPlxuICAgICAgICB7Y2hpbGRyZW59XG4gICAgICA8L21haW4+XG4gICAgPC9kaXY+XG4gICk7XG59Il0sIm5hbWVzIjpbIlJlYWN0IiwidXNlU3RhdGUiLCJ1c2VFZmZlY3QiLCJMaW5rIiwidXNlUm91dGVyIiwidXNlQXV0aCIsInVzZUFwcFN0YXRlIiwiTG9nb3V0QnV0dG9uIiwibG9nb1BhdGgiLCJMYXlvdXQiLCJjaGlsZHJlbiIsInJvdXRlciIsInBhdGhuYW1lIiwidXNlciIsIm1vYmlsZU1lbnVPcGVuIiwic2V0TW9iaWxlTWVudU9wZW4iLCJkaXNwYXRjaCIsImh5ZHJhdGVGcm9tU3RvcmFnZSIsInR5cGUiLCJwYXlsb2FkIiwibGFzdFZpc2l0ZWRQYXRoIiwicGF0aCIsInB1c2giLCJuYXZMaW5rcyIsIm5hbWUiLCJkaXYiLCJjbGFzc05hbWUiLCJoZWFkZXIiLCJpbWciLCJzcmMiLCJhbHQiLCJidXR0b24iLCJvbkNsaWNrIiwic3ZnIiwieG1sbnMiLCJmaWxsIiwidmlld0JveCIsInN0cm9rZSIsInN0cm9rZUxpbmVjYXAiLCJzdHJva2VMaW5lam9pbiIsInN0cm9rZVdpZHRoIiwiZCIsIm5hdiIsIm1hcCIsImxpbmsiLCJocmVmIiwibWFpbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./pages/Layout.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./pages/_app.tsx":
/*!************************!*\
  !*** ./pages/_app.tsx ***!
  \************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ App)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _components_AuthContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n/* harmony import */ var _context_AppStateContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../context/AppStateContext */ \"(pages-dir-node)/./context/AppStateContext.tsx\");\n/* harmony import */ var _components_ErrorBoundary__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/ErrorBoundary */ \"(pages-dir-node)/./components/ErrorBoundary.tsx\");\n/* harmony import */ var _components_StateLoader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/StateLoader */ \"(pages-dir-node)/./components/StateLoader.tsx\");\n/* harmony import */ var _components_LoadingPage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/LoadingPage */ \"(pages-dir-node)/./components/LoadingPage.tsx\");\n/* harmony import */ var react_toastify__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-toastify */ \"react-toastify\");\n/* harmony import */ var _Layout__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Layout */ \"(pages-dir-node)/./pages/Layout.tsx\");\n/* harmony import */ var _index_css__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../index.css */ \"(pages-dir-node)/./index.css\");\n/* harmony import */ var _index_css__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_index_css__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var react_toastify_dist_ReactToastify_css__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! react-toastify/dist/ReactToastify.css */ \"(pages-dir-node)/./node_modules/.pnpm/react-toastify@10.0.6_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/react-toastify/dist/ReactToastify.css\");\n/* harmony import */ var react_toastify_dist_ReactToastify_css__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(react_toastify_dist_ReactToastify_css__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var _styles_animations_css__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../styles/animations.css */ \"(pages-dir-node)/./styles/animations.css\");\n/* harmony import */ var _styles_animations_css__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(_styles_animations_css__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var _api_apiClient__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../api/apiClient */ \"(pages-dir-node)/./api/apiClient.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([react_toastify__WEBPACK_IMPORTED_MODULE_7__]);\nreact_toastify__WEBPACK_IMPORTED_MODULE_7__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Pages that should have the layout (header/navigation)\nconst pagesWithLayout = [\n    '/chat',\n    '/wallet',\n    '/trading',\n    '/social',\n    '/settings'\n];\n// Pages that don't require authentication\nconst publicPages = [\n    '/login',\n    '/register',\n    '/forgot',\n    '/reset'\n];\n// FIXED: Simplified and stabilized AuthGuard component\nfunction AuthGuard({ children, router }) {\n    const { user, loading, isAuthenticated } = (0,_components_AuthContext__WEBPACK_IMPORTED_MODULE_2__.useAuth)();\n    const isPublicPage = publicPages.includes(router.pathname);\n    const [isNavigating, setIsNavigating] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const lastRedirectAtRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    const initialLoadComplete = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    const unauthGraceUntilRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    // FIXED: Extended grace window and better token handling\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthGuard.useEffect\": ()=>{\n            if (!loading) {\n                initialLoadComplete.current = true;\n                // If a token exists, provide a longer grace window to avoid bouncing to login\n                const tokenExists = !!(0,_api_apiClient__WEBPACK_IMPORTED_MODULE_12__.getAuthToken)();\n                if (tokenExists) {\n                    unauthGraceUntilRef.current = Date.now() + 5000; // FIXED: Extended to 5s grace\n                    console.log('AuthGuard: Token exists, setting 5s grace window');\n                } else {\n                    unauthGraceUntilRef.current = 0;\n                }\n            }\n        }\n    }[\"AuthGuard.useEffect\"], [\n        loading\n    ]);\n    // FIXED: Simplified redirect logic with better grace handling\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthGuard.useEffect\": ()=>{\n            if (!initialLoadComplete.current || loading || isNavigating) {\n                return;\n            }\n            // If not authenticated and not on a public page, redirect to login\n            if (!isAuthenticated && !user && !isPublicPage) {\n                const now = Date.now();\n                const withinGrace = now < unauthGraceUntilRef.current;\n                const tokenExists = !!(0,_api_apiClient__WEBPACK_IMPORTED_MODULE_12__.getAuthToken)();\n                // FIXED: Never redirect away from chat if a token exists during grace period\n                if (router.pathname === '/chat' && (tokenExists || withinGrace)) {\n                    console.log('AuthGuard: On /chat with token/grace present; suppressing unauth redirect');\n                    return;\n                }\n                if (withinGrace) {\n                    console.log('AuthGuard: Skipping unauth redirect (within grace period)');\n                    return;\n                }\n                // Throttle repeated redirects\n                const now2 = Date.now();\n                const recentlyRedirected = now2 - lastRedirectAtRef.current < 2000;\n                if (recentlyRedirected) {\n                    console.log('AuthGuard: Skipping redirect (recently redirected)');\n                    return;\n                }\n                console.log('AuthGuard: Redirecting unauthenticated user to login');\n                lastRedirectAtRef.current = now2;\n                setIsNavigating(true);\n                router.replace('/login').then({\n                    \"AuthGuard.useEffect\": ()=>setIsNavigating(false)\n                }[\"AuthGuard.useEffect\"]).catch({\n                    \"AuthGuard.useEffect\": (error)=>{\n                        console.error('Navigation error:', error);\n                        setIsNavigating(false);\n                    }\n                }[\"AuthGuard.useEffect\"]);\n            }\n            // FIXED: Simplified authenticated user redirect logic\n            if (isAuthenticated && user && isPublicPage) {\n                // Check for coordination flags to avoid double redirects\n                let skipPublicRedirect = false;\n                try {\n                    skipPublicRedirect = sessionStorage.getItem('GRACE_POST_LOGIN_REDIRECT') === '1';\n                } catch  {}\n                // Throttle repeated redirects within a short window\n                const now = Date.now();\n                const recentlyRedirected = now - lastRedirectAtRef.current < 2000;\n                if (!skipPublicRedirect && !recentlyRedirected) {\n                    console.log('AuthGuard: Redirecting authenticated user to chat');\n                    lastRedirectAtRef.current = now;\n                    setIsNavigating(true);\n                    try {\n                        sessionStorage.setItem('GRACE_ALREADY_REDIRECTED', '1');\n                    } catch  {}\n                    router.replace('/chat').then({\n                        \"AuthGuard.useEffect\": ()=>setIsNavigating(false)\n                    }[\"AuthGuard.useEffect\"]).catch({\n                        \"AuthGuard.useEffect\": (error)=>{\n                            console.error('Navigation error:', error);\n                            setIsNavigating(false);\n                        }\n                    }[\"AuthGuard.useEffect\"]);\n                } else {\n                    // Clear the flag after the first pass to re-enable normal behavior\n                    try {\n                        sessionStorage.removeItem('GRACE_POST_LOGIN_REDIRECT');\n                    } catch  {}\n                }\n            }\n        }\n    }[\"AuthGuard.useEffect\"], [\n        isAuthenticated,\n        user,\n        isPublicPage,\n        loading,\n        router,\n        isNavigating\n    ]);\n    // FIXED: Clear redirect guard when on /chat\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthGuard.useEffect\": ()=>{\n            if (router.pathname === '/chat') {\n                try {\n                    sessionStorage.removeItem('GRACE_ALREADY_REDIRECTED');\n                } catch  {}\n            }\n        }\n    }[\"AuthGuard.useEffect\"], [\n        router.pathname\n    ]);\n    // FIXED: Simplified loading states\n    if (loading) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LoadingPage__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n            message: \"Loading authentication...\"\n        }, void 0, false, {\n            fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n            lineNumber: 127,\n            columnNumber: 12\n        }, this);\n    }\n    // Show navigation state\n    if (isNavigating) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LoadingPage__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n            message: \"Navigating...\"\n        }, void 0, false, {\n            fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n            lineNumber: 132,\n            columnNumber: 12\n        }, this);\n    }\n    // Don't render children until auth check is complete for protected pages\n    if (!loading && !user && !isPublicPage) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LoadingPage__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n            message: \"Redirecting to login...\"\n        }, void 0, false, {\n            fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n            lineNumber: 137,\n            columnNumber: 12\n        }, this);\n    }\n    // Render children with proper layout\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: children\n    }, void 0, false);\n}\nfunction App({ Component, pageProps, router }) {\n    const shouldHaveLayout = pagesWithLayout.includes(router.pathname);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ErrorBoundary__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n        componentName: \"Main App\",\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_AuthContext__WEBPACK_IMPORTED_MODULE_2__.AuthProvider, {\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_context_AppStateContext__WEBPACK_IMPORTED_MODULE_3__.AppStateProvider, {\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_StateLoader__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AuthGuard, {\n                        router: router,\n                        children: [\n                            shouldHaveLayout ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_Layout__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Component, {\n                                    ...pageProps\n                                }, void 0, false, {\n                                    fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n                                    lineNumber: 155,\n                                    columnNumber: 19\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n                                lineNumber: 154,\n                                columnNumber: 17\n                            }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Component, {\n                                ...pageProps\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n                                lineNumber: 158,\n                                columnNumber: 17\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_toastify__WEBPACK_IMPORTED_MODULE_7__.ToastContainer, {\n                                position: \"bottom-right\",\n                                theme: \"dark\"\n                            }, void 0, false, {\n                                fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n                                lineNumber: 160,\n                                columnNumber: 15\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n                        lineNumber: 152,\n                        columnNumber: 13\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n                    lineNumber: 151,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n                lineNumber: 150,\n                columnNumber: 9\n            }, this)\n        }, void 0, false, {\n            fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n            lineNumber: 149,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/home/ubuntu/grace-project/src/ui/pages/_app.tsx\",\n        lineNumber: 148,\n        columnNumber: 5\n    }, this);\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNELFFBQVEsQ0FBQ0csY0FBYztRQUN0QyxxQkFBTyw4REFBQ1osK0RBQVdBO1lBQUNzQyxTQUFROzs7Ozs7SUFDOUI7SUFFQSxxQ0FBcUM7SUFDckMscUJBQU87a0JBQUcvQjs7QUFDWjtBQUVlLFNBQVNnQyxJQUFJLEVBQUVDLFNBQVMsRUFBRUMsU0FBUyxFQUFFakMsTUFBTSxFQUFZO0lBQ3BFLE1BQU1rQyxtQkFBbUJ0QyxnQkFBZ0JTLFFBQVEsQ0FBQ0wsT0FBT00sUUFBUTtJQUVqRSxxQkFDRSw4REFBQ2hCLGlFQUFhQTtRQUFDNkMsZUFBYztrQkFDM0IsNEVBQUNoRCxpRUFBWUE7c0JBQ1gsNEVBQUNFLHNFQUFnQkE7MEJBQ2YsNEVBQUNFLCtEQUFXQTs4QkFDViw0RUFBQ087d0JBQVVFLFFBQVFBOzs0QkFDaEJrQyxpQ0FDQyw4REFBQ3hDLCtDQUFNQTswQ0FDTCw0RUFBQ3NDO29DQUFXLEdBQUdDLFNBQVM7Ozs7Ozs7Ozs7cURBRzFCLDhEQUFDRDtnQ0FBVyxHQUFHQyxTQUFTOzs7Ozs7MENBRTFCLDhEQUFDeEMsMERBQWNBO2dDQUFDMkMsVUFBUztnQ0FBZUMsT0FBTTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFPNUQiLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9ncmFjZS1wcm9qZWN0L3NyYy91aS9wYWdlcy9fYXBwLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VTdGF0ZSwgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQXBwUHJvcHMgfSBmcm9tICduZXh0L2FwcCc7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcic7XG5pbXBvcnQgeyBBdXRoUHJvdmlkZXIsIHVzZUF1dGggfSBmcm9tICcuLi9jb21wb25lbnRzL0F1dGhDb250ZXh0JztcbmltcG9ydCB7IEFwcFN0YXRlUHJvdmlkZXIgfSBmcm9tICcuLi9jb250ZXh0L0FwcFN0YXRlQ29udGV4dCc7XG5pbXBvcnQgRXJyb3JCb3VuZGFyeSBmcm9tICcuLi9jb21wb25lbnRzL0Vycm9yQm91bmRhcnknO1xuaW1wb3J0IFN0YXRlTG9hZGVyIGZyb20gJy4uL2NvbXBvbmVudHMvU3RhdGVMb2FkZXInO1xuaW1wb3J0IExvYWRpbmdQYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvTG9hZGluZ1BhZ2UnO1xuaW1wb3J0IHsgVG9hc3RDb250YWluZXIgfSBmcm9tICdyZWFjdC10b2FzdGlmeSc7XG5pbXBvcnQgTGF5b3V0IGZyb20gJy4vTGF5b3V0JztcbmltcG9ydCAnLi4vaW5kZXguY3NzJztcbmltcG9ydCAncmVhY3QtdG9hc3RpZnkvZGlzdC9SZWFjdFRvYXN0aWZ5LmNzcyc7XG5pbXBvcnQgJy4uL3N0eWxlcy9hbmltYXRpb25zLmNzcyc7XG5pbXBvcnQgeyBnZXRBdXRoVG9rZW4gfSBmcm9tICcuLi9hcGkvYXBpQ2xpZW50JztcblxuLy8gUGFnZXMgdGhhdCBzaG91bGQgaGF2ZSB0aGUgbGF5b3V0IChoZWFkZXIvbmF2aWdhdGlvbilcbmNvbnN0IHBhZ2VzV2l0aExheW91dCA9IFsnL2NoYXQnLCAnL3dhbGxldCcsICcvdHJhZGluZycsICcvc29jaWFsJywgJy9zZXR0aW5ncyddO1xuXG4vLyBQYWdlcyB0aGF0IGRvbid0IHJlcXVpcmUgYXV0aGVudGljYXRpb25cbmNvbnN0IHB1YmxpY1BhZ2VzID0gWycvbG9naW4nLCAnL3JlZ2lzdGVyJywgJy9mb3Jnb3QnLCAnL3Jlc2V0J107XG5cbi8vIEZJWEVEOiBTaW1wbGlmaWVkIGFuZCBzdGFiaWxpemVkIEF1dGhHdWFyZCBjb21wb25lbnRcbmZ1bmN0aW9uIEF1dGhHdWFyZCh7IGNoaWxkcmVuLCByb3V0ZXIgfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlLCByb3V0ZXI6IGFueSB9KSB7XG4gIGNvbnN0IHsgdXNlciwgbG9hZGluZywgaXNBdXRoZW50aWNhdGVkIH0gPSB1c2VBdXRoKCk7XG4gIGNvbnN0IGlzUHVibGljUGFnZSA9IHB1YmxpY1BhZ2VzLmluY2x1ZGVzKHJvdXRlci5wYXRobmFtZSk7XG4gIGNvbnN0IFtpc05hdmlnYXRpbmcsIHNldElzTmF2aWdhdGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGxhc3RSZWRpcmVjdEF0UmVmID0gdXNlUmVmPG51bWJlcj4oMCk7XG4gIGNvbnN0IGluaXRpYWxMb2FkQ29tcGxldGUgPSB1c2VSZWYoZmFsc2UpO1xuICBjb25zdCB1bmF1dGhHcmFjZVVudGlsUmVmID0gdXNlUmVmPG51bWJlcj4oMCk7XG4gIFxuICAvLyBGSVhFRDogRXh0ZW5kZWQgZ3JhY2Ugd2luZG93IGFuZCBiZXR0ZXIgdG9rZW4gaGFuZGxpbmdcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWxvYWRpbmcpIHtcbiAgICAgIGluaXRpYWxMb2FkQ29tcGxldGUuY3VycmVudCA9IHRydWU7XG4gICAgICAvLyBJZiBhIHRva2VuIGV4aXN0cywgcHJvdmlkZSBhIGxvbmdlciBncmFjZSB3aW5kb3cgdG8gYXZvaWQgYm91bmNpbmcgdG8gbG9naW5cbiAgICAgIGNvbnN0IHRva2VuRXhpc3RzID0gISFnZXRBdXRoVG9rZW4oKTtcbiAgICAgIGlmICh0b2tlbkV4aXN0cykge1xuICAgICAgICB1bmF1dGhHcmFjZVVudGlsUmVmLmN1cnJlbnQgPSBEYXRlLm5vdygpICsgNTAwMDsgLy8gRklYRUQ6IEV4dGVuZGVkIHRvIDVzIGdyYWNlXG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRoR3VhcmQ6IFRva2VuIGV4aXN0cywgc2V0dGluZyA1cyBncmFjZSB3aW5kb3cnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVuYXV0aEdyYWNlVW50aWxSZWYuY3VycmVudCA9IDA7XG4gICAgICB9XG4gICAgfVxuICB9LCBbbG9hZGluZ10pO1xuICBcbiAgLy8gRklYRUQ6IFNpbXBsaWZpZWQgcmVkaXJlY3QgbG9naWMgd2l0aCBiZXR0ZXIgZ3JhY2UgaGFuZGxpbmdcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWluaXRpYWxMb2FkQ29tcGxldGUuY3VycmVudCB8fCBsb2FkaW5nIHx8IGlzTmF2aWdhdGluZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICAvLyBJZiBub3QgYXV0aGVudGljYXRlZCBhbmQgbm90IG9uIGEgcHVibGljIHBhZ2UsIHJlZGlyZWN0IHRvIGxvZ2luXG4gICAgaWYgKCFpc0F1dGhlbnRpY2F0ZWQgJiYgIXVzZXIgJiYgIWlzUHVibGljUGFnZSkge1xuICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgIGNvbnN0IHdpdGhpbkdyYWNlID0gbm93IDwgdW5hdXRoR3JhY2VVbnRpbFJlZi5jdXJyZW50O1xuICAgICAgY29uc3QgdG9rZW5FeGlzdHMgPSAhIWdldEF1dGhUb2tlbigpO1xuICAgICAgXG4gICAgICAvLyBGSVhFRDogTmV2ZXIgcmVkaXJlY3QgYXdheSBmcm9tIGNoYXQgaWYgYSB0b2tlbiBleGlzdHMgZHVyaW5nIGdyYWNlIHBlcmlvZFxuICAgICAgaWYgKHJvdXRlci5wYXRobmFtZSA9PT0gJy9jaGF0JyAmJiAodG9rZW5FeGlzdHMgfHwgd2l0aGluR3JhY2UpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRoR3VhcmQ6IE9uIC9jaGF0IHdpdGggdG9rZW4vZ3JhY2UgcHJlc2VudDsgc3VwcHJlc3NpbmcgdW5hdXRoIHJlZGlyZWN0Jyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKHdpdGhpbkdyYWNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRoR3VhcmQ6IFNraXBwaW5nIHVuYXV0aCByZWRpcmVjdCAod2l0aGluIGdyYWNlIHBlcmlvZCknKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBUaHJvdHRsZSByZXBlYXRlZCByZWRpcmVjdHNcbiAgICAgIGNvbnN0IG5vdzIgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcmVjZW50bHlSZWRpcmVjdGVkID0gbm93MiAtIGxhc3RSZWRpcmVjdEF0UmVmLmN1cnJlbnQgPCAyMDAwO1xuICAgICAgaWYgKHJlY2VudGx5UmVkaXJlY3RlZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnQXV0aEd1YXJkOiBTa2lwcGluZyByZWRpcmVjdCAocmVjZW50bHkgcmVkaXJlY3RlZCknKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnQXV0aEd1YXJkOiBSZWRpcmVjdGluZyB1bmF1dGhlbnRpY2F0ZWQgdXNlciB0byBsb2dpbicpO1xuICAgICAgbGFzdFJlZGlyZWN0QXRSZWYuY3VycmVudCA9IG5vdzI7XG4gICAgICBzZXRJc05hdmlnYXRpbmcodHJ1ZSk7XG4gICAgICByb3V0ZXIucmVwbGFjZSgnL2xvZ2luJylcbiAgICAgICAgLnRoZW4oKCkgPT4gc2V0SXNOYXZpZ2F0aW5nKGZhbHNlKSlcbiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ05hdmlnYXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgIHNldElzTmF2aWdhdGluZyhmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBGSVhFRDogU2ltcGxpZmllZCBhdXRoZW50aWNhdGVkIHVzZXIgcmVkaXJlY3QgbG9naWNcbiAgICBpZiAoaXNBdXRoZW50aWNhdGVkICYmIHVzZXIgJiYgaXNQdWJsaWNQYWdlKSB7XG4gICAgICAvLyBDaGVjayBmb3IgY29vcmRpbmF0aW9uIGZsYWdzIHRvIGF2b2lkIGRvdWJsZSByZWRpcmVjdHNcbiAgICAgIGxldCBza2lwUHVibGljUmVkaXJlY3QgPSBmYWxzZTtcbiAgICAgIHRyeSB7XG4gICAgICAgIHNraXBQdWJsaWNSZWRpcmVjdCA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ0dSQUNFX1BPU1RfTE9HSU5fUkVESVJFQ1QnKSA9PT0gJzEnO1xuICAgICAgfSBjYXRjaCB7fVxuXG4gICAgICAvLyBUaHJvdHRsZSByZXBlYXRlZCByZWRpcmVjdHMgd2l0aGluIGEgc2hvcnQgd2luZG93XG4gICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcmVjZW50bHlSZWRpcmVjdGVkID0gbm93IC0gbGFzdFJlZGlyZWN0QXRSZWYuY3VycmVudCA8IDIwMDA7XG5cbiAgICAgIGlmICghc2tpcFB1YmxpY1JlZGlyZWN0ICYmICFyZWNlbnRseVJlZGlyZWN0ZWQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0F1dGhHdWFyZDogUmVkaXJlY3RpbmcgYXV0aGVudGljYXRlZCB1c2VyIHRvIGNoYXQnKTtcbiAgICAgICAgbGFzdFJlZGlyZWN0QXRSZWYuY3VycmVudCA9IG5vdztcbiAgICAgICAgc2V0SXNOYXZpZ2F0aW5nKHRydWUpO1xuICAgICAgICB0cnkgeyBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdHUkFDRV9BTFJFQURZX1JFRElSRUNURUQnLCAnMScpOyB9IGNhdGNoIHt9XG4gICAgICAgIHJvdXRlci5yZXBsYWNlKCcvY2hhdCcpXG4gICAgICAgICAgLnRoZW4oKCkgPT4gc2V0SXNOYXZpZ2F0aW5nKGZhbHNlKSlcbiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdOYXZpZ2F0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICAgIHNldElzTmF2aWdhdGluZyhmYWxzZSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBDbGVhciB0aGUgZmxhZyBhZnRlciB0aGUgZmlyc3QgcGFzcyB0byByZS1lbmFibGUgbm9ybWFsIGJlaGF2aW9yXG4gICAgICAgIHRyeSB7IHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ0dSQUNFX1BPU1RfTE9HSU5fUkVESVJFQ1QnKTsgfSBjYXRjaCB7fVxuICAgICAgfVxuICAgIH1cbiAgfSwgW2lzQXV0aGVudGljYXRlZCwgdXNlciwgaXNQdWJsaWNQYWdlLCBsb2FkaW5nLCByb3V0ZXIsIGlzTmF2aWdhdGluZ10pO1xuXG4gIC8vIEZJWEVEOiBDbGVhciByZWRpcmVjdCBndWFyZCB3aGVuIG9uIC9jaGF0XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHJvdXRlci5wYXRobmFtZSA9PT0gJy9jaGF0Jykge1xuICAgICAgdHJ5IHsgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgnR1JBQ0VfQUxSRUFEWV9SRURJUkVDVEVEJyk7IH0gY2F0Y2gge31cbiAgICB9XG4gIH0sIFtyb3V0ZXIucGF0aG5hbWVdKTtcblxuICAvLyBGSVhFRDogU2ltcGxpZmllZCBsb2FkaW5nIHN0YXRlc1xuICBpZiAobG9hZGluZykge1xuICAgIHJldHVybiA8TG9hZGluZ1BhZ2UgbWVzc2FnZT1cIkxvYWRpbmcgYXV0aGVudGljYXRpb24uLi5cIiAvPjtcbiAgfVxuICBcbiAgLy8gU2hvdyBuYXZpZ2F0aW9uIHN0YXRlXG4gIGlmIChpc05hdmlnYXRpbmcpIHtcbiAgICByZXR1cm4gPExvYWRpbmdQYWdlIG1lc3NhZ2U9XCJOYXZpZ2F0aW5nLi4uXCIgLz47XG4gIH1cbiAgXG4gIC8vIERvbid0IHJlbmRlciBjaGlsZHJlbiB1bnRpbCBhdXRoIGNoZWNrIGlzIGNvbXBsZXRlIGZvciBwcm90ZWN0ZWQgcGFnZXNcbiAgaWYgKCFsb2FkaW5nICYmICF1c2VyICYmICFpc1B1YmxpY1BhZ2UpIHtcbiAgICByZXR1cm4gPExvYWRpbmdQYWdlIG1lc3NhZ2U9XCJSZWRpcmVjdGluZyB0byBsb2dpbi4uLlwiIC8+O1xuICB9XG4gIFxuICAvLyBSZW5kZXIgY2hpbGRyZW4gd2l0aCBwcm9wZXIgbGF5b3V0XG4gIHJldHVybiA8PntjaGlsZHJlbn08Lz47XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIEFwcCh7IENvbXBvbmVudCwgcGFnZVByb3BzLCByb3V0ZXIgfTogQXBwUHJvcHMpIHtcbiAgY29uc3Qgc2hvdWxkSGF2ZUxheW91dCA9IHBhZ2VzV2l0aExheW91dC5pbmNsdWRlcyhyb3V0ZXIucGF0aG5hbWUpO1xuXG4gIHJldHVybiAoXG4gICAgPEVycm9yQm91bmRhcnkgY29tcG9uZW50TmFtZT1cIk1haW4gQXBwXCI+XG4gICAgICA8QXV0aFByb3ZpZGVyPlxuICAgICAgICA8QXBwU3RhdGVQcm92aWRlcj5cbiAgICAgICAgICA8U3RhdGVMb2FkZXI+XG4gICAgICAgICAgICA8QXV0aEd1YXJkIHJvdXRlcj17cm91dGVyfT5cbiAgICAgICAgICAgICAge3Nob3VsZEhhdmVMYXlvdXQgPyAoXG4gICAgICAgICAgICAgICAgPExheW91dD5cbiAgICAgICAgICAgICAgICAgIDxDb21wb25lbnQgey4uLnBhZ2VQcm9wc30gLz5cbiAgICAgICAgICAgICAgICA8L0xheW91dD5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8Q29tcG9uZW50IHsuLi5wYWdlUHJvcHN9IC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDxUb2FzdENvbnRhaW5lciBwb3NpdGlvbj1cImJvdHRvbS1yaWdodFwiIHRoZW1lPVwiZGFya1wiIC8+XG4gICAgICAgICAgICA8L0F1dGhHdWFyZD5cbiAgICAgICAgICA8L1N0YXRlTG9hZGVyPlxuICAgICAgICA8L0FwcFN0YXRlUHJvdmlkZXI+XG4gICAgICA8L0F1dGhQcm92aWRlcj5cbiAgICA8L0Vycm9yQm91bmRhcnk+XG4gICk7XG59Il0sIm5hbWVzIjpbIlJlYWN0IiwidXNlRWZmZWN0IiwidXNlU3RhdGUiLCJ1c2VSZWYiLCJBdXRoUHJvdmlkZXIiLCJ1c2VBdXRoIiwiQXBwU3RhdGVQcm92aWRlciIsIkVycm9yQm91bmRhcnkiLCJTdGF0ZUxvYWRlciIsIkxvYWRpbmdQYWdlIiwiVG9hc3RDb250YWluZXIiLCJMYXlvdXQiLCJnZXRBdXRoVG9rZW4iLCJwYWdlc1dpdGhMYXlvdXQiLCJwdWJsaWNQYWdlcyIsIkF1dGhHdWFyZCIsImNoaWxkcmVuIiwicm91dGVyIiwidXNlciIsImxvYWRpbmciLCJpc0F1dGhlbnRpY2F0ZWQiLCJpc1B1YmxpY1BhZ2UiLCJpbmNsdWRlcyIsInBhdGhuYW1lIiwiaXNOYXZpZ2F0aW5nIiwic2V0SXNOYXZpZ2F0aW5nIiwibGFzdFJlZGlyZWN0QXRSZWYiLCJpbml0aWFsTG9hZENvbXBsZXRlIiwidW5hdXRoR3JhY2VVbnRpbFJlZiIsImN1cnJlbnQiLCJ0b2tlbkV4aXN0cyIsIkRhdGUiLCJub3ciLCJjb25zb2xlIiwibG9nIiwid2l0aGluR3JhY2UiLCJub3cyIiwicmVjZW50bHlSZWRpcmVjdGVkIiwicmVwbGFjZSIsInRoZW4iLCJjYXRjaCIsImVycm9yIiwic2tpcFB1YmxpY1JlZGlyZWN0Iiwic2Vzc2lvblN0b3JhZ2UiLCJnZXRJdGVtIiwic2V0SXRlbSIsInJlbW92ZUl0ZW0iLCJtZXNzYWdlIiwiQXBwIiwiQ29tcG9uZW50IiwicGFnZVByb3BzIiwic2hvdWxkSGF2ZUxheW91dCIsImNvbXBvbmVudE5hbWUiLCJwb3NpdGlvbiIsInRoZW1lIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./pages/_app.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./pages/index.tsx":
/*!*************************!*\
  !*** ./pages/index.tsx ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Home)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/router */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/router.js\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _components_AuthContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n/* harmony import */ var _api_apiClient__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../api/apiClient */ \"(pages-dir-node)/./api/apiClient.ts\");\n\n\n\n\n\nfunction Home() {\n    const router = (0,next_router__WEBPACK_IMPORTED_MODULE_2__.useRouter)();\n    const { isAuthenticated, user, loading } = (0,_components_AuthContext__WEBPACK_IMPORTED_MODULE_3__.useAuth)();\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Home.useEffect\": ()=>{\n            // Small delay to allow auth state to settle on initial mount\n            const id = setTimeout({\n                \"Home.useEffect.id\": ()=>{\n                    const tokenExists = !!(0,_api_apiClient__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)();\n                    if (isAuthenticated && user || tokenExists) {\n                        router.replace('/chat');\n                    } else {\n                        router.replace('/login');\n                    }\n                }\n            }[\"Home.useEffect.id\"], loading ? 200 : 50);\n            return ({\n                \"Home.useEffect\": ()=>clearTimeout(id)\n            })[\"Home.useEffect\"];\n        }\n    }[\"Home.useEffect\"], [\n        router,\n        isAuthenticated,\n        user,\n        loading\n    ]);\n    // This will be shown briefly before the redirect happens\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"min-h-screen bg-gray-900 text-white flex items-center justify-center\",\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"text-center\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                className: \"text-2xl\",\n                children: \"Loading Grace Terminal...\"\n            }, void 0, false, {\n                fileName: \"/home/ubuntu/grace-project/src/ui/pages/index.tsx\",\n                lineNumber: 27,\n                columnNumber: 9\n            }, this)\n        }, void 0, false, {\n            fileName: \"/home/ubuntu/grace-project/src/ui/pages/index.tsx\",\n            lineNumber: 26,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/home/ubuntu/grace-project/src/ui/pages/index.tsx\",\n        lineNumber: 25,\n        columnNumber: 5\n    }, this);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3BhZ2VzL2luZGV4LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQXlDO0FBQ0Q7QUFDWTtBQUNKO0FBRWpDLFNBQVNLO0lBQ3RCLE1BQU1DLFNBQVNKLHNEQUFTQTtJQUN4QixNQUFNLEVBQUVLLGVBQWUsRUFBRUMsSUFBSSxFQUFFQyxPQUFPLEVBQUUsR0FBR04sZ0VBQU9BO0lBRWxERixnREFBU0E7MEJBQUM7WUFDUiw2REFBNkQ7WUFDN0QsTUFBTVMsS0FBS0M7cUNBQVc7b0JBQ3BCLE1BQU1DLGNBQWMsQ0FBQyxDQUFDUiw0REFBWUE7b0JBQ2xDLElBQUksbUJBQW9CSSxRQUFTSSxhQUFhO3dCQUM1Q04sT0FBT08sT0FBTyxDQUFDO29CQUNqQixPQUFPO3dCQUNMUCxPQUFPTyxPQUFPLENBQUM7b0JBQ2pCO2dCQUNGO29DQUFHSixVQUFVLE1BQU07WUFDbkI7a0NBQU8sSUFBTUssYUFBYUo7O1FBQzVCO3lCQUFHO1FBQUNKO1FBQVFDO1FBQWlCQztRQUFNQztLQUFRO0lBRTNDLHlEQUF5RDtJQUN6RCxxQkFDRSw4REFBQ007UUFBSUMsV0FBVTtrQkFDYiw0RUFBQ0Q7WUFBSUMsV0FBVTtzQkFDYiw0RUFBQ0M7Z0JBQUdELFdBQVU7MEJBQVc7Ozs7Ozs7Ozs7Ozs7Ozs7QUFJakMiLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9ncmFjZS1wcm9qZWN0L3NyYy91aS9wYWdlcy9pbmRleC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuLi9jb21wb25lbnRzL0F1dGhDb250ZXh0JztcbmltcG9ydCB7IGdldEF1dGhUb2tlbiB9IGZyb20gJy4uL2FwaS9hcGlDbGllbnQnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBIb21lKCkge1xuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcbiAgY29uc3QgeyBpc0F1dGhlbnRpY2F0ZWQsIHVzZXIsIGxvYWRpbmcgfSA9IHVzZUF1dGgoKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFNtYWxsIGRlbGF5IHRvIGFsbG93IGF1dGggc3RhdGUgdG8gc2V0dGxlIG9uIGluaXRpYWwgbW91bnRcbiAgICBjb25zdCBpZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW5FeGlzdHMgPSAhIWdldEF1dGhUb2tlbigpO1xuICAgICAgaWYgKChpc0F1dGhlbnRpY2F0ZWQgJiYgdXNlcikgfHwgdG9rZW5FeGlzdHMpIHtcbiAgICAgICAgcm91dGVyLnJlcGxhY2UoJy9jaGF0Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByb3V0ZXIucmVwbGFjZSgnL2xvZ2luJyk7XG4gICAgICB9XG4gICAgfSwgbG9hZGluZyA/IDIwMCA6IDUwKTtcbiAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KGlkKTtcbiAgfSwgW3JvdXRlciwgaXNBdXRoZW50aWNhdGVkLCB1c2VyLCBsb2FkaW5nXSk7XG5cbiAgLy8gVGhpcyB3aWxsIGJlIHNob3duIGJyaWVmbHkgYmVmb3JlIHRoZSByZWRpcmVjdCBoYXBwZW5zXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJtaW4taC1zY3JlZW4gYmctZ3JheS05MDAgdGV4dC13aGl0ZSBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlclwiPlxuICAgICAgICA8aDIgY2xhc3NOYW1lPVwidGV4dC0yeGxcIj5Mb2FkaW5nIEdyYWNlIFRlcm1pbmFsLi4uPC9oMj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufSJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZUVmZmVjdCIsInVzZVJvdXRlciIsInVzZUF1dGgiLCJnZXRBdXRoVG9rZW4iLCJIb21lIiwicm91dGVyIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlciIsImxvYWRpbmciLCJpZCIsInNldFRpbWVvdXQiLCJ0b2tlbkV4aXN0cyIsInJlcGxhY2UiLCJjbGVhclRpbWVvdXQiLCJkaXYiLCJjbGFzc05hbWUiLCJoMiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./pages/index.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./styles/animations.css":
/*!*******************************!*\
  !*** ./styles/animations.css ***!
  \*******************************/
/***/ (() => {



/***/ }),

/***/ "(pages-dir-node)/./utils/StateBackupService.ts":
/*!*************************************!*\
  !*** ./utils/StateBackupService.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _StatePersistence__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./StatePersistence */ \"(pages-dir-node)/./utils/StatePersistence.ts\");\n// StateBackupService.ts - Manages additional state backup mechanisms\n\nclass StateBackupService {\n    static instance;\n    serviceWorkerRegistration = null;\n    backupInterval = null;\n    lastBackupTime = 0;\n    BACKUP_INTERVAL_MS = 60000;\n    isRegistering = false;\n    constructor(){\n    // Private constructor for singleton pattern\n    }\n    static getInstance() {\n        if (!StateBackupService.instance) {\n            StateBackupService.instance = new StateBackupService();\n        }\n        return StateBackupService.instance;\n    }\n    /**\n   * Initialize the backup service\n   */ async initialize() {\n        try {\n            // Register service worker only in production builds to avoid 404s in dev\n            const isProd = \"development\" === 'production';\n            if (isProd && 'serviceWorker' in navigator && !this.isRegistering) {\n                this.isRegistering = true;\n                try {\n                    this.serviceWorkerRegistration = await navigator.serviceWorker.register('/serviceWorker.js', {\n                        scope: '/'\n                    });\n                    console.log('Service Worker registered successfully', this.serviceWorkerRegistration);\n                    // Set up service worker message handling\n                    navigator.serviceWorker.addEventListener('message', this.handleServiceWorkerMessage);\n                    // Start periodic backup\n                    this.startPeriodicBackup();\n                    this.isRegistering = false;\n                    return true;\n                } catch (error) {\n                    console.error('Service Worker registration failed:', error);\n                    this.isRegistering = false;\n                    // Even if service worker fails, we can still use local storage backups\n                    this.startPeriodicBackup();\n                    return false;\n                }\n            } else {\n                // Fallback for browsers without SW support or in development\n                if (!isProd) {\n                    console.log('Skipping Service Worker in development; using local storage backups only');\n                } else {\n                    console.log('Service Workers not supported or already registering, using local storage only');\n                }\n                this.startPeriodicBackup();\n                return false;\n            }\n        } catch (error) {\n            console.error('Error initializing backup service:', error);\n            return false;\n        }\n    }\n    /**\n   * Handle messages from service worker\n   */ handleServiceWorkerMessage = (event)=>{\n        if (event.data && event.data.type === 'BACKUP_STATE_COMPLETE') {\n            if (event.data.success) {\n                console.log('Service Worker backup complete');\n            } else {\n                console.error('Service Worker backup failed:', event.data.error);\n            }\n        }\n    };\n    /**\n   * Start periodic state backups\n   */ startPeriodicBackup() {\n        if (this.backupInterval) {\n            clearInterval(this.backupInterval);\n        }\n        this.backupInterval = window.setInterval(()=>{\n            this.backupCurrentState();\n        }, this.BACKUP_INTERVAL_MS);\n        console.log('Periodic state backup started');\n        // Also backup on certain events\n        window.addEventListener('beforeunload', this.backupCurrentState);\n        window.addEventListener('pagehide', this.backupCurrentState);\n        // Backup now\n        this.backupCurrentState();\n    }\n    /**\n   * Stop periodic backups\n   */ stopPeriodicBackup() {\n        if (this.backupInterval) {\n            clearInterval(this.backupInterval);\n            this.backupInterval = null;\n            window.removeEventListener('beforeunload', this.backupCurrentState);\n            window.removeEventListener('pagehide', this.backupCurrentState);\n            console.log('Periodic state backup stopped');\n        }\n    }\n    /**\n   * Backup the current application state\n   */ backupCurrentState = async ()=>{\n        try {\n            // Don't backup too frequently\n            const now = Date.now();\n            if (now - this.lastBackupTime < 10000) {\n                return;\n            }\n            this.lastBackupTime = now;\n            // Get current state snapshot\n            const snapshot = _StatePersistence__WEBPACK_IMPORTED_MODULE_0__[\"default\"].retrieveSnapshot();\n            if (!snapshot) {\n                console.log('No state snapshot to backup');\n                return;\n            }\n            // Backup to service worker if available\n            if (navigator.serviceWorker.controller) {\n                navigator.serviceWorker.controller.postMessage({\n                    type: 'BACKUP_STATE',\n                    state: snapshot\n                });\n                console.log('State backup sent to Service Worker');\n            }\n            // Secondary browser storage backup using a different key\n            try {\n                localStorage.setItem('GRACE_STATE_BACKUP', JSON.stringify({\n                    timestamp: now,\n                    state: snapshot\n                }));\n            } catch (storageError) {\n                console.error('Error backing up to localStorage:', storageError);\n            }\n        } catch (error) {\n            console.error('State backup failed:', error);\n        }\n    };\n    /**\n   * Attempt to recover state from all backup sources\n   */ async attemptRecovery() {\n        try {\n            console.log('Attempting state recovery from all sources');\n            // Try main persistence manager first\n            const mainSnapshot = _StatePersistence__WEBPACK_IMPORTED_MODULE_0__[\"default\"].retrieveSnapshot();\n            if (mainSnapshot) {\n                console.log('Recovered state from main persistence manager');\n                return mainSnapshot;\n            }\n            // Try localStorage backup\n            try {\n                const backupJson = localStorage.getItem('GRACE_STATE_BACKUP');\n                if (backupJson) {\n                    const backup = JSON.parse(backupJson);\n                    if (backup && backup.state) {\n                        console.log('Recovered state from localStorage backup');\n                        return backup.state;\n                    }\n                }\n            } catch (e) {\n                console.error('Error reading from localStorage backup:', e);\n            }\n            // Try service worker backup (this gets complex with async)\n            if (navigator.serviceWorker.controller) {\n                return new Promise((resolve)=>{\n                    // Set up a one-time message handler\n                    const messageHandler = (event)=>{\n                        if (event.data && event.data.type === 'RECOVERY_RESULT') {\n                            navigator.serviceWorker.removeEventListener('message', messageHandler);\n                            if (event.data.state) {\n                                console.log('Recovered state from Service Worker');\n                                resolve(event.data.state);\n                            } else {\n                                console.log('No state found in Service Worker');\n                                resolve(null);\n                            }\n                        }\n                    };\n                    navigator.serviceWorker.addEventListener('message', messageHandler);\n                    // Request recovery - we've already checked controller is not null\n                    navigator.serviceWorker.controller.postMessage({\n                        type: 'RECOVER_STATE'\n                    });\n                    // Set timeout for recovery attempt\n                    setTimeout(()=>{\n                        navigator.serviceWorker.removeEventListener('message', messageHandler);\n                        console.log('Service Worker recovery timed out');\n                        resolve(null);\n                    }, 3000);\n                });\n            }\n            console.log('No state recovered from any source');\n            return null;\n        } catch (error) {\n            console.error('Error during state recovery:', error);\n            return null;\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StateBackupService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL1N0YXRlQmFja3VwU2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLHFFQUFxRTtBQUNaO0FBRXpELE1BQU1DO0lBQ0osT0FBZUMsU0FBNkI7SUFDcENDLDRCQUE4RCxLQUFLO0lBQ25FQyxpQkFBZ0MsS0FBSztJQUNyQ0MsaUJBQXlCLEVBQUU7SUFDbEJDLHFCQUFxQixNQUFNO0lBQ3BDQyxnQkFBZ0IsTUFBTTtJQUU5QixhQUFzQjtJQUNwQiw0Q0FBNEM7SUFDOUM7SUFFQSxPQUFjQyxjQUFrQztRQUM5QyxJQUFJLENBQUNQLG1CQUFtQkMsUUFBUSxFQUFFO1lBQ2hDRCxtQkFBbUJDLFFBQVEsR0FBRyxJQUFJRDtRQUNwQztRQUNBLE9BQU9BLG1CQUFtQkMsUUFBUTtJQUNwQztJQUVBOztHQUVDLEdBQ0QsTUFBYU8sYUFBK0I7UUFDMUMsSUFBSTtZQUNGLHlFQUF5RTtZQUN6RSxNQUFNQyxTQUFTQyxrQkFBeUI7WUFDeEMsSUFBSUQsVUFBVSxtQkFBbUJFLGFBQWEsQ0FBQyxJQUFJLENBQUNMLGFBQWEsRUFBRTtnQkFDakUsSUFBSSxDQUFDQSxhQUFhLEdBQUc7Z0JBQ3JCLElBQUk7b0JBQ0YsSUFBSSxDQUFDSix5QkFBeUIsR0FBRyxNQUFNUyxVQUFVQyxhQUFhLENBQUNDLFFBQVEsQ0FBQyxxQkFBcUI7d0JBQzNGQyxPQUFPO29CQUNUO29CQUNBQyxRQUFRQyxHQUFHLENBQUMsMENBQTBDLElBQUksQ0FBQ2QseUJBQXlCO29CQUVwRix5Q0FBeUM7b0JBQ3pDUyxVQUFVQyxhQUFhLENBQUNLLGdCQUFnQixDQUFDLFdBQVcsSUFBSSxDQUFDQywwQkFBMEI7b0JBRW5GLHdCQUF3QjtvQkFDeEIsSUFBSSxDQUFDQyxtQkFBbUI7b0JBQ3hCLElBQUksQ0FBQ2IsYUFBYSxHQUFHO29CQUNyQixPQUFPO2dCQUNULEVBQUUsT0FBT2MsT0FBTztvQkFDZEwsUUFBUUssS0FBSyxDQUFDLHVDQUF1Q0E7b0JBQ3JELElB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QyxhQUFhLENBQUN1QixVQUFVLENBQUVDLFdBQVcsQ0FBQzt3QkFDOUNiLE1BQU07b0JBQ1I7b0JBRUEsbUNBQW1DO29CQUNuQytCLFdBQVc7d0JBQ1QzQyxVQUFVQyxhQUFhLENBQUNrQixtQkFBbUIsQ0FBQyxXQUFXdUI7d0JBQ3ZEdEMsUUFBUUMsR0FBRyxDQUFDO3dCQUNab0MsUUFBUTtvQkFDVixHQUFHO2dCQUNMO1lBQ0Y7WUFFQXJDLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU87UUFDVCxFQUFFLE9BQU9JLE9BQU87WUFDZEwsUUFBUUssS0FBSyxDQUFDLGdDQUFnQ0E7WUFDOUMsT0FBTztRQUNUO0lBQ0Y7QUFDRjtBQUVBLGlFQUFlcEIsa0JBQWtCQSxFQUFDIiwic291cmNlcyI6WyIvaG9tZS91YnVudHUvZ3JhY2UtcHJvamVjdC9zcmMvdWkvdXRpbHMvU3RhdGVCYWNrdXBTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFN0YXRlQmFja3VwU2VydmljZS50cyAtIE1hbmFnZXMgYWRkaXRpb25hbCBzdGF0ZSBiYWNrdXAgbWVjaGFuaXNtc1xuaW1wb3J0IFN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyIGZyb20gJy4vU3RhdGVQZXJzaXN0ZW5jZSc7XG5cbmNsYXNzIFN0YXRlQmFja3VwU2VydmljZSB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTdGF0ZUJhY2t1cFNlcnZpY2U7XG4gIHByaXZhdGUgc2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbjogU2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGJhY2t1cEludGVydmFsOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBsYXN0QmFja3VwVGltZTogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSByZWFkb25seSBCQUNLVVBfSU5URVJWQUxfTVMgPSA2MDAwMDsgLy8gMSBtaW51dGVcbiAgcHJpdmF0ZSBpc1JlZ2lzdGVyaW5nID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBQcml2YXRlIGNvbnN0cnVjdG9yIGZvciBzaW5nbGV0b24gcGF0dGVyblxuICB9XG5cbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBTdGF0ZUJhY2t1cFNlcnZpY2Uge1xuICAgIGlmICghU3RhdGVCYWNrdXBTZXJ2aWNlLmluc3RhbmNlKSB7XG4gICAgICBTdGF0ZUJhY2t1cFNlcnZpY2UuaW5zdGFuY2UgPSBuZXcgU3RhdGVCYWNrdXBTZXJ2aWNlKCk7XG4gICAgfVxuICAgIHJldHVybiBTdGF0ZUJhY2t1cFNlcnZpY2UuaW5zdGFuY2U7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSB0aGUgYmFja3VwIHNlcnZpY2VcbiAgICovXG4gIHB1YmxpYyBhc3luYyBpbml0aWFsaXplKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBSZWdpc3RlciBzZXJ2aWNlIHdvcmtlciBvbmx5IGluIHByb2R1Y3Rpb24gYnVpbGRzIHRvIGF2b2lkIDQwNHMgaW4gZGV2XG4gICAgICBjb25zdCBpc1Byb2QgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nO1xuICAgICAgaWYgKGlzUHJvZCAmJiAnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yICYmICF0aGlzLmlzUmVnaXN0ZXJpbmcpIHtcbiAgICAgICAgdGhpcy5pc1JlZ2lzdGVyaW5nID0gdHJ1ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0aGlzLnNlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb24gPSBhd2FpdCBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcignL3NlcnZpY2VXb3JrZXIuanMnLCB7XG4gICAgICAgICAgICBzY29wZTogJy8nXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1NlcnZpY2UgV29ya2VyIHJlZ2lzdGVyZWQgc3VjY2Vzc2Z1bGx5JywgdGhpcy5zZXJ2aWNlV29ya2VyUmVnaXN0cmF0aW9uKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTZXQgdXAgc2VydmljZSB3b3JrZXIgbWVzc2FnZSBoYW5kbGluZ1xuICAgICAgICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLmhhbmRsZVNlcnZpY2VXb3JrZXJNZXNzYWdlKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTdGFydCBwZXJpb2RpYyBiYWNrdXBcbiAgICAgICAgICB0aGlzLnN0YXJ0UGVyaW9kaWNCYWNrdXAoKTtcbiAgICAgICAgICB0aGlzLmlzUmVnaXN0ZXJpbmcgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdTZXJ2aWNlIFdvcmtlciByZWdpc3RyYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgICAgICB0aGlzLmlzUmVnaXN0ZXJpbmcgPSBmYWxzZTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBFdmVuIGlmIHNlcnZpY2Ugd29ya2VyIGZhaWxzLCB3ZSBjYW4gc3RpbGwgdXNlIGxvY2FsIHN0b3JhZ2UgYmFja3Vwc1xuICAgICAgICAgIHRoaXMuc3RhcnRQZXJpb2RpY0JhY2t1cCgpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmFsbGJhY2sgZm9yIGJyb3dzZXJzIHdpdGhvdXQgU1cgc3VwcG9ydCBvciBpbiBkZXZlbG9wbWVudFxuICAgICAgICBpZiAoIWlzUHJvZCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTa2lwcGluZyBTZXJ2aWNlIFdvcmtlciBpbiBkZXZlbG9wbWVudDsgdXNpbmcgbG9jYWwgc3RvcmFnZSBiYWNrdXBzIG9ubHknKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmljZSBXb3JrZXJzIG5vdCBzdXBwb3J0ZWQgb3IgYWxyZWFkeSByZWdpc3RlcmluZywgdXNpbmcgbG9jYWwgc3RvcmFnZSBvbmx5Jyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGFydFBlcmlvZGljQmFja3VwKCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgaW5pdGlhbGl6aW5nIGJhY2t1cCBzZXJ2aWNlOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIG1lc3NhZ2VzIGZyb20gc2VydmljZSB3b3JrZXJcbiAgICovXG4gIHByaXZhdGUgaGFuZGxlU2VydmljZVdvcmtlck1lc3NhZ2UgPSAoZXZlbnQ6IE1lc3NhZ2VFdmVudCkgPT4ge1xuICAgIGlmIChldmVudC5kYXRhICYmIGV2ZW50LmRhdGEudHlwZSA9PT0gJ0JBQ0tVUF9TVEFURV9DT01QTEVURScpIHtcbiAgICAgIGlmIChldmVudC5kYXRhLnN1Y2Nlc3MpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1NlcnZpY2UgV29ya2VyIGJhY2t1cCBjb21wbGV0ZScpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignU2VydmljZSBXb3JrZXIgYmFja3VwIGZhaWxlZDonLCBldmVudC5kYXRhLmVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHBlcmlvZGljIHN0YXRlIGJhY2t1cHNcbiAgICovXG4gIHB1YmxpYyBzdGFydFBlcmlvZGljQmFja3VwKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJhY2t1cEludGVydmFsKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuYmFja3VwSW50ZXJ2YWwpO1xuICAgIH1cbiAgICBcbiAgICB0aGlzLmJhY2t1cEludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMuYmFja3VwQ3VycmVudFN0YXRlKCk7XG4gICAgfSwgdGhpcy5CQUNLVVBfSU5URVJWQUxfTVMpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdQZXJpb2RpYyBzdGF0ZSBiYWNrdXAgc3RhcnRlZCcpO1xuICAgIFxuICAgIC8vIEFsc28gYmFja3VwIG9uIGNlcnRhaW4gZXZlbnRzXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHRoaXMuYmFja3VwQ3VycmVudFN0YXRlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncGFnZWhpZGUnLCB0aGlzLmJhY2t1cEN1cnJlbnRTdGF0ZSk7XG4gICAgXG4gICAgLy8gQmFja3VwIG5vd1xuICAgIHRoaXMuYmFja3VwQ3VycmVudFN0YXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCBwZXJpb2RpYyBiYWNrdXBzXG4gICAqL1xuICBwdWJsaWMgc3RvcFBlcmlvZGljQmFja3VwKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmJhY2t1cEludGVydmFsKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuYmFja3VwSW50ZXJ2YWwpO1xuICAgICAgdGhpcy5iYWNrdXBJbnRlcnZhbCA9IG51bGw7XG4gICAgICBcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCB0aGlzLmJhY2t1cEN1cnJlbnRTdGF0ZSk7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigncGFnZWhpZGUnLCB0aGlzLmJhY2t1cEN1cnJlbnRTdGF0ZSk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdQZXJpb2RpYyBzdGF0ZSBiYWNrdXAgc3RvcHBlZCcpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBCYWNrdXAgdGhlIGN1cnJlbnQgYXBwbGljYXRpb24gc3RhdGVcbiAgICovXG4gIHB1YmxpYyBiYWNrdXBDdXJyZW50U3RhdGUgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIERvbid0IGJhY2t1cCB0b28gZnJlcXVlbnRseVxuICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgIGlmIChub3cgLSB0aGlzLmxhc3RCYWNrdXBUaW1lIDwgMTAwMDApIHsgLy8gTWluIDEwcyBiZXR3ZWVuIGJhY2t1cHNcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICB0aGlzLmxhc3RCYWNrdXBUaW1lID0gbm93O1xuICAgICAgXG4gICAgICAvLyBHZXQgY3VycmVudCBzdGF0ZSBzbmFwc2hvdFxuICAgICAgY29uc3Qgc25hcHNob3QgPSBTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlci5yZXRyaWV2ZVNuYXBzaG90KCk7XG4gICAgICBpZiAoIXNuYXBzaG90KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdObyBzdGF0ZSBzbmFwc2hvdCB0byBiYWNrdXAnKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBCYWNrdXAgdG8gc2VydmljZSB3b3JrZXIgaWYgYXZhaWxhYmxlXG4gICAgICBpZiAobmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlcikge1xuICAgICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5jb250cm9sbGVyLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICB0eXBlOiAnQkFDS1VQX1NUQVRFJyxcbiAgICAgICAgICBzdGF0ZTogc25hcHNob3RcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTdGF0ZSBiYWNrdXAgc2VudCB0byBTZXJ2aWNlIFdvcmtlcicpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTZWNvbmRhcnkgYnJvd3NlciBzdG9yYWdlIGJhY2t1cCB1c2luZyBhIGRpZmZlcmVudCBrZXlcbiAgICAgIHRyeSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdHUkFDRV9TVEFURV9CQUNLVVAnLCBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgdGltZXN0YW1wOiBub3csXG4gICAgICAgICAgc3RhdGU6IHNuYXBzaG90XG4gICAgICAgIH0pKTtcbiAgICAgIH0gY2F0Y2ggKHN0b3JhZ2VFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBiYWNraW5nIHVwIHRvIGxvY2FsU3RvcmFnZTonLCBzdG9yYWdlRXJyb3IpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTdGF0ZSBiYWNrdXAgZmFpbGVkOicsIGVycm9yKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEF0dGVtcHQgdG8gcmVjb3ZlciBzdGF0ZSBmcm9tIGFsbCBiYWNrdXAgc291cmNlc1xuICAgKi9cbiAgcHVibGljIGFzeW5jIGF0dGVtcHRSZWNvdmVyeSgpOiBQcm9taXNlPGFueSB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ0F0dGVtcHRpbmcgc3RhdGUgcmVjb3ZlcnkgZnJvbSBhbGwgc291cmNlcycpO1xuICAgICAgXG4gICAgICAvLyBUcnkgbWFpbiBwZXJzaXN0ZW5jZSBtYW5hZ2VyIGZpcnN0XG4gICAgICBjb25zdCBtYWluU25hcHNob3QgPSBTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlci5yZXRyaWV2ZVNuYXBzaG90KCk7XG4gICAgICBpZiAobWFpblNuYXBzaG90KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdSZWNvdmVyZWQgc3RhdGUgZnJvbSBtYWluIHBlcnNpc3RlbmNlIG1hbmFnZXInKTtcbiAgICAgICAgcmV0dXJuIG1haW5TbmFwc2hvdDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVHJ5IGxvY2FsU3RvcmFnZSBiYWNrdXBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGJhY2t1cEpzb24gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnR1JBQ0VfU1RBVEVfQkFDS1VQJyk7XG4gICAgICAgIGlmIChiYWNrdXBKc29uKSB7XG4gICAgICAgICAgY29uc3QgYmFja3VwID0gSlNPTi5wYXJzZShiYWNrdXBKc29uKTtcbiAgICAgICAgICBpZiAoYmFja3VwICYmIGJhY2t1cC5zdGF0ZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1JlY292ZXJlZCBzdGF0ZSBmcm9tIGxvY2FsU3RvcmFnZSBiYWNrdXAnKTtcbiAgICAgICAgICAgIHJldHVybiBiYWNrdXAuc3RhdGU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgZnJvbSBsb2NhbFN0b3JhZ2UgYmFja3VwOicsIGUpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBUcnkgc2VydmljZSB3b3JrZXIgYmFja3VwICh0aGlzIGdldHMgY29tcGxleCB3aXRoIGFzeW5jKVxuICAgICAgaWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgLy8gU2V0IHVwIGEgb25lLXRpbWUgbWVzc2FnZSBoYW5kbGVyXG4gICAgICAgICAgY29uc3QgbWVzc2FnZUhhbmRsZXIgPSAoZXZlbnQ6IE1lc3NhZ2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmRhdGEgJiYgZXZlbnQuZGF0YS50eXBlID09PSAnUkVDT1ZFUllfUkVTVUxUJykge1xuICAgICAgICAgICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbWVzc2FnZUhhbmRsZXIpO1xuICAgICAgICAgICAgICBpZiAoZXZlbnQuZGF0YS5zdGF0ZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZWNvdmVyZWQgc3RhdGUgZnJvbSBTZXJ2aWNlIFdvcmtlcicpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZXZlbnQuZGF0YS5zdGF0ZSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIHN0YXRlIGZvdW5kIGluIFNlcnZpY2UgV29ya2VyJyk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgXG4gICAgICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBSZXF1ZXN0IHJlY292ZXJ5IC0gd2UndmUgYWxyZWFkeSBjaGVja2VkIGNvbnRyb2xsZXIgaXMgbm90IG51bGxcbiAgICAgICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5jb250cm9sbGVyIS5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICB0eXBlOiAnUkVDT1ZFUl9TVEFURSdcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTZXQgdGltZW91dCBmb3IgcmVjb3ZlcnkgYXR0ZW1wdFxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTZXJ2aWNlIFdvcmtlciByZWNvdmVyeSB0aW1lZCBvdXQnKTtcbiAgICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgICAgfSwgMzAwMCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnTm8gc3RhdGUgcmVjb3ZlcmVkIGZyb20gYW55IHNvdXJjZScpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBzdGF0ZSByZWNvdmVyeTonLCBlcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU3RhdGVCYWNrdXBTZXJ2aWNlO1xuIl0sIm5hbWVzIjpbIlN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyIiwiU3RhdGVCYWNrdXBTZXJ2aWNlIiwiaW5zdGFuY2UiLCJzZXJ2aWNlV29ya2VyUmVnaXN0cmF0aW9uIiwiYmFja3VwSW50ZXJ2YWwiLCJsYXN0QmFja3VwVGltZSIsIkJBQ0tVUF9JTlRFUlZBTF9NUyIsImlzUmVnaXN0ZXJpbmciLCJnZXRJbnN0YW5jZSIsImluaXRpYWxpemUiLCJpc1Byb2QiLCJwcm9jZXNzIiwibmF2aWdhdG9yIiwic2VydmljZVdvcmtlciIsInJlZ2lzdGVyIiwic2NvcGUiLCJjb25zb2xlIiwibG9nIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZVNlcnZpY2VXb3JrZXJNZXNzYWdlIiwic3RhcnRQZXJpb2RpY0JhY2t1cCIsImVycm9yIiwiZXZlbnQiLCJkYXRhIiwidHlwZSIsInN1Y2Nlc3MiLCJjbGVhckludGVydmFsIiwid2luZG93Iiwic2V0SW50ZXJ2YWwiLCJiYWNrdXBDdXJyZW50U3RhdGUiLCJzdG9wUGVyaW9kaWNCYWNrdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwibm93IiwiRGF0ZSIsInNuYXBzaG90IiwicmV0cmlldmVTbmFwc2hvdCIsImNvbnRyb2xsZXIiLCJwb3N0TWVzc2FnZSIsInN0YXRlIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0aW1lc3RhbXAiLCJzdG9yYWdlRXJyb3IiLCJhdHRlbXB0UmVjb3ZlcnkiLCJtYWluU25hcHNob3QiLCJiYWNrdXBKc29uIiwiZ2V0SXRlbSIsImJhY2t1cCIsInBhcnNlIiwiZSIsIlByb21pc2UiLCJyZXNvbHZlIiwibWVzc2FnZUhhbmRsZXIiLCJzZXRUaW1lb3V0Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/StateBackupService.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./utils/StateOperationLock.ts":
/*!*************************************!*\
  !*** ./utils/StateOperationLock.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/**\n * StateOperationLock - Prevents race conditions in state operations\n * \n * This utility provides a central locking mechanism to prevent concurrent state operations\n * from interfering with each other, which can cause race conditions and lost updates.\n */ class StateOperationLock {\n    static instance;\n    activeLocks = new Map();\n    DEFAULT_TIMEOUT = 5000;\n    // Make this a singleton\n    constructor(){}\n    static getInstance() {\n        if (!StateOperationLock.instance) {\n            StateOperationLock.instance = new StateOperationLock();\n        }\n        return StateOperationLock.instance;\n    }\n    /**\n   * Acquires a lock for a specific operation\n   * @param resourceId Identifier for the resource being locked (e.g., 'chat', 'trading')\n   * @param operation Description of the operation being performed\n   * @param timeoutMs Lock timeout in milliseconds\n   * @returns Lock ID if acquired, null if failed\n   */ acquireLock(resourceId, operation, timeoutMs = this.DEFAULT_TIMEOUT) {\n        // Clean expired locks first\n        this.cleanExpiredLocks();\n        // Check if the resource is already locked\n        if (this.activeLocks.has(resourceId)) {\n            console.warn(`Resource ${resourceId} is already locked for operation: ${this.activeLocks.get(resourceId)?.operation}`);\n            return null;\n        }\n        // Create a new lock\n        const lockId = `lock_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\n        const now = Date.now();\n        const lockInfo = {\n            id: lockId,\n            operation,\n            acquiredAt: now,\n            expiresAt: now + timeoutMs\n        };\n        // Set the lock\n        this.activeLocks.set(resourceId, lockInfo);\n        console.log(`Lock acquired for ${resourceId}: ${operation}`);\n        // Set automatic release after timeout\n        setTimeout(()=>{\n            this.releaseLock(resourceId, lockId);\n        }, timeoutMs);\n        return lockId;\n    }\n    /**\n   * Releases a lock if the lockId matches\n   * @param resourceId Resource identifier\n   * @param lockId Lock ID returned from acquireLock\n   * @returns true if released, false if not found or ID doesn't match\n   */ releaseLock(resourceId, lockId) {\n        const lock = this.activeLocks.get(resourceId);\n        if (!lock) {\n            console.warn(`No lock found for resource ${resourceId}`);\n            return false;\n        }\n        if (lock.id !== lockId) {\n            console.warn(`Lock ID mismatch for ${resourceId}: expected ${lock.id}, got ${lockId}`);\n            return false;\n        }\n        // Release the lock\n        this.activeLocks.delete(resourceId);\n        console.log(`Lock released for ${resourceId}`);\n        return true;\n    }\n    /**\n   * Checks if a resource is currently locked\n   * @param resourceId Resource identifier\n   * @returns true if locked, false otherwise\n   */ isLocked(resourceId) {\n        this.cleanExpiredLocks();\n        return this.activeLocks.has(resourceId);\n    }\n    /**\n   * Clean up any expired locks\n   */ cleanExpiredLocks() {\n        const now = Date.now();\n        for (const [resourceId, lock] of this.activeLocks.entries()){\n            if (lock.expiresAt < now) {\n                console.log(`Lock for ${resourceId} expired and was auto-released`);\n                this.activeLocks.delete(resourceId);\n            }\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StateOperationLock.getInstance());\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL1N0YXRlT3BlcmF0aW9uTG9jay50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7Ozs7O0NBS0MsR0FTRCxNQUFNQTtJQUNKLE9BQWVDLFNBQTZCO0lBQ3BDQyxjQUFxQyxJQUFJQyxNQUFNO0lBQy9DQyxrQkFBa0IsS0FBSztJQUUvQix3QkFBd0I7SUFDeEIsYUFBc0IsQ0FBQztJQUV2QixPQUFjQyxjQUFrQztRQUM5QyxJQUFJLENBQUNMLG1CQUFtQkMsUUFBUSxFQUFFO1lBQ2hDRCxtQkFBbUJDLFFBQVEsR0FBRyxJQUFJRDtRQUNwQztRQUNBLE9BQU9BLG1CQUFtQkMsUUFBUTtJQUNwQztJQUVBOzs7Ozs7R0FNQyxHQUNELFlBQW1CTSxVQUFrQixFQUFFQyxTQUFpQixFQUFFQyxZQUFZLElBQUksQ0FBQ0wsZUFBZSxFQUFpQjtRQUN6Ryw0QkFBNEI7UUFDNUIsSUFBSSxDQUFDTSxpQkFBaUI7UUFFdEIsMENBQTBDO1FBQzFDLElBQUksSUFBSSxDQUFDUixXQUFXLENBQUNTLEdBQUcsQ0FBQ0osYUFBYTtZQUNwQ0ssUUFBUUMsSUFBSSxDQUFDLENBQUMsU0FBUyxFQUFFTixXQUFXLGtDQUFrQyxFQUFFLElBQUksQ0FBQ0wsV0FBVyxDQUFDWSxHQUFHLENBQUNQLGFBQWFDLFdBQVc7WUFDckgsT0FBTztRQUNUO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1PLFNBQVMsQ0FBQyxLQUFLLEVBQUVDLEtBQUtDLEdBQUcsR0FBRyxDQUFDLEVBQUVDLEtBQUtDLE1BQU0sR0FBR0MsUUFBUSxDQUFDLElBQUlDLFNBQVMsQ0FBQyxHQUFHLElBQUk7UUFDakYsTUFBTUosTUFBTUQsS0FBS0MsR0FBRztRQUVwQixNQUFNSyxXQUFxQjtZQUN6QkMsSUFBSVI7WUFDSlA7WUFDQWdCLFlBQVlQO1lBQ1pRLFdBQVdSLE1BQU1SO1FBQ25CO1FBRUEsZUFBZTtRQUNmLElBQUksQ0FBQ1AsV0FBVyxDQUFDd0IsR0FBRyxDQUFDbkIsWUFBWWU7UUFDakNWLFFBQVFlLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixFQUFFcEIsV0FBVyxFQUFFLEVBQUVDLFdBQVc7UUFFM0Qsc0NBQXNDO1FBQ3RDb0IsV0FBVztZQUNULElBQUksQ0FBQ0MsV0FBVyxDQUFDdEIsWUFBWVE7UUFDL0IsR0FBR047UUFFSCxPQUFPTTtJQUNUO0lBRUE7Ozs7O0dBS0MsR0FDRCxZQUFtQlIsVUFBa0IsRUFBRVEsTUFBYyxFQUFXO1FBQzlELE1BQU1lLE9BQU8sSUFBSSxDQUFDNUIsV0FBVyxDQUFDWSxHQUFHLENBQUNQO1FBRWxDLElBQUksQ0FBQ3VCLE1BQU07WUFDVGxCLFFBQVFDLElBQUksQ0FBQyxDQUFDLDJCQUEyQixFQUFFTixZQUFZO1lBQ3ZELE9BQU87UUFDVDtRQUVBLElBQUl1QixLQUFLUCxFQUFFLEtBQUtSLFFBQVE7WUFDdEJILFFBQVFDLElBQUksQ0FBQyxDQUFDLHFCQUFxQixFQUFFTixXQUFXLFdBQVcsRUFBRXVCLEtBQUtQLEVBQUUsQ0FBQyxNQUFNLEVBQUVSLFFBQVE7WUFDckYsT0FBTztRQUNUO1FBRUEsbUJBQW1CO1FBQ25CLElBQUksQ0FBQ2IsV0FBVyxDQUFDNkIsTUFBTSxDQUFDeEI7UUFDeEJLLFFBQVFlLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixFQUFFcEIsWUFBWTtRQUU3QyxPQUFPO0lBQ1Q7SUFFQTs7OztHQUlDLEdBQ0QsU0FBZ0JBLFVBQWtCLEVBQVc7UUFDM0MsSUFBSSxDQUFDRyxpQkFBaUI7UUFDdEIsT0FBTyxJQUFJLENBQUNSLFdBQVcsQ0FBQ1MsR0FBRyxDQUFDSjtJQUM5QjtJQUVBOztHQUVDLEdBQ0Qsb0JBQWtDO1FBQ2hDLE1BQU1VLE1BQU1ELEtBQUtDLEdBQUc7UUFFcEIsS0FBSyxNQUFNLENBQUNWLFlBQVl1QixLQUFLLElBQUksSUFBSSxDQUFDNUIsV0FBVyxDQUFDK0IsT0FBTyxHQUFJO1lBQzNELElBQUlILEtBQUtMLFNBQVMsR0FBR1IsS0FBSztnQkFDeEJMLFFBQVFlLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRXBCLFdBQVcsOEJBQThCLENBQUM7Z0JBQ2xFLElBQUksQ0FBQ0wsV0FBVyxDQUFDNkIsTUFBTSxDQUFDeEI7WUFDMUI7UUFDRjtJQUNGO0FBQ0Y7QUFFQSxpRUFBZVAsbUJBQW1CSyxXQUFXLEVBQUUsRUFBQyIsInNvdXJjZXMiOlsiL2hvbWUvdWJ1bnR1L2dyYWNlLXByb2plY3Qvc3JjL3VpL3V0aWxzL1N0YXRlT3BlcmF0aW9uTG9jay50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFN0YXRlT3BlcmF0aW9uTG9jayAtIFByZXZlbnRzIHJhY2UgY29uZGl0aW9ucyBpbiBzdGF0ZSBvcGVyYXRpb25zXG4gKiBcbiAqIFRoaXMgdXRpbGl0eSBwcm92aWRlcyBhIGNlbnRyYWwgbG9ja2luZyBtZWNoYW5pc20gdG8gcHJldmVudCBjb25jdXJyZW50IHN0YXRlIG9wZXJhdGlvbnNcbiAqIGZyb20gaW50ZXJmZXJpbmcgd2l0aCBlYWNoIG90aGVyLCB3aGljaCBjYW4gY2F1c2UgcmFjZSBjb25kaXRpb25zIGFuZCBsb3N0IHVwZGF0ZXMuXG4gKi9cblxuaW50ZXJmYWNlIExvY2tJbmZvIHtcbiAgaWQ6IHN0cmluZztcbiAgb3BlcmF0aW9uOiBzdHJpbmc7XG4gIGFjcXVpcmVkQXQ6IG51bWJlcjtcbiAgZXhwaXJlc0F0OiBudW1iZXI7XG59XG5cbmNsYXNzIFN0YXRlT3BlcmF0aW9uTG9jayB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBTdGF0ZU9wZXJhdGlvbkxvY2s7XG4gIHByaXZhdGUgYWN0aXZlTG9ja3M6IE1hcDxzdHJpbmcsIExvY2tJbmZvPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSBERUZBVUxUX1RJTUVPVVQgPSA1MDAwOyAvLyBEZWZhdWx0IGxvY2sgdGltZW91dDogNSBzZWNvbmRzXG5cbiAgLy8gTWFrZSB0aGlzIGEgc2luZ2xldG9uXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7fVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogU3RhdGVPcGVyYXRpb25Mb2NrIHtcbiAgICBpZiAoIVN0YXRlT3BlcmF0aW9uTG9jay5pbnN0YW5jZSkge1xuICAgICAgU3RhdGVPcGVyYXRpb25Mb2NrLmluc3RhbmNlID0gbmV3IFN0YXRlT3BlcmF0aW9uTG9jaygpO1xuICAgIH1cbiAgICByZXR1cm4gU3RhdGVPcGVyYXRpb25Mb2NrLmluc3RhbmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEFjcXVpcmVzIGEgbG9jayBmb3IgYSBzcGVjaWZpYyBvcGVyYXRpb25cbiAgICogQHBhcmFtIHJlc291cmNlSWQgSWRlbnRpZmllciBmb3IgdGhlIHJlc291cmNlIGJlaW5nIGxvY2tlZCAoZS5nLiwgJ2NoYXQnLCAndHJhZGluZycpXG4gICAqIEBwYXJhbSBvcGVyYXRpb24gRGVzY3JpcHRpb24gb2YgdGhlIG9wZXJhdGlvbiBiZWluZyBwZXJmb3JtZWRcbiAgICogQHBhcmFtIHRpbWVvdXRNcyBMb2NrIHRpbWVvdXQgaW4gbWlsbGlzZWNvbmRzXG4gICAqIEByZXR1cm5zIExvY2sgSUQgaWYgYWNxdWlyZWQsIG51bGwgaWYgZmFpbGVkXG4gICAqL1xuICBwdWJsaWMgYWNxdWlyZUxvY2socmVzb3VyY2VJZDogc3RyaW5nLCBvcGVyYXRpb246IHN0cmluZywgdGltZW91dE1zID0gdGhpcy5ERUZBVUxUX1RJTUVPVVQpOiBzdHJpbmcgfCBudWxsIHtcbiAgICAvLyBDbGVhbiBleHBpcmVkIGxvY2tzIGZpcnN0XG4gICAgdGhpcy5jbGVhbkV4cGlyZWRMb2NrcygpO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHRoZSByZXNvdXJjZSBpcyBhbHJlYWR5IGxvY2tlZFxuICAgIGlmICh0aGlzLmFjdGl2ZUxvY2tzLmhhcyhyZXNvdXJjZUlkKSkge1xuICAgICAgY29uc29sZS53YXJuKGBSZXNvdXJjZSAke3Jlc291cmNlSWR9IGlzIGFscmVhZHkgbG9ja2VkIGZvciBvcGVyYXRpb246ICR7dGhpcy5hY3RpdmVMb2Nrcy5nZXQocmVzb3VyY2VJZCk/Lm9wZXJhdGlvbn1gKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBcbiAgICAvLyBDcmVhdGUgYSBuZXcgbG9ja1xuICAgIGNvbnN0IGxvY2tJZCA9IGBsb2NrXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMiwgOSl9YDtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIFxuICAgIGNvbnN0IGxvY2tJbmZvOiBMb2NrSW5mbyA9IHtcbiAgICAgIGlkOiBsb2NrSWQsXG4gICAgICBvcGVyYXRpb24sXG4gICAgICBhY3F1aXJlZEF0OiBub3csXG4gICAgICBleHBpcmVzQXQ6IG5vdyArIHRpbWVvdXRNc1xuICAgIH07XG4gICAgXG4gICAgLy8gU2V0IHRoZSBsb2NrXG4gICAgdGhpcy5hY3RpdmVMb2Nrcy5zZXQocmVzb3VyY2VJZCwgbG9ja0luZm8pO1xuICAgIGNvbnNvbGUubG9nKGBMb2NrIGFjcXVpcmVkIGZvciAke3Jlc291cmNlSWR9OiAke29wZXJhdGlvbn1gKTtcbiAgICBcbiAgICAvLyBTZXQgYXV0b21hdGljIHJlbGVhc2UgYWZ0ZXIgdGltZW91dFxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5yZWxlYXNlTG9jayhyZXNvdXJjZUlkLCBsb2NrSWQpO1xuICAgIH0sIHRpbWVvdXRNcyk7XG4gICAgXG4gICAgcmV0dXJuIGxvY2tJZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWxlYXNlcyBhIGxvY2sgaWYgdGhlIGxvY2tJZCBtYXRjaGVzXG4gICAqIEBwYXJhbSByZXNvdXJjZUlkIFJlc291cmNlIGlkZW50aWZpZXJcbiAgICogQHBhcmFtIGxvY2tJZCBMb2NrIElEIHJldHVybmVkIGZyb20gYWNxdWlyZUxvY2tcbiAgICogQHJldHVybnMgdHJ1ZSBpZiByZWxlYXNlZCwgZmFsc2UgaWYgbm90IGZvdW5kIG9yIElEIGRvZXNuJ3QgbWF0Y2hcbiAgICovXG4gIHB1YmxpYyByZWxlYXNlTG9jayhyZXNvdXJjZUlkOiBzdHJpbmcsIGxvY2tJZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbG9jayA9IHRoaXMuYWN0aXZlTG9ja3MuZ2V0KHJlc291cmNlSWQpO1xuICAgIFxuICAgIGlmICghbG9jaykge1xuICAgICAgY29uc29sZS53YXJuKGBObyBsb2NrIGZvdW5kIGZvciByZXNvdXJjZSAke3Jlc291cmNlSWR9YCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIFxuICAgIGlmIChsb2NrLmlkICE9PSBsb2NrSWQpIHtcbiAgICAgIGNvbnNvbGUud2FybihgTG9jayBJRCBtaXNtYXRjaCBmb3IgJHtyZXNvdXJjZUlkfTogZXhwZWN0ZWQgJHtsb2NrLmlkfSwgZ290ICR7bG9ja0lkfWApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBSZWxlYXNlIHRoZSBsb2NrXG4gICAgdGhpcy5hY3RpdmVMb2Nrcy5kZWxldGUocmVzb3VyY2VJZCk7XG4gICAgY29uc29sZS5sb2coYExvY2sgcmVsZWFzZWQgZm9yICR7cmVzb3VyY2VJZH1gKTtcbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgYSByZXNvdXJjZSBpcyBjdXJyZW50bHkgbG9ja2VkXG4gICAqIEBwYXJhbSByZXNvdXJjZUlkIFJlc291cmNlIGlkZW50aWZpZXJcbiAgICogQHJldHVybnMgdHJ1ZSBpZiBsb2NrZWQsIGZhbHNlIG90aGVyd2lzZVxuICAgKi9cbiAgcHVibGljIGlzTG9ja2VkKHJlc291cmNlSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHRoaXMuY2xlYW5FeHBpcmVkTG9ja3MoKTtcbiAgICByZXR1cm4gdGhpcy5hY3RpdmVMb2Nrcy5oYXMocmVzb3VyY2VJZCk7XG4gIH1cblxuICAvKipcbiAgICogQ2xlYW4gdXAgYW55IGV4cGlyZWQgbG9ja3NcbiAgICovXG4gIHByaXZhdGUgY2xlYW5FeHBpcmVkTG9ja3MoKTogdm9pZCB7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IFtyZXNvdXJjZUlkLCBsb2NrXSBvZiB0aGlzLmFjdGl2ZUxvY2tzLmVudHJpZXMoKSkge1xuICAgICAgaWYgKGxvY2suZXhwaXJlc0F0IDwgbm93KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBMb2NrIGZvciAke3Jlc291cmNlSWR9IGV4cGlyZWQgYW5kIHdhcyBhdXRvLXJlbGVhc2VkYCk7XG4gICAgICAgIHRoaXMuYWN0aXZlTG9ja3MuZGVsZXRlKHJlc291cmNlSWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTdGF0ZU9wZXJhdGlvbkxvY2suZ2V0SW5zdGFuY2UoKTtcbiJdLCJuYW1lcyI6WyJTdGF0ZU9wZXJhdGlvbkxvY2siLCJpbnN0YW5jZSIsImFjdGl2ZUxvY2tzIiwiTWFwIiwiREVGQVVMVF9USU1FT1VUIiwiZ2V0SW5zdGFuY2UiLCJhY3F1aXJlTG9jayIsInJlc291cmNlSWQiLCJvcGVyYXRpb24iLCJ0aW1lb3V0TXMiLCJjbGVhbkV4cGlyZWRMb2NrcyIsImhhcyIsImNvbnNvbGUiLCJ3YXJuIiwiZ2V0IiwibG9ja0lkIiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsImxvY2tJbmZvIiwiaWQiLCJhY3F1aXJlZEF0IiwiZXhwaXJlc0F0Iiwic2V0IiwibG9nIiwic2V0VGltZW91dCIsInJlbGVhc2VMb2NrIiwibG9jayIsImRlbGV0ZSIsImlzTG9ja2VkIiwiZW50cmllcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/StateOperationLock.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./utils/StatePersistence.ts":
/*!***********************************!*\
  !*** ./utils/StatePersistence.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   preventUnintendedRefresh: () => (/* binding */ preventUnintendedRefresh)\n/* harmony export */ });\n/* harmony import */ var _StateOperationLock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./StateOperationLock */ \"(pages-dir-node)/./utils/StateOperationLock.ts\");\n\nclass StatePersistenceManager {\n    static getStoredState() {\n        throw new Error('Method not implemented.');\n    }\n    // Storage keys - making this public so it can be referenced by sync logic\n    static STORAGE_KEY = 'GRACE_DYNAMIC_SNAPSHOT';\n    static MAX_SNAPSHOT_AGE = 24 * 60 * 60 * 1000;\n    static STORAGE_VERSION = 1;\n    static MAX_STORAGE_SIZE = 4 * 1024 * 1024;\n    // Advanced logging mechanism\n    static log(message, level = 'info') {\n        const timestamp = new Date().toISOString();\n        const logMessage = `[StatePersistence:${level.toUpperCase()}] ${timestamp} - ${message}`;\n        switch(level){\n            case 'info':\n                console.log(logMessage);\n                break;\n            case 'warn':\n                console.warn(logMessage);\n                break;\n            case 'error':\n                console.error(logMessage);\n                break;\n        }\n    // Optional: Send to error tracking service\n    // this.reportToErrorTracking(message, level);\n    }\n    // Check storage quota and manage size\n    static async checkStorageQuota() {\n        try {\n            // Use the Storage API if available (modern browsers)\n            if ('storage' in navigator && 'estimate' in navigator.storage) {\n                const estimate = await navigator.storage.estimate();\n                const { usage, quota } = estimate;\n                if (usage && quota) {\n                    const usageRatio = usage / quota;\n                    this.log(`Storage usage: ${(usageRatio * 100).toFixed(2)}% (${Math.round(usage / 1024 / 1024)}MB / ${Math.round(quota / 1024 / 1024)}MB)`);\n                    // If over 90% of quota, try to clean up\n                    if (usageRatio > 0.9) {\n                        this.log('Storage quota nearing limit, cleaning up old data', 'warn');\n                        return this.cleanupStorage();\n                    }\n                }\n            } else {\n                // Fallback for browsers without Storage API\n                // Check current storage size\n                let totalSize = 0;\n                for(let i = 0; i < localStorage.length; i++){\n                    const key = localStorage.key(i);\n                    if (key) {\n                        const value = localStorage.getItem(key) || '';\n                        totalSize += key.length + value.length;\n                    }\n                }\n                // Convert to MB for easier debugging\n                const sizeMB = totalSize / (1024 * 1024);\n                this.log(`Estimated localStorage usage: ${sizeMB.toFixed(2)}MB`);\n                // If over 4MB, clean up (typical localStorage limit is 5MB)\n                if (totalSize > this.MAX_STORAGE_SIZE) {\n                    this.log('Storage size nearing limit, cleaning up old data', 'warn');\n                    return this.cleanupStorage();\n                }\n            }\n            return true;\n        } catch (error) {\n            this.log(`Error checking storage quota: ${error}`, 'error');\n            return true; // Continue anyway to not block operation\n        }\n    }\n    // Clean up storage when approaching quota limits\n    static cleanupStorage() {\n        try {\n            // Strategy 1: Remove old chat messages (typically the largest data)\n            const keysToCheck = [];\n            for(let i = 0; i < localStorage.length; i++){\n                const key = localStorage.key(i);\n                if (key && (key.startsWith('messages_') || key.includes('draft_'))) {\n                    keysToCheck.push(key);\n                }\n            }\n            // Sort by last access time if available\n            const keysWithTime = keysToCheck.map((key)=>{\n                // Ensure key is a string before calling replace\n                const sessionId = String(key).replace('messages_', '').replace('draft_', '');\n                const lastSynced = localStorage.getItem(`lastSynced_${sessionId}`);\n                const timestamp = lastSynced ? new Date(lastSynced).getTime() : 0;\n                return {\n                    key,\n                    timestamp\n                };\n            });\n            // Sort oldest first\n            keysWithTime.sort((a, b)=>a.timestamp - b.timestamp);\n            // Remove oldest 30% of items\n            const itemsToRemove = Math.ceil(keysWithTime.length * 0.3);\n            for(let i = 0; i < itemsToRemove; i++){\n                if (i < keysWithTime.length) {\n                    localStorage.removeItem(keysWithTime[i].key);\n                    this.log(`Removed old data: ${keysWithTime[i].key}`);\n                }\n            }\n            // Strategy 2: If main snapshot is too large, try to trim it\n            const snapshot = localStorage.getItem(this.STORAGE_KEY);\n            if (snapshot && snapshot.length > 1024 * 1024) {\n                try {\n                    const parsedSnapshot = JSON.parse(snapshot);\n                    // Trim message history to reduce size\n                    if (parsedSnapshot.chatContext && parsedSnapshot.chatContext.messages) {\n                        // Keep only last 20 messages\n                        parsedSnapshot.chatContext.messages = parsedSnapshot.chatContext.messages.slice(-20);\n                    }\n                    // Store the trimmed version\n                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(parsedSnapshot));\n                    this.log('Trimmed main snapshot size');\n                } catch (e) {\n                    this.log(`Error trimming snapshot: ${e}`, 'error');\n                }\n            }\n            return true;\n        } catch (error) {\n            this.log(`Error cleaning up storage: ${error}`, 'error');\n            return false;\n        }\n    }\n    // Validate snapshot structure and schema\n    static validateSnapshotSchema(snapshot) {\n        if (!snapshot || typeof snapshot !== 'object') return false;\n        // Check required fields\n        if (typeof snapshot.timestamp !== 'number') return false;\n        // Check for required sub-objects\n        const requiredObjects = [\n            'userSession',\n            'chatContext',\n            'pageState',\n            'widgetStates'\n        ];\n        for (const obj of requiredObjects){\n            if (!snapshot[obj] || typeof snapshot[obj] !== 'object') {\n                return false;\n            }\n        }\n        return true;\n    }\n    // Create a backup of the current snapshot\n    static createBackup() {\n        try {\n            const currentSnapshot = localStorage.getItem(this.STORAGE_KEY);\n            if (currentSnapshot) {\n                localStorage.setItem(`${this.STORAGE_KEY}_BACKUP`, currentSnapshot);\n            }\n        } catch (error) {\n            this.log(`Failed to create backup: ${error}`, 'warn');\n        }\n    }\n    // Capture the current application state with enhanced safety\n    static async captureSnapshot(partialState) {\n        // Acquire a lock for state operations to prevent race conditions\n        const lockId = _StateOperationLock__WEBPACK_IMPORTED_MODULE_0__[\"default\"].acquireLock('state_snapshot', 'capture_snapshot');\n        if (!lockId) {\n            this.log('Could not acquire lock for state operation, another operation is in progress', 'warn');\n            return;\n        }\n        try {\n            // Validate storage availability\n            if (!this.isStorageAvailable()) {\n                this.log('Local storage not available', 'warn');\n                return;\n            }\n            // Check quota before writing\n            const quotaOk = await this.checkStorageQuota();\n            if (!quotaOk) {\n                this.log('Storage quota issues, data may not be saved completely', 'warn');\n            }\n            const existingSnapshot = this.retrieveSnapshot();\n            const newSnapshot = {\n                timestamp: Date.now(),\n                version: this.STORAGE_VERSION,\n                userSession: partialState?.userSession || existingSnapshot?.userSession || {},\n                chatContext: partialState?.chatContext || existingSnapshot?.chatContext || {},\n                pageState: partialState?.pageState || existingSnapshot?.pageState || {},\n                widgetStates: partialState?.widgetStates || existingSnapshot?.widgetStates || {}\n            };\n            // Create a backup of the current state before updating\n            this.createBackup();\n            // Attempt to save state\n            try {\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(newSnapshot));\n                this.log('State snapshot captured successfully');\n            } catch (storageError) {\n                // If failed due to quota, force cleanup and try again\n                this.log(`Storage error, forcing cleanup: ${storageError}`, 'warn');\n                this.cleanupStorage();\n                // Try one more time with a more minimal state\n                const minimalSnapshot = {\n                    timestamp: Date.now(),\n                    version: this.STORAGE_VERSION,\n                    userSession: newSnapshot.userSession,\n                    // Minimal objects to ensure basic functionality\n                    chatContext: {\n                        currentConversationId: newSnapshot.chatContext.currentConversationId\n                    },\n                    pageState: {\n                        lastVisitedPath: newSnapshot.pageState.lastVisitedPath\n                    },\n                    widgetStates: {}\n                };\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(minimalSnapshot));\n                this.log('Minimal state snapshot saved as fallback');\n            }\n        } catch (error) {\n            this.log(`Failed to capture state snapshot: ${error}`, 'error');\n        } finally{\n            // Always release the lock\n            _StateOperationLock__WEBPACK_IMPORTED_MODULE_0__[\"default\"].releaseLock('state_snapshot', lockId);\n        }\n    }\n    // Check local storage availability\n    static isStorageAvailable() {\n        try {\n            const testKey = '__storage_test__';\n            localStorage.setItem(testKey, testKey);\n            localStorage.removeItem(testKey);\n            return true;\n        } catch (e) {\n            return false;\n        }\n    }\n    // Validate snapshot age and integrity\n    static validateSnapshot(snapshot) {\n        if (!snapshot) return false;\n        // Check schema/structure validity\n        if (!this.validateSnapshotSchema(snapshot)) {\n            this.log('Snapshot has invalid schema, discarding', 'warn');\n            return false;\n        }\n        const currentTime = Date.now();\n        const snapshotAge = currentTime - snapshot.timestamp;\n        if (snapshotAge > this.MAX_SNAPSHOT_AGE) {\n            this.log('Snapshot too old, discarding', 'warn');\n            return false;\n        }\n        return true;\n    }\n    // Retrieve the last saved state snapshot with corruption recovery\n    static retrieveSnapshot() {\n        // We don't lock for reads, but we do check if there's a write in progress\n        if (_StateOperationLock__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isLocked('state_snapshot')) {\n            this.log('State snapshot is currently being updated, using existing snapshot', 'warn');\n        }\n        try {\n            const snapshot = localStorage.getItem(this.STORAGE_KEY);\n            if (!snapshot) return null;\n            try {\n                const parsedSnapshot = JSON.parse(snapshot);\n                // Validate snapshot integrity\n                if (this.validateSnapshot(parsedSnapshot)) {\n                    return parsedSnapshot;\n                } else {\n                    this.log('Invalid snapshot detected, attempting recovery', 'warn');\n                    return this.attemptSnapshotRecovery();\n                }\n            } catch (parseError) {\n                this.log(`JSON parse error: ${parseError}, attempting recovery`, 'error');\n                return this.attemptSnapshotRecovery();\n            }\n        } catch (error) {\n            this.log(`Failed to retrieve state snapshot: ${error}`, 'error');\n            return null;\n        }\n    }\n    // Attempt to recover corrupted state\n    static attemptSnapshotRecovery() {\n        try {\n            this.log('Attempting state recovery', 'warn');\n            // Strategy 1: Check for backup\n            const backupSnapshot = localStorage.getItem(`${this.STORAGE_KEY}_BACKUP`);\n            if (backupSnapshot) {\n                try {\n                    const parsedBackup = JSON.parse(backupSnapshot);\n                    if (this.validateSnapshot(parsedBackup)) {\n                        this.log('Recovered state from backup', 'info');\n                        return parsedBackup;\n                    }\n                } catch (e) {\n                    this.log('Backup snapshot also corrupted', 'warn');\n                }\n            }\n            // Strategy 2: Build from individual pieces in localStorage\n            const recoveredState = {\n                timestamp: Date.now(),\n                version: this.STORAGE_VERSION,\n                userSession: {},\n                chatContext: {},\n                pageState: {},\n                widgetStates: {}\n            };\n            // Try to get last path from localStorage\n            const activeSessionId = localStorage.getItem('activeSessionId');\n            if (activeSessionId) {\n                recoveredState.chatContext.currentConversationId = activeSessionId;\n            }\n            // Set recovery flag\n            recoveredState.recovered = true;\n            this.log('Created minimal recovered state', 'info');\n            return recoveredState;\n        } catch (error) {\n            this.log(`Recovery failed: ${error}`, 'error');\n            return null;\n        }\n    }\n    // Hydrate application state\n    static hydrateState(router) {\n        const snapshot = this.retrieveSnapshot();\n        if (snapshot) {\n            // Optionally navigate to last visited path\n            if (router && snapshot.pageState.lastVisitedPath) {\n                router.push(snapshot.pageState.lastVisitedPath);\n            }\n            return snapshot;\n        }\n        return {};\n    }\n    // Clear the snapshot (used during logout)\n    static clearSnapshot() {\n        localStorage.removeItem(this.STORAGE_KEY);\n    }\n}\n// Prevent accidental page unload\nfunction preventUnintendedRefresh(e) {\n    e.preventDefault();\n    e.returnValue = ''; // Required for Chrome\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StatePersistenceManager);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL1N0YXRlUGVyc2lzdGVuY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ3NEO0FBNkR0RCxNQUFNQztJQUNKLE9BQU9DLGlCQUFpQjtRQUN0QixNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFDQSwwRUFBMEU7SUFDMUUsT0FBY0MsY0FBYyx5QkFBeUI7SUFDckQsT0FBZUMsbUJBQW1CLEtBQUssS0FBSyxLQUFLLEtBQUs7SUFDdEQsT0FBZUMsa0JBQWtCLEVBQUU7SUFDbkMsT0FBZUMsbUJBQW1CLElBQUksT0FBTyxLQUFLO0lBRWxELDZCQUE2QjtJQUM3QixPQUFlQyxJQUFJQyxPQUFlLEVBQUVDLFFBQW1DLE1BQU0sRUFBRTtRQUM3RSxNQUFNQyxZQUFZLElBQUlDLE9BQU9DLFdBQVc7UUFDeEMsTUFBTUMsYUFBYSxDQUFDLGtCQUFrQixFQUFFSixNQUFNSyxXQUFXLEdBQUcsRUFBRSxFQUFFSixVQUFVLEdBQUcsRUFBRUYsU0FBUztRQUV4RixPQUFPQztZQUNMLEtBQUs7Z0JBQVFNLFFBQVFSLEdBQUcsQ0FBQ007Z0JBQWE7WUFDdEMsS0FBSztnQkFBUUUsUUFBUUMsSUFBSSxDQUFDSDtnQkFBYTtZQUN2QyxLQUFLO2dCQUFTRSxRQUFRRSxLQUFLLENBQUNKO2dCQUFhO1FBQzNDO0lBRUEsMkNBQTJDO0lBQzNDLDhDQUE4QztJQUNoRDtJQUVBLHNDQUFzQztJQUN0QyxhQUFxQkssb0JBQXNDO1FBQ3pELElBQUk7WUFDRixxREFBcUQ7WUFDckQsSUFBSSxhQUFhQyxhQUFhLGNBQWNBLFVBQVVDLE9BQU8sRUFBRTtnQkFDN0QsTUFBTUMsV0FBVyxNQUFNRixVQUFVQyxPQUFPLENBQUNDLFFBQVE7Z0JBQ2pELE1BQU0sRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUUsR0FBR0Y7Z0JBRXpCLElBQUlDLFNBQVNDLE9BQU87b0JBQ2xCLE1BQU1DLGFBQWFGLFFBQVFDO29CQUMzQixJQUFJLENBQUNoQixHQUFHLENBQUMsQ0FB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LENBQUM7WUFDakI7WUFFQSx5Q0FBeUM7WUFDekMsTUFBTWdCLGtCQUFrQm5FLGFBQWFJLE9BQU8sQ0FBQztZQUM3QyxJQUFJK0QsaUJBQWlCO2dCQUNuQkQsZUFBZXZDLFdBQVcsQ0FBQzJCLHFCQUFxQixHQUFHYTtZQUNyRDtZQUVBLG9CQUFvQjtZQUNwQkQsZUFBZUUsU0FBUyxHQUFHO1lBRTNCLElBQUksQ0FBQzVGLEdBQUcsQ0FBQyxtQ0FBbUM7WUFDNUMsT0FBTzBGO1FBQ1QsRUFBRSxPQUFPaEYsT0FBTztZQUNkLElBQUksQ0FBQ1YsR0FBRyxDQUFDLENBQUMsaUJBQWlCLEVBQUVVLE9BQU8sRUFBRTtZQUN0QyxPQUFPO1FBQ1Q7SUFDRjtJQUVBLDRCQUE0QjtJQUM1QixPQUFPbUYsYUFBYUMsTUFBbUIsRUFBaUM7UUFDdEUsTUFBTS9DLFdBQVcsSUFBSSxDQUFDc0IsZ0JBQWdCO1FBRXRDLElBQUl0QixVQUFVO1lBQ1osMkNBQTJDO1lBQzNDLElBQUkrQyxVQUFVL0MsU0FBUzJCLFNBQVMsQ0FBQ0ssZUFBZSxFQUFFO2dCQUNoRGUsT0FBTzdELElBQUksQ0FBQ2MsU0FBUzJCLFNBQVMsQ0FBQ0ssZUFBZTtZQUNoRDtZQUVBLE9BQU9oQztRQUNUO1FBRUEsT0FBTyxDQUFDO0lBQ1Y7SUFFQSwwQ0FBMEM7SUFDMUMsT0FBT2dELGdCQUFzQjtRQUMzQnZFLGFBQWFzQixVQUFVLENBQUMsSUFBSSxDQUFDbEQsV0FBVztJQUMxQztBQUNGO0FBRUEsaUNBQWlDO0FBQzFCLFNBQVNvRyx5QkFBeUJ4QyxDQUFvQjtJQUMzREEsRUFBRXlDLGNBQWM7SUFDaEJ6QyxFQUFFMEMsV0FBVyxHQUFHLElBQUksc0JBQXNCO0FBQzVDO0FBRUEsaUVBQWV6Ryx1QkFBdUJBLEVBQUMiLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9ncmFjZS1wcm9qZWN0L3NyYy91aS91dGlscy9TdGF0ZVBlcnNpc3RlbmNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcic7XG5pbXBvcnQgU3RhdGVPcGVyYXRpb25Mb2NrIGZyb20gJy4vU3RhdGVPcGVyYXRpb25Mb2NrJztcblxuLy8gRGVmaW5lIHRoZSBzaGFwZSBvZiBvdXIgcGVyc2lzdGVudCBzdGF0ZVxuZXhwb3J0IGludGVyZmFjZSBEeW5hbWljU3RhdGVTbmFwc2hvdCB7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICB2ZXJzaW9uPzogbnVtYmVyOyAgICAgIC8vIFNjaGVtYSB2ZXJzaW9uIGZvciBtaWdyYXRpb25zXG4gIHJlY292ZXJlZD86IGJvb2xlYW47ICAgLy8gRmxhZyBmb3IgcmVjb3ZlcmVkIHN0YXRlXG4gIHVzZXJTZXNzaW9uOiB7XG4gICAgdG9rZW4/OiBzdHJpbmc7XG4gICAgdXNlcm5hbWU/OiBzdHJpbmc7XG4gIH07XG4gIGNoYXRDb250ZXh0OiB7XG4gICAgY3VycmVudENvbnZlcnNhdGlvbklkPzogc3RyaW5nO1xuICAgIGRyYWZ0TWVzc2FnZT86IHN0cmluZztcbiAgICBsYXN0TWVzc2FnZVRpbWVzdGFtcD86IG51bWJlcjtcbiAgfTtcbiAgcGFnZVN0YXRlOiB7XG4gICAgbGFzdFZpc2l0ZWRQYXRoPzogc3RyaW5nO1xuICAgIHNjcm9sbFBvc2l0aW9ucz86IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gIH07XG4gIHdpZGdldFN0YXRlczoge1xuICAgIHRyYWRpbmdQb3NpdGlvbnM/OiBhbnlbXTtcbiAgICB3YWxsZXRCYWxhbmNlPzogbnVtYmVyO1xuICB9O1xuICBcbiAgLy8gRXh0ZW5kZWQgc3RhdGUgcHJvcGVydGllc1xuICBjaGF0U3RhdGU/OiB7XG4gICAgY3VycmVudFNlc3Npb25JZD86IHN0cmluZztcbiAgICBhY3RpdmVTZXNzaW9ucz86IHN0cmluZ1tdO1xuICAgIHNlc3Npb25zPzogUmVjb3JkPHN0cmluZywgYW55PjtcbiAgICBkcmFmdE1lc3NhZ2VzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgfTtcbiAgXG4gIHRyYWRpbmdTdGF0ZT86IHtcbiAgICBzZWxlY3RlZFRva2VuPzogYW55O1xuICAgIHdhdGNobGlzdD86IHN0cmluZ1tdO1xuICAgIHRyYWRlSGlzdG9yeT86IGFueVtdO1xuICAgIHRyYWRlRm9ybT86IGFueTtcbiAgICByZXNvbHV0aW9uPzogc3RyaW5nO1xuICAgIHNlYXJjaD86IHN0cmluZztcbiAgICBwb3NpdGlvbnM/OiBhbnlbXTtcbiAgfTtcbiAgXG4gIHdhbGxldFN0YXRlPzoge1xuICAgIGNvbm5lY3RlZFdhbGxldHM/OiBhbnlbXTtcbiAgICB0cmFuc2FjdGlvbnM/OiBhbnlbXTtcbiAgfTtcbiAgXG4gIHNvY2lhbFN0YXRlPzoge1xuICAgIHBvc3RzPzogYW55W107XG4gICAgZm9sbG93aW5nPzogc3RyaW5nW107XG4gICAgbm90aWZpY2F0aW9ucz86IGFueVtdO1xuICB9O1xuICBcbiAgdWlTdGF0ZT86IHtcbiAgICBkYXJrTW9kZT86IGJvb2xlYW47XG4gICAgc2lkZWJhck9wZW4/OiBib29sZWFuO1xuICAgIGFjdGl2ZVRhYnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICB9O1xufVxuXG5jbGFzcyBTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlciB7XG4gIHN0YXRpYyBnZXRTdG9yZWRTdGF0ZSgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ01ldGhvZCBub3QgaW1wbGVtZW50ZWQuJyk7XG4gIH1cbiAgLy8gU3RvcmFnZSBrZXlzIC0gbWFraW5nIHRoaXMgcHVibGljIHNvIGl0IGNhbiBiZSByZWZlcmVuY2VkIGJ5IHN5bmMgbG9naWNcbiAgcHVibGljIHN0YXRpYyBTVE9SQUdFX0tFWSA9ICdHUkFDRV9EWU5BTUlDX1NOQVBTSE9UJztcbiAgcHJpdmF0ZSBzdGF0aWMgTUFYX1NOQVBTSE9UX0FHRSA9IDI0ICogNjAgKiA2MCAqIDEwMDA7IC8vIDI0IGhvdXJzXG4gIHByaXZhdGUgc3RhdGljIFNUT1JBR0VfVkVSU0lPTiA9IDE7IC8vIFVzZWQgZm9yIHNjaGVtYSBtaWdyYXRpb25zXG4gIHByaXZhdGUgc3RhdGljIE1BWF9TVE9SQUdFX1NJWkUgPSA0ICogMTAyNCAqIDEwMjQ7IC8vIDRNQiBtYXggc2l6ZSAobG9jYWxTdG9yYWdlIGlzIHR5cGljYWxseSA1TUIpXG5cbiAgLy8gQWR2YW5jZWQgbG9nZ2luZyBtZWNoYW5pc21cbiAgcHJpdmF0ZSBzdGF0aWMgbG9nKG1lc3NhZ2U6IHN0cmluZywgbGV2ZWw6ICdpbmZvJyB8ICd3YXJuJyB8ICdlcnJvcicgPSAnaW5mbycpIHtcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gICAgY29uc3QgbG9nTWVzc2FnZSA9IGBbU3RhdGVQZXJzaXN0ZW5jZToke2xldmVsLnRvVXBwZXJDYXNlKCl9XSAke3RpbWVzdGFtcH0gLSAke21lc3NhZ2V9YDtcbiAgICBcbiAgICBzd2l0Y2gobGV2ZWwpIHtcbiAgICAgIGNhc2UgJ2luZm8nOiBjb25zb2xlLmxvZyhsb2dNZXNzYWdlKTsgYnJlYWs7XG4gICAgICBjYXNlICd3YXJuJzogY29uc29sZS53YXJuKGxvZ01lc3NhZ2UpOyBicmVhaztcbiAgICAgIGNhc2UgJ2Vycm9yJzogY29uc29sZS5lcnJvcihsb2dNZXNzYWdlKTsgYnJlYWs7XG4gICAgfVxuXG4gICAgLy8gT3B0aW9uYWw6IFNlbmQgdG8gZXJyb3IgdHJhY2tpbmcgc2VydmljZVxuICAgIC8vIHRoaXMucmVwb3J0VG9FcnJvclRyYWNraW5nKG1lc3NhZ2UsIGxldmVsKTtcbiAgfVxuXG4gIC8vIENoZWNrIHN0b3JhZ2UgcXVvdGEgYW5kIG1hbmFnZSBzaXplXG4gIHByaXZhdGUgc3RhdGljIGFzeW5jIGNoZWNrU3RvcmFnZVF1b3RhKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgdGhlIFN0b3JhZ2UgQVBJIGlmIGF2YWlsYWJsZSAobW9kZXJuIGJyb3dzZXJzKVxuICAgICAgaWYgKCdzdG9yYWdlJyBpbiBuYXZpZ2F0b3IgJiYgJ2VzdGltYXRlJyBpbiBuYXZpZ2F0b3Iuc3RvcmFnZSkge1xuICAgICAgICBjb25zdCBlc3RpbWF0ZSA9IGF3YWl0IG5hdmlnYXRvci5zdG9yYWdlLmVzdGltYXRlKCk7XG4gICAgICAgIGNvbnN0IHsgdXNhZ2UsIHF1b3RhIH0gPSBlc3RpbWF0ZTtcbiAgICAgICAgXG4gICAgICAgIGlmICh1c2FnZSAmJiBxdW90YSkge1xuICAgICAgICAgIGNvbnN0IHVzYWdlUmF0aW8gPSB1c2FnZSAvIHF1b3RhO1xuICAgICAgICAgIHRoaXMubG9nKGBTdG9yYWdlIHVzYWdlOiAkeyh1c2FnZVJhdGlvICogMTAwKS50b0ZpeGVkKDIpfSUgKCR7TWF0aC5yb3VuZCh1c2FnZSAvIDEwMjQgLyAxMDI0KX1NQiAvICR7TWF0aC5yb3VuZChxdW90YSAvIDEwMjQgLyAxMDI0KX1NQilgKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBJZiBvdmVyIDkwJSBvZiBxdW90YSwgdHJ5IHRvIGNsZWFuIHVwXG4gICAgICAgICAgaWYgKHVzYWdlUmF0aW8gPiAwLjkpIHtcbiAgICAgICAgICAgIHRoaXMubG9nKCdTdG9yYWdlIHF1b3RhIG5lYXJpbmcgbGltaXQsIGNsZWFuaW5nIHVwIG9sZCBkYXRhJywgJ3dhcm4nKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNsZWFudXBTdG9yYWdlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGYWxsYmFjayBmb3IgYnJvd3NlcnMgd2l0aG91dCBTdG9yYWdlIEFQSVxuICAgICAgICAvLyBDaGVjayBjdXJyZW50IHN0b3JhZ2Ugc2l6ZVxuICAgICAgICBsZXQgdG90YWxTaXplID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NhbFN0b3JhZ2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBrZXkgPSBsb2NhbFN0b3JhZ2Uua2V5KGkpO1xuICAgICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSB8fCAnJztcbiAgICAgICAgICAgIHRvdGFsU2l6ZSArPSBrZXkubGVuZ3RoICsgdmFsdWUubGVuZ3RoO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ29udmVydCB0byBNQiBmb3IgZWFzaWVyIGRlYnVnZ2luZ1xuICAgICAgICBjb25zdCBzaXplTUIgPSB0b3RhbFNpemUgLyAoMTAyNCAqIDEwMjQpO1xuICAgICAgICB0aGlzLmxvZyhgRXN0aW1hdGVkIGxvY2FsU3RvcmFnZSB1c2FnZTogJHtzaXplTUIudG9GaXhlZCgyKX1NQmApO1xuICAgICAgICBcbiAgICAgICAgLy8gSWYgb3ZlciA0TUIsIGNsZWFuIHVwICh0eXBpY2FsIGxvY2FsU3RvcmFnZSBsaW1pdCBpcyA1TUIpXG4gICAgICAgIGlmICh0b3RhbFNpemUgPiB0aGlzLk1BWF9TVE9SQUdFX1NJWkUpIHtcbiAgICAgICAgICB0aGlzLmxvZygnU3RvcmFnZSBzaXplIG5lYXJpbmcgbGltaXQsIGNsZWFuaW5nIHVwIG9sZCBkYXRhJywgJ3dhcm4nKTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5jbGVhbnVwU3RvcmFnZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZyhgRXJyb3IgY2hlY2tpbmcgc3RvcmFnZSBxdW90YTogJHtlcnJvcn1gLCAnZXJyb3InKTtcbiAgICAgIHJldHVybiB0cnVlOyAvLyBDb250aW51ZSBhbnl3YXkgdG8gbm90IGJsb2NrIG9wZXJhdGlvblxuICAgIH1cbiAgfVxuICBcbiAgLy8gQ2xlYW4gdXAgc3RvcmFnZSB3aGVuIGFwcHJvYWNoaW5nIHF1b3RhIGxpbWl0c1xuICBwcml2YXRlIHN0YXRpYyBjbGVhbnVwU3RvcmFnZSgpOiBib29sZWFuIHtcbiAgICB0cnkge1xuICAgICAgLy8gU3RyYXRlZ3kgMTogUmVtb3ZlIG9sZCBjaGF0IG1lc3NhZ2VzICh0eXBpY2FsbHkgdGhlIGxhcmdlc3QgZGF0YSlcbiAgICAgIGNvbnN0IGtleXNUb0NoZWNrOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsb2NhbFN0b3JhZ2UubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qga2V5ID0gbG9jYWxTdG9yYWdlLmtleShpKTtcbiAgICAgICAgaWYgKGtleSAmJiAoa2V5LnN0YXJ0c1dpdGgoJ21lc3NhZ2VzXycpIHx8IGtleS5pbmNsdWRlcygnZHJhZnRfJykpKSB7XG4gICAgICAgICAga2V5c1RvQ2hlY2sucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFNvcnQgYnkgbGFzdCBhY2Nlc3MgdGltZSBpZiBhdmFpbGFibGVcbiAgICAgIGNvbnN0IGtleXNXaXRoVGltZSA9IGtleXNUb0NoZWNrLm1hcChrZXkgPT4ge1xuICAgICAgICAvLyBFbnN1cmUga2V5IGlzIGEgc3RyaW5nIGJlZm9yZSBjYWxsaW5nIHJlcGxhY2VcbiAgICAgICAgY29uc3Qgc2Vzc2lvbklkID0gU3RyaW5nKGtleSkucmVwbGFjZSgnbWVzc2FnZXNfJywgJycpLnJlcGxhY2UoJ2RyYWZ0XycsICcnKTtcbiAgICAgICAgY29uc3QgbGFzdFN5bmNlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBsYXN0U3luY2VkXyR7c2Vzc2lvbklkfWApO1xuICAgICAgICBjb25zdCB0aW1lc3RhbXAgPSBsYXN0U3luY2VkID8gbmV3IERhdGUobGFzdFN5bmNlZCkuZ2V0VGltZSgpIDogMDtcbiAgICAgICAgcmV0dXJuIHsga2V5LCB0aW1lc3RhbXAgfTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBTb3J0IG9sZGVzdCBmaXJzdFxuICAgICAga2V5c1dpdGhUaW1lLnNvcnQoKGEsIGIpID0+IGEudGltZXN0YW1wIC0gYi50aW1lc3RhbXApO1xuICAgICAgXG4gICAgICAvLyBSZW1vdmUgb2xkZXN0IDMwJSBvZiBpdGVtc1xuICAgICAgY29uc3QgaXRlbXNUb1JlbW92ZSA9IE1hdGguY2VpbChrZXlzV2l0aFRpbWUubGVuZ3RoICogMC4zKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXNUb1JlbW92ZTsgaSsrKSB7XG4gICAgICAgIGlmIChpIDwga2V5c1dpdGhUaW1lLmxlbmd0aCkge1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleXNXaXRoVGltZVtpXS5rZXkpO1xuICAgICAgICAgIHRoaXMubG9nKGBSZW1vdmVkIG9sZCBkYXRhOiAke2tleXNXaXRoVGltZVtpXS5rZXl9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU3RyYXRlZ3kgMjogSWYgbWFpbiBzbmFwc2hvdCBpcyB0b28gbGFyZ2UsIHRyeSB0byB0cmltIGl0XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuU1RPUkFHRV9LRVkpO1xuICAgICAgaWYgKHNuYXBzaG90ICYmIHNuYXBzaG90Lmxlbmd0aCA+IDEwMjQgKiAxMDI0KSB7IC8vIElmIG92ZXIgMU1CXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcGFyc2VkU25hcHNob3QgPSBKU09OLnBhcnNlKHNuYXBzaG90KTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBUcmltIG1lc3NhZ2UgaGlzdG9yeSB0byByZWR1Y2Ugc2l6ZVxuICAgICAgICAgIGlmIChwYXJzZWRTbmFwc2hvdC5jaGF0Q29udGV4dCAmJiBwYXJzZWRTbmFwc2hvdC5jaGF0Q29udGV4dC5tZXNzYWdlcykge1xuICAgICAgICAgICAgLy8gS2VlcCBvbmx5IGxhc3QgMjAgbWVzc2FnZXNcbiAgICAgICAgICAgIHBhcnNlZFNuYXBzaG90LmNoYXRDb250ZXh0Lm1lc3NhZ2VzID0gXG4gICAgICAgICAgICAgIHBhcnNlZFNuYXBzaG90LmNoYXRDb250ZXh0Lm1lc3NhZ2VzLnNsaWNlKC0yMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIFN0b3JlIHRoZSB0cmltbWVkIHZlcnNpb25cbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLlNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShwYXJzZWRTbmFwc2hvdCkpO1xuICAgICAgICAgIHRoaXMubG9nKCdUcmltbWVkIG1haW4gc25hcHNob3Qgc2l6ZScpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgdGhpcy5sb2coYEVycm9yIHRyaW1taW5nIHNuYXBzaG90OiAke2V9YCwgJ2Vycm9yJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nKGBFcnJvciBjbGVhbmluZyB1cCBzdG9yYWdlOiAke2Vycm9yfWAsICdlcnJvcicpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gVmFsaWRhdGUgc25hcHNob3Qgc3RydWN0dXJlIGFuZCBzY2hlbWFcbiAgcHJpdmF0ZSBzdGF0aWMgdmFsaWRhdGVTbmFwc2hvdFNjaGVtYShzbmFwc2hvdDogYW55KTogYm9vbGVhbiB7XG4gICAgaWYgKCFzbmFwc2hvdCB8fCB0eXBlb2Ygc25hcHNob3QgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gQ2hlY2sgcmVxdWlyZWQgZmllbGRzXG4gICAgaWYgKHR5cGVvZiBzbmFwc2hvdC50aW1lc3RhbXAgIT09ICdudW1iZXInKSByZXR1cm4gZmFsc2U7XG4gICAgXG4gICAgLy8gQ2hlY2sgZm9yIHJlcXVpcmVkIHN1Yi1vYmplY3RzXG4gICAgY29uc3QgcmVxdWlyZWRPYmplY3RzID0gWyd1c2VyU2Vzc2lvbicsICdjaGF0Q29udGV4dCcsICdwYWdlU3RhdGUnLCAnd2lkZ2V0U3RhdGVzJ107XG4gICAgZm9yIChjb25zdCBvYmogb2YgcmVxdWlyZWRPYmplY3RzKSB7XG4gICAgICBpZiAoIXNuYXBzaG90W29ial0gfHwgdHlwZW9mIHNuYXBzaG90W29ial0gIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBDcmVhdGUgYSBiYWNrdXAgb2YgdGhlIGN1cnJlbnQgc25hcHNob3RcbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlQmFja3VwKCk6IHZvaWQge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjdXJyZW50U25hcHNob3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLlNUT1JBR0VfS0VZKTtcbiAgICAgIGlmIChjdXJyZW50U25hcHNob3QpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7dGhpcy5TVE9SQUdFX0tFWX1fQkFDS1VQYCwgY3VycmVudFNuYXBzaG90KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2coYEZhaWxlZCB0byBjcmVhdGUgYmFja3VwOiAke2Vycm9yfWAsICd3YXJuJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ2FwdHVyZSB0aGUgY3VycmVudCBhcHBsaWNhdGlvbiBzdGF0ZSB3aXRoIGVuaGFuY2VkIHNhZmV0eVxuICBzdGF0aWMgYXN5bmMgY2FwdHVyZVNuYXBzaG90KHBhcnRpYWxTdGF0ZT86IFBhcnRpYWw8RHluYW1pY1N0YXRlU25hcHNob3Q+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gQWNxdWlyZSBhIGxvY2sgZm9yIHN0YXRlIG9wZXJhdGlvbnMgdG8gcHJldmVudCByYWNlIGNvbmRpdGlvbnNcbiAgICBjb25zdCBsb2NrSWQgPSBTdGF0ZU9wZXJhdGlvbkxvY2suYWNxdWlyZUxvY2soJ3N0YXRlX3NuYXBzaG90JywgJ2NhcHR1cmVfc25hcHNob3QnKTtcbiAgICBpZiAoIWxvY2tJZCkge1xuICAgICAgdGhpcy5sb2coJ0NvdWxkIG5vdCBhY3F1aXJlIGxvY2sgZm9yIHN0YXRlIG9wZXJhdGlvbiwgYW5vdGhlciBvcGVyYXRpb24gaXMgaW4gcHJvZ3Jlc3MnLCAnd2FybicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gVmFsaWRhdGUgc3RvcmFnZSBhdmFpbGFiaWxpdHlcbiAgICAgIGlmICghdGhpcy5pc1N0b3JhZ2VBdmFpbGFibGUoKSkge1xuICAgICAgICB0aGlzLmxvZygnTG9jYWwgc3RvcmFnZSBub3QgYXZhaWxhYmxlJywgJ3dhcm4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDaGVjayBxdW90YSBiZWZvcmUgd3JpdGluZ1xuICAgICAgY29uc3QgcXVvdGFPayA9IGF3YWl0IHRoaXMuY2hlY2tTdG9yYWdlUXVvdGEoKTtcbiAgICAgIGlmICghcXVvdGFPaykge1xuICAgICAgICB0aGlzLmxvZygnU3RvcmFnZSBxdW90YSBpc3N1ZXMsIGRhdGEgbWF5IG5vdCBiZSBzYXZlZCBjb21wbGV0ZWx5JywgJ3dhcm4nKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZXhpc3RpbmdTbmFwc2hvdCA9IHRoaXMucmV0cmlldmVTbmFwc2hvdCgpO1xuICAgICAgY29uc3QgbmV3U25hcHNob3Q6IER5bmFtaWNTdGF0ZVNuYXBzaG90ID0ge1xuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIHZlcnNpb246IHRoaXMuU1RPUkFHRV9WRVJTSU9OLCAvLyBBZGQgdmVyc2lvbiBmb3Igc2NoZW1hIG1pZ3JhdGlvbnNcbiAgICAgICAgdXNlclNlc3Npb246IHBhcnRpYWxTdGF0ZT8udXNlclNlc3Npb24gfHwgZXhpc3RpbmdTbmFwc2hvdD8udXNlclNlc3Npb24gfHwge30sXG4gICAgICAgIGNoYXRDb250ZXh0OiBwYXJ0aWFsU3RhdGU/LmNoYXRDb250ZXh0IHx8IGV4aXN0aW5nU25hcHNob3Q/LmNoYXRDb250ZXh0IHx8IHt9LFxuICAgICAgICBwYWdlU3RhdGU6IHBhcnRpYWxTdGF0ZT8ucGFnZVN0YXRlIHx8IGV4aXN0aW5nU25hcHNob3Q/LnBhZ2VTdGF0ZSB8fCB7fSxcbiAgICAgICAgd2lkZ2V0U3RhdGVzOiBwYXJ0aWFsU3RhdGU/LndpZGdldFN0YXRlcyB8fCBleGlzdGluZ1NuYXBzaG90Py53aWRnZXRTdGF0ZXMgfHwge31cbiAgICAgIH07XG5cbiAgICAgIC8vIENyZWF0ZSBhIGJhY2t1cCBvZiB0aGUgY3VycmVudCBzdGF0ZSBiZWZvcmUgdXBkYXRpbmdcbiAgICAgIHRoaXMuY3JlYXRlQmFja3VwKCk7XG4gICAgICBcbiAgICAgIC8vIEF0dGVtcHQgdG8gc2F2ZSBzdGF0ZVxuICAgICAgdHJ5IHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkobmV3U25hcHNob3QpKTtcbiAgICAgICAgdGhpcy5sb2coJ1N0YXRlIHNuYXBzaG90IGNhcHR1cmVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgfSBjYXRjaCAoc3RvcmFnZUVycm9yKSB7XG4gICAgICAgIC8vIElmIGZhaWxlZCBkdWUgdG8gcXVvdGEsIGZvcmNlIGNsZWFudXAgYW5kIHRyeSBhZ2FpblxuICAgICAgICB0aGlzLmxvZyhgU3RvcmFnZSBlcnJvciwgZm9yY2luZyBjbGVhbnVwOiAke3N0b3JhZ2VFcnJvcn1gLCAnd2FybicpO1xuICAgICAgICB0aGlzLmNsZWFudXBTdG9yYWdlKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBUcnkgb25lIG1vcmUgdGltZSB3aXRoIGEgbW9yZSBtaW5pbWFsIHN0YXRlXG4gICAgICAgIGNvbnN0IG1pbmltYWxTbmFwc2hvdCA9IHtcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgdmVyc2lvbjogdGhpcy5TVE9SQUdFX1ZFUlNJT04sXG4gICAgICAgICAgdXNlclNlc3Npb246IG5ld1NuYXBzaG90LnVzZXJTZXNzaW9uLFxuICAgICAgICAgIC8vIE1pbmltYWwgb2JqZWN0cyB0byBlbnN1cmUgYmFzaWMgZnVuY3Rpb25hbGl0eVxuICAgICAgICAgIGNoYXRDb250ZXh0OiB7IGN1cnJlbnRDb252ZXJzYXRpb25JZDogbmV3U25hcHNob3QuY2hhdENvbnRleHQuY3VycmVudENvbnZlcnNhdGlvbklkIH0sXG4gICAgICAgICAgcGFnZVN0YXRlOiB7IGxhc3RWaXNpdGVkUGF0aDogbmV3U25hcHNob3QucGFnZVN0YXRlLmxhc3RWaXNpdGVkUGF0aCB9LFxuICAgICAgICAgIHdpZGdldFN0YXRlczoge31cbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMuU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KG1pbmltYWxTbmFwc2hvdCkpO1xuICAgICAgICB0aGlzLmxvZygnTWluaW1hbCBzdGF0ZSBzbmFwc2hvdCBzYXZlZCBhcyBmYWxsYmFjaycpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZyhgRmFpbGVkIHRvIGNhcHR1cmUgc3RhdGUgc25hcHNob3Q6ICR7ZXJyb3J9YCwgJ2Vycm9yJyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIEFsd2F5cyByZWxlYXNlIHRoZSBsb2NrXG4gICAgICBTdGF0ZU9wZXJhdGlvbkxvY2sucmVsZWFzZUxvY2soJ3N0YXRlX3NuYXBzaG90JywgbG9ja0lkKTtcbiAgICB9XG4gIH1cblxuICAvLyBDaGVjayBsb2NhbCBzdG9yYWdlIGF2YWlsYWJpbGl0eVxuICBwcml2YXRlIHN0YXRpYyBpc1N0b3JhZ2VBdmFpbGFibGUoKTogYm9vbGVhbiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRlc3RLZXkgPSAnX19zdG9yYWdlX3Rlc3RfXyc7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0ZXN0S2V5LCB0ZXN0S2V5KTtcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRlc3RLZXkpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8vIFZhbGlkYXRlIHNuYXBzaG90IGFnZSBhbmQgaW50ZWdyaXR5XG4gIHByaXZhdGUgc3RhdGljIHZhbGlkYXRlU25hcHNob3Qoc25hcHNob3Q6IER5bmFtaWNTdGF0ZVNuYXBzaG90KTogYm9vbGVhbiB7XG4gICAgaWYgKCFzbmFwc2hvdCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgLy8gQ2hlY2sgc2NoZW1hL3N0cnVjdHVyZSB2YWxpZGl0eVxuICAgIGlmICghdGhpcy52YWxpZGF0ZVNuYXBzaG90U2NoZW1hKHNuYXBzaG90KSkge1xuICAgICAgdGhpcy5sb2coJ1NuYXBzaG90IGhhcyBpbnZhbGlkIHNjaGVtYSwgZGlzY2FyZGluZycsICd3YXJuJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3QgY3VycmVudFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHNuYXBzaG90QWdlID0gY3VycmVudFRpbWUgLSBzbmFwc2hvdC50aW1lc3RhbXA7XG5cbiAgICBpZiAoc25hcHNob3RBZ2UgPiB0aGlzLk1BWF9TTkFQU0hPVF9BR0UpIHtcbiAgICAgIHRoaXMubG9nKCdTbmFwc2hvdCB0b28gb2xkLCBkaXNjYXJkaW5nJywgJ3dhcm4nKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIFJldHJpZXZlIHRoZSBsYXN0IHNhdmVkIHN0YXRlIHNuYXBzaG90IHdpdGggY29ycnVwdGlvbiByZWNvdmVyeVxuICBzdGF0aWMgcmV0cmlldmVTbmFwc2hvdCgpOiBEeW5hbWljU3RhdGVTbmFwc2hvdCB8IG51bGwge1xuICAgIC8vIFdlIGRvbid0IGxvY2sgZm9yIHJlYWRzLCBidXQgd2UgZG8gY2hlY2sgaWYgdGhlcmUncyBhIHdyaXRlIGluIHByb2dyZXNzXG4gICAgaWYgKFN0YXRlT3BlcmF0aW9uTG9jay5pc0xvY2tlZCgnc3RhdGVfc25hcHNob3QnKSkge1xuICAgICAgdGhpcy5sb2coJ1N0YXRlIHNuYXBzaG90IGlzIGN1cnJlbnRseSBiZWluZyB1cGRhdGVkLCB1c2luZyBleGlzdGluZyBzbmFwc2hvdCcsICd3YXJuJyk7XG4gICAgfVxuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzbmFwc2hvdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRoaXMuU1RPUkFHRV9LRVkpO1xuICAgICAgaWYgKCFzbmFwc2hvdCkgcmV0dXJuIG51bGw7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBhcnNlZFNuYXBzaG90OiBEeW5hbWljU3RhdGVTbmFwc2hvdCA9IEpTT04ucGFyc2Uoc25hcHNob3QpO1xuICAgICAgICBcbiAgICAgICAgLy8gVmFsaWRhdGUgc25hcHNob3QgaW50ZWdyaXR5XG4gICAgICAgIGlmICh0aGlzLnZhbGlkYXRlU25hcHNob3QocGFyc2VkU25hcHNob3QpKSB7XG4gICAgICAgICAgcmV0dXJuIHBhcnNlZFNuYXBzaG90O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubG9nKCdJbnZhbGlkIHNuYXBzaG90IGRldGVjdGVkLCBhdHRlbXB0aW5nIHJlY292ZXJ5JywgJ3dhcm4nKTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5hdHRlbXB0U25hcHNob3RSZWNvdmVyeSgpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgIHRoaXMubG9nKGBKU09OIHBhcnNlIGVycm9yOiAke3BhcnNlRXJyb3J9LCBhdHRlbXB0aW5nIHJlY292ZXJ5YCwgJ2Vycm9yJyk7XG4gICAgICAgIHJldHVybiB0aGlzLmF0dGVtcHRTbmFwc2hvdFJlY292ZXJ5KCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nKGBGYWlsZWQgdG8gcmV0cmlldmUgc3RhdGUgc25hcHNob3Q6ICR7ZXJyb3J9YCwgJ2Vycm9yJyk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIEF0dGVtcHQgdG8gcmVjb3ZlciBjb3JydXB0ZWQgc3RhdGVcbiAgcHJpdmF0ZSBzdGF0aWMgYXR0ZW1wdFNuYXBzaG90UmVjb3ZlcnkoKTogRHluYW1pY1N0YXRlU25hcHNob3QgfCBudWxsIHtcbiAgICB0cnkge1xuICAgICAgdGhpcy5sb2coJ0F0dGVtcHRpbmcgc3RhdGUgcmVjb3ZlcnknLCAnd2FybicpO1xuICAgICAgXG4gICAgICAvLyBTdHJhdGVneSAxOiBDaGVjayBmb3IgYmFja3VwXG4gICAgICBjb25zdCBiYWNrdXBTbmFwc2hvdCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGAke3RoaXMuU1RPUkFHRV9LRVl9X0JBQ0tVUGApO1xuICAgICAgaWYgKGJhY2t1cFNuYXBzaG90KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcGFyc2VkQmFja3VwID0gSlNPTi5wYXJzZShiYWNrdXBTbmFwc2hvdCk7XG4gICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVTbmFwc2hvdChwYXJzZWRCYWNrdXApKSB7XG4gICAgICAgICAgICB0aGlzLmxvZygnUmVjb3ZlcmVkIHN0YXRlIGZyb20gYmFja3VwJywgJ2luZm8nKTtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZWRCYWNrdXA7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgdGhpcy5sb2coJ0JhY2t1cCBzbmFwc2hvdCBhbHNvIGNvcnJ1cHRlZCcsICd3YXJuJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU3RyYXRlZ3kgMjogQnVpbGQgZnJvbSBpbmRpdmlkdWFsIHBpZWNlcyBpbiBsb2NhbFN0b3JhZ2VcbiAgICAgIGNvbnN0IHJlY292ZXJlZFN0YXRlOiBEeW5hbWljU3RhdGVTbmFwc2hvdCA9IHtcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB2ZXJzaW9uOiB0aGlzLlNUT1JBR0VfVkVSU0lPTixcbiAgICAgICAgdXNlclNlc3Npb246IHt9LFxuICAgICAgICBjaGF0Q29udGV4dDoge30sXG4gICAgICAgIHBhZ2VTdGF0ZToge30sXG4gICAgICAgIHdpZGdldFN0YXRlczoge31cbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFRyeSB0byBnZXQgbGFzdCBwYXRoIGZyb20gbG9jYWxTdG9yYWdlXG4gICAgICBjb25zdCBhY3RpdmVTZXNzaW9uSWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWN0aXZlU2Vzc2lvbklkJyk7XG4gICAgICBpZiAoYWN0aXZlU2Vzc2lvbklkKSB7XG4gICAgICAgIHJlY292ZXJlZFN0YXRlLmNoYXRDb250ZXh0LmN1cnJlbnRDb252ZXJzYXRpb25JZCA9IGFjdGl2ZVNlc3Npb25JZDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU2V0IHJlY292ZXJ5IGZsYWdcbiAgICAgIHJlY292ZXJlZFN0YXRlLnJlY292ZXJlZCA9IHRydWU7XG4gICAgICBcbiAgICAgIHRoaXMubG9nKCdDcmVhdGVkIG1pbmltYWwgcmVjb3ZlcmVkIHN0YXRlJywgJ2luZm8nKTtcbiAgICAgIHJldHVybiByZWNvdmVyZWRTdGF0ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2coYFJlY292ZXJ5IGZhaWxlZDogJHtlcnJvcn1gLCAnZXJyb3InKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8vIEh5ZHJhdGUgYXBwbGljYXRpb24gc3RhdGVcbiAgc3RhdGljIGh5ZHJhdGVTdGF0ZShyb3V0ZXI/OiBOZXh0Um91dGVyKTogUGFydGlhbDxEeW5hbWljU3RhdGVTbmFwc2hvdD4ge1xuICAgIGNvbnN0IHNuYXBzaG90ID0gdGhpcy5yZXRyaWV2ZVNuYXBzaG90KCk7XG4gICAgXG4gICAgaWYgKHNuYXBzaG90KSB7XG4gICAgICAvLyBPcHRpb25hbGx5IG5hdmlnYXRlIHRvIGxhc3QgdmlzaXRlZCBwYXRoXG4gICAgICBpZiAocm91dGVyICYmIHNuYXBzaG90LnBhZ2VTdGF0ZS5sYXN0VmlzaXRlZFBhdGgpIHtcbiAgICAgICAgcm91dGVyLnB1c2goc25hcHNob3QucGFnZVN0YXRlLmxhc3RWaXNpdGVkUGF0aCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzbmFwc2hvdDtcbiAgICB9XG5cbiAgICByZXR1cm4ge307XG4gIH1cblxuICAvLyBDbGVhciB0aGUgc25hcHNob3QgKHVzZWQgZHVyaW5nIGxvZ291dClcbiAgc3RhdGljIGNsZWFyU25hcHNob3QoKTogdm9pZCB7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0odGhpcy5TVE9SQUdFX0tFWSk7XG4gIH1cbn1cblxuLy8gUHJldmVudCBhY2NpZGVudGFsIHBhZ2UgdW5sb2FkXG5leHBvcnQgZnVuY3Rpb24gcHJldmVudFVuaW50ZW5kZWRSZWZyZXNoKGU6IEJlZm9yZVVubG9hZEV2ZW50KSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgZS5yZXR1cm5WYWx1ZSA9ICcnOyAvLyBSZXF1aXJlZCBmb3IgQ2hyb21lXG59XG5cbmV4cG9ydCBkZWZhdWx0IFN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyO1xuIl0sIm5hbWVzIjpbIlN0YXRlT3BlcmF0aW9uTG9jayIsIlN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyIiwiZ2V0U3RvcmVkU3RhdGUiLCJFcnJvciIsIlNUT1JBR0VfS0VZIiwiTUFYX1NOQVBTSE9UX0FHRSIsIlNUT1JBR0VfVkVSU0lPTiIsIk1BWF9TVE9SQUdFX1NJWkUiLCJsb2ciLCJtZXNzYWdlIiwibGV2ZWwiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJsb2dNZXNzYWdlIiwidG9VcHBlckNhc2UiLCJjb25zb2xlIiwid2FybiIsImVycm9yIiwiY2hlY2tTdG9yYWdlUXVvdGEiLCJuYXZpZ2F0b3IiLCJzdG9yYWdlIiwiZXN0aW1hdGUiLCJ1c2FnZSIsInF1b3RhIiwidXNhZ2VSYXRpbyIsInRvRml4ZWQiLCJNYXRoIiwicm91bmQiLCJjbGVhbnVwU3RvcmFnZSIsInRvdGFsU2l6ZSIsImkiLCJsb2NhbFN0b3JhZ2UiLCJsZW5ndGgiLCJrZXkiLCJ2YWx1ZSIsImdldEl0ZW0iLCJzaXplTUIiLCJrZXlzVG9DaGVjayIsInN0YXJ0c1dpdGgiLCJpbmNsdWRlcyIsInB1c2giLCJrZXlzV2l0aFRpbWUiLCJtYXAiLCJzZXNzaW9uSWQiLCJTdHJpbmciLCJyZXBsYWNlIiwibGFzdFN5bmNlZCIsImdldFRpbWUiLCJzb3J0IiwiYSIsImIiLCJpdGVtc1RvUmVtb3ZlIiwiY2VpbCIsInJlbW92ZUl0ZW0iLCJzbmFwc2hvdCIsInBhcnNlZFNuYXBzaG90IiwiSlNPTiIsInBhcnNlIiwiY2hhdENvbnRleHQiLCJtZXNzYWdlcyIsInNsaWNlIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImUiLCJ2YWxpZGF0ZVNuYXBzaG90U2NoZW1hIiwicmVxdWlyZWRPYmplY3RzIiwib2JqIiwiY3JlYXRlQmFja3VwIiwiY3VycmVudFNuYXBzaG90IiwiY2FwdHVyZVNuYXBzaG90IiwicGFydGlhbFN0YXRlIiwibG9ja0lkIiwiYWNxdWlyZUxvY2siLCJpc1N0b3JhZ2VBdmFpbGFibGUiLCJxdW90YU9rIiwiZXhpc3RpbmdTbmFwc2hvdCIsInJldHJpZXZlU25hcHNob3QiLCJuZXdTbmFwc2hvdCIsIm5vdyIsInZlcnNpb24iLCJ1c2VyU2Vzc2lvbiIsInBhZ2VTdGF0ZSIsIndpZGdldFN0YXRlcyIsInN0b3JhZ2VFcnJvciIsIm1pbmltYWxTbmFwc2hvdCIsImN1cnJlbnRDb252ZXJzYXRpb25JZCIsImxhc3RWaXNpdGVkUGF0aCIsInJlbGVhc2VMb2NrIiwidGVzdEtleSIsInZhbGlkYXRlU25hcHNob3QiLCJjdXJyZW50VGltZSIsInNuYXBzaG90QWdlIiwiaXNMb2NrZWQiLCJhdHRlbXB0U25hcHNob3RSZWNvdmVyeSIsInBhcnNlRXJyb3IiLCJiYWNrdXBTbmFwc2hvdCIsInBhcnNlZEJhY2t1cCIsInJlY292ZXJlZFN0YXRlIiwiYWN0aXZlU2Vzc2lvbklkIiwicmVjb3ZlcmVkIiwiaHlkcmF0ZVN0YXRlIiwicm91dGVyIiwiY2xlYXJTbmFwc2hvdCIsInByZXZlbnRVbmludGVuZGVkUmVmcmVzaCIsInByZXZlbnREZWZhdWx0IiwicmV0dXJuVmFsdWUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/StatePersistence.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./utils/authUtils.ts":
/*!****************************!*\
  !*** ./utils/authUtils.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TOKEN_EXPIRY_KEY: () => (/* binding */ TOKEN_EXPIRY_KEY),\n/* harmony export */   TOKEN_KEY: () => (/* binding */ TOKEN_KEY),\n/* harmony export */   addAuthHeaders: () => (/* binding */ addAuthHeaders),\n/* harmony export */   authFetch: () => (/* binding */ authFetch),\n/* harmony export */   clearAuthTokens: () => (/* binding */ clearAuthTokens),\n/* harmony export */   getAuthToken: () => (/* binding */ getAuthToken),\n/* harmony export */   getTokenExpiry: () => (/* binding */ getTokenExpiry),\n/* harmony export */   isTokenExpired: () => (/* binding */ isTokenExpired),\n/* harmony export */   storeAuthToken: () => (/* binding */ storeAuthToken)\n/* harmony export */ });\n/**\n * Authentication Utilities for Grace App\n * \n * Provides standardized token management compatible with the existing auth-utils.js system.\n */ // Token storage constants - exported for consistency across the codebase\nconst TOKEN_KEY = 'grace_token';\nconst TOKEN_EXPIRY_KEY = 'grace_token_expiry';\n// Backward/parallel compatibility: some modules may use this alternate key\nconst ALT_TOKEN_KEY = 'grace_auth_token';\n// Simple mutex to prevent race conditions\nlet tokenMutex = Promise.resolve();\n/**\n * Store authentication token with remember-me preference\n * Uses a mutex to prevent race conditions\n */ async function storeAuthToken(token, rememberMe = false) {\n    if (true) return;\n    // Wait for any existing operation to complete\n    await tokenMutex;\n    // Create a new lock that others will wait for\n    let releaseLock;\n    tokenMutex = new Promise((resolve)=>{\n        releaseLock = resolve;\n    });\n    try {\n        // Clear both to prevent any token conflicts\n        clearAuthTokens();\n        // Store in the appropriate location\n        const storage = rememberMe ? localStorage : sessionStorage;\n        // Write under both keys for compatibility\n        storage.setItem(TOKEN_KEY, token);\n        storage.setItem(ALT_TOKEN_KEY, token);\n        // Set expiry date (24 hours from now)\n        const expiry = new Date();\n        expiry.setHours(expiry.getHours() + 24);\n        storage.setItem(TOKEN_EXPIRY_KEY, expiry.toISOString());\n    } finally{\n        releaseLock();\n    }\n}\n/**\n * Get the current authentication token from storage\n * Checks sessionStorage first, then falls back to localStorage\n */ function getAuthToken() {\n    if (false) {}\n    return null;\n}\n/**\n * Get token expiration date\n */ function getTokenExpiry() {\n    if (false) {}\n    return null;\n}\n/**\n * Check if token is expired\n */ function isTokenExpired() {\n    const expiry = getTokenExpiry();\n    return !expiry || expiry < new Date();\n}\n/**\n * Clear all authentication tokens\n */ function clearAuthTokens() {\n    if (false) {}\n}\n/**\n * Add authorization headers to fetch options\n */ function addAuthHeaders(options = {}) {\n    const token = getAuthToken();\n    const headers = {\n        ...options.headers,\n        'Content-Type': 'application/json'\n    };\n    if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n    }\n    return {\n        ...options,\n        headers\n    };\n}\n/**\n * Wrapper for fetch with authentication headers\n */ async function authFetch(url, options = {}) {\n    return fetch(url, addAuthHeaders(options));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL2F1dGhVdGlscy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTs7OztDQUlDLEdBRUQseUVBQXlFO0FBQ2xFLE1BQU1BLFlBQVksY0FBYztBQUNoQyxNQUFNQyxtQkFBbUIscUJBQXFCO0FBQ3JELDJFQUEyRTtBQUMzRSxNQUFNQyxnQkFBZ0I7QUFFdEIsMENBQTBDO0FBQzFDLElBQUlDLGFBQWFDLFFBQVFDLE9BQU87QUFFaEM7OztDQUdDLEdBQ00sZUFBZUMsZUFBZUMsS0FBYSxFQUFFQyxhQUFzQixLQUFLO0lBQzdFLElBQUksSUFBNkIsRUFBRTtJQUVuQyw4Q0FBOEM7SUFDOUMsTUFBTUw7SUFFTiw4Q0FBOEM7SUFDOUMsSUFBSU07SUFDSk4sYUFBYSxJQUFJQyxRQUFRQyxDQUFBQTtRQUN2QkksY0FBY0o7SUFDaEI7SUFFQSxJQUFJO1FBQ0YsNENBQTRDO1FBQzVDSztRQUVBLG9DQUFvQztRQUNwQyxNQUFNQyxVQUFVSCxhQUFhSSxlQUFlQztRQUM1QywwQ0FBMEM7UUFDMUNGLFFBQVFHLE9BQU8sQ0FBQ2QsV0FBV087UUFDM0JJLFFBQVFHLE9BQU8sQ0FBQ1osZUFBZUs7UUFFL0Isc0NBQXNDO1FBQ3RDLE1BQU1RLFNBQVMsSUFBSUM7UUFDbkJELE9BQU9FLFFBQVEsQ0FBQ0YsT0FBT0csUUFBUSxLQUFLO1FBQ3BDUCxRQUFRRyxPQUFPLENBQUNiLGtCQUFrQmMsT0FBT0ksV0FBVztJQUN0RCxTQUFVO1FBQ1JWO0lBQ0Y7QUFDRjtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNXO0lBQ2QsSUFBSSxLQUE2QixFQUFFLEVBU2xDO0lBQ0QsT0FBTztBQUNUO0FBRUE7O0NBRUMsR0FDTSxTQUFTRTtJQUNkLElBQUksS0FBNkIsRUFBRSxFQUdsQztJQUNELE9BQU87QUFDVDtBQUVBOztDQUVDLEdBQ00sU0FBU0U7SUFDZCxNQUFNVCxTQUFTTztJQUNmLE9BQU8sQ0FBQ1AsVUFBVUEsU0FBUyxJQUFJQztBQUNqQztBQUVBOztDQUVDLEdBQ00sU0FBU047SUFDZCxJQUFJLEtBQTZCLEVBQUUsRUFRbEM7QUFDSDtBQUVBOztDQUVDLEdBQ00sU0FBU2dCLGVBQWVDLFVBQXVCLENBQUMsQ0FBQztJQUN0RCxNQUFNcEIsUUFBUWE7SUFDZCxNQUFNUSxVQUFVO1FBQ2QsR0FBR0QsUUFBUUMsT0FBTztRQUNsQixnQkFBZ0I7SUFDbEI7SUFFQSxJQUFJckIsT0FBTztRQUNUcUIsT0FBTyxDQUFDLGdCQUFnQixHQUFHLENBQUMsT0FBTyxFQUFFckIsT0FBTztJQUM5QztJQUVBLE9BQU87UUFDTCxHQUFHb0IsT0FBTztRQUNWQztJQUNGO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVDLFVBQVVDLEdBQVcsRUFBRUgsVUFBdUIsQ0FBQyxDQUFDO0lBQ3BFLE9BQU9JLE1BQU1ELEtBQUtKLGVBQWVDO0FBQ25DIiwic291cmNlcyI6WyIvaG9tZS91YnVudHUvZ3JhY2UtcHJvamVjdC9zcmMvdWkvdXRpbHMvYXV0aFV0aWxzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQXV0aGVudGljYXRpb24gVXRpbGl0aWVzIGZvciBHcmFjZSBBcHBcbiAqIFxuICogUHJvdmlkZXMgc3RhbmRhcmRpemVkIHRva2VuIG1hbmFnZW1lbnQgY29tcGF0aWJsZSB3aXRoIHRoZSBleGlzdGluZyBhdXRoLXV0aWxzLmpzIHN5c3RlbS5cbiAqL1xuXG4vLyBUb2tlbiBzdG9yYWdlIGNvbnN0YW50cyAtIGV4cG9ydGVkIGZvciBjb25zaXN0ZW5jeSBhY3Jvc3MgdGhlIGNvZGViYXNlXG5leHBvcnQgY29uc3QgVE9LRU5fS0VZID0gJ2dyYWNlX3Rva2VuJztcbmV4cG9ydCBjb25zdCBUT0tFTl9FWFBJUllfS0VZID0gJ2dyYWNlX3Rva2VuX2V4cGlyeSc7XG4vLyBCYWNrd2FyZC9wYXJhbGxlbCBjb21wYXRpYmlsaXR5OiBzb21lIG1vZHVsZXMgbWF5IHVzZSB0aGlzIGFsdGVybmF0ZSBrZXlcbmNvbnN0IEFMVF9UT0tFTl9LRVkgPSAnZ3JhY2VfYXV0aF90b2tlbic7XG5cbi8vIFNpbXBsZSBtdXRleCB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xubGV0IHRva2VuTXV0ZXggPSBQcm9taXNlLnJlc29sdmUoKTtcblxuLyoqXG4gKiBTdG9yZSBhdXRoZW50aWNhdGlvbiB0b2tlbiB3aXRoIHJlbWVtYmVyLW1lIHByZWZlcmVuY2VcbiAqIFVzZXMgYSBtdXRleCB0byBwcmV2ZW50IHJhY2UgY29uZGl0aW9uc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc3RvcmVBdXRoVG9rZW4odG9rZW46IHN0cmluZywgcmVtZW1iZXJNZTogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykgcmV0dXJuO1xuICBcbiAgLy8gV2FpdCBmb3IgYW55IGV4aXN0aW5nIG9wZXJhdGlvbiB0byBjb21wbGV0ZVxuICBhd2FpdCB0b2tlbk11dGV4O1xuICBcbiAgLy8gQ3JlYXRlIGEgbmV3IGxvY2sgdGhhdCBvdGhlcnMgd2lsbCB3YWl0IGZvclxuICBsZXQgcmVsZWFzZUxvY2s6ICgpID0+IHZvaWQ7XG4gIHRva2VuTXV0ZXggPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICByZWxlYXNlTG9jayA9IHJlc29sdmU7XG4gIH0pO1xuICBcbiAgdHJ5IHtcbiAgICAvLyBDbGVhciBib3RoIHRvIHByZXZlbnQgYW55IHRva2VuIGNvbmZsaWN0c1xuICAgIGNsZWFyQXV0aFRva2VucygpO1xuICAgIFxuICAgIC8vIFN0b3JlIGluIHRoZSBhcHByb3ByaWF0ZSBsb2NhdGlvblxuICAgIGNvbnN0IHN0b3JhZ2UgPSByZW1lbWJlck1lID8gbG9jYWxTdG9yYWdlIDogc2Vzc2lvblN0b3JhZ2U7XG4gICAgLy8gV3JpdGUgdW5kZXIgYm90aCBrZXlzIGZvciBjb21wYXRpYmlsaXR5XG4gICAgc3RvcmFnZS5zZXRJdGVtKFRPS0VOX0tFWSwgdG9rZW4pO1xuICAgIHN0b3JhZ2Uuc2V0SXRlbShBTFRfVE9LRU5fS0VZLCB0b2tlbik7XG4gICAgXG4gICAgLy8gU2V0IGV4cGlyeSBkYXRlICgyNCBob3VycyBmcm9tIG5vdylcbiAgICBjb25zdCBleHBpcnkgPSBuZXcgRGF0ZSgpO1xuICAgIGV4cGlyeS5zZXRIb3VycyhleHBpcnkuZ2V0SG91cnMoKSArIDI0KTtcbiAgICBzdG9yYWdlLnNldEl0ZW0oVE9LRU5fRVhQSVJZX0tFWSwgZXhwaXJ5LnRvSVNPU3RyaW5nKCkpO1xuICB9IGZpbmFsbHkge1xuICAgIHJlbGVhc2VMb2NrISgpO1xuICB9XG59XG5cbi8qKlxuICogR2V0IHRoZSBjdXJyZW50IGF1dGhlbnRpY2F0aW9uIHRva2VuIGZyb20gc3RvcmFnZVxuICogQ2hlY2tzIHNlc3Npb25TdG9yYWdlIGZpcnN0LCB0aGVuIGZhbGxzIGJhY2sgdG8gbG9jYWxTdG9yYWdlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRBdXRoVG9rZW4oKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIFByZWZlciBzZXNzaW9uU3RvcmFnZSBmb3IgY3VycmVudCBzZXNzaW9uLCB0aGVuIGxvY2FsU3RvcmFnZVxuICAgIC8vIENoZWNrIGJvdGggcHJpbWFyeSBhbmQgYWx0ZXJuYXRlIGtleXNcbiAgICByZXR1cm4gKFxuICAgICAgc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9LRVkpIHx8XG4gICAgICBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKEFMVF9UT0tFTl9LRVkpIHx8XG4gICAgICBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9LRVkpIHx8XG4gICAgICBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShBTFRfVE9LRU5fS0VZKVxuICAgICk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogR2V0IHRva2VuIGV4cGlyYXRpb24gZGF0ZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VG9rZW5FeHBpcnkoKTogRGF0ZSB8IG51bGwge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBjb25zdCBleHBpcnlTdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9FWFBJUllfS0VZKSB8fCBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFRPS0VOX0VYUElSWV9LRVkpO1xuICAgIHJldHVybiBleHBpcnlTdHIgPyBuZXcgRGF0ZShleHBpcnlTdHIpIDogbnVsbDtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiB0b2tlbiBpcyBleHBpcmVkXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1Rva2VuRXhwaXJlZCgpOiBib29sZWFuIHtcbiAgY29uc3QgZXhwaXJ5ID0gZ2V0VG9rZW5FeHBpcnkoKTtcbiAgcmV0dXJuICFleHBpcnkgfHwgZXhwaXJ5IDwgbmV3IERhdGUoKTtcbn1cblxuLyoqXG4gKiBDbGVhciBhbGwgYXV0aGVudGljYXRpb24gdG9rZW5zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGVhckF1dGhUb2tlbnMoKTogdm9pZCB7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIENsZWFyIGZyb20gYm90aCBzdG9yYWdlIGxvY2F0aW9ucyB0byBiZSBzYWZlXG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oVE9LRU5fS0VZKTtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShBTFRfVE9LRU5fS0VZKTtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShUT0tFTl9FWFBJUllfS0VZKTtcbiAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKFRPS0VOX0tFWSk7XG4gICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShBTFRfVE9LRU5fS0VZKTtcbiAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKFRPS0VOX0VYUElSWV9LRVkpO1xuICB9XG59XG5cbi8qKlxuICogQWRkIGF1dGhvcml6YXRpb24gaGVhZGVycyB0byBmZXRjaCBvcHRpb25zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhZGRBdXRoSGVhZGVycyhvcHRpb25zOiBSZXF1ZXN0SW5pdCA9IHt9KTogUmVxdWVzdEluaXQge1xuICBjb25zdCB0b2tlbiA9IGdldEF1dGhUb2tlbigpO1xuICBjb25zdCBoZWFkZXJzID0geyBcbiAgICAuLi5vcHRpb25zLmhlYWRlcnMsXG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgfTtcbiAgXG4gIGlmICh0b2tlbikge1xuICAgIGhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICB9XG4gIFxuICByZXR1cm4ge1xuICAgIC4uLm9wdGlvbnMsXG4gICAgaGVhZGVycyxcbiAgfTtcbn1cblxuLyoqXG4gKiBXcmFwcGVyIGZvciBmZXRjaCB3aXRoIGF1dGhlbnRpY2F0aW9uIGhlYWRlcnNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGF1dGhGZXRjaCh1cmw6IHN0cmluZywgb3B0aW9uczogUmVxdWVzdEluaXQgPSB7fSk6IFByb21pc2U8UmVzcG9uc2U+IHtcbiAgcmV0dXJuIGZldGNoKHVybCwgYWRkQXV0aEhlYWRlcnMob3B0aW9ucykpO1xufVxuXG4iXSwibmFtZXMiOlsiVE9LRU5fS0VZIiwiVE9LRU5fRVhQSVJZX0tFWSIsIkFMVF9UT0tFTl9LRVkiLCJ0b2tlbk11dGV4IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzdG9yZUF1dGhUb2tlbiIsInRva2VuIiwicmVtZW1iZXJNZSIsInJlbGVhc2VMb2NrIiwiY2xlYXJBdXRoVG9rZW5zIiwic3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsInNlc3Npb25TdG9yYWdlIiwic2V0SXRlbSIsImV4cGlyeSIsIkRhdGUiLCJzZXRIb3VycyIsImdldEhvdXJzIiwidG9JU09TdHJpbmciLCJnZXRBdXRoVG9rZW4iLCJnZXRJdGVtIiwiZ2V0VG9rZW5FeHBpcnkiLCJleHBpcnlTdHIiLCJpc1Rva2VuRXhwaXJlZCIsInJlbW92ZUl0ZW0iLCJhZGRBdXRoSGVhZGVycyIsIm9wdGlvbnMiLCJoZWFkZXJzIiwiYXV0aEZldGNoIiwidXJsIiwiZmV0Y2giXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/authUtils.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./utils/devAuth.ts":
/*!**************************!*\
  !*** ./utils/devAuth.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bypassLogin: () => (/* binding */ bypassLogin),\n/* harmony export */   getAdminAuthData: () => (/* binding */ getAdminAuthData),\n/* harmony export */   hasAdminBypass: () => (/* binding */ hasAdminBypass)\n/* harmony export */ });\n/* harmony import */ var _authUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./authUtils */ \"(pages-dir-node)/./utils/authUtils.ts\");\n/**\n * Grace Admin Access Utilities\n * \n * This file contains the admin backdoor mechanism that provides\n * immediate access to the Grace interface with full privileges.\n */ \n// Admin user credentials with full access permissions\nconst ADMIN_USER = {\n    id: 'admin-kdot-id',\n    username: 'kdot',\n    email: 'kmanjo11@gmail.com',\n    role: 'admin',\n    permissions: [\n        'ALL'\n    ],\n    wallets: [],\n    settings: {\n        theme: 'dark',\n        notifications: true\n    }\n};\n// Admin authentication token (extremely long-lived - 10 years)\n// This is a properly formatted JWT that should pass validation checks\nconst ADMIN_TOKEN = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbi1rZG90LWlkIiwidXNlcm5hbWUiOiJrZG90IiwiZW1haWwiOiJrbWFuam8xMUBnbWFpbC5jb20iLCJyb2xlIjoiYWRtaW4iLCJwZXJtaXNzaW9ucyI6WyJBTEwiXSwiZXhwIjoxOTAwMDAwMDAwLCJpYXQiOjE1ODAwMDAwMDB9.p58K8xzT2BEuBRKgNUMTdbzHRhPgpnL_q91qfm8qRCk';\n/**\n * Check for admin backdoor query parameter\n */ const hasAdminBypass = ()=>{\n    const urlParams = new URLSearchParams(window.location.search);\n    // Secret parameter with a specific value for added security\n    return urlParams.get('xmaster') === 'kdotaccess';\n};\n/**\n * Create admin authentication data\n */ const getAdminAuthData = ()=>{\n    return {\n        token: ADMIN_TOKEN,\n        user: ADMIN_USER,\n        remember_me: true\n    };\n};\n/**\n * Bypass normal login for admin user with all access privileges\n * \n * @param loginFunction The real login function from AuthContext\n */ const bypassLogin = (loginFunction)=>{\n    try {\n        // Get admin credentials and token\n        const adminAuthData = getAdminAuthData();\n        if (adminAuthData) {\n            console.info(' Using admin master access');\n            // Ensure the token is stored in BOTH localStorage and sessionStorage\n            // This guarantees it will be found regardless of which storage is checked\n            localStorage.setItem('grace_token', adminAuthData.token);\n            sessionStorage.setItem('grace_token', adminAuthData.token);\n            // Set a very far future expiry to prevent token timeout\n            const farFuture = new Date();\n            farFuture.setFullYear(farFuture.getFullYear() + 10); // 10 years in the future\n            localStorage.setItem('grace_token_expiry', farFuture.toISOString());\n            sessionStorage.setItem('grace_token_expiry', farFuture.toISOString());\n            // Use the standard auth function to store properly\n            (0,_authUtils__WEBPACK_IMPORTED_MODULE_0__.storeAuthToken)(adminAuthData.token, true);\n            // Call the real login function with our admin data\n            loginFunction(adminAuthData);\n            // Store a flag indicating we're using admin mode\n            localStorage.setItem('grace_admin_mode', 'true');\n        }\n    } catch (error) {\n        console.error('Admin access failed:', error);\n        // Fallback direct storage in case of error\n        const adminAuthData = getAdminAuthData();\n        localStorage.setItem('grace_token', adminAuthData.token);\n        localStorage.setItem('grace_admin_mode', 'true');\n        window.location.reload(); // Force reload to retry auth\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL2RldkF1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7OztDQUtDLEdBRTRDO0FBRTdDLHNEQUFzRDtBQUN0RCxNQUFNQyxhQUFhO0lBQ2pCQyxJQUFJO0lBQ0pDLFVBQVU7SUFDVkMsT0FBTztJQUNQQyxNQUFNO0lBQ05DLGFBQWE7UUFBQztLQUFNO0lBQ3BCQyxTQUFTLEVBQUU7SUFDWEMsVUFBVTtRQUNSQyxPQUFPO1FBQ1BDLGVBQWU7SUFDakI7QUFDRjtBQUVBLCtEQUErRDtBQUMvRCxzRUFBc0U7QUFDdEUsTUFBTUMsY0FBYztBQUVwQjs7Q0FFQyxHQUNNLE1BQU1DLGlCQUFpQjtJQUM1QixNQUFNQyxZQUFZLElBQUlDLGdCQUFnQkMsT0FBT0MsUUFBUSxDQUFDQyxNQUFNO0lBQzVELDREQUE0RDtJQUM1RCxPQUFPSixVQUFVSyxHQUFHLENBQUMsZUFBZTtBQUN0QyxFQUFFO0FBRUY7O0NBRUMsR0FDTSxNQUFNQyxtQkFBbUI7SUFDOUIsT0FBTztRQUNMQyxPQUFPVDtRQUNQVSxNQUFNcEI7UUFDTnFCLGFBQWE7SUFDZjtBQUNGLEVBQUU7QUFFRjs7OztDQUlDLEdBQ00sTUFBTUMsY0FBYyxDQUFDQztJQUMxQixJQUFJO1FBQ0Ysa0NBQWtDO1FBQ2xDLE1BQU1DLGdCQUFnQk47UUFFdEIsSUFBSU0sZUFBZTtZQUNqQkMsUUFBUUMsSUFBSSxDQUFDO1lBRWIscUVBQXFFO1lBQ3JFLDBFQUEwRTtZQUMxRUMsYUFBYUMsT0FBTyxDQUFDLGVBQWVKLGNBQWNMLEtBQUs7WUFDdkRVLGVBQWVELE9BQU8sQ0FBQyxlQUFlSixjQUFjTCxLQUFLO1lBRXpELHdEQUF3RDtZQUN4RCxNQUFNVyxZQUFZLElBQUlDO1lBQ3RCRCxVQUFVRSxXQUFXLENBQUNGLFVBQVVHLFdBQVcsS0FBSyxLQUFLLHlCQUF5QjtZQUM5RU4sYUFBYUMsT0FBTyxDQUFDLHNCQUFzQkUsVUFBVUksV0FBVztZQUNoRUwsZUFBZUQsT0FBTyxDQUFDLHNCQUFzQkUsVUFBVUksV0FBVztZQUVsRSxtREFBbUQ7WUFDbkRuQywwREFBY0EsQ0FBQ3lCLGNBQWNMLEtBQUssRUFBRTtZQUVwQyxtREFBbUQ7WUFDbkRJLGNBQWNDO1lBRWQsaURBQWlEO1lBQ2pERyxhQUFhQyxPQUFPLENBQUMsb0JBQW9CO1FBQzNDO0lBQ0YsRUFBRSxPQUFPTyxPQUFPO1FBQ2RWLFFBQVFVLEtBQUssQ0FBQyx3QkFBd0JBO1FBQ3RDLDJDQUEyQztRQUMzQyxNQUFNWCxnQkFBZ0JOO1FBQ3RCUyxhQUFhQyxPQUFPLENBQUMsZUFBZUosY0FBY0wsS0FBSztRQUN2RFEsYUFBYUMsT0FBTyxDQUFDLG9CQUFvQjtRQUN6Q2QsT0FBT0MsUUFBUSxDQUFDcUIsTUFBTSxJQUFJLDZCQUE2QjtJQUN6RDtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIi9ob21lL3VidW50dS9ncmFjZS1wcm9qZWN0L3NyYy91aS91dGlscy9kZXZBdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR3JhY2UgQWRtaW4gQWNjZXNzIFV0aWxpdGllc1xuICogXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgdGhlIGFkbWluIGJhY2tkb29yIG1lY2hhbmlzbSB0aGF0IHByb3ZpZGVzXG4gKiBpbW1lZGlhdGUgYWNjZXNzIHRvIHRoZSBHcmFjZSBpbnRlcmZhY2Ugd2l0aCBmdWxsIHByaXZpbGVnZXMuXG4gKi9cblxuaW1wb3J0IHsgc3RvcmVBdXRoVG9rZW4gfSBmcm9tICcuL2F1dGhVdGlscyc7XG5cbi8vIEFkbWluIHVzZXIgY3JlZGVudGlhbHMgd2l0aCBmdWxsIGFjY2VzcyBwZXJtaXNzaW9uc1xuY29uc3QgQURNSU5fVVNFUiA9IHtcbiAgaWQ6ICdhZG1pbi1rZG90LWlkJyxcbiAgdXNlcm5hbWU6ICdrZG90JyxcbiAgZW1haWw6ICdrbWFuam8xMUBnbWFpbC5jb20nLFxuICByb2xlOiAnYWRtaW4nLFxuICBwZXJtaXNzaW9uczogWydBTEwnXSxcbiAgd2FsbGV0czogW10sIC8vIFdpbGwgYmUgcG9wdWxhdGVkIGJ5IHRoZSBhcHBcbiAgc2V0dGluZ3M6IHtcbiAgICB0aGVtZTogJ2RhcmsnLFxuICAgIG5vdGlmaWNhdGlvbnM6IHRydWVcbiAgfVxufTtcblxuLy8gQWRtaW4gYXV0aGVudGljYXRpb24gdG9rZW4gKGV4dHJlbWVseSBsb25nLWxpdmVkIC0gMTAgeWVhcnMpXG4vLyBUaGlzIGlzIGEgcHJvcGVybHkgZm9ybWF0dGVkIEpXVCB0aGF0IHNob3VsZCBwYXNzIHZhbGlkYXRpb24gY2hlY2tzXG5jb25zdCBBRE1JTl9UT0tFTiA9ICdleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuZXlKemRXSWlPaUpoWkcxcGJpMXJaRzkwTFdsa0lpd2lkWE5sY201aGJXVWlPaUpyWkc5MElpd2laVzFoYVd3aU9pSnJiV0Z1YW04eE1VQm5iV0ZwYkM1amIyMGlMQ0p5YjJ4bElqb2lZV1J0YVc0aUxDSndaWEp0YVhOemFXOXVjeUk2V3lKQlRFd2lYU3dpWlhod0lqb3hPVEF3TURBd01EQXdMQ0pwWVhRaU9qRTFPREF3TURBd01EQjkucDU4Szh4elQyQkV1QlJLZ05VTVRkYnpIUmhQZ3BuTF9xOTFxZm04cVJDayc7IFxuXG4vKipcbiAqIENoZWNrIGZvciBhZG1pbiBiYWNrZG9vciBxdWVyeSBwYXJhbWV0ZXJcbiAqL1xuZXhwb3J0IGNvbnN0IGhhc0FkbWluQnlwYXNzID0gKCk6IGJvb2xlYW4gPT4ge1xuICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xuICAvLyBTZWNyZXQgcGFyYW1ldGVyIHdpdGggYSBzcGVjaWZpYyB2YWx1ZSBmb3IgYWRkZWQgc2VjdXJpdHlcbiAgcmV0dXJuIHVybFBhcmFtcy5nZXQoJ3htYXN0ZXInKSA9PT0gJ2tkb3RhY2Nlc3MnO1xufTtcblxuLyoqXG4gKiBDcmVhdGUgYWRtaW4gYXV0aGVudGljYXRpb24gZGF0YVxuICovXG5leHBvcnQgY29uc3QgZ2V0QWRtaW5BdXRoRGF0YSA9ICgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICB0b2tlbjogQURNSU5fVE9LRU4sXG4gICAgdXNlcjogQURNSU5fVVNFUixcbiAgICByZW1lbWJlcl9tZTogdHJ1ZVxuICB9O1xufTtcblxuLyoqXG4gKiBCeXBhc3Mgbm9ybWFsIGxvZ2luIGZvciBhZG1pbiB1c2VyIHdpdGggYWxsIGFjY2VzcyBwcml2aWxlZ2VzXG4gKiBcbiAqIEBwYXJhbSBsb2dpbkZ1bmN0aW9uIFRoZSByZWFsIGxvZ2luIGZ1bmN0aW9uIGZyb20gQXV0aENvbnRleHRcbiAqL1xuZXhwb3J0IGNvbnN0IGJ5cGFzc0xvZ2luID0gKGxvZ2luRnVuY3Rpb246IChkYXRhOiBhbnkpID0+IHZvaWQpOiB2b2lkID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgYWRtaW4gY3JlZGVudGlhbHMgYW5kIHRva2VuXG4gICAgY29uc3QgYWRtaW5BdXRoRGF0YSA9IGdldEFkbWluQXV0aERhdGEoKTtcbiAgICBcbiAgICBpZiAoYWRtaW5BdXRoRGF0YSkge1xuICAgICAgY29uc29sZS5pbmZvKCfwn5SRIFVzaW5nIGFkbWluIG1hc3RlciBhY2Nlc3MnKTtcbiAgICAgIFxuICAgICAgLy8gRW5zdXJlIHRoZSB0b2tlbiBpcyBzdG9yZWQgaW4gQk9USCBsb2NhbFN0b3JhZ2UgYW5kIHNlc3Npb25TdG9yYWdlXG4gICAgICAvLyBUaGlzIGd1YXJhbnRlZXMgaXQgd2lsbCBiZSBmb3VuZCByZWdhcmRsZXNzIG9mIHdoaWNoIHN0b3JhZ2UgaXMgY2hlY2tlZFxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2dyYWNlX3Rva2VuJywgYWRtaW5BdXRoRGF0YS50b2tlbik7XG4gICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdncmFjZV90b2tlbicsIGFkbWluQXV0aERhdGEudG9rZW4pO1xuICAgICAgXG4gICAgICAvLyBTZXQgYSB2ZXJ5IGZhciBmdXR1cmUgZXhwaXJ5IHRvIHByZXZlbnQgdG9rZW4gdGltZW91dFxuICAgICAgY29uc3QgZmFyRnV0dXJlID0gbmV3IERhdGUoKTtcbiAgICAgIGZhckZ1dHVyZS5zZXRGdWxsWWVhcihmYXJGdXR1cmUuZ2V0RnVsbFllYXIoKSArIDEwKTsgLy8gMTAgeWVhcnMgaW4gdGhlIGZ1dHVyZVxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2dyYWNlX3Rva2VuX2V4cGlyeScsIGZhckZ1dHVyZS50b0lTT1N0cmluZygpKTtcbiAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2dyYWNlX3Rva2VuX2V4cGlyeScsIGZhckZ1dHVyZS50b0lTT1N0cmluZygpKTtcbiAgICAgIFxuICAgICAgLy8gVXNlIHRoZSBzdGFuZGFyZCBhdXRoIGZ1bmN0aW9uIHRvIHN0b3JlIHByb3Blcmx5XG4gICAgICBzdG9yZUF1dGhUb2tlbihhZG1pbkF1dGhEYXRhLnRva2VuLCB0cnVlKTtcbiAgICAgIFxuICAgICAgLy8gQ2FsbCB0aGUgcmVhbCBsb2dpbiBmdW5jdGlvbiB3aXRoIG91ciBhZG1pbiBkYXRhXG4gICAgICBsb2dpbkZ1bmN0aW9uKGFkbWluQXV0aERhdGEpO1xuICAgICAgXG4gICAgICAvLyBTdG9yZSBhIGZsYWcgaW5kaWNhdGluZyB3ZSdyZSB1c2luZyBhZG1pbiBtb2RlXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZ3JhY2VfYWRtaW5fbW9kZScsICd0cnVlJyk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FkbWluIGFjY2VzcyBmYWlsZWQ6JywgZXJyb3IpO1xuICAgIC8vIEZhbGxiYWNrIGRpcmVjdCBzdG9yYWdlIGluIGNhc2Ugb2YgZXJyb3JcbiAgICBjb25zdCBhZG1pbkF1dGhEYXRhID0gZ2V0QWRtaW5BdXRoRGF0YSgpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdncmFjZV90b2tlbicsIGFkbWluQXV0aERhdGEudG9rZW4pO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdncmFjZV9hZG1pbl9tb2RlJywgJ3RydWUnKTtcbiAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7IC8vIEZvcmNlIHJlbG9hZCB0byByZXRyeSBhdXRoXG4gIH1cbn07XG4iXSwibmFtZXMiOlsic3RvcmVBdXRoVG9rZW4iLCJBRE1JTl9VU0VSIiwiaWQiLCJ1c2VybmFtZSIsImVtYWlsIiwicm9sZSIsInBlcm1pc3Npb25zIiwid2FsbGV0cyIsInNldHRpbmdzIiwidGhlbWUiLCJub3RpZmljYXRpb25zIiwiQURNSU5fVE9LRU4iLCJoYXNBZG1pbkJ5cGFzcyIsInVybFBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoIiwiZ2V0IiwiZ2V0QWRtaW5BdXRoRGF0YSIsInRva2VuIiwidXNlciIsInJlbWVtYmVyX21lIiwiYnlwYXNzTG9naW4iLCJsb2dpbkZ1bmN0aW9uIiwiYWRtaW5BdXRoRGF0YSIsImNvbnNvbGUiLCJpbmZvIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsInNlc3Npb25TdG9yYWdlIiwiZmFyRnV0dXJlIiwiRGF0ZSIsInNldEZ1bGxZZWFyIiwiZ2V0RnVsbFllYXIiLCJ0b0lTT1N0cmluZyIsImVycm9yIiwicmVsb2FkIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/devAuth.ts\n");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/pages.runtime.dev.js":
/*!**********************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages.runtime.dev.js" ***!
  \**********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/pages.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/page-path/normalize-data-path":
/*!*********************************************************************!*\
  !*** external "next/dist/shared/lib/page-path/normalize-data-path" ***!
  \*********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/page-path/normalize-data-path");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/add-path-prefix":
/*!********************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/add-path-prefix" ***!
  \********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/add-path-prefix");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/format-url":
/*!***************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/format-url" ***!
  \***************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/format-url");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/is-bot":
/*!***********************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/is-bot" ***!
  \***********************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/is-bot");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/remove-trailing-slash":
/*!**************************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/remove-trailing-slash" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/remove-trailing-slash");

/***/ }),

/***/ "next/dist/shared/lib/utils":
/*!*********************************************!*\
  !*** external "next/dist/shared/lib/utils" ***!
  \*********************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/utils");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("react");

/***/ }),

/***/ "react-dom":
/*!****************************!*\
  !*** external "react-dom" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("react-dom");

/***/ }),

/***/ "react-toastify":
/*!*********************************!*\
  !*** external "react-toastify" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = import("react-toastify");;

/***/ }),

/***/ "react/jsx-dev-runtime":
/*!****************************************!*\
  !*** external "react/jsx-dev-runtime" ***!
  \****************************************/
/***/ ((module) => {

"use strict";
module.exports = require("react/jsx-dev-runtime");

/***/ }),

/***/ "react/jsx-runtime":
/*!************************************!*\
  !*** external "react/jsx-runtime" ***!
  \************************************/
/***/ ((module) => {

"use strict";
module.exports = require("react/jsx-runtime");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1","vendor-chunks/@swc+helpers@0.5.15","vendor-chunks/react-toastify@10.0.6_react-dom@19.1.1_react@19.1.1__react@19.1.1"], () => (__webpack_exec__("(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2F&preferredRegion=&absolutePagePath=.%2Fpages%2Findex.tsx&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();