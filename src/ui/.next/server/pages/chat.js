/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/chat";
exports.ids = ["pages/chat"];
exports.modules = {

/***/ "(pages-dir-node)/./api/apiClient.ts":
/*!**************************!*\
  !*** ./api/apiClient.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   API_ENDPOINTS: () => (/* binding */ API_ENDPOINTS),\n/* harmony export */   ApiError: () => (/* binding */ ApiError),\n/* harmony export */   ChatApi: () => (/* binding */ ChatApi),\n/* harmony export */   TradingApi: () => (/* binding */ TradingApi),\n/* harmony export */   addAuthHeaders: () => (/* binding */ addAuthHeaders),\n/* harmony export */   api: () => (/* binding */ api),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getAuthToken: () => (/* binding */ getAuthToken),\n/* harmony export */   removeAuthToken: () => (/* binding */ removeAuthToken),\n/* harmony export */   saveAuthToken: () => (/* binding */ saveAuthToken)\n/* harmony export */ });\n/**\n * API Client for Grace App\n * \n * Provides standardized error handling and response processing for all API calls.\n */ // Front api constant and robust resolver for base URL\nconst API_BASE_URL =  false || '';\n// Resolve base URL; prefer env var, else use relative path to avoid CORS issues\nconst resolveBaseUrl = ()=>{\n    const envUrl = \"\";\n    if (envUrl && envUrl.trim() !== '') {\n        return envUrl.endsWith('/') ? envUrl.slice(0, -1) : envUrl;\n    }\n    // Fallback to relative base to use same-origin or dev proxy\n    return '';\n};\n// Auth token key for localStorage\nconst AUTH_TOKEN_KEY = 'grace_auth_token';\nconst ALT_TOKEN_KEY = 'grace_token';\n// Get auth token from storage (checks both session and local, and both keys)\nconst getAuthToken = ()=>{\n    if (false) {}\n    return null;\n};\n// Save auth token to localStorage under both keys for compatibility\nconst saveAuthToken = (token)=>{\n    if (false) {}\n};\n// Remove auth token from both storage locations and keys\nconst removeAuthToken = ()=>{\n    if (false) {}\n};\n// Add auth headers to request options\nconst addAuthHeaders = (options = {})=>{\n    const token = getAuthToken();\n    if (token) {\n        return {\n            ...options,\n            headers: {\n                ...options.headers,\n                'Authorization': `Bearer ${token}`,\n                'Content-Type': 'application/json'\n            }\n        };\n    }\n    return options;\n};\n// API Error types\nclass ApiError extends Error {\n    statusCode;\n    data;\n    constructor(message, statusCode, data){\n        super(message);\n        this.name = 'ApiError';\n        this.statusCode = statusCode;\n        this.data = data;\n    }\n}\n// API configuration - use environment variable if available, otherwise use relative path\n// Ensure API_BASE_URL ends with a slash (kept for backward compatibility)\nconst getBaseUrl = ()=>{\n    const base = API_BASE_URL;\n    if (base && base.endsWith('/')) {\n        return base.slice(0, -1);\n    }\n    return base;\n};\n// API endpoints constants\nconst API_ENDPOINTS = {\n    AUTH: {\n        LOGIN: '/api/auth/login',\n        REGISTER: '/api/auth/register',\n        VERIFY_TOKEN: '/api/auth/verify',\n        LOGOUT: '/api/auth/logout',\n        REFRESH_TOKEN: '/auth/refresh-token',\n        FORGOT_PASSWORD: '/api/auth/forgot-password',\n        RESET_PASSWORD: '/api/auth/reset-password'\n    },\n    USER: {\n        PROFILE: '/api/user/profile',\n        LEVERAGE_POSITIONS: '/api/user/leverage_positions',\n        SPOT_POSITIONS: '/api/user/spot_positions',\n        POSITION_HISTORY: '/api/user/position_history',\n        TRADE_HISTORY: '/api/user/trade_history',\n        LIMIT_ORDERS: '/api/limit-orders'\n    },\n    WALLET: {\n        DATA: '/api/wallet/data',\n        INFO: '/api/wallet/info',\n        MANGO_BALANCE: '/api/wallet/mango-balance',\n        GENERATE: '/api/wallet/generate',\n        SEND: '/api/wallet/send',\n        CONNECT_PHANTOM: '/api/wallet/phantom/connect',\n        COMPLETE_PHANTOM: '/api/wallet/phantom/callback',\n        DISCONNECT_PHANTOM: '/api/wallet/phantom/disconnect',\n        // Map BALANCE to INFO since the server uses /api/wallet/info endpoint to get wallet balance\n        BALANCE: '/api/wallet/info',\n        TRANSACTIONS: '/api/wallet/transactions'\n    },\n    CHAT: {\n        // Get all chat sessions for the authenticated user\n        SESSIONS: '/api/chat/sessions',\n        // Create a new chat session\n        NEW_SESSION: '/api/chat/session/new',\n        // Get chat history for a specific session\n        HISTORY: (sessionId)=>`/api/chat/history/${sessionId}`,\n        // Send a chat message\n        MESSAGE: '/api/chat/message'\n    },\n    SOCIAL: {\n        // Core social media endpoints\n        SENTIMENT: '/api/social/sentiment',\n        TRENDING: '/api/social/trending-topics',\n        INFLUENTIAL: '/api/social/influential',\n        TWEETS: '/api/social/tweets'\n    },\n    MANGO: {\n        // Mango Markets API endpoints\n        BASE: '/api/mango',\n        OHLCV: '/api/mango/ohlcv',\n        MARKETS: '/api/mango/markets',\n        ORDER_BOOK: '/api/mango/orderbook',\n        TRADES: '/api/mango/trades',\n        MARKET_STATS: '/api/mango/market-stats',\n        COMMUNITIES: '/api/social/communities',\n        ENTITIES: '/api/social/entities',\n        FEED: '/api/social/feed',\n        CONNECTIONS: '/api/social/connections'\n    },\n    TRADING: {\n        EXECUTE: '/api/trading/execute',\n        CONFIRM: '/api/trading/confirm',\n        SMART_SETTINGS: '/api/trading/smart-settings',\n        TOKENS: '/api/trading/tokens',\n        PRICE_CHART: '/api/trading/price-chart',\n        SWAP: '/api/trading/swap',\n        SELL_POSITION: '/api/trading/sell-position',\n        USER_POSITIONS: '/api/user/positions',\n        LEVERAGE_POSITIONS: '/api/user/leverage_positions',\n        SPOT_POSITIONS: '/api/user/spot_positions'\n    },\n    SETTINGS: {\n        // Updated to match backend implementation\n        PROFILE: '/api/user/settings',\n        NOTIFICATIONS: '/api/settings/notifications',\n        // Additional backend settings endpoint\n        TRADING_SETTINGS: '/api/trading/smart-settings'\n    }\n};\n/**\n * Normalize different API response formats to a consistent structure\n * \n * This prioritizes API response formats in a predictable order:\n * 1. Auth responses with token and user\n * 2. Standard success responses with data\n * 3. Results-based responses\n * 4. Default pass-through\n */ function normalizeResponse(responseData) {\n    // Handle auth responses with token\n    if (responseData && typeof responseData === 'object' && 'token' in responseData) {\n        // Save the token when received in the response\n        saveAuthToken(responseData.token);\n        // Remove token from response data to avoid exposing it\n        const { token, ...rest } = responseData;\n        return rest;\n    }\n    // Handle standard success response format\n    if (responseData && typeof responseData === 'object' && 'success' in responseData) {\n        return responseData;\n    }\n    // Handle results-based response format\n    if (responseData && typeof responseData === 'object' && 'results' in responseData) {\n        return {\n            success: true,\n            data: responseData.results,\n            ...responseData\n        };\n    }\n    // Default: pass through the response data as-is\n    // Some endpoints return results in a 'results' property\n    if (responseData.results) {\n        return responseData.results;\n    }\n    // PRIORITY 4: Handle direct data format without success flag\n    // Some old endpoints return {data: {...}} directly\n    if (responseData.data && responseData.success === undefined) {\n        return responseData.data;\n    }\n    // Fall back to returning the entire response as is\n    return responseData;\n}\n/**\n * Process the API response and handle errors consistently\n */ async function processResponse(response) {\n    try {\n        // Clone the response so we can read it multiple times\n        const responseClone = response.clone();\n        // Read body ONCE as text, then attempt to parse JSON from it.\n        const bodyText = await response.text();\n        let data = undefined;\n        try {\n            data = bodyText ? JSON.parse(bodyText) : undefined;\n            // If we get a new token in the response, save it\n            if (data && data.token) {\n                saveAuthToken(data.token);\n            }\n        } catch (e) {\n            // Non-JSON body; treat as text error payload when not ok\n            if (!response.ok) {\n                return {\n                    success: false,\n                    error: bodyText || 'Invalid response format',\n                    statusCode: response.status,\n                    rawResponse: responseClone\n                };\n            }\n            // If OK status but non-JSON, pass raw text as data\n            return {\n                success: true,\n                data: bodyText,\n                statusCode: response.status,\n                rawResponse: responseClone\n            };\n        }\n        // Handle HTTP error status codes\n        if (!response.ok) {\n            // Do not perform global side effects here; let callers decide how to handle 401/403\n            return {\n                success: false,\n                error: data?.message || data?.error || `HTTP error ${response.status}`,\n                statusCode: response.status,\n                data,\n                rawResponse: responseClone\n            };\n        }\n        // Success case - normalize the response data\n        return {\n            success: true,\n            data: normalizeResponse(data),\n            statusCode: response.status,\n            rawResponse: responseClone\n        };\n    } catch (error) {\n        console.error('Error processing response:', error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : 'Unknown error processing response',\n            rawResponse: response.clone()\n        };\n    }\n}\n/**\n * Make an API request with proper error handling\n */ async function apiRequest(endpoint, options = {}) {\n    try {\n        // Get base URL from environment or use robust fallback\n        const baseUrl = resolveBaseUrl();\n        const url = endpoint.startsWith('http') ? endpoint : `${baseUrl}${endpoint}`;\n        console.log('API Request:', {\n            baseUrl,\n            endpoint,\n            url\n        });\n        // Add auth headers to the request\n        const requestOptions = addAuthHeaders({\n            ...options,\n            credentials: 'include',\n            headers: {\n                ...options.headers,\n                'Content-Type': 'application/json'\n            }\n        });\n        console.log('Making fetch request to:', url, 'with options:', requestOptions);\n        const response = await fetch(url, requestOptions);\n        console.log('Response received:', response.status, response.statusText);\n        return await processResponse(response);\n    } catch (error) {\n        if (error instanceof ApiError) {\n            // Rethrow ApiError instances\n            throw error;\n        }\n        // Handle network errors\n        throw new ApiError(error instanceof Error ? error.message : 'Network error', 0);\n    }\n}\n// Convenience methods for common HTTP methods\nconst api = {\n    async get (endpoint, options = {}) {\n        return apiRequest(endpoint, {\n            ...options,\n            method: 'GET'\n        });\n    },\n    async post (endpoint, data, options = {}) {\n        return apiRequest(endpoint, {\n            ...options,\n            method: 'POST',\n            body: JSON.stringify(data)\n        });\n    },\n    async put (endpoint, data, options = {}) {\n        return apiRequest(endpoint, {\n            ...options,\n            method: 'PUT',\n            body: JSON.stringify(data)\n        });\n    },\n    async delete (endpoint, options = {}) {\n        return apiRequest(endpoint, {\n            ...options,\n            method: 'DELETE'\n        });\n    }\n};\n// Chat API methods\nconst ChatApi = {\n    /**\n   * Get all chat sessions for the authenticated user\n   * @returns Promise with list of chat sessions\n   */ /**\n   * Get all chat sessions for the authenticated user\n   * @param limit Optional limit for pagination\n   * @param offset Optional offset for pagination\n   * @returns Promise with list of chat sessions and pagination info\n   */ async getSessions (limit, offset) {\n        try {\n            const params = new URLSearchParams();\n            if (limit) params.append('limit', limit.toString());\n            if (offset) params.append('offset', offset.toString());\n            const query = params.toString();\n            const url = query ? `${API_ENDPOINTS.CHAT.SESSIONS}?${query}` : API_ENDPOINTS.CHAT.SESSIONS;\n            const response = await api.get(url);\n            return {\n                sessions: response.data?.data || [],\n                total: response.data?.total || 0,\n                has_more: response.data?.has_more || false\n            };\n        } catch (error) {\n            const errorMessage = error.response?.data?.error || 'Failed to fetch chat sessions';\n            const usingFallback = error.response?.data?.using_fallback;\n            console.error('Error fetching chat sessions:', errorMessage, {\n                usingFallback\n            });\n            throw new Error(errorMessage);\n        }\n    },\n    /**\n   * Create a new chat session\n   * @param title Optional title for the new session\n   * @returns Promise with the new session ID\n   */ async createSession (title) {\n        try {\n            const response = await api.post(API_ENDPOINTS.CHAT.NEW_SESSION, {\n                title: title || 'New Chat'\n            });\n            if (!response.data?.session_id) {\n                throw new Error('Invalid response format from server');\n            }\n            return {\n                session_id: response.data.session_id\n            };\n        } catch (error) {\n            console.error('Error creating chat session:', error);\n            throw new Error('Failed to create chat session');\n        }\n    },\n    /**\n   * Get chat history for a specific session\n   * @param sessionId ID of the chat session\n   * @returns Promise with chat history\n   */ /**\n   * Get chat history for a specific session\n   * @param sessionId ID of the chat session\n   * @param limit Optional limit for pagination\n   * @param offset Optional offset for pagination\n   * @returns Promise with chat history and pagination info\n   */ async getHistory (sessionId, limit, offset) {\n        try {\n            const params = new URLSearchParams();\n            if (limit) params.append('limit', limit.toString());\n            if (offset) params.append('offset', offset.toString());\n            const query = params.toString();\n            const url = query ? `${API_ENDPOINTS.CHAT.HISTORY(sessionId)}?${query}` : API_ENDPOINTS.CHAT.HISTORY(sessionId);\n            const response = await api.get(url);\n            return {\n                messages: response.data?.data || [],\n                total: response.data?.total || 0,\n                has_more: response.data?.has_more || false\n            };\n        } catch (error) {\n            const errorMessage = error.response?.data?.error || 'Failed to fetch chat history';\n            const usingFallback = error.response?.data?.using_fallback;\n            console.error('Error fetching chat history:', errorMessage, {\n                usingFallback\n            });\n            throw new Error(errorMessage);\n        }\n    },\n    /**\n   * Send a message in a chat session\n   * @param sessionId ID of the chat session\n   * @param message The message content\n   * @returns Promise with the assistant's response\n   */ /**\n   * Send a message in a chat session\n   * @param sessionId ID of the chat session\n   * @param message The message content\n   * @param metadata Optional metadata to include with the message\n   * @returns Promise with the assistant's response\n   */ async sendMessage (sessionId, message, metadata) {\n        try {\n            const response = await api.post(API_ENDPOINTS.CHAT.MESSAGE, {\n                session_id: sessionId,\n                message,\n                timestamp: new Date().toISOString(),\n                ...metadata && {\n                    metadata\n                }\n            });\n            if (!response.data || !response.data.data) {\n                throw new Error('Invalid response format from server');\n            }\n            return {\n                response: response.data.data.response || '',\n                metadata: response.data.data.metadata,\n                session_id: response.data.data.session_id || sessionId,\n                message_id: response.data.data.message_id || `msg_${Date.now()}`,\n                timestamp: response.data.data.timestamp || new Date().toISOString()\n            };\n        } catch (error) {\n            const errorMessage = error.response?.data?.error || 'Failed to send chat message';\n            const usingFallback = error.response?.data?.using_fallback;\n            console.error('Error sending chat message:', errorMessage, {\n                usingFallback\n            });\n            throw new Error(errorMessage);\n        }\n    }\n};\n// Trading API methods\nconst TradingApi = {\n    /**\n   * Execute a trade (first step of two-phase trade execution)\n   * @param params Trade execution parameters\n   * @returns Trade execution result with confirmation ID if confirmation required\n   */ async executeTrade (params) {\n        try {\n            const response = await api.post('/api/trading/execute', {\n                ...params,\n                amount: params.amount.toString()\n            });\n            return response.data;\n        } catch (error) {\n            console.error('Trade execution failed:', error);\n            throw new Error(error.response?.data?.error || 'Trade execution failed');\n        }\n    },\n    /**\n   * Confirm a pending trade (second step of two-phase trade execution)\n   * @param confirmationId The confirmation ID from executeTrade response\n   * @returns Final trade execution result\n   */ async confirmTrade (confirmationId) {\n        try {\n            const response = await api.post('/api/trading/confirm', {\n                confirmation_id: confirmationId\n            });\n            return response.data;\n        } catch (error) {\n            console.error('Trade confirmation failed:', error);\n            throw new Error(error.response?.data?.error || 'Trade confirmation failed');\n        }\n    },\n    /**\n   * Close an existing position (leverage or spot)\n   * @param params Position parameters to close\n   * @returns Position closing result\n   */ async closePosition (params) {\n        try {\n            const response = await api.post('/api/trading/sell-position', params);\n            return response.data;\n        } catch (error) {\n            console.error('Position closing failed:', error);\n            throw new Error(error.response?.data?.error || 'Failed to close position');\n        }\n    },\n    /**\n   * Sell a spot token for another token (usually USDC)\n   * @param params Token selling parameters\n   * @returns Token selling result\n   */ async sellToken (params) {\n        try {\n            const response = await api.post('/api/trading/sell-token', {\n                ...params,\n                amount: params.amount.toString()\n            });\n            return response.data;\n        } catch (error) {\n            console.error('Token selling failed:', error);\n            throw new Error(error.response?.data?.error || 'Failed to sell token');\n        }\n    },\n    /**\n   * Sell or close a position (full or partial)\n   * @param params Position selling parameters\n   * @returns Result of the position sale\n   */ async sellPosition (params) {\n        try {\n            const requestData = {\n                ...params\n            };\n            // If percentage is provided, adjust the amount accordingly\n            if (params.percentage && params.percentage > 0 && params.percentage < 100) {\n                requestData.amount = params.amount * params.percentage / 100;\n            }\n            const response = await api.post(API_ENDPOINTS.TRADING.SELL_POSITION, requestData);\n            return response.data;\n        } catch (error) {\n            console.error('Failed to close position:', error);\n            throw new Error(error.response?.data?.error || 'Failed to close position');\n        }\n    },\n    /**\n   * Get user's leverage positions from Mango V3\n   * @returns User's leverage positions with success/error status\n   */ async getUserLeveragePositions () {\n        try {\n            const response = await api.get(API_ENDPOINTS.USER.LEVERAGE_POSITIONS);\n            // If response already has the right format, return it directly\n            if (response.data && typeof response.data === 'object' && 'success' in response.data) {\n                return response.data;\n            }\n            // Otherwise format according to Mango V3 spec\n            const positions = Array.isArray(response.data) ? response.data : [];\n            return {\n                success: true,\n                positions,\n                metadata: {\n                    total_positions: positions.length,\n                    timestamp: new Date().toISOString()\n                }\n            };\n        } catch (error) {\n            console.error('Error fetching leverage positions:', error);\n            return {\n                success: false,\n                positions: [],\n                error: {\n                    message: error instanceof Error ? error.message : 'Failed to fetch leverage positions',\n                    code: 'POSITION_FETCH_ERROR'\n                }\n            };\n        }\n    },\n    /**\n   * Get user's spot positions from wallet balances\n   * @returns User's spot positions with success/error status\n   */ async getUserSpotPositions () {\n        try {\n            const response = await api.get(API_ENDPOINTS.USER.SPOT_POSITIONS);\n            // If response already has the right format, return it directly\n            if (response.data && typeof response.data === 'object' && 'success' in response.data) {\n                return response.data;\n            }\n            // Otherwise format according to Mango V3 spec\n            const positions = Array.isArray(response.data) ? response.data : [];\n            return {\n                success: true,\n                positions,\n                metadata: {\n                    total_positions: positions.length,\n                    timestamp: new Date().toISOString()\n                }\n            };\n        } catch (error) {\n            console.error('Error fetching spot positions:', error);\n            return {\n                success: false,\n                positions: [],\n                error: {\n                    message: error instanceof Error ? error.message : 'Failed to fetch spot positions',\n                    code: 'POSITION_FETCH_ERROR'\n                }\n            };\n        }\n    },\n    /**\n   * Get position history for a user with pagination and filtering\n   * @param params Query parameters for filtering position history\n   * @returns Promise with position history data\n   */ getPositionHistory: async (params)=>{\n        try {\n            // Build query parameters\n            const queryParams = new URLSearchParams();\n            if (params?.market) queryParams.append('market', params.market);\n            if (params?.startTime) queryParams.append('start_time', String(params.startTime));\n            if (params?.endTime) queryParams.append('end_time', String(params.endTime));\n            if (params?.interval) queryParams.append('interval', params.interval);\n            if (params?.includePnl !== undefined) queryParams.append('include_pnl', String(params.includePnl));\n            if (params?.includeLivePnl) queryParams.append('include_live_pnl', 'true');\n            if (params?.cursor) queryParams.append('cursor', params.cursor);\n            if (params?.limit) queryParams.append('limit', String(params.limit));\n            const response = await fetch(`${API_ENDPOINTS.USER.POSITION_HISTORY}?${queryParams.toString()}`, {\n                method: 'GET',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${getAuthToken()}`\n                }\n            });\n            const data = await response.json();\n            // Handle error responses\n            if (!response.ok) {\n                const errorData = data?.error || {};\n                throw new ApiError(errorData.message || `HTTP error! status: ${response.status}`, response.status, {\n                    code: errorData.code || 'api_error',\n                    status: errorData.status || response.status,\n                    timestamp: errorData.timestamp || new Date().toISOString(),\n                    ...errorData.details && {\n                        details: errorData.details\n                    }\n                });\n            }\n            // Transform the successful response to match the PositionHistoryResponse type\n            return {\n                success: data.success,\n                position_history: data.position_history || [],\n                pnl_over_time: data.pnl_over_time || [],\n                pagination: data.pagination || {\n                    has_more: data.metadata?.has_more || false,\n                    next_cursor: data.metadata?.cursor,\n                    limit: params?.limit || 100,\n                    total: data.metadata?.total || 0\n                },\n                metadata: {\n                    user_identifier: data.metadata?.user_identifier || '',\n                    market: params?.market || 'all',\n                    start_time: data.metadata?.start_time || new Date().toISOString(),\n                    end_time: data.metadata?.end_time || new Date().toISOString(),\n                    interval: params?.interval || '1d',\n                    total_positions: data.metadata?.total || 0,\n                    has_more: data.metadata?.has_more || false,\n                    cursor: data.metadata?.cursor\n                }\n            };\n        } catch (error) {\n            console.error('Error fetching position history:', error);\n            // Handle ApiError instances\n            if (error instanceof ApiError) {\n                return {\n                    success: false,\n                    position_history: [],\n                    pnl_over_time: [],\n                    pagination: {\n                        has_more: false,\n                        next_cursor: undefined,\n                        limit: params?.limit || 100,\n                        total: 0\n                    },\n                    metadata: {\n                        user_identifier: '',\n                        market: params?.market || 'all',\n                        start_time: new Date().toISOString(),\n                        end_time: new Date().toISOString(),\n                        interval: params?.interval || '1d',\n                        total_positions: 0,\n                        has_more: false\n                    },\n                    error: error.message,\n                    error_details: error.data\n                };\n            }\n            // Handle other types of errors\n            return {\n                success: false,\n                position_history: [],\n                pnl_over_time: [],\n                pagination: {\n                    has_more: false,\n                    next_cursor: undefined,\n                    limit: params?.limit || 100,\n                    total: 0\n                },\n                metadata: {\n                    user_identifier: '',\n                    market: params?.market || 'all',\n                    start_time: new Date().toISOString(),\n                    end_time: new Date().toISOString(),\n                    interval: params?.interval || '1d',\n                    total_positions: 0,\n                    has_more: false\n                },\n                error: error instanceof Error ? error.message : 'Unknown error',\n                error_details: {\n                    code: 'unexpected_error',\n                    status: 500,\n                    timestamp: new Date().toISOString()\n                }\n            };\n        }\n    },\n    /**\n   * Get detailed position history for a specific position\n   * @param positionId ID of the position to get history for\n   * @param params Additional query parameters\n   * @returns Promise with detailed position history\n   */ getPositionDetails: async (positionId, params)=>{\n        try {\n            // Convert params to query string\n            const queryParams = new URLSearchParams({\n                positionId\n            });\n            if (params?.startTime) queryParams.append('startTime', String(params.startTime));\n            if (params?.endTime) queryParams.append('endTime', String(params.endTime));\n            if (params?.interval) queryParams.append('interval', params.interval);\n            const endpoint = `${API_ENDPOINTS.USER.POSITION_HISTORY}/details?${queryParams.toString()}`;\n            // Create headers object with proper typing\n            const authHeaders = addAuthHeaders();\n            const headers = new Headers();\n            headers.append('Content-Type', 'application/json');\n            // Add auth headers if they exist\n            if (authHeaders) {\n                Object.entries(authHeaders).forEach(([key, value])=>{\n                    if (value) headers.append(key, value);\n                });\n            }\n            const response = await api.get(endpoint, {\n                headers\n            });\n            if (!response.success) {\n                throw new Error(response.error || 'Failed to fetch position details');\n            }\n            return response.data.data;\n        } catch (error) {\n            console.error('Error fetching position details:', error);\n            throw error;\n        }\n    }\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (api);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFO0FBRUYsaUVBQWVjLEdBQUdBLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy93b25rYXN3b3JsZC9Eb3dubG9hZHMvZ3JhY2UtcHJvamVjdC9zcmMvdWkvYXBpL2FwaUNsaWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEFQSSBDbGllbnQgZm9yIEdyYWNlIEFwcFxuICogXG4gKiBQcm92aWRlcyBzdGFuZGFyZGl6ZWQgZXJyb3IgaGFuZGxpbmcgYW5kIHJlc3BvbnNlIHByb2Nlc3NpbmcgZm9yIGFsbCBBUEkgY2FsbHMuXG4gKi9cblxuLy8gRnJvbnQgYXBpIGNvbnN0YW50IGFuZCByb2J1c3QgcmVzb2x2ZXIgZm9yIGJhc2UgVVJMXG5jb25zdCBBUElfQkFTRV9VUkwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUElfVVJMIHx8ICcnO1xuXG4vLyBSZXNvbHZlIGJhc2UgVVJMOyBwcmVmZXIgZW52IHZhciwgZWxzZSB1c2UgcmVsYXRpdmUgcGF0aCB0byBhdm9pZCBDT1JTIGlzc3Vlc1xuY29uc3QgcmVzb2x2ZUJhc2VVcmwgPSAoKTogc3RyaW5nID0+IHtcbiAgY29uc3QgZW52VXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfQVBJX1VSTDtcbiAgaWYgKGVudlVybCAmJiBlbnZVcmwudHJpbSgpICE9PSAnJykge1xuICAgIHJldHVybiBlbnZVcmwuZW5kc1dpdGgoJy8nKSA/IGVudlVybC5zbGljZSgwLCAtMSkgOiBlbnZVcmw7XG4gIH1cbiAgLy8gRmFsbGJhY2sgdG8gcmVsYXRpdmUgYmFzZSB0byB1c2Ugc2FtZS1vcmlnaW4gb3IgZGV2IHByb3h5XG4gIHJldHVybiAnJztcbn07XG5cbi8vIEF1dGggdG9rZW4ga2V5IGZvciBsb2NhbFN0b3JhZ2VcbmNvbnN0IEFVVEhfVE9LRU5fS0VZID0gJ2dyYWNlX2F1dGhfdG9rZW4nO1xuY29uc3QgQUxUX1RPS0VOX0tFWSA9ICdncmFjZV90b2tlbic7XG5cbi8vIEdldCBhdXRoIHRva2VuIGZyb20gc3RvcmFnZSAoY2hlY2tzIGJvdGggc2Vzc2lvbiBhbmQgbG9jYWwsIGFuZCBib3RoIGtleXMpXG5leHBvcnQgY29uc3QgZ2V0QXV0aFRva2VuID0gKCk6IHN0cmluZyB8IG51bGwgPT4ge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gKFxuICAgICAgLy8gUHJlZmVyIHNlc3Npb25TdG9yYWdlIGZvciBjdXJyZW50IHNlc3Npb25cbiAgICAgIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oQVVUSF9UT0tFTl9LRVkpIHx8XG4gICAgICBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKEFMVF9UT0tFTl9LRVkpIHx8XG4gICAgICAvLyBGYWxsYmFjayB0byBsb2NhbFN0b3JhZ2VcbiAgICAgIGxvY2FsU3RvcmFnZS5nZXRJdGVtKEFVVEhfVE9LRU5fS0VZKSB8fFxuICAgICAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oQUxUX1RPS0VOX0tFWSlcbiAgICApO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcblxuLy8gU2F2ZSBhdXRoIHRva2VuIHRvIGxvY2FsU3RvcmFnZSB1bmRlciBib3RoIGtleXMgZm9yIGNvbXBhdGliaWxpdHlcbmV4cG9ydCBjb25zdCBzYXZlQXV0aFRva2VuID0gKHRva2VuOiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oQVVUSF9UT0tFTl9LRVksIHRva2VuKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShBTFRfVE9LRU5fS0VZLCB0b2tlbik7XG4gIH1cbn07XG5cbi8vIFJlbW92ZSBhdXRoIHRva2VuIGZyb20gYm90aCBzdG9yYWdlIGxvY2F0aW9ucyBhbmQga2V5c1xuZXhwb3J0IGNvbnN0IHJlbW92ZUF1dGhUb2tlbiA9ICgpOiB2b2lkID0+IHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oQVVUSF9UT0tFTl9LRVkpO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKEFMVF9UT0tFTl9LRVkpO1xuICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oQVVUSF9UT0tFTl9LRVkpO1xuICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oQUxUX1RPS0VOX0tFWSk7XG4gIH1cbn07XG5cbi8vIEFkZCBhdXRoIGhlYWRlcnMgdG8gcmVxdWVzdCBvcHRpb25zXG5leHBvcnQgY29uc3QgYWRkQXV0aEhlYWRlcnMgPSAob3B0aW9uczogUmVxdWVzdEluaXQgPSB7fSk6IFJlcXVlc3RJbml0ID0+IHtcbiAgY29uc3QgdG9rZW4gPSBnZXRBdXRoVG9rZW4oKTtcbiAgaWYgKHRva2VuKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIC4uLm9wdGlvbnMuaGVhZGVycyxcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxuICByZXR1cm4gb3B0aW9ucztcbn07XG5pbXBvcnQgeyBUcmFkZSwgVHJhZGVIaXN0b3J5UmVzcG9uc2UsIFBvc2l0aW9uSGlzdG9yeVJlc3BvbnNlLCBUcmFkZUV4ZWN1dGlvblJlc3VsdCwgUG9zaXRpb25IaXN0b3J5RW50cnksIFVzZXJQb3NpdGlvbnNSZXNwb25zZSwgQmFzZVBvc2l0aW9uIH0gZnJvbSAnLi9hcGlUeXBlcyc7XG4vLyBObyBjaXJjdWxhciBpbXBvcnRzXG5cbi8vIEFQSSBSZXNwb25zZSB0eXBlc1xuZXhwb3J0IGludGVyZmFjZSBBcGlSZXNwb25zZTxUID0gYW55PiB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGRhdGE/OiBUO1xuICBlcnJvcj86IHN0cmluZztcbiAgc3RhdHVzQ29kZT86IG51bWJlcjtcbiAgcmF3UmVzcG9uc2U/OiBhbnk7IC8vIE9yaWdpbmFsIHVucHJvY2Vzc2VkIHJlc3BvbnNlIGZvciBkZWJ1Z2dpbmdcbn1cblxuLy8gQVBJIEVycm9yIHR5cGVzXG5leHBvcnQgY2xhc3MgQXBpRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIHB1YmxpYyBzdGF0dXNDb2RlOiBudW1iZXI7XG4gIHB1YmxpYyBkYXRhPzogYW55O1xuXG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgc3RhdHVzQ29kZTogbnVtYmVyLCBkYXRhPzogYW55KSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gJ0FwaUVycm9yJztcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gIH1cbn1cblxuLy8gQVBJIGNvbmZpZ3VyYXRpb24gLSB1c2UgZW52aXJvbm1lbnQgdmFyaWFibGUgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgdXNlIHJlbGF0aXZlIHBhdGhcblxuLy8gRW5zdXJlIEFQSV9CQVNFX1VSTCBlbmRzIHdpdGggYSBzbGFzaCAoa2VwdCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcbmNvbnN0IGdldEJhc2VVcmwgPSAoKSA9PiB7XG4gIGNvbnN0IGJhc2UgPSBBUElfQkFTRV9VUkw7XG4gIGlmIChiYXNlICYmIGJhc2UuZW5kc1dpdGgoJy8nKSkge1xuICAgIHJldHVybiBiYXNlLnNsaWNlKDAsIC0xKTtcbiAgfVxuICByZXR1cm4gYmFzZTtcbn07XG5cbi8vIEFQSSBlbmRwb2ludHMgY29uc3RhbnRzXG5leHBvcnQgY29uc3QgQVBJX0VORFBPSU5UUyA9IHtcbiAgQVVUSDoge1xuICAgIExPR0lOOiAnL2FwaS9hdXRoL2xvZ2luJyxcbiAgICBSRUdJU1RFUjogJy9hcGkvYXV0aC9yZWdpc3RlcicsXG4gICAgVkVSSUZZX1RPS0VOOiAnL2FwaS9hdXRoL3ZlcmlmeScsXG4gICAgTE9HT1VUOiAnL2FwaS9hdXRoL2xvZ291dCcsXG4gICAgUkVGUkVTSF9UT0tFTjogJy9hdXRoL3JlZnJlc2gtdG9rZW4nLFxuICAgIEZPUkdPVF9QQVNTV09SRDogJy9hcGkvYXV0aC9mb3Jnb3QtcGFzc3dvcmQnLFxuICAgIFJFU0VUX1BBU1NXT1JEOiAnL2FwaS9hdXRoL3Jlc2V0LXBhc3N3b3JkJ1xuICB9LFxuICBVU0VSOiB7XG4gICAgUFJPRklMRTogJy9hcGkvdXNlci9wcm9maWxlJyxcbiAgICBMRVZFUkFHRV9QT1NJVElPTlM6ICcvYXBpL3VzZXIvbGV2ZXJhZ2VfcG9zaXRpb25zJyxcbiAgICBTUE9UX1BPU0lUSU9OUzogJy9hcGkvdXNlci9zcG90X3Bvc2l0aW9ucycsXG4gICAgUE9TSVRJT05fSElTVE9SWTogJy9hcGkvdXNlci9wb3NpdGlvbl9oaXN0b3J5JyxcbiAgICBUUkFERV9ISVNUT1JZOiAnL2FwaS91c2VyL3RyYWRlX2hpc3RvcnknLFxuICAgIExJTUlUX09SREVSUzogJy9hcGkvbGltaXQtb3JkZXJzJ1xuICB9LFxuICBXQUxMRVQ6IHtcbiAgICBEQVRBOiAnL2FwaS93YWxsZXQvZGF0YScsXG4gICAgSU5GTzogJy9hcGkvd2FsbGV0L2luZm8nLFxuICAgIE1BTkdPX0JBTEFOQ0U6ICcvYXBpL3dhbGxldC9tYW5nby1iYWxhbmNlJywgLy8gTWFuZ28gZXhjIGJhbGFuY2VcbiAgICBHRU5FUkFURTogJy9hcGkvd2FsbGV0L2dlbmVyYXRlJyxcbiAgICBTRU5EOiAnL2FwaS93YWxsZXQvc2VuZCcsXG4gICAgQ09OTkVDVF9QSEFOVE9NOiAnL2FwaS93YWxsZXQvcGhhbnRvbS9jb25uZWN0JyxcbiAgICBDT01QTEVURV9QSEFOVE9NOiAnL2FwaS93YWxsZXQvcGhhbnRvbS9jYWxsYmFjaycsIC8vIFVwZGF0ZWQgdG8gbWF0Y2ggYWN0dWFsIGJhY2tlbmQgZW5kcG9pbnRcbiAgICBESVNDT05ORUNUX1BIQU5UT006ICcvYXBpL3dhbGxldC9waGFudG9tL2Rpc2Nvbm5lY3QnLFxuICAgIC8vIE1hcCBCQUxBTkNFIHRvIElORk8gc2luY2UgdGhlIHNlcnZlciB1c2VzIC9hcGkvd2FsbGV0L2luZm8gZW5kcG9pbnQgdG8gZ2V0IHdhbGxldCBiYWxhbmNlXG4gICAgQkFMQU5DRTogJy9hcGkvd2FsbGV0L2luZm8nLFxuICAgIFRSQU5TQUNUSU9OUzogJy9hcGkvd2FsbGV0L3RyYW5zYWN0aW9ucydcbiAgfSxcbiAgQ0hBVDoge1xuICAgIC8vIEdldCBhbGwgY2hhdCBzZXNzaW9ucyBmb3IgdGhlIGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgIFNFU1NJT05TOiAnL2FwaS9jaGF0L3Nlc3Npb25zJyxcbiAgICAvLyBDcmVhdGUgYSBuZXcgY2hhdCBzZXNzaW9uXG4gICAgTkVXX1NFU1NJT046ICcvYXBpL2NoYXQvc2Vzc2lvbi9uZXcnLFxuICAgIC8vIEdldCBjaGF0IGhpc3RvcnkgZm9yIGEgc3BlY2lmaWMgc2Vzc2lvblxuICAgIEhJU1RPUlk6IChzZXNzaW9uSWQ6IHN0cmluZykgPT4gYC9hcGkvY2hhdC9oaXN0b3J5LyR7c2Vzc2lvbklkfWAsXG4gICAgLy8gU2VuZCBhIGNoYXQgbWVzc2FnZVxuICAgIE1FU1NBR0U6ICcvYXBpL2NoYXQvbWVzc2FnZSdcbiAgfSxcbiAgU09DSUFMOiB7XG4gICAgLy8gQ29yZSBzb2NpYWwgbWVkaWEgZW5kcG9pbnRzXG4gICAgU0VOVElNRU5UOiAnL2FwaS9zb2NpYWwvc2VudGltZW50JyxcbiAgICBUUkVORElORzogJy9hcGkvc29jaWFsL3RyZW5kaW5nLXRvcGljcycsXG4gICAgSU5GTFVFTlRJQUw6ICcvYXBpL3NvY2lhbC9pbmZsdWVudGlhbCcsXG4gICAgVFdFRVRTOiAnL2FwaS9zb2NpYWwvdHdlZXRzJyxcbiAgfSxcbiAgTUFOR086IHtcbiAgICAvLyBNYW5nbyBNYXJrZXRzIEFQSSBlbmRwb2ludHNcbiAgICBCQVNFOiAnL2FwaS9tYW5nbycsXG4gICAgT0hMQ1Y6ICcvYXBpL21hbmdvL29obGN2JyxcbiAgICBNQVJLRVRTOiAnL2FwaS9tYW5nby9tYXJrZXRzJyxcbiAgICBPUkRFUl9CT09LOiAnL2FwaS9tYW5nby9vcmRlcmJvb2snLFxuICAgIFRSQURFUzogJy9hcGkvbWFuZ28vdHJhZGVzJyxcbiAgICBNQVJLRVRfU1RBVFM6ICcvYXBpL21hbmdvL21hcmtldC1zdGF0cycsXG4gICAgQ09NTVVOSVRJRVM6ICcvYXBpL3NvY2lhbC9jb21tdW5pdGllcycsXG4gICAgRU5USVRJRVM6ICcvYXBpL3NvY2lhbC9lbnRpdGllcycsXG4gICAgRkVFRDogJy9hcGkvc29jaWFsL2ZlZWQnLFxuICAgIENPTk5FQ1RJT05TOiAnL2FwaS9zb2NpYWwvY29ubmVjdGlvbnMnXG4gIH0sXG4gIFRSQURJTkc6IHtcbiAgICBFWEVDVVRFOiAnL2FwaS90cmFkaW5nL2V4ZWN1dGUnLFxuICAgIENPTkZJUk06ICcvYXBpL3RyYWRpbmcvY29uZmlybScsXG4gICAgU01BUlRfU0VUVElOR1M6ICcvYXBpL3RyYWRpbmcvc21hcnQtc2V0dGluZ3MnLFxuICAgIFRPS0VOUzogJy9hcGkvdHJhZGluZy90b2tlbnMnLFxuICAgIFBSSUNFX0NIQVJUOiAnL2FwaS90cmFkaW5nL3ByaWNlLWNoYXJ0JyxcbiAgICBTV0FQOiAnL2FwaS90cmFkaW5nL3N3YXAnLFxuICAgIFNFTExfUE9TSVRJT046ICcvYXBpL3RyYWRpbmcvc2VsbC1wb3NpdGlvbicsXG4gICAgVVNFUl9QT1NJVElPTlM6ICcvYXBpL3VzZXIvcG9zaXRpb25zJyxcbiAgICBMRVZFUkFHRV9QT1NJVElPTlM6ICcvYXBpL3VzZXIvbGV2ZXJhZ2VfcG9zaXRpb25zJyxcbiAgICBTUE9UX1BPU0lUSU9OUzogJy9hcGkvdXNlci9zcG90X3Bvc2l0aW9ucydcbiAgfSxcbiAgU0VUVElOR1M6IHtcbiAgICAvLyBVcGRhdGVkIHRvIG1hdGNoIGJhY2tlbmQgaW1wbGVtZW50YXRpb25cbiAgICBQUk9GSUxFOiAnL2FwaS91c2VyL3NldHRpbmdzJywgIC8vIE1hdGNoZXMgdXNlcl9zZXR0aW5ncyBlbmRwb2ludCBpbiBiYWNrZW5kXG4gICAgTk9USUZJQ0FUSU9OUzogJy9hcGkvc2V0dGluZ3Mvbm90aWZpY2F0aW9ucycsIC8vIEtlZXAgZm9yIGZ1dHVyZSBpbXBsZW1lbnRhdGlvblxuICAgIC8vIEFkZGl0aW9uYWwgYmFja2VuZCBzZXR0aW5ncyBlbmRwb2ludFxuICAgIFRSQURJTkdfU0VUVElOR1M6ICcvYXBpL3RyYWRpbmcvc21hcnQtc2V0dGluZ3MnLCAvLyBNYXRjaGVzIHRyYWRpbmdfc21hcnRfc2V0dGluZ3MgaW4gYmFja2VuZFxuICB9LFxufTtcblxuLyoqXG4gKiBOb3JtYWxpemUgZGlmZmVyZW50IEFQSSByZXNwb25zZSBmb3JtYXRzIHRvIGEgY29uc2lzdGVudCBzdHJ1Y3R1cmVcbiAqIFxuICogVGhpcyBwcmlvcml0aXplcyBBUEkgcmVzcG9uc2UgZm9ybWF0cyBpbiBhIHByZWRpY3RhYmxlIG9yZGVyOlxuICogMS4gQXV0aCByZXNwb25zZXMgd2l0aCB0b2tlbiBhbmQgdXNlclxuICogMi4gU3RhbmRhcmQgc3VjY2VzcyByZXNwb25zZXMgd2l0aCBkYXRhXG4gKiAzLiBSZXN1bHRzLWJhc2VkIHJlc3BvbnNlc1xuICogNC4gRGVmYXVsdCBwYXNzLXRocm91Z2hcbiAqL1xuZnVuY3Rpb24gbm9ybWFsaXplUmVzcG9uc2U8VD4ocmVzcG9uc2VEYXRhOiBhbnkpOiBUIHtcbiAgLy8gSGFuZGxlIGF1dGggcmVzcG9uc2VzIHdpdGggdG9rZW5cbiAgaWYgKHJlc3BvbnNlRGF0YSAmJiB0eXBlb2YgcmVzcG9uc2VEYXRhID09PSAnb2JqZWN0JyAmJiAndG9rZW4nIGluIHJlc3BvbnNlRGF0YSkge1xuICAgIC8vIFNhdmUgdGhlIHRva2VuIHdoZW4gcmVjZWl2ZWQgaW4gdGhlIHJlc3BvbnNlXG4gICAgc2F2ZUF1dGhUb2tlbihyZXNwb25zZURhdGEudG9rZW4pO1xuICAgIC8vIFJlbW92ZSB0b2tlbiBmcm9tIHJlc3BvbnNlIGRhdGEgdG8gYXZvaWQgZXhwb3NpbmcgaXRcbiAgICBjb25zdCB7IHRva2VuLCAuLi5yZXN0IH0gPSByZXNwb25zZURhdGE7XG4gICAgcmV0dXJuIHJlc3QgYXMgVDtcbiAgfVxuICBcbiAgLy8gSGFuZGxlIHN0YW5kYXJkIHN1Y2Nlc3MgcmVzcG9uc2UgZm9ybWF0XG4gIGlmIChyZXNwb25zZURhdGEgJiYgdHlwZW9mIHJlc3BvbnNlRGF0YSA9PT0gJ29iamVjdCcgJiYgJ3N1Y2Nlc3MnIGluIHJlc3BvbnNlRGF0YSkge1xuICAgIHJldHVybiByZXNwb25zZURhdGEgYXMgVDtcbiAgfVxuICBcbiAgLy8gSGFuZGxlIHJlc3VsdHMtYmFzZWQgcmVzcG9uc2UgZm9ybWF0XG4gIGlmIChyZXNwb25zZURhdGEgJiYgdHlwZW9mIHJlc3BvbnNlRGF0YSA9PT0gJ29iamVjdCcgJiYgJ3Jlc3VsdHMnIGluIHJlc3BvbnNlRGF0YSkge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogcmVzcG9uc2VEYXRhLnJlc3VsdHMsXG4gICAgICAuLi5yZXNwb25zZURhdGFcbiAgICB9IGFzIHVua25vd24gYXMgVDtcbiAgfVxuICBcbiAgLy8gRGVmYXVsdDogcGFzcyB0aHJvdWdoIHRoZSByZXNwb25zZSBkYXRhIGFzLWlzXG4gIC8vIFNvbWUgZW5kcG9pbnRzIHJldHVybiByZXN1bHRzIGluIGEgJ3Jlc3VsdHMnIHByb3BlcnR5XG4gIGlmIChyZXNwb25zZURhdGEucmVzdWx0cykge1xuICAgIHJldHVybiByZXNwb25zZURhdGEucmVzdWx0cyBhcyBUO1xuICB9XG4gIFxuICAvLyBQUklPUklUWSA0OiBIYW5kbGUgZGlyZWN0IGRhdGEgZm9ybWF0IHdpdGhvdXQgc3VjY2VzcyBmbGFnXG4gIC8vIFNvbWUgb2xkIGVuZHBvaW50cyByZXR1cm4ge2RhdGE6IHsuLi59fSBkaXJlY3RseVxuICBpZiAocmVzcG9uc2VEYXRhLmRhdGEgJiYgcmVzcG9uc2VEYXRhLnN1Y2Nlc3MgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiByZXNwb25zZURhdGEuZGF0YSBhcyBUO1xuICB9XG4gIFxuICAvLyBGYWxsIGJhY2sgdG8gcmV0dXJuaW5nIHRoZSBlbnRpcmUgcmVzcG9uc2UgYXMgaXNcbiAgcmV0dXJuIHJlc3BvbnNlRGF0YSBhcyBUO1xufVxuXG4vKipcbiAqIFByb2Nlc3MgdGhlIEFQSSByZXNwb25zZSBhbmQgaGFuZGxlIGVycm9ycyBjb25zaXN0ZW50bHlcbiAqL1xuYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1Jlc3BvbnNlPFQ+KHJlc3BvbnNlOiBSZXNwb25zZSk6IFByb21pc2U8QXBpUmVzcG9uc2U8VD4+IHtcbiAgdHJ5IHtcbiAgICAvLyBDbG9uZSB0aGUgcmVzcG9uc2Ugc28gd2UgY2FuIHJlYWQgaXQgbXVsdGlwbGUgdGltZXNcbiAgICBjb25zdCByZXNwb25zZUNsb25lID0gcmVzcG9uc2UuY2xvbmUoKTtcbiAgICBcbiAgICAvLyBSZWFkIGJvZHkgT05DRSBhcyB0ZXh0LCB0aGVuIGF0dGVtcHQgdG8gcGFyc2UgSlNPTiBmcm9tIGl0LlxuICAgIGNvbnN0IGJvZHlUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIGxldCBkYXRhOiBhbnkgPSB1bmRlZmluZWQ7XG4gICAgdHJ5IHtcbiAgICAgIGRhdGEgPSBib2R5VGV4dCA/IEpTT04ucGFyc2UoYm9keVRleHQpIDogdW5kZWZpbmVkO1xuICAgICAgLy8gSWYgd2UgZ2V0IGEgbmV3IHRva2VuIGluIHRoZSByZXNwb25zZSwgc2F2ZSBpdFxuICAgICAgaWYgKGRhdGEgJiYgZGF0YS50b2tlbikge1xuICAgICAgICBzYXZlQXV0aFRva2VuKGRhdGEudG9rZW4pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIE5vbi1KU09OIGJvZHk7IHRyZWF0IGFzIHRleHQgZXJyb3IgcGF5bG9hZCB3aGVuIG5vdCBva1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBib2R5VGV4dCB8fCAnSW52YWxpZCByZXNwb25zZSBmb3JtYXQnLFxuICAgICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICByYXdSZXNwb25zZTogcmVzcG9uc2VDbG9uZVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgLy8gSWYgT0sgc3RhdHVzIGJ1dCBub24tSlNPTiwgcGFzcyByYXcgdGV4dCBhcyBkYXRhXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBib2R5VGV4dCBhcyB1bmtub3duIGFzIFQsXG4gICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgcmF3UmVzcG9uc2U6IHJlc3BvbnNlQ2xvbmVcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBIVFRQIGVycm9yIHN0YXR1cyBjb2Rlc1xuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIC8vIERvIG5vdCBwZXJmb3JtIGdsb2JhbCBzaWRlIGVmZmVjdHMgaGVyZTsgbGV0IGNhbGxlcnMgZGVjaWRlIGhvdyB0byBoYW5kbGUgNDAxLzQwM1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBkYXRhPy5tZXNzYWdlIHx8IGRhdGE/LmVycm9yIHx8IGBIVFRQIGVycm9yICR7cmVzcG9uc2Uuc3RhdHVzfWAsXG4gICAgICAgIHN0YXR1c0NvZGU6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgZGF0YSxcbiAgICAgICAgcmF3UmVzcG9uc2U6IHJlc3BvbnNlQ2xvbmVcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8vIFN1Y2Nlc3MgY2FzZSAtIG5vcm1hbGl6ZSB0aGUgcmVzcG9uc2UgZGF0YVxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogbm9ybWFsaXplUmVzcG9uc2U8VD4oZGF0YSksXG4gICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICByYXdSZXNwb25zZTogcmVzcG9uc2VDbG9uZVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyByZXNwb25zZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3IgcHJvY2Vzc2luZyByZXNwb25zZScsXG4gICAgICByYXdSZXNwb25zZTogcmVzcG9uc2UuY2xvbmUoKVxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBNYWtlIGFuIEFQSSByZXF1ZXN0IHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGFwaVJlcXVlc3Q8VCA9IGFueT4oXG4gIGVuZHBvaW50OiBzdHJpbmcsXG4gIG9wdGlvbnM6IFJlcXVlc3RJbml0ID0ge31cbik6IFByb21pc2U8QXBpUmVzcG9uc2U8VD4+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgYmFzZSBVUkwgZnJvbSBlbnZpcm9ubWVudCBvciB1c2Ugcm9idXN0IGZhbGxiYWNrXG4gICAgY29uc3QgYmFzZVVybCA9IHJlc29sdmVCYXNlVXJsKCk7XG4gICAgY29uc3QgdXJsID0gZW5kcG9pbnQuc3RhcnRzV2l0aCgnaHR0cCcpID8gZW5kcG9pbnQgOiBgJHtiYXNlVXJsfSR7ZW5kcG9pbnR9YDtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnQVBJIFJlcXVlc3Q6JywgeyBiYXNlVXJsLCBlbmRwb2ludCwgdXJsIH0pO1xuICAgIFxuICAgIC8vIEFkZCBhdXRoIGhlYWRlcnMgdG8gdGhlIHJlcXVlc3RcbiAgICBjb25zdCByZXF1ZXN0T3B0aW9ucyA9IGFkZEF1dGhIZWFkZXJzKHtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnLCAvLyBJbmNsdWRlIGNvb2tpZXMgZm9yIENTUkYgcHJvdGVjdGlvblxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAuLi5vcHRpb25zLmhlYWRlcnMsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICB9LFxuICAgIH0pO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNYWtpbmcgZmV0Y2ggcmVxdWVzdCB0bzonLCB1cmwsICd3aXRoIG9wdGlvbnM6JywgcmVxdWVzdE9wdGlvbnMpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCByZXF1ZXN0T3B0aW9ucyk7XG4gICAgY29uc29sZS5sb2coJ1Jlc3BvbnNlIHJlY2VpdmVkOicsIHJlc3BvbnNlLnN0YXR1cywgcmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG5cbiAgICByZXR1cm4gYXdhaXQgcHJvY2Vzc1Jlc3BvbnNlPFQ+KHJlc3BvbnNlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBBcGlFcnJvcikge1xuICAgICAgLy8gUmV0aHJvdyBBcGlFcnJvciBpbnN0YW5jZXNcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYW5kbGUgbmV0d29yayBlcnJvcnNcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdOZXR3b3JrIGVycm9yJyxcbiAgICAgIDBcbiAgICApO1xuICB9XG59XG5cbi8vIENvbnZlbmllbmNlIG1ldGhvZHMgZm9yIGNvbW1vbiBIVFRQIG1ldGhvZHNcbmV4cG9ydCBjb25zdCBhcGkgPSB7XG4gIGFzeW5jIGdldDxUID0gYW55PihlbmRwb2ludDogc3RyaW5nLCBvcHRpb25zOiBSZXF1ZXN0SW5pdCA9IHt9KTogUHJvbWlzZTxBcGlSZXNwb25zZTxUPj4ge1xuICAgIHJldHVybiBhcGlSZXF1ZXN0PFQ+KGVuZHBvaW50LCB7IC4uLm9wdGlvbnMsIG1ldGhvZDogJ0dFVCcgfSk7XG4gIH0sXG4gIFxuICBhc3luYyBwb3N0PFQgPSBhbnk+KGVuZHBvaW50OiBzdHJpbmcsIGRhdGE6IGFueSwgb3B0aW9uczogUmVxdWVzdEluaXQgPSB7fSk6IFByb21pc2U8QXBpUmVzcG9uc2U8VD4+IHtcbiAgICByZXR1cm4gYXBpUmVxdWVzdDxUPihlbmRwb2ludCwge1xuICAgICAgLi4ub3B0aW9ucyxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXG4gICAgfSk7XG4gIH0sXG4gIFxuICBhc3luYyBwdXQ8VCA9IGFueT4oZW5kcG9pbnQ6IHN0cmluZywgZGF0YTogYW55LCBvcHRpb25zOiBSZXF1ZXN0SW5pdCA9IHt9KTogUHJvbWlzZTxBcGlSZXNwb25zZTxUPj4ge1xuICAgIHJldHVybiBhcGlSZXF1ZXN0PFQ+KGVuZHBvaW50LCB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgIH0pO1xuICB9LFxuICBcbiAgYXN5bmMgZGVsZXRlPFQgPSBhbnk+KGVuZHBvaW50OiBzdHJpbmcsIG9wdGlvbnM6IFJlcXVlc3RJbml0ID0ge30pOiBQcm9taXNlPEFwaVJlc3BvbnNlPFQ+PiB7XG4gICAgcmV0dXJuIGFwaVJlcXVlc3Q8VD4oZW5kcG9pbnQsIHsgLi4ub3B0aW9ucywgbWV0aG9kOiAnREVMRVRFJyB9KTtcbiAgfVxufTtcblxuLy8gQ2hhdCBBUEkgVHlwZXNcbmludGVyZmFjZSBDaGF0U2Vzc2lvbiB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGNyZWF0ZWQ6IHN0cmluZztcbiAgdXBkYXRlZDogc3RyaW5nO1xuICBtZXNzYWdlX2NvdW50OiBudW1iZXI7XG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55Pjtcbn1cblxuaW50ZXJmYWNlIENoYXRNZXNzYWdlIHtcbiAgaWQ6IHN0cmluZztcbiAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcbiAgY29udGVudDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IHN0cmluZztcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufVxuXG5pbnRlcmZhY2UgQXBpRXJyb3JSZXNwb25zZSB7XG4gIGVycm9yOiBzdHJpbmc7XG4gIHVzaW5nX2ZhbGxiYWNrPzogYm9vbGVhbjtcbiAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG4vLyBDaGF0IEFQSSBtZXRob2RzXG5leHBvcnQgY29uc3QgQ2hhdEFwaSA9IHtcbiAgLyoqXG4gICAqIEdldCBhbGwgY2hhdCBzZXNzaW9ucyBmb3IgdGhlIGF1dGhlbnRpY2F0ZWQgdXNlclxuICAgKiBAcmV0dXJucyBQcm9taXNlIHdpdGggbGlzdCBvZiBjaGF0IHNlc3Npb25zXG4gICAqL1xuICAvKipcbiAgICogR2V0IGFsbCBjaGF0IHNlc3Npb25zIGZvciB0aGUgYXV0aGVudGljYXRlZCB1c2VyXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdCBmb3IgcGFnaW5hdGlvblxuICAgKiBAcGFyYW0gb2Zmc2V0IE9wdGlvbmFsIG9mZnNldCBmb3IgcGFnaW5hdGlvblxuICAgKiBAcmV0dXJucyBQcm9taXNlIHdpdGggbGlzdCBvZiBjaGF0IHNlc3Npb25zIGFuZCBwYWdpbmF0aW9uIGluZm9cbiAgICovXG4gIGFzeW5jIGdldFNlc3Npb25zKGxpbWl0PzogbnVtYmVyLCBvZmZzZXQ/OiBudW1iZXIpOiBQcm9taXNlPHtcbiAgICBzZXNzaW9uczogQ2hhdFNlc3Npb25bXTtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIGhhc19tb3JlOiBib29sZWFuO1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcbiAgICAgIGlmIChsaW1pdCkgcGFyYW1zLmFwcGVuZCgnbGltaXQnLCBsaW1pdC50b1N0cmluZygpKTtcbiAgICAgIGlmIChvZmZzZXQpIHBhcmFtcy5hcHBlbmQoJ29mZnNldCcsIG9mZnNldC50b1N0cmluZygpKTtcbiAgICAgIFxuICAgICAgY29uc3QgcXVlcnkgPSBwYXJhbXMudG9TdHJpbmcoKTtcbiAgICAgIGNvbnN0IHVybCA9IHF1ZXJ5ID8gYCR7QVBJX0VORFBPSU5UUy5DSEFULlNFU1NJT05TfT8ke3F1ZXJ5fWAgOiBBUElfRU5EUE9JTlRTLkNIQVQuU0VTU0lPTlM7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmdldDx7XG4gICAgICAgIGRhdGE6IENoYXRTZXNzaW9uW107XG4gICAgICAgIHRvdGFsOiBudW1iZXI7XG4gICAgICAgIGhhc19tb3JlOiBib29sZWFuO1xuICAgICAgfT4odXJsKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc2Vzc2lvbnM6IHJlc3BvbnNlLmRhdGE/LmRhdGEgfHwgW10sXG4gICAgICAgIHRvdGFsOiByZXNwb25zZS5kYXRhPy50b3RhbCB8fCAwLFxuICAgICAgICBoYXNfbW9yZTogcmVzcG9uc2UuZGF0YT8uaGFzX21vcmUgfHwgZmFsc2UsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvciB8fCAnRmFpbGVkIHRvIGZldGNoIGNoYXQgc2Vzc2lvbnMnO1xuICAgICAgY29uc3QgdXNpbmdGYWxsYmFjayA9IGVycm9yLnJlc3BvbnNlPy5kYXRhPy51c2luZ19mYWxsYmFjaztcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNoYXQgc2Vzc2lvbnM6JywgZXJyb3JNZXNzYWdlLCB7IHVzaW5nRmFsbGJhY2sgfSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBjaGF0IHNlc3Npb25cbiAgICogQHBhcmFtIHRpdGxlIE9wdGlvbmFsIHRpdGxlIGZvciB0aGUgbmV3IHNlc3Npb25cbiAgICogQHJldHVybnMgUHJvbWlzZSB3aXRoIHRoZSBuZXcgc2Vzc2lvbiBJRFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlU2Vzc2lvbih0aXRsZT86IHN0cmluZyk6IFByb21pc2U8eyBzZXNzaW9uX2lkOiBzdHJpbmcgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5wb3N0PHsgc2Vzc2lvbl9pZDogc3RyaW5nIH0+KFxuICAgICAgICBBUElfRU5EUE9JTlRTLkNIQVQuTkVXX1NFU1NJT04sXG4gICAgICAgIHsgdGl0bGU6IHRpdGxlIHx8ICdOZXcgQ2hhdCcgfVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKCFyZXNwb25zZS5kYXRhPy5zZXNzaW9uX2lkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBzZXJ2ZXInKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHsgc2Vzc2lvbl9pZDogcmVzcG9uc2UuZGF0YS5zZXNzaW9uX2lkIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNoYXQgc2Vzc2lvbjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjcmVhdGUgY2hhdCBzZXNzaW9uJyk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgY2hhdCBoaXN0b3J5IGZvciBhIHNwZWNpZmljIHNlc3Npb25cbiAgICogQHBhcmFtIHNlc3Npb25JZCBJRCBvZiB0aGUgY2hhdCBzZXNzaW9uXG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCBjaGF0IGhpc3RvcnlcbiAgICovXG4gIC8qKlxuICAgKiBHZXQgY2hhdCBoaXN0b3J5IGZvciBhIHNwZWNpZmljIHNlc3Npb25cbiAgICogQHBhcmFtIHNlc3Npb25JZCBJRCBvZiB0aGUgY2hhdCBzZXNzaW9uXG4gICAqIEBwYXJhbSBsaW1pdCBPcHRpb25hbCBsaW1pdCBmb3IgcGFnaW5hdGlvblxuICAgKiBAcGFyYW0gb2Zmc2V0IE9wdGlvbmFsIG9mZnNldCBmb3IgcGFnaW5hdGlvblxuICAgKiBAcmV0dXJucyBQcm9taXNlIHdpdGggY2hhdCBoaXN0b3J5IGFuZCBwYWdpbmF0aW9uIGluZm9cbiAgICovXG4gIGFzeW5jIGdldEhpc3RvcnkoXG4gICAgc2Vzc2lvbklkOiBzdHJpbmcsXG4gICAgbGltaXQ/OiBudW1iZXIsXG4gICAgb2Zmc2V0PzogbnVtYmVyXG4gICk6IFByb21pc2U8e1xuICAgIG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdO1xuICAgIHRvdGFsOiBudW1iZXI7XG4gICAgaGFzX21vcmU6IGJvb2xlYW47XG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICAgICAgaWYgKGxpbWl0KSBwYXJhbXMuYXBwZW5kKCdsaW1pdCcsIGxpbWl0LnRvU3RyaW5nKCkpO1xuICAgICAgaWYgKG9mZnNldCkgcGFyYW1zLmFwcGVuZCgnb2Zmc2V0Jywgb2Zmc2V0LnRvU3RyaW5nKCkpO1xuICAgICAgXG4gICAgICBjb25zdCBxdWVyeSA9IHBhcmFtcy50b1N0cmluZygpO1xuICAgICAgY29uc3QgdXJsID0gcXVlcnkgXG4gICAgICAgID8gYCR7QVBJX0VORFBPSU5UUy5DSEFULkhJU1RPUlkoc2Vzc2lvbklkKX0/JHtxdWVyeX1gXG4gICAgICAgIDogQVBJX0VORFBPSU5UUy5DSEFULkhJU1RPUlkoc2Vzc2lvbklkKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZ2V0PHtcbiAgICAgICAgZGF0YTogQ2hhdE1lc3NhZ2VbXTtcbiAgICAgICAgdG90YWw6IG51bWJlcjtcbiAgICAgICAgaGFzX21vcmU6IGJvb2xlYW47XG4gICAgICB9Pih1cmwpO1xuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlczogcmVzcG9uc2UuZGF0YT8uZGF0YSB8fCBbXSxcbiAgICAgICAgdG90YWw6IHJlc3BvbnNlLmRhdGE/LnRvdGFsIHx8IDAsXG4gICAgICAgIGhhc19tb3JlOiByZXNwb25zZS5kYXRhPy5oYXNfbW9yZSB8fCBmYWxzZSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdGYWlsZWQgdG8gZmV0Y2ggY2hhdCBoaXN0b3J5JztcbiAgICAgIGNvbnN0IHVzaW5nRmFsbGJhY2sgPSBlcnJvci5yZXNwb25zZT8uZGF0YT8udXNpbmdfZmFsbGJhY2s7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjaGF0IGhpc3Rvcnk6JywgZXJyb3JNZXNzYWdlLCB7IHVzaW5nRmFsbGJhY2sgfSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFNlbmQgYSBtZXNzYWdlIGluIGEgY2hhdCBzZXNzaW9uXG4gICAqIEBwYXJhbSBzZXNzaW9uSWQgSUQgb2YgdGhlIGNoYXQgc2Vzc2lvblxuICAgKiBAcGFyYW0gbWVzc2FnZSBUaGUgbWVzc2FnZSBjb250ZW50XG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCB0aGUgYXNzaXN0YW50J3MgcmVzcG9uc2VcbiAgICovXG4gIC8qKlxuICAgKiBTZW5kIGEgbWVzc2FnZSBpbiBhIGNoYXQgc2Vzc2lvblxuICAgKiBAcGFyYW0gc2Vzc2lvbklkIElEIG9mIHRoZSBjaGF0IHNlc3Npb25cbiAgICogQHBhcmFtIG1lc3NhZ2UgVGhlIG1lc3NhZ2UgY29udGVudFxuICAgKiBAcGFyYW0gbWV0YWRhdGEgT3B0aW9uYWwgbWV0YWRhdGEgdG8gaW5jbHVkZSB3aXRoIHRoZSBtZXNzYWdlXG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCB0aGUgYXNzaXN0YW50J3MgcmVzcG9uc2VcbiAgICovXG4gIGFzeW5jIHNlbmRNZXNzYWdlKFxuICAgIHNlc3Npb25JZDogc3RyaW5nLFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgKTogUHJvbWlzZTx7XG4gICAgcmVzcG9uc2U6IHN0cmluZztcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gICAgc2Vzc2lvbl9pZDogc3RyaW5nO1xuICAgIG1lc3NhZ2VfaWQ6IHN0cmluZztcbiAgICB0aW1lc3RhbXA6IHN0cmluZztcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5wb3N0PHsgZGF0YTogYW55IH0+KFxuICAgICAgICBBUElfRU5EUE9JTlRTLkNIQVQuTUVTU0FHRSxcbiAgICAgICAge1xuICAgICAgICAgIHNlc3Npb25faWQ6IHNlc3Npb25JZCxcbiAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIC4uLihtZXRhZGF0YSAmJiB7IG1ldGFkYXRhIH0pLFxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLmRhdGEgfHwgIXJlc3BvbnNlLmRhdGEuZGF0YSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZm9ybWF0IGZyb20gc2VydmVyJyk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3BvbnNlOiByZXNwb25zZS5kYXRhLmRhdGEucmVzcG9uc2UgfHwgJycsXG4gICAgICAgIG1ldGFkYXRhOiByZXNwb25zZS5kYXRhLmRhdGEubWV0YWRhdGEsXG4gICAgICAgIHNlc3Npb25faWQ6IHJlc3BvbnNlLmRhdGEuZGF0YS5zZXNzaW9uX2lkIHx8IHNlc3Npb25JZCxcbiAgICAgICAgbWVzc2FnZV9pZDogcmVzcG9uc2UuZGF0YS5kYXRhLm1lc3NhZ2VfaWQgfHwgYG1zZ18ke0RhdGUubm93KCl9YCxcbiAgICAgICAgdGltZXN0YW1wOiByZXNwb25zZS5kYXRhLmRhdGEudGltZXN0YW1wIHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdGYWlsZWQgdG8gc2VuZCBjaGF0IG1lc3NhZ2UnO1xuICAgICAgY29uc3QgdXNpbmdGYWxsYmFjayA9IGVycm9yLnJlc3BvbnNlPy5kYXRhPy51c2luZ19mYWxsYmFjaztcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgY2hhdCBtZXNzYWdlOicsIGVycm9yTWVzc2FnZSwgeyB1c2luZ0ZhbGxiYWNrIH0pO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxuICB9LFxufTtcblxuLy8gVHJhZGluZyBBUEkgbWV0aG9kc1xuZXhwb3J0IGNvbnN0IFRyYWRpbmdBcGkgPSB7XG4gIC8qKlxuICAgKiBFeGVjdXRlIGEgdHJhZGUgKGZpcnN0IHN0ZXAgb2YgdHdvLXBoYXNlIHRyYWRlIGV4ZWN1dGlvbilcbiAgICogQHBhcmFtIHBhcmFtcyBUcmFkZSBleGVjdXRpb24gcGFyYW1ldGVyc1xuICAgKiBAcmV0dXJucyBUcmFkZSBleGVjdXRpb24gcmVzdWx0IHdpdGggY29uZmlybWF0aW9uIElEIGlmIGNvbmZpcm1hdGlvbiByZXF1aXJlZFxuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZVRyYWRlKHBhcmFtczoge1xuICAgIGFjdGlvbjogJ2J1eScgfCAnc2VsbCc7XG4gICAgdG9rZW46IHN0cmluZztcbiAgICBhbW91bnQ6IHN0cmluZyB8IG51bWJlcjtcbiAgICBpc0xldmVyYWdlPzogYm9vbGVhbjtcbiAgICBsZXZlcmFnZT86IG51bWJlcjtcbiAgICBzdG9wTG9zcz86IG51bWJlcjtcbiAgICB0YWtlUHJvZml0PzogbnVtYmVyO1xuICB9KTogUHJvbWlzZTxUcmFkZUV4ZWN1dGlvblJlc3VsdD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFwaS5wb3N0KCcvYXBpL3RyYWRpbmcvZXhlY3V0ZScsIHtcbiAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICBhbW91bnQ6IHBhcmFtcy5hbW91bnQudG9TdHJpbmcoKVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignVHJhZGUgZXhlY3V0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGVycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvciB8fCAnVHJhZGUgZXhlY3V0aW9uIGZhaWxlZCdcbiAgICAgICk7XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBDb25maXJtIGEgcGVuZGluZyB0cmFkZSAoc2Vjb25kIHN0ZXAgb2YgdHdvLXBoYXNlIHRyYWRlIGV4ZWN1dGlvbilcbiAgICogQHBhcmFtIGNvbmZpcm1hdGlvbklkIFRoZSBjb25maXJtYXRpb24gSUQgZnJvbSBleGVjdXRlVHJhZGUgcmVzcG9uc2VcbiAgICogQHJldHVybnMgRmluYWwgdHJhZGUgZXhlY3V0aW9uIHJlc3VsdFxuICAgKi9cbiAgYXN5bmMgY29uZmlybVRyYWRlKGNvbmZpcm1hdGlvbklkOiBzdHJpbmcpOiBQcm9taXNlPFRyYWRlRXhlY3V0aW9uUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLnBvc3QoJy9hcGkvdHJhZGluZy9jb25maXJtJywge1xuICAgICAgICBjb25maXJtYXRpb25faWQ6IGNvbmZpcm1hdGlvbklkXG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdUcmFkZSBjb25maXJtYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdUcmFkZSBjb25maXJtYXRpb24gZmFpbGVkJ1xuICAgICAgKTtcbiAgICB9XG4gIH0sXG4gIFxuICAvKipcbiAgICogQ2xvc2UgYW4gZXhpc3RpbmcgcG9zaXRpb24gKGxldmVyYWdlIG9yIHNwb3QpXG4gICAqIEBwYXJhbSBwYXJhbXMgUG9zaXRpb24gcGFyYW1ldGVycyB0byBjbG9zZVxuICAgKiBAcmV0dXJucyBQb3NpdGlvbiBjbG9zaW5nIHJlc3VsdFxuICAgKi9cbiAgYXN5bmMgY2xvc2VQb3NpdGlvbihwYXJhbXM6IHtcbiAgICBtYXJrZXQ6IHN0cmluZztcbiAgICBwb3NpdGlvbl9pZD86IHN0cmluZztcbiAgICBzaXplPzogbnVtYmVyO1xuICAgIHByaWNlPzogbnVtYmVyO1xuICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdCgnL2FwaS90cmFkaW5nL3NlbGwtcG9zaXRpb24nLCBwYXJhbXMpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Bvc2l0aW9uIGNsb3NpbmcgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdGYWlsZWQgdG8gY2xvc2UgcG9zaXRpb24nXG4gICAgICApO1xuICAgIH1cbiAgfSxcbiAgXG4gIC8qKlxuICAgKiBTZWxsIGEgc3BvdCB0b2tlbiBmb3IgYW5vdGhlciB0b2tlbiAodXN1YWxseSBVU0RDKVxuICAgKiBAcGFyYW0gcGFyYW1zIFRva2VuIHNlbGxpbmcgcGFyYW1ldGVyc1xuICAgKiBAcmV0dXJucyBUb2tlbiBzZWxsaW5nIHJlc3VsdFxuICAgKi9cbiAgYXN5bmMgc2VsbFRva2VuKHBhcmFtczoge1xuICAgIHRva2VuOiBzdHJpbmc7XG4gICAgYW1vdW50OiBudW1iZXIgfCBzdHJpbmc7XG4gICAgdGFyZ2V0X3Rva2VuPzogc3RyaW5nO1xuICAgIHByaWNlPzogbnVtYmVyO1xuICB9KTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdCgnL2FwaS90cmFkaW5nL3NlbGwtdG9rZW4nLCB7XG4gICAgICAgIC4uLnBhcmFtcyxcbiAgICAgICAgYW1vdW50OiBwYXJhbXMuYW1vdW50LnRvU3RyaW5nKClcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1Rva2VuIHNlbGxpbmcgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgZXJyb3IucmVzcG9uc2U/LmRhdGE/LmVycm9yIHx8ICdGYWlsZWQgdG8gc2VsbCB0b2tlbidcbiAgICAgICk7XG4gICAgfVxuICB9LFxuICBcbiAgLyoqXG4gICAqIFNlbGwgb3IgY2xvc2UgYSBwb3NpdGlvbiAoZnVsbCBvciBwYXJ0aWFsKVxuICAgKiBAcGFyYW0gcGFyYW1zIFBvc2l0aW9uIHNlbGxpbmcgcGFyYW1ldGVyc1xuICAgKiBAcmV0dXJucyBSZXN1bHQgb2YgdGhlIHBvc2l0aW9uIHNhbGVcbiAgICovXG4gIGFzeW5jIHNlbGxQb3NpdGlvbihwYXJhbXM6IHtcbiAgICBwb3NpdGlvbklkOiBzdHJpbmc7XG4gICAgdG9rZW46IHN0cmluZztcbiAgICBhbW91bnQ6IG51bWJlcjtcbiAgICB0eXBlOiAnc3BvdCcgfCAnbGV2ZXJhZ2UnO1xuICAgIHBlcmNlbnRhZ2U/OiBudW1iZXI7IC8vIE9wdGlvbmFsOiBwZXJjZW50YWdlIG9mIHBvc2l0aW9uIHRvIGNsb3NlICgwLTEwMClcbiAgfSk6IFByb21pc2U8e3N1Y2Nlc3M6IGJvb2xlYW47IG1lc3NhZ2U/OiBzdHJpbmc7IGVycm9yPzogc3RyaW5nfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXF1ZXN0RGF0YSA9IHsuLi5wYXJhbXN9O1xuICAgICAgXG4gICAgICAvLyBJZiBwZXJjZW50YWdlIGlzIHByb3ZpZGVkLCBhZGp1c3QgdGhlIGFtb3VudCBhY2NvcmRpbmdseVxuICAgICAgaWYgKHBhcmFtcy5wZXJjZW50YWdlICYmIHBhcmFtcy5wZXJjZW50YWdlID4gMCAmJiBwYXJhbXMucGVyY2VudGFnZSA8IDEwMCkge1xuICAgICAgICByZXF1ZXN0RGF0YS5hbW91bnQgPSAocGFyYW1zLmFtb3VudCAqIHBhcmFtcy5wZXJjZW50YWdlIC8gMTAwKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdChBUElfRU5EUE9JTlRTLlRSQURJTkcuU0VMTF9QT1NJVElPTiwgcmVxdWVzdERhdGEpO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjbG9zZSBwb3NpdGlvbjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGVycm9yLnJlc3BvbnNlPy5kYXRhPy5lcnJvciB8fCAnRmFpbGVkIHRvIGNsb3NlIHBvc2l0aW9uJ1xuICAgICAgKTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldCB1c2VyJ3MgbGV2ZXJhZ2UgcG9zaXRpb25zIGZyb20gTWFuZ28gVjNcbiAgICogQHJldHVybnMgVXNlcidzIGxldmVyYWdlIHBvc2l0aW9ucyB3aXRoIHN1Y2Nlc3MvZXJyb3Igc3RhdHVzXG4gICAqL1xuICBhc3luYyBnZXRVc2VyTGV2ZXJhZ2VQb3NpdGlvbnMoKTogUHJvbWlzZTxVc2VyUG9zaXRpb25zUmVzcG9uc2U+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZ2V0PFVzZXJQb3NpdGlvbnNSZXNwb25zZSB8IGFueVtdPihBUElfRU5EUE9JTlRTLlVTRVIuTEVWRVJBR0VfUE9TSVRJT05TKTtcbiAgICAgIFxuICAgICAgLy8gSWYgcmVzcG9uc2UgYWxyZWFkeSBoYXMgdGhlIHJpZ2h0IGZvcm1hdCwgcmV0dXJuIGl0IGRpcmVjdGx5XG4gICAgICBpZiAocmVzcG9uc2UuZGF0YSAmJiB0eXBlb2YgcmVzcG9uc2UuZGF0YSA9PT0gJ29iamVjdCcgJiYgJ3N1Y2Nlc3MnIGluIHJlc3BvbnNlLmRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEgYXMgVXNlclBvc2l0aW9uc1Jlc3BvbnNlO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBPdGhlcndpc2UgZm9ybWF0IGFjY29yZGluZyB0byBNYW5nbyBWMyBzcGVjXG4gICAgICBjb25zdCBwb3NpdGlvbnMgPSBBcnJheS5pc0FycmF5KHJlc3BvbnNlLmRhdGEpID8gcmVzcG9uc2UuZGF0YSA6IFtdO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgcG9zaXRpb25zLFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHRvdGFsX3Bvc2l0aW9uczogcG9zaXRpb25zLmxlbmd0aCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBsZXZlcmFnZSBwb3NpdGlvbnM6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIHBvc2l0aW9uczogW10sXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGZldGNoIGxldmVyYWdlIHBvc2l0aW9ucycsXG4gICAgICAgICAgY29kZTogJ1BPU0lUSU9OX0ZFVENIX0VSUk9SJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogR2V0IHVzZXIncyBzcG90IHBvc2l0aW9ucyBmcm9tIHdhbGxldCBiYWxhbmNlc1xuICAgKiBAcmV0dXJucyBVc2VyJ3Mgc3BvdCBwb3NpdGlvbnMgd2l0aCBzdWNjZXNzL2Vycm9yIHN0YXR1c1xuICAgKi9cbiAgYXN5bmMgZ2V0VXNlclNwb3RQb3NpdGlvbnMoKTogUHJvbWlzZTxVc2VyUG9zaXRpb25zUmVzcG9uc2U+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkuZ2V0PFVzZXJQb3NpdGlvbnNSZXNwb25zZSB8IGFueVtdPihBUElfRU5EUE9JTlRTLlVTRVIuU1BPVF9QT1NJVElPTlMpO1xuICAgICAgXG4gICAgICAvLyBJZiByZXNwb25zZSBhbHJlYWR5IGhhcyB0aGUgcmlnaHQgZm9ybWF0LCByZXR1cm4gaXQgZGlyZWN0bHlcbiAgICAgIGlmIChyZXNwb25zZS5kYXRhICYmIHR5cGVvZiByZXNwb25zZS5kYXRhID09PSAnb2JqZWN0JyAmJiAnc3VjY2VzcycgaW4gcmVzcG9uc2UuZGF0YSkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YSBhcyBVc2VyUG9zaXRpb25zUmVzcG9uc2U7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIE90aGVyd2lzZSBmb3JtYXQgYWNjb3JkaW5nIHRvIE1hbmdvIFYzIHNwZWNcbiAgICAgIGNvbnN0IHBvc2l0aW9ucyA9IEFycmF5LmlzQXJyYXkocmVzcG9uc2UuZGF0YSkgPyByZXNwb25zZS5kYXRhIDogW107XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBwb3NpdGlvbnMsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdG90YWxfcG9zaXRpb25zOiBwb3NpdGlvbnMubGVuZ3RoLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHNwb3QgcG9zaXRpb25zOicsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBwb3NpdGlvbnM6IFtdLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBmZXRjaCBzcG90IHBvc2l0aW9ucycsXG4gICAgICAgICAgY29kZTogJ1BPU0lUSU9OX0ZFVENIX0VSUk9SJ1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogR2V0IHBvc2l0aW9uIGhpc3RvcnkgZm9yIGEgdXNlciB3aXRoIHBhZ2luYXRpb24gYW5kIGZpbHRlcmluZ1xuICAgKiBAcGFyYW0gcGFyYW1zIFF1ZXJ5IHBhcmFtZXRlcnMgZm9yIGZpbHRlcmluZyBwb3NpdGlvbiBoaXN0b3J5XG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2l0aCBwb3NpdGlvbiBoaXN0b3J5IGRhdGFcbiAgICovXG4gIGdldFBvc2l0aW9uSGlzdG9yeTogYXN5bmMgKHBhcmFtcz86IHtcbiAgICBtYXJrZXQ/OiBzdHJpbmc7XG4gICAgc3RhcnRUaW1lPzogc3RyaW5nIHwgbnVtYmVyO1xuICAgIGVuZFRpbWU/OiBzdHJpbmcgfCBudW1iZXI7XG4gICAgaW50ZXJ2YWw/OiBzdHJpbmc7XG4gICAgaW5jbHVkZVBubD86IGJvb2xlYW47XG4gICAgaW5jbHVkZUxpdmVQbmw/OiBib29sZWFuO1xuICAgIGN1cnNvcj86IHN0cmluZztcbiAgICBsaW1pdD86IG51bWJlcjtcbiAgfSk6IFByb21pc2U8UG9zaXRpb25IaXN0b3J5UmVzcG9uc2U+ID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQnVpbGQgcXVlcnkgcGFyYW1ldGVyc1xuICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG4gICAgICBcbiAgICAgIGlmIChwYXJhbXM/Lm1hcmtldCkgcXVlcnlQYXJhbXMuYXBwZW5kKCdtYXJrZXQnLCBwYXJhbXMubWFya2V0KTtcbiAgICAgIGlmIChwYXJhbXM/LnN0YXJ0VGltZSkgcXVlcnlQYXJhbXMuYXBwZW5kKCdzdGFydF90aW1lJywgU3RyaW5nKHBhcmFtcy5zdGFydFRpbWUpKTtcbiAgICAgIGlmIChwYXJhbXM/LmVuZFRpbWUpIHF1ZXJ5UGFyYW1zLmFwcGVuZCgnZW5kX3RpbWUnLCBTdHJpbmcocGFyYW1zLmVuZFRpbWUpKTtcbiAgICAgIGlmIChwYXJhbXM/LmludGVydmFsKSBxdWVyeVBhcmFtcy5hcHBlbmQoJ2ludGVydmFsJywgcGFyYW1zLmludGVydmFsKTtcbiAgICAgIGlmIChwYXJhbXM/LmluY2x1ZGVQbmwgIT09IHVuZGVmaW5lZCkgcXVlcnlQYXJhbXMuYXBwZW5kKCdpbmNsdWRlX3BubCcsIFN0cmluZyhwYXJhbXMuaW5jbHVkZVBubCkpO1xuICAgICAgaWYgKHBhcmFtcz8uaW5jbHVkZUxpdmVQbmwpIHF1ZXJ5UGFyYW1zLmFwcGVuZCgnaW5jbHVkZV9saXZlX3BubCcsICd0cnVlJyk7XG4gICAgICBpZiAocGFyYW1zPy5jdXJzb3IpIHF1ZXJ5UGFyYW1zLmFwcGVuZCgnY3Vyc29yJywgcGFyYW1zLmN1cnNvcik7XG4gICAgICBpZiAocGFyYW1zPy5saW1pdCkgcXVlcnlQYXJhbXMuYXBwZW5kKCdsaW1pdCcsIFN0cmluZyhwYXJhbXMubGltaXQpKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtBUElfRU5EUE9JTlRTLlVTRVIuUE9TSVRJT05fSElTVE9SWX0/JHtxdWVyeVBhcmFtcy50b1N0cmluZygpfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7Z2V0QXV0aFRva2VuKCl9YFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIFxuICAgICAgLy8gSGFuZGxlIGVycm9yIHJlc3BvbnNlc1xuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBkYXRhPy5lcnJvciB8fCB7fTtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIGVycm9yRGF0YS5tZXNzYWdlIHx8IGBIVFRQIGVycm9yISBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWAsXG4gICAgICAgICAgcmVzcG9uc2Uuc3RhdHVzLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGNvZGU6IGVycm9yRGF0YS5jb2RlIHx8ICdhcGlfZXJyb3InLFxuICAgICAgICAgICAgc3RhdHVzOiBlcnJvckRhdGEuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZXJyb3JEYXRhLnRpbWVzdGFtcCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICAuLi4oZXJyb3JEYXRhLmRldGFpbHMgJiYgeyBkZXRhaWxzOiBlcnJvckRhdGEuZGV0YWlscyB9KVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVHJhbnNmb3JtIHRoZSBzdWNjZXNzZnVsIHJlc3BvbnNlIHRvIG1hdGNoIHRoZSBQb3NpdGlvbkhpc3RvcnlSZXNwb25zZSB0eXBlXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBkYXRhLnN1Y2Nlc3MsXG4gICAgICAgIHBvc2l0aW9uX2hpc3Rvcnk6IGRhdGEucG9zaXRpb25faGlzdG9yeSB8fCBbXSxcbiAgICAgICAgcG5sX292ZXJfdGltZTogZGF0YS5wbmxfb3Zlcl90aW1lIHx8IFtdLFxuICAgICAgICBwYWdpbmF0aW9uOiBkYXRhLnBhZ2luYXRpb24gfHwge1xuICAgICAgICAgIGhhc19tb3JlOiBkYXRhLm1ldGFkYXRhPy5oYXNfbW9yZSB8fCBmYWxzZSxcbiAgICAgICAgICBuZXh0X2N1cnNvcjogZGF0YS5tZXRhZGF0YT8uY3Vyc29yLFxuICAgICAgICAgIGxpbWl0OiBwYXJhbXM/LmxpbWl0IHx8IDEwMCxcbiAgICAgICAgICB0b3RhbDogZGF0YS5tZXRhZGF0YT8udG90YWwgfHwgMFxuICAgICAgICB9LFxuICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgIHVzZXJfaWRlbnRpZmllcjogZGF0YS5tZXRhZGF0YT8udXNlcl9pZGVudGlmaWVyIHx8ICcnLFxuICAgICAgICAgIG1hcmtldDogcGFyYW1zPy5tYXJrZXQgfHwgJ2FsbCcsXG4gICAgICAgICAgc3RhcnRfdGltZTogZGF0YS5tZXRhZGF0YT8uc3RhcnRfdGltZSB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgZW5kX3RpbWU6IGRhdGEubWV0YWRhdGE/LmVuZF90aW1lIHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBpbnRlcnZhbDogcGFyYW1zPy5pbnRlcnZhbCB8fCAnMWQnLFxuICAgICAgICAgIHRvdGFsX3Bvc2l0aW9uczogZGF0YS5tZXRhZGF0YT8udG90YWwgfHwgMCxcbiAgICAgICAgICBoYXNfbW9yZTogZGF0YS5tZXRhZGF0YT8uaGFzX21vcmUgfHwgZmFsc2UsXG4gICAgICAgICAgY3Vyc29yOiBkYXRhLm1ldGFkYXRhPy5jdXJzb3JcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgcG9zaXRpb24gaGlzdG9yeTonLCBlcnJvcik7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBBcGlFcnJvciBpbnN0YW5jZXNcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEFwaUVycm9yKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgcG9zaXRpb25faGlzdG9yeTogW10sXG4gICAgICAgICAgcG5sX292ZXJfdGltZTogW10sXG4gICAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgICAgaGFzX21vcmU6IGZhbHNlLFxuICAgICAgICAgICAgbmV4dF9jdXJzb3I6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGxpbWl0OiBwYXJhbXM/LmxpbWl0IHx8IDEwMCxcbiAgICAgICAgICAgIHRvdGFsOiAwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRhZGF0YToge1xuICAgICAgICAgICAgdXNlcl9pZGVudGlmaWVyOiAnJyxcbiAgICAgICAgICAgIG1hcmtldDogcGFyYW1zPy5tYXJrZXQgfHwgJ2FsbCcsXG4gICAgICAgICAgICBzdGFydF90aW1lOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICBlbmRfdGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgaW50ZXJ2YWw6IHBhcmFtcz8uaW50ZXJ2YWwgfHwgJzFkJyxcbiAgICAgICAgICAgIHRvdGFsX3Bvc2l0aW9uczogMCxcbiAgICAgICAgICAgIGhhc19tb3JlOiBmYWxzZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgZXJyb3JfZGV0YWlsczogZXJyb3IuZGF0YVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBIYW5kbGUgb3RoZXIgdHlwZXMgb2YgZXJyb3JzXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgcG9zaXRpb25faGlzdG9yeTogW10sXG4gICAgICAgIHBubF9vdmVyX3RpbWU6IFtdLFxuICAgICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgICAgaGFzX21vcmU6IGZhbHNlLFxuICAgICAgICAgIG5leHRfY3Vyc29yOiB1bmRlZmluZWQsXG4gICAgICAgICAgbGltaXQ6IHBhcmFtcz8ubGltaXQgfHwgMTAwLFxuICAgICAgICAgIHRvdGFsOiAwXG4gICAgICAgIH0sXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgdXNlcl9pZGVudGlmaWVyOiAnJyxcbiAgICAgICAgICBtYXJrZXQ6IHBhcmFtcz8ubWFya2V0IHx8ICdhbGwnLFxuICAgICAgICAgIHN0YXJ0X3RpbWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICBlbmRfdGltZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIGludGVydmFsOiBwYXJhbXM/LmludGVydmFsIHx8ICcxZCcsXG4gICAgICAgICAgdG90YWxfcG9zaXRpb25zOiAwLFxuICAgICAgICAgIGhhc19tb3JlOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgIGVycm9yX2RldGFpbHM6IHtcbiAgICAgICAgICBjb2RlOiAndW5leHBlY3RlZF9lcnJvcicsXG4gICAgICAgICAgc3RhdHVzOiA1MDAsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldCBkZXRhaWxlZCBwb3NpdGlvbiBoaXN0b3J5IGZvciBhIHNwZWNpZmljIHBvc2l0aW9uXG4gICAqIEBwYXJhbSBwb3NpdGlvbklkIElEIG9mIHRoZSBwb3NpdGlvbiB0byBnZXQgaGlzdG9yeSBmb3JcbiAgICogQHBhcmFtIHBhcmFtcyBBZGRpdGlvbmFsIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICogQHJldHVybnMgUHJvbWlzZSB3aXRoIGRldGFpbGVkIHBvc2l0aW9uIGhpc3RvcnlcbiAgICovXG4gIGdldFBvc2l0aW9uRGV0YWlsczogYXN5bmMgKFxuICAgIHBvc2l0aW9uSWQ6IHN0cmluZyxcbiAgICBwYXJhbXM/OiB7XG4gICAgICBzdGFydFRpbWU/OiBzdHJpbmcgfCBudW1iZXI7XG4gICAgICBlbmRUaW1lPzogc3RyaW5nIHwgbnVtYmVyO1xuICAgICAgaW50ZXJ2YWw/OiBzdHJpbmc7XG4gICAgfVxuICApOiBQcm9taXNlPFBvc2l0aW9uSGlzdG9yeUVudHJ5PiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENvbnZlcnQgcGFyYW1zIHRvIHF1ZXJ5IHN0cmluZ1xuICAgICAgY29uc3QgcXVlcnlQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHsgcG9zaXRpb25JZCB9KTtcbiAgICAgIGlmIChwYXJhbXM/LnN0YXJ0VGltZSkgcXVlcnlQYXJhbXMuYXBwZW5kKCdzdGFydFRpbWUnLCBTdHJpbmcocGFyYW1zLnN0YXJ0VGltZSkpO1xuICAgICAgaWYgKHBhcmFtcz8uZW5kVGltZSkgcXVlcnlQYXJhbXMuYXBwZW5kKCdlbmRUaW1lJywgU3RyaW5nKHBhcmFtcy5lbmRUaW1lKSk7XG4gICAgICBpZiAocGFyYW1zPy5pbnRlcnZhbCkgcXVlcnlQYXJhbXMuYXBwZW5kKCdpbnRlcnZhbCcsIHBhcmFtcy5pbnRlcnZhbCk7XG5cbiAgICAgIGNvbnN0IGVuZHBvaW50ID0gYCR7QVBJX0VORFBPSU5UUy5VU0VSLlBPU0lUSU9OX0hJU1RPUll9L2RldGFpbHM/JHtxdWVyeVBhcmFtcy50b1N0cmluZygpfWA7XG4gICAgICAvLyBDcmVhdGUgaGVhZGVycyBvYmplY3Qgd2l0aCBwcm9wZXIgdHlwaW5nXG4gICAgICBjb25zdCBhdXRoSGVhZGVycyA9IGFkZEF1dGhIZWFkZXJzKCk7XG4gICAgICBjb25zdCBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcbiAgICAgIGhlYWRlcnMuYXBwZW5kKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgXG4gICAgICAvLyBBZGQgYXV0aCBoZWFkZXJzIGlmIHRoZXkgZXhpc3RcbiAgICAgIGlmIChhdXRoSGVhZGVycykge1xuICAgICAgICBPYmplY3QuZW50cmllcyhhdXRoSGVhZGVycykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgaWYgKHZhbHVlKSBoZWFkZXJzLmFwcGVuZChrZXksIHZhbHVlKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmdldDx7IHN1Y2Nlc3M6IGJvb2xlYW47IGRhdGE6IFBvc2l0aW9uSGlzdG9yeUVudHJ5IH0+KGVuZHBvaW50LCB7IGhlYWRlcnMgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzcG9uc2UuZXJyb3IgfHwgJ0ZhaWxlZCB0byBmZXRjaCBwb3NpdGlvbiBkZXRhaWxzJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiAocmVzcG9uc2UuZGF0YSBhcyBhbnkpLmRhdGE7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHBvc2l0aW9uIGRldGFpbHM6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBhcGk7XG4iXSwibmFtZXMiOlsiQVBJX0JBU0VfVVJMIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0FQSV9VUkwiLCJyZXNvbHZlQmFzZVVybCIsImVudlVybCIsInRyaW0iLCJlbmRzV2l0aCIsInNsaWNlIiwiQVVUSF9UT0tFTl9LRVkiLCJBTFRfVE9LRU5fS0VZIiwiZ2V0QXV0aFRva2VuIiwic2Vzc2lvblN0b3JhZ2UiLCJnZXRJdGVtIiwibG9jYWxTdG9yYWdlIiwic2F2ZUF1dGhUb2tlbiIsInRva2VuIiwic2V0SXRlbSIsInJlbW92ZUF1dGhUb2tlbiIsInJlbW92ZUl0ZW0iLCJhZGRBdXRoSGVhZGVycyIsIm9wdGlvbnMiLCJoZWFkZXJzIiwiQXBpRXJyb3IiLCJFcnJvciIsInN0YXR1c0NvZGUiLCJkYXRhIiwibWVzc2FnZSIsIm5hbWUiLCJnZXRCYXNlVXJsIiwiYmFzZSIsIkFQSV9FTkRQT0lOVFMiLCJBVVRIIiwiTE9HSU4iLCJSRUdJU1RFUiIsIlZFUklGWV9UT0tFTiIsIkxPR09VVCIsIlJFRlJFU0hfVE9LRU4iLCJGT1JHT1RfUEFTU1dPUkQiLCJSRVNFVF9QQVNTV09SRCIsIlVTRVIiLCJQUk9GSUxFIiwiTEVWRVJBR0VfUE9TSVRJT05TIiwiU1BPVF9QT1NJVElPTlMiLCJQT1NJVElPTl9ISVNUT1JZIiwiVFJBREVfSElTVE9SWSIsIkxJTUlUX09SREVSUyIsIldBTExFVCIsIkRBVEEiLCJJTkZPIiwiTUFOR09fQkFMQU5DRSIsIkdFTkVSQVRFIiwiU0VORCIsIkNPTk5FQ1RfUEhBTlRPTSIsIkNPTVBMRVRFX1BIQU5UT00iLCJESVNDT05ORUNUX1BIQU5UT00iLCJCQUxBTkNFIiwiVFJBTlNBQ1RJT05TIiwiQ0hBVCIsIlNFU1NJT05TIiwiTkVXX1NFU1NJT04iLCJISVNUT1JZIiwic2Vzc2lvbklkIiwiTUVTU0FHRSIsIlNPQ0lBTCIsIlNFTlRJTUVOVCIsIlRSRU5ESU5HIiwiSU5GTFVFTlRJQUwiLCJUV0VFVFMiLCJNQU5HTyIsIkJBU0UiLCJPSExDViIsIk1BUktFVFMiLCJPUkRFUl9CT09LIiwiVFJBREVTIiwiTUFSS0VUX1NUQVRTIiwiQ09NTVVOSVRJRVMiLCJFTlRJVElFUyIsIkZFRUQiLCJDT05ORUNUSU9OUyIsIlRSQURJTkciLCJFWEVDVVRFIiwiQ09ORklSTSIsIlNNQVJUX1NFVFRJTkdTIiwiVE9LRU5TIiwiUFJJQ0VfQ0hBUlQiLCJTV0FQIiwiU0VMTF9QT1NJVElPTiIsIlVTRVJfUE9TSVRJT05TIiwiU0VUVElOR1MiLCJOT1RJRklDQVRJT05TIiwiVFJBRElOR19TRVRUSU5HUyIsIm5vcm1hbGl6ZVJlc3BvbnNlIiwicmVzcG9uc2VEYXRhIiwicmVzdCIsInN1Y2Nlc3MiLCJyZXN1bHRzIiwidW5kZWZpbmVkIiwicHJvY2Vzc1Jlc3BvbnNlIiwicmVzcG9uc2UiLCJyZXNwb25zZUNsb25lIiwiY2xvbmUiLCJib2R5VGV4dCIsInRleHQiLCJKU09OIiwicGFyc2UiLCJlIiwib2siLCJlcnJvciIsInN0YXR1cyIsInJhd1Jlc3BvbnNlIiwiY29uc29sZSIsImFwaVJlcXVlc3QiLCJlbmRwb2ludCIsImJhc2VVcmwiLCJ1cmwiLCJzdGFydHNXaXRoIiwibG9nIiwicmVxdWVzdE9wdGlvbnMiLCJjcmVkZW50aWFscyIsImZldGNoIiwic3RhdHVzVGV4dCIsImFwaSIsImdldCIsIm1ldGhvZCIsInBvc3QiLCJib2R5Iiwic3RyaW5naWZ5IiwicHV0IiwiZGVsZXRlIiwiQ2hhdEFwaSIsImdldFNlc3Npb25zIiwibGltaXQiLCJvZmZzZXQiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJhcHBlbmQiLCJ0b1N0cmluZyIsInF1ZXJ5Iiwic2Vzc2lvbnMiLCJ0b3RhbCIsImhhc19tb3JlIiwiZXJyb3JNZXNzYWdlIiwidXNpbmdGYWxsYmFjayIsInVzaW5nX2ZhbGxiYWNrIiwiY3JlYXRlU2Vzc2lvbiIsInRpdGxlIiwic2Vzc2lvbl9pZCIsImdldEhpc3RvcnkiLCJtZXNzYWdlcyIsInNlbmRNZXNzYWdlIiwibWV0YWRhdGEiLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJtZXNzYWdlX2lkIiwibm93IiwiVHJhZGluZ0FwaSIsImV4ZWN1dGVUcmFkZSIsImFtb3VudCIsImNvbmZpcm1UcmFkZSIsImNvbmZpcm1hdGlvbklkIiwiY29uZmlybWF0aW9uX2lkIiwiY2xvc2VQb3NpdGlvbiIsInNlbGxUb2tlbiIsInNlbGxQb3NpdGlvbiIsInJlcXVlc3REYXRhIiwicGVyY2VudGFnZSIsImdldFVzZXJMZXZlcmFnZVBvc2l0aW9ucyIsInBvc2l0aW9ucyIsIkFycmF5IiwiaXNBcnJheSIsInRvdGFsX3Bvc2l0aW9ucyIsImxlbmd0aCIsImNvZGUiLCJnZXRVc2VyU3BvdFBvc2l0aW9ucyIsImdldFBvc2l0aW9uSGlzdG9yeSIsInF1ZXJ5UGFyYW1zIiwibWFya2V0Iiwic3RhcnRUaW1lIiwiU3RyaW5nIiwiZW5kVGltZSIsImludGVydmFsIiwiaW5jbHVkZVBubCIsImluY2x1ZGVMaXZlUG5sIiwiY3Vyc29yIiwianNvbiIsImVycm9yRGF0YSIsImRldGFpbHMiLCJwb3NpdGlvbl9oaXN0b3J5IiwicG5sX292ZXJfdGltZSIsInBhZ2luYXRpb24iLCJuZXh0X2N1cnNvciIsInVzZXJfaWRlbnRpZmllciIsInN0YXJ0X3RpbWUiLCJlbmRfdGltZSIsImVycm9yX2RldGFpbHMiLCJnZXRQb3NpdGlvbkRldGFpbHMiLCJwb3NpdGlvbklkIiwiYXV0aEhlYWRlcnMiLCJIZWFkZXJzIiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWx1ZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./api/apiClient.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./components/AuthContext.tsx":
/*!************************************!*\
  !*** ./components/AuthContext.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuthProvider: () => (/* binding */ AuthProvider),\n/* harmony export */   useAuth: () => (/* binding */ useAuth)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _api_apiClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../api/apiClient */ \"(pages-dir-node)/./api/apiClient.ts\");\n/* harmony import */ var _utils_devAuth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/devAuth */ \"(pages-dir-node)/./utils/devAuth.ts\");\n/* harmony import */ var _utils_authUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/authUtils */ \"(pages-dir-node)/./utils/authUtils.ts\");\n// src/ui/components/AuthContext.tsx\n\n\n\n\n// Import admin backdoor utilities\n\n// Import standardized auth utils\n\nconst TOKEN_EXPIRY_KEY = 'grace_token_expiry';\nconst REFRESH_TOKEN_KEY = 'grace_refresh_token';\nconst TOKEN_VERIFY_INTERVAL = 60000; // Check token validity every 60 seconds\n// Improved session persistence utility to avoid conflicts with form state\nconst SessionPersistence = {\n    STORAGE_KEY: 'GRACE_SESSION_SNAPSHOT',\n    // Safely capture session snapshot with minimal data to avoid interference\n    captureSnapshot (user, token) {\n        try {\n            if (!user || !token) {\n                this.clearSnapshot();\n                return;\n            }\n            // Store only essential user identification data\n            // Avoid storing complete state that might conflict with forms\n            const snapshot = {\n                timestamp: Date.now(),\n                user: {\n                    id: user.id,\n                    username: user.username,\n                    email: user.email\n                },\n                // Don't store the actual token, just indicate authentication\n                authenticated: true\n            };\n            // Use sessionStorage instead of localStorage to avoid persisting between browser sessions\n            // This helps prevent stale data from affecting forms on future visits\n            sessionStorage.setItem(this.STORAGE_KEY, JSON.stringify(snapshot));\n        } catch (error) {\n            console.warn('Failed to capture session snapshot', error);\n        // Silently fail - don't let snapshot errors affect the application\n        }\n    },\n    // Retrieve session snapshot with validation\n    retrieveSnapshot () {\n        try {\n            const snapshotStr = sessionStorage.getItem(this.STORAGE_KEY);\n            if (!snapshotStr) return {\n                user: null,\n                token: null\n            };\n            const snapshot = JSON.parse(snapshotStr);\n            // Validate snapshot with expiration check (30 minutes)\n            const MAX_AGE = 30 * 60 * 1000; // 30 minutes in milliseconds\n            const isExpired = Date.now() - (snapshot.timestamp || 0) > MAX_AGE;\n            if (snapshot && snapshot.user && !isExpired) {\n                return {\n                    user: snapshot.user,\n                    // Get actual token from authUtils to ensure consistency\n                    token: (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)()\n                };\n            }\n            // Clear expired snapshot\n            if (isExpired) this.clearSnapshot();\n            return {\n                user: null,\n                token: null\n            };\n        } catch (error) {\n            console.warn('Failed to retrieve session snapshot', error);\n            this.clearSnapshot(); // Clear invalid snapshot\n            return {\n                user: null,\n                token: null\n            };\n        }\n    },\n    // Clear session snapshot\n    clearSnapshot () {\n        try {\n            sessionStorage.removeItem(this.STORAGE_KEY);\n        } catch (error) {\n            console.warn('Failed to clear session snapshot', error);\n        }\n    }\n};\nconst AuthContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(null);\nfunction AuthProvider({ children }) {\n    const [user, setUser] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [isAuthenticated, setIsAuthenticated] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Use state for token to ensure it's updated when changed\n    const [token, setToken] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)((0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)());\n    // Add flag to prevent verification immediately after login\n    const [skipNextVerification, setSkipNextVerification] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Update token state whenever auth state changes\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthProvider.useEffect\": ()=>{\n            setToken((0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)());\n        }\n    }[\"AuthProvider.useEffect\"], [\n        isAuthenticated\n    ]);\n    // Admin backdoor for quick access\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthProvider.useEffect\": ()=>{\n            // Check if we should use the admin backdoor\n            if ((0,_utils_devAuth__WEBPACK_IMPORTED_MODULE_3__.hasAdminBypass)() && !isAuthenticated && !token) {\n                (0,_utils_devAuth__WEBPACK_IMPORTED_MODULE_3__.bypassLogin)(login);\n            }\n        }\n    }[\"AuthProvider.useEffect\"], []);\n    // Verify auth tokens on mount and set interval\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthProvider.useEffect\": ()=>{\n            let isMounted = true;\n            const verifyOnMount = {\n                \"AuthProvider.useEffect.verifyOnMount\": async ()=>{\n                    // Skip initial verification if there's no token\n                    if (false) {}\n                    console.log('AuthContext: Verifying token on mount');\n                    // Verify token on component mount\n                    await verifyToken();\n                    // Handle case where verification completed but component was unmounted\n                    if (isMounted) setLoading(false);\n                }\n            }[\"AuthProvider.useEffect.verifyOnMount\"];\n            verifyOnMount();\n            // Set up periodic token verification\n            const interval = setInterval({\n                \"AuthProvider.useEffect.interval\": ()=>{\n                    if (!skipNextVerification) {\n                        verifyToken();\n                    } else {\n                        // Reset skip flag after using it once\n                        setSkipNextVerification(false);\n                    }\n                }\n            }[\"AuthProvider.useEffect.interval\"], TOKEN_VERIFY_INTERVAL);\n            return ({\n                \"AuthProvider.useEffect\": ()=>{\n                    isMounted = false;\n                    clearInterval(interval);\n                }\n            })[\"AuthProvider.useEffect\"];\n        }\n    }[\"AuthProvider.useEffect\"], []);\n    // Verify user token with backend\n    const verifyToken = async ()=>{\n        // If no token exists, there's nothing to verify\n        const token = (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)();\n        if (!token) {\n            console.log('AuthContext: No token to verify');\n            setIsAuthenticated(false);\n            setUser(null);\n            setLoading(false);\n            return false;\n        }\n        try {\n            console.log('AuthContext: Verifying token with backend');\n            setLoading(true);\n            const response = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].get(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.AUTH.VERIFY_TOKEN);\n            if (response.success && response.data) {\n                // Token is valid, update user data\n                console.log('AuthContext: Token verified successfully');\n                setIsAuthenticated(true);\n                setUser(response.data.user || {});\n                setToken(token); // Ensure token state matches storage\n                return true;\n            }\n            // Non-success HTTP response\n            const status = response.statusCode ?? 0;\n            if (status === 401 || status === 403) {\n                console.log('AuthContext: Token verification failed with unauthorized status:', status);\n                clearAuthState();\n                return false;\n            }\n            // For other errors (5xx, 0, etc.), keep current auth state to avoid flicker\n            console.warn('AuthContext: Verification non-success but not unauthorized. Preserving auth state.', {\n                status,\n                error: response.error\n            });\n            return false;\n        } catch (error) {\n            // Network or unexpected error: preserve current auth state\n            const msg = error instanceof Error ? error.message : 'Unknown error';\n            console.error('Token verification error, preserving auth state:', msg);\n            return false;\n        } finally{\n            setLoading(false);\n        }\n    };\n    // Enhanced logging utility for authentication events\n    const logAuthEvent = (eventType, details = {})=>{\n        const timestamp = new Date().toISOString();\n        const logEntry = {\n            timestamp,\n            eventType,\n            ...details\n        };\n        // Optional: Send to backend logging service or store locally\n        console.log(JSON.stringify(logEntry));\n        // Store in local storage for potential debugging\n        try {\n            const authLogs = JSON.parse(localStorage.getItem('auth_logs') || '[]');\n            authLogs.push(logEntry);\n            // Keep only last 50 log entries\n            localStorage.setItem('auth_logs', JSON.stringify(authLogs.slice(-50)));\n        } catch (e) {\n            console.error('Failed to log authentication event', e);\n        }\n    };\n    // Check if user has a wallet and generate one if not available\n    const checkAndGenerateWallet = async ()=>{\n        try {\n            // Skip if not authenticated\n            if (!isAuthenticated || !token) {\n                return;\n            }\n            // First check if wallet already exists\n            const walletResponse = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].get(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.WALLET.INFO, {});\n            // If no wallet or wallet address is empty, generate a new one\n            if (!walletResponse.success || !walletResponse.data?.wallet?.wallet_address) {\n                console.log('No wallet found for user, generating a new internal wallet...');\n                // Generate a new wallet\n                const generateResponse = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.WALLET.GENERATE, {});\n                if (generateResponse.success) {\n                    console.log('Wallet generated successfully:', generateResponse.data?.wallet?.wallet_address);\n                    // You could set wallet info in state here if needed\n                    return generateResponse.data?.wallet;\n                } else {\n                    console.error('Failed to generate wallet:', generateResponse.error);\n                }\n            } else {\n                console.log('User wallet already exists:', walletResponse.data?.wallet?.wallet_address);\n                return walletResponse.data?.wallet;\n            }\n        } catch (error) {\n            console.error('Error checking/generating wallet:', error instanceof Error ? error.message : 'Unknown error');\n        }\n    };\n    // Implement token refresh functionality with exponential backoff\n    const refreshToken = async (retryCount = 0)=>{\n        const MAX_RETRIES = 3;\n        const BASE_DELAY = 1000; // 1 second initial delay\n        try {\n            logAuthEvent('TOKEN_REFRESH_ATTEMPT', {\n                retryCount\n            });\n            // Exponential backoff with jitter\n            if (retryCount > 0) {\n                const delay = BASE_DELAY * Math.pow(2, retryCount) * (1 + Math.random());\n                await new Promise((resolve)=>setTimeout(resolve, delay));\n            }\n            // Use the dedicated refresh token endpoint\n            const response = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.AUTH.REFRESH_TOKEN, {});\n            if (!response.success || !response.data?.token) {\n                throw new Error('Token refresh failed: Invalid response');\n            }\n            const { token, username } = response.data;\n            // Determine storage type based on where the current token is stored\n            const inLocalStorage = localStorage.getItem(_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.TOKEN_KEY) !== null;\n            const rememberMe = inLocalStorage; // If in localStorage, user wanted persistent login\n            // Store the new token with the same preference\n            await (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.storeAuthToken)(token, rememberMe);\n            // Update local token state\n            setToken(token);\n            setIsAuthenticated(true);\n            // Optional: Update username if provided\n            if (username) {\n                setUser((prevUser)=>({\n                        ...prevUser,\n                        username\n                    }));\n            }\n            logAuthEvent('TOKEN_REFRESH_SUCCESS', {\n                username\n            });\n            return true;\n        } catch (error) {\n            const errorMessage = error instanceof Error ? error.message : 'Unknown refresh error';\n            logAuthEvent('TOKEN_REFRESH_FAILURE', {\n                errorMessage,\n                retryCount,\n                errorStack: error instanceof Error ? error.stack : undefined\n            });\n            // Implement retry mechanism\n            if (retryCount < MAX_RETRIES) {\n                console.warn(`Token refresh attempt ${retryCount + 1} failed. Retrying...`);\n                return refreshToken(retryCount + 1);\n            }\n            // Final fallback: logout after max retries\n            console.error('Token refresh failed after maximum retries');\n            logout();\n            return false;\n        }\n    };\n    // Login with credentials\n    const login = async (data)=>{\n        try {\n            console.log('AuthContext: login function called with data:', data);\n            // Some API clients save the token directly to storage and strip it from payload\n            // Fall back to reading from storage if not present on the response object\n            if (!data.token) {\n                const storedToken = (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)();\n                console.log('AuthContext: token missing in payload, using stored token:', !!storedToken);\n                if (storedToken) {\n                    data.token = storedToken;\n                } else {\n                    throw new Error('No token found in login data or storage');\n                }\n            }\n            console.log('AuthContext: Processing login with token');\n            // Store token with remember me preference if provided\n            const rememberMe = data.remember_me !== undefined ? data.remember_me : true; // Default to true for persistent login\n            // Store token and wait for it to complete\n            await (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.storeAuthToken)(data.token, rememberMe);\n            console.log('AuthContext: Token stored successfully');\n            // Update application state\n            setToken(data.token); // Ensure token state is synchronized\n            setUser(data.user || {});\n            setIsAuthenticated(true);\n            setLoading(false); // Ensure loading state is turned off\n            console.log('AuthContext: State updated - isAuthenticated: true, user:', data.user);\n            // Capture minimal session data after successful login\n            if (data.user) {\n                SessionPersistence.captureSnapshot(data.user, data.token);\n            }\n            // Set flag to skip next verification cycle to avoid race condition\n            setSkipNextVerification(true);\n            // Log successful login state update\n            console.log('AuthContext: Login complete, auth state updated');\n            // Automatically check for wallet and generate if needed\n            // This ensures every user has a wallet automatically\n            setTimeout(()=>{\n                checkAndGenerateWallet();\n            }, 500); // Small delay to ensure auth is fully established\n            return true; // Signal successful login\n        } catch (error) {\n            console.error('Login failed:', error instanceof Error ? error.message : 'Unknown error');\n            // Ensure auth state is reset if login fails\n            (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.clearAuthTokens)();\n            SessionPersistence.clearSnapshot();\n            setToken(null);\n            setUser(null);\n            setIsAuthenticated(false);\n            setLoading(false);\n            return false; // Signal failed login\n        }\n    };\n    // Clear auth state - reusable function for both logout and failed auth\n    const clearAuthState = ()=>{\n        (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.clearAuthTokens)();\n        setToken(null);\n        setUser(null);\n        setIsAuthenticated(false);\n        SessionPersistence.clearSnapshot();\n    };\n    // Clear auth state\n    const logout = async ()=>{\n        logAuthEvent('logout_initiated');\n        try {\n            // Attempt to call logout endpoint if we have a token\n            if ((0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)()) {\n                await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__[\"default\"].post(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.AUTH.LOGOUT, {});\n            }\n        } catch (error) {\n            console.error('Error during logout:', error);\n        // Continue with logout regardless of API errors\n        } finally{\n            // Always clear local state and storage\n            clearAuthState();\n            // Log the event\n            logAuthEvent('logout_complete');\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AuthContext.Provider, {\n        value: {\n            user,\n            login,\n            logout,\n            loading,\n            refreshToken,\n            isAuthenticated\n        },\n        children: children\n    }, void 0, false, {\n        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/AuthContext.tsx\",\n        lineNumber: 447,\n        columnNumber: 5\n    }, this);\n}\nconst useAuth = ()=>{\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(AuthContext);\n    if (!context) {\n        throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvQXV0aENvbnRleHQudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBLG9DQUFvQzs7QUFFMEM7QUFDN0I7QUFDZDtBQUNuQyxrQ0FBa0M7QUFDNkI7QUFDL0QsaUNBQWlDO0FBU0w7QUFFNUIsTUFBTWEsbUJBQW1CO0FBQ3pCLE1BQU1DLG9CQUFvQjtBQUMxQixNQUFNQyx3QkFBd0IsT0FBTyx3Q0FBd0M7QUFFN0UsMEVBQTBFO0FBQzFFLE1BQU1DLHFCQUFxQjtJQUN6QkMsYUFBYTtJQUViLDBFQUEwRTtJQUMxRUMsaUJBQWdCQyxJQUFpQixFQUFFQyxLQUFvQjtRQUNyRCxJQUFJO1lBQ0YsSUFBSSxDQUFDRCxRQUFRLENBQUNDLE9BQU87Z0JBQ25CLElBQUksQ0FBQ0MsYUFBYTtnQkFDbEI7WUFDRjtZQUVBLGdEQUFnRDtZQUNoRCw4REFBOEQ7WUFDOUQsTUFBTUMsV0FBVztnQkFDZkMsV0FBV0MsS0FBS0MsR0FBRztnQkFDbkJOLE1BQU07b0JBQ0pPLElBQUlQLEtBQUtPLEVBQUU7b0JBQ1hDLFVBQVVSLEtBQUtRLFFBQVE7b0JBQ3ZCQyxPQUFPVCxLQUFLUyxLQUFLO2dCQUNuQjtnQkFDQSw2REFBNkQ7Z0JBQzdEQyxlQUFlO1lBQ2pCO1lBRUEsMEZBQTBGO1lBQzFGLHNFQUFzRTtZQUN0RUMsZUFBZUMsT0FBTyxDQUFDLElBQUksQ0FBQ2QsV0FBVyxFQUFFZSxLQUFLQyxTQUFTLENBQUNYO1FBQzFELEVBQUUsT0FBT1ksT0FBTztZQUNkQyxRQUFRQyxJQUFJLENBQUMsc0NBQXNDRjtRQUNuRCxtRUFBbUU7UUFDckU7SUFDRjtJQUVBLDRDQUE0QztJQUM1Q0c7UUFDRSxJQUFJO1lBQ0YsTUFBTUMsY0FBY1IsZUFBZVMsT0FBTyxDQUFDLElBQUksQ0FBQ3RCLFdBQVc7WUFDM0QsSUFBSSxDQUFDcUIsYUFBYSxPQUFPO2dCQUFFbkIsTUFBTTtnQkFBTUMsT0FBTztZQUFLO1lBRW5ELE1BQU1FLFdB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TUFBTUgsMkRBQVEsQ0FBQ0QseURBQWFBLENBQUM0RCxJQUFJLENBQUNtRCxNQUFNLEVBQUUsQ0FBQztZQUM3QztRQUNGLEVBQUUsT0FBT2xGLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLHdCQUF3QkE7UUFDdEMsZ0RBQWdEO1FBQ2xELFNBQVU7WUFDUix1Q0FBdUM7WUFDdkNxQztZQUVBLGdCQUFnQjtZQUNoQkksYUFBYTtRQUNmO0lBQ0Y7SUFFQSxxQkFDRSw4REFBQy9CLFlBQVl5RSxRQUFRO1FBQUNDLE9BQU87WUFDM0JuRztZQUNBb0M7WUFDQTBEO1lBQ0FqRTtZQUNBOEM7WUFDQTVDO1FBQ0Y7a0JBQ0dKOzs7Ozs7QUFHUDtBQUVPLE1BQU15RSxVQUFVO0lBQ3JCLE1BQU1DLFVBQVV0SCxpREFBVUEsQ0FBQzBDO0lBQzNCLElBQUksQ0FBQzRFLFNBQVM7UUFDWixNQUFNLElBQUkvQyxNQUFNO0lBQ2xCO0lBQ0EsT0FBTytDO0FBQ1QsRUFBRSIsInNvdXJjZXMiOlsiL1VzZXJzL3dvbmthc3dvcmxkL0Rvd25sb2Fkcy9ncmFjZS1wcm9qZWN0L3NyYy91aS9jb21wb25lbnRzL0F1dGhDb250ZXh0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvdWkvY29tcG9uZW50cy9BdXRoQ29udGV4dC50c3hcblxuaW1wb3J0IFJlYWN0LCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBBUElfRU5EUE9JTlRTIH0gZnJvbSAnLi4vYXBpL2FwaUNsaWVudCc7XG5pbXBvcnQgYXBpIGZyb20gJy4uL2FwaS9hcGlDbGllbnQnO1xuLy8gSW1wb3J0IGFkbWluIGJhY2tkb29yIHV0aWxpdGllc1xuaW1wb3J0IHsgaGFzQWRtaW5CeXBhc3MsIGJ5cGFzc0xvZ2luIH0gZnJvbSAnLi4vdXRpbHMvZGV2QXV0aCc7XG4vLyBJbXBvcnQgc3RhbmRhcmRpemVkIGF1dGggdXRpbHNcbmltcG9ydCB7XG4gIGdldEF1dGhUb2tlbixcbiAgZ2V0VG9rZW5FeHBpcnksXG4gIHN0b3JlQXV0aFRva2VuLFxuICBjbGVhckF1dGhUb2tlbnMsXG4gIGlzVG9rZW5FeHBpcmVkLFxuICBhZGRBdXRoSGVhZGVycyxcbiAgVE9LRU5fS0VZXG59IGZyb20gJy4uL3V0aWxzL2F1dGhVdGlscyc7XG5cbmNvbnN0IFRPS0VOX0VYUElSWV9LRVkgPSAnZ3JhY2VfdG9rZW5fZXhwaXJ5JztcbmNvbnN0IFJFRlJFU0hfVE9LRU5fS0VZID0gJ2dyYWNlX3JlZnJlc2hfdG9rZW4nO1xuY29uc3QgVE9LRU5fVkVSSUZZX0lOVEVSVkFMID0gNjAwMDA7IC8vIENoZWNrIHRva2VuIHZhbGlkaXR5IGV2ZXJ5IDYwIHNlY29uZHNcblxuLy8gSW1wcm92ZWQgc2Vzc2lvbiBwZXJzaXN0ZW5jZSB1dGlsaXR5IHRvIGF2b2lkIGNvbmZsaWN0cyB3aXRoIGZvcm0gc3RhdGVcbmNvbnN0IFNlc3Npb25QZXJzaXN0ZW5jZSA9IHtcbiAgU1RPUkFHRV9LRVk6ICdHUkFDRV9TRVNTSU9OX1NOQVBTSE9UJyxcbiAgXG4gIC8vIFNhZmVseSBjYXB0dXJlIHNlc3Npb24gc25hcHNob3Qgd2l0aCBtaW5pbWFsIGRhdGEgdG8gYXZvaWQgaW50ZXJmZXJlbmNlXG4gIGNhcHR1cmVTbmFwc2hvdCh1c2VyOiBVc2VyIHwgbnVsbCwgdG9rZW46IHN0cmluZyB8IG51bGwpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCF1c2VyIHx8ICF0b2tlbikge1xuICAgICAgICB0aGlzLmNsZWFyU25hcHNob3QoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBTdG9yZSBvbmx5IGVzc2VudGlhbCB1c2VyIGlkZW50aWZpY2F0aW9uIGRhdGFcbiAgICAgIC8vIEF2b2lkIHN0b3JpbmcgY29tcGxldGUgc3RhdGUgdGhhdCBtaWdodCBjb25mbGljdCB3aXRoIGZvcm1zXG4gICAgICBjb25zdCBzbmFwc2hvdCA9IHtcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWxcbiAgICAgICAgfSxcbiAgICAgICAgLy8gRG9uJ3Qgc3RvcmUgdGhlIGFjdHVhbCB0b2tlbiwganVzdCBpbmRpY2F0ZSBhdXRoZW50aWNhdGlvblxuICAgICAgICBhdXRoZW50aWNhdGVkOiB0cnVlXG4gICAgICB9O1xuXG4gICAgICAvLyBVc2Ugc2Vzc2lvblN0b3JhZ2UgaW5zdGVhZCBvZiBsb2NhbFN0b3JhZ2UgdG8gYXZvaWQgcGVyc2lzdGluZyBiZXR3ZWVuIGJyb3dzZXIgc2Vzc2lvbnNcbiAgICAgIC8vIFRoaXMgaGVscHMgcHJldmVudCBzdGFsZSBkYXRhIGZyb20gYWZmZWN0aW5nIGZvcm1zIG9uIGZ1dHVyZSB2aXNpdHNcbiAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0odGhpcy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoc25hcHNob3QpKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY2FwdHVyZSBzZXNzaW9uIHNuYXBzaG90JywgZXJyb3IpO1xuICAgICAgLy8gU2lsZW50bHkgZmFpbCAtIGRvbid0IGxldCBzbmFwc2hvdCBlcnJvcnMgYWZmZWN0IHRoZSBhcHBsaWNhdGlvblxuICAgIH1cbiAgfSxcblxuICAvLyBSZXRyaWV2ZSBzZXNzaW9uIHNuYXBzaG90IHdpdGggdmFsaWRhdGlvblxuICByZXRyaWV2ZVNuYXBzaG90KCk6IHsgdXNlcjogVXNlciB8IG51bGwsIHRva2VuOiBzdHJpbmcgfCBudWxsIH0ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzbmFwc2hvdFN0ciA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0odGhpcy5TVE9SQUdFX0tFWSk7XG4gICAgICBpZiAoIXNuYXBzaG90U3RyKSByZXR1cm4geyB1c2VyOiBudWxsLCB0b2tlbjogbnVsbCB9O1xuXG4gICAgICBjb25zdCBzbmFwc2hvdCA9IEpTT04ucGFyc2Uoc25hcHNob3RTdHIpO1xuICAgICAgXG4gICAgICAvLyBWYWxpZGF0ZSBzbmFwc2hvdCB3aXRoIGV4cGlyYXRpb24gY2hlY2sgKDMwIG1pbnV0ZXMpXG4gICAgICBjb25zdCBNQVhfQUdFID0gMzAgKiA2MCAqIDEwMDA7IC8vIDMwIG1pbnV0ZXMgaW4gbWlsbGlzZWNvbmRzXG4gICAgICBjb25zdCBpc0V4cGlyZWQgPSAoRGF0ZS5ub3coKSAtIChzbmFwc2hvdC50aW1lc3RhbXAgfHwgMCkpID4gTUFYX0FHRTtcbiAgICAgIFxuICAgICAgaWYgKHNuYXBzaG90ICYmIHNuYXBzaG90LnVzZXIgJiYgIWlzRXhwaXJlZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHVzZXI6IHNuYXBzaG90LnVzZXIsXG4gICAgICAgICAgLy8gR2V0IGFjdHVhbCB0b2tlbiBmcm9tIGF1dGhVdGlscyB0byBlbnN1cmUgY29uc2lzdGVuY3lcbiAgICAgICAgICB0b2tlbjogZ2V0QXV0aFRva2VuKClcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2xlYXIgZXhwaXJlZCBzbmFwc2hvdFxuICAgICAgaWYgKGlzRXhwaXJlZCkgdGhpcy5jbGVhclNuYXBzaG90KCk7XG4gICAgICByZXR1cm4geyB1c2VyOiBudWxsLCB0b2tlbjogbnVsbCB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byByZXRyaWV2ZSBzZXNzaW9uIHNuYXBzaG90JywgZXJyb3IpO1xuICAgICAgdGhpcy5jbGVhclNuYXBzaG90KCk7IC8vIENsZWFyIGludmFsaWQgc25hcHNob3RcbiAgICAgIHJldHVybiB7IHVzZXI6IG51bGwsIHRva2VuOiBudWxsIH07XG4gICAgfVxuICB9LFxuXG4gIC8vIENsZWFyIHNlc3Npb24gc25hcHNob3RcbiAgY2xlYXJTbmFwc2hvdCgpIHtcbiAgICB0cnkge1xuICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSh0aGlzLlNUT1JBR0VfS0VZKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gY2xlYXIgc2Vzc2lvbiBzbmFwc2hvdCcsIGVycm9yKTtcbiAgICB9XG4gIH1cbn07XG5cbmludGVyZmFjZSBVc2VyIHtcbiAgaWQ/OiBzdHJpbmc7XG4gIHVzZXJuYW1lPzogc3RyaW5nO1xuICBlbWFpbD86IHN0cmluZztcbiAgW2tleTogc3RyaW5nXTogYW55O1xufVxuXG5pbnRlcmZhY2UgQXV0aENvbnRleHRUeXBlIHtcbiAgdXNlcjogVXNlciB8IG51bGw7XG4gIGxvZ2luOiAoZGF0YTogYW55KSA9PiBQcm9taXNlPGJvb2xlYW4+O1xuICBsb2dvdXQ6ICgpID0+IHZvaWQ7XG4gIGxvYWRpbmc6IGJvb2xlYW47XG4gIHJlZnJlc2hUb2tlbjogKCkgPT4gUHJvbWlzZTxib29sZWFuPjtcbiAgaXNBdXRoZW50aWNhdGVkOiBib29sZWFuO1xufVxuXG5jb25zdCBBdXRoQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQ8QXV0aENvbnRleHRUeXBlIHwgbnVsbD4obnVsbCk7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIEF1dGhQcm92aWRlcih7IGNoaWxkcmVuIH06IHsgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZSB9KSB7XG4gIGNvbnN0IFt1c2VyLCBzZXRVc2VyXSA9IHVzZVN0YXRlPFVzZXIgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4odHJ1ZSk7XG4gIGNvbnN0IFtpc0F1dGhlbnRpY2F0ZWQsIHNldElzQXV0aGVudGljYXRlZF0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG4gIC8vIFVzZSBzdGF0ZSBmb3IgdG9rZW4gdG8gZW5zdXJlIGl0J3MgdXBkYXRlZCB3aGVuIGNoYW5nZWRcbiAgY29uc3QgW3Rva2VuLCBzZXRUb2tlbl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihnZXRBdXRoVG9rZW4oKSk7XG4gIC8vIEFkZCBmbGFnIHRvIHByZXZlbnQgdmVyaWZpY2F0aW9uIGltbWVkaWF0ZWx5IGFmdGVyIGxvZ2luXG4gIGNvbnN0IFtza2lwTmV4dFZlcmlmaWNhdGlvbiwgc2V0U2tpcE5leHRWZXJpZmljYXRpb25dID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuICBcbiAgLy8gVXBkYXRlIHRva2VuIHN0YXRlIHdoZW5ldmVyIGF1dGggc3RhdGUgY2hhbmdlc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHNldFRva2VuKGdldEF1dGhUb2tlbigpKTtcbiAgfSwgW2lzQXV0aGVudGljYXRlZF0pO1xuICBcbiAgLy8gQWRtaW4gYmFja2Rvb3IgZm9yIHF1aWNrIGFjY2Vzc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIENoZWNrIGlmIHdlIHNob3VsZCB1c2UgdGhlIGFkbWluIGJhY2tkb29yXG4gICAgaWYgKGhhc0FkbWluQnlwYXNzKCkgJiYgIWlzQXV0aGVudGljYXRlZCAmJiAhdG9rZW4pIHtcbiAgICAgIGJ5cGFzc0xvZ2luKGxvZ2luKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICAvLyBWZXJpZnkgYXV0aCB0b2tlbnMgb24gbW91bnQgYW5kIHNldCBpbnRlcnZhbFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxldCBpc01vdW50ZWQgPSB0cnVlO1xuICAgIFxuICAgIGNvbnN0IHZlcmlmeU9uTW91bnQgPSBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBTa2lwIGluaXRpYWwgdmVyaWZpY2F0aW9uIGlmIHRoZXJlJ3Mgbm8gdG9rZW5cbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiAhZ2V0QXV0aFRva2VuKCkpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0F1dGhDb250ZXh0OiBObyB0b2tlbiBmb3VuZCBvbiBtb3VudCwgc2tpcHBpbmcgdmVyaWZpY2F0aW9uJyk7XG4gICAgICAgIGlmIChpc01vdW50ZWQpIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogVmVyaWZ5aW5nIHRva2VuIG9uIG1vdW50Jyk7XG4gICAgICAvLyBWZXJpZnkgdG9rZW4gb24gY29tcG9uZW50IG1vdW50XG4gICAgICBhd2FpdCB2ZXJpZnlUb2tlbigpO1xuICAgICAgXG4gICAgICAvLyBIYW5kbGUgY2FzZSB3aGVyZSB2ZXJpZmljYXRpb24gY29tcGxldGVkIGJ1dCBjb21wb25lbnQgd2FzIHVubW91bnRlZFxuICAgICAgaWYgKGlzTW91bnRlZCkgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgfTtcbiAgICBcbiAgICB2ZXJpZnlPbk1vdW50KCk7XG4gICAgXG4gICAgLy8gU2V0IHVwIHBlcmlvZGljIHRva2VuIHZlcmlmaWNhdGlvblxuICAgIGNvbnN0IGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKCFza2lwTmV4dFZlcmlmaWNhdGlvbikge1xuICAgICAgICB2ZXJpZnlUb2tlbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gUmVzZXQgc2tpcCBmbGFnIGFmdGVyIHVzaW5nIGl0IG9uY2VcbiAgICAgICAgc2V0U2tpcE5leHRWZXJpZmljYXRpb24oZmFsc2UpO1xuICAgICAgfVxuICAgIH0sIFRPS0VOX1ZFUklGWV9JTlRFUlZBTCk7XG4gICAgXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlzTW91bnRlZCA9IGZhbHNlO1xuICAgICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbCk7XG4gICAgfTtcbiAgfSwgW10pOyAgICAgXG5cbiAgLy8gVmVyaWZ5IHVzZXIgdG9rZW4gd2l0aCBiYWNrZW5kXG4gIGNvbnN0IHZlcmlmeVRva2VuID0gYXN5bmMgKCkgPT4ge1xuICAgIC8vIElmIG5vIHRva2VuIGV4aXN0cywgdGhlcmUncyBub3RoaW5nIHRvIHZlcmlmeVxuICAgIGNvbnN0IHRva2VuID0gZ2V0QXV0aFRva2VuKCk7XG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgY29uc29sZS5sb2coJ0F1dGhDb250ZXh0OiBObyB0b2tlbiB0byB2ZXJpZnknKTtcbiAgICAgIHNldElzQXV0aGVudGljYXRlZChmYWxzZSk7XG4gICAgICBzZXRVc2VyKG51bGwpO1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogVmVyaWZ5aW5nIHRva2VuIHdpdGggYmFja2VuZCcpO1xuICAgICAgc2V0TG9hZGluZyh0cnVlKTtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYXBpLmdldChBUElfRU5EUE9JTlRTLkFVVEguVkVSSUZZX1RPS0VOKTtcblxuICAgICAgaWYgKHJlc3BvbnNlLnN1Y2Nlc3MgJiYgcmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAvLyBUb2tlbiBpcyB2YWxpZCwgdXBkYXRlIHVzZXIgZGF0YVxuICAgICAgICBjb25zb2xlLmxvZygnQXV0aENvbnRleHQ6IFRva2VuIHZlcmlmaWVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICBzZXRJc0F1dGhlbnRpY2F0ZWQodHJ1ZSk7XG4gICAgICAgIHNldFVzZXIocmVzcG9uc2UuZGF0YS51c2VyIHx8IHt9KTtcbiAgICAgICAgc2V0VG9rZW4odG9rZW4pOyAvLyBFbnN1cmUgdG9rZW4gc3RhdGUgbWF0Y2hlcyBzdG9yYWdlXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBOb24tc3VjY2VzcyBIVFRQIHJlc3BvbnNlXG4gICAgICBjb25zdCBzdGF0dXMgPSByZXNwb25zZS5zdGF0dXNDb2RlID8/IDA7XG4gICAgICBpZiAoc3RhdHVzID09PSA0MDEgfHwgc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0F1dGhDb250ZXh0OiBUb2tlbiB2ZXJpZmljYXRpb24gZmFpbGVkIHdpdGggdW5hdXRob3JpemVkIHN0YXR1czonLCBzdGF0dXMpO1xuICAgICAgICBjbGVhckF1dGhTdGF0ZSgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIEZvciBvdGhlciBlcnJvcnMgKDV4eCwgMCwgZXRjLiksIGtlZXAgY3VycmVudCBhdXRoIHN0YXRlIHRvIGF2b2lkIGZsaWNrZXJcbiAgICAgIGNvbnNvbGUud2FybignQXV0aENvbnRleHQ6IFZlcmlmaWNhdGlvbiBub24tc3VjY2VzcyBidXQgbm90IHVuYXV0aG9yaXplZC4gUHJlc2VydmluZyBhdXRoIHN0YXRlLicsIHtcbiAgICAgICAgc3RhdHVzLFxuICAgICAgICBlcnJvcjogcmVzcG9uc2UuZXJyb3JcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAvLyBOZXR3b3JrIG9yIHVuZXhwZWN0ZWQgZXJyb3I6IHByZXNlcnZlIGN1cnJlbnQgYXV0aCBzdGF0ZVxuICAgICAgY29uc3QgbXNnID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcic7XG4gICAgICBjb25zb2xlLmVycm9yKCdUb2tlbiB2ZXJpZmljYXRpb24gZXJyb3IsIHByZXNlcnZpbmcgYXV0aCBzdGF0ZTonLCBtc2cpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gRW5oYW5jZWQgbG9nZ2luZyB1dGlsaXR5IGZvciBhdXRoZW50aWNhdGlvbiBldmVudHNcbiAgY29uc3QgbG9nQXV0aEV2ZW50ID0gKGV2ZW50VHlwZTogc3RyaW5nLCBkZXRhaWxzOiBhbnkgPSB7fSkgPT4ge1xuICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcbiAgICBjb25zdCBsb2dFbnRyeSA9IHtcbiAgICAgIHRpbWVzdGFtcCxcbiAgICAgIGV2ZW50VHlwZSxcbiAgICAgIC4uLmRldGFpbHNcbiAgICB9O1xuICAgIFxuICAgIC8vIE9wdGlvbmFsOiBTZW5kIHRvIGJhY2tlbmQgbG9nZ2luZyBzZXJ2aWNlIG9yIHN0b3JlIGxvY2FsbHlcbiAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShsb2dFbnRyeSkpO1xuICAgIFxuICAgIC8vIFN0b3JlIGluIGxvY2FsIHN0b3JhZ2UgZm9yIHBvdGVudGlhbCBkZWJ1Z2dpbmdcbiAgICB0cnkge1xuICAgICAgY29uc3QgYXV0aExvZ3MgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhdXRoX2xvZ3MnKSB8fCAnW10nKTtcbiAgICAgIGF1dGhMb2dzLnB1c2gobG9nRW50cnkpO1xuICAgICAgLy8gS2VlcCBvbmx5IGxhc3QgNTAgbG9nIGVudHJpZXNcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhdXRoX2xvZ3MnLCBKU09OLnN0cmluZ2lmeShhdXRoTG9ncy5zbGljZSgtNTApKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvZyBhdXRoZW50aWNhdGlvbiBldmVudCcsIGUpO1xuICAgIH1cbiAgfTtcblxuICAvLyBDaGVjayBpZiB1c2VyIGhhcyBhIHdhbGxldCBhbmQgZ2VuZXJhdGUgb25lIGlmIG5vdCBhdmFpbGFibGVcbiAgY29uc3QgY2hlY2tBbmRHZW5lcmF0ZVdhbGxldCA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gU2tpcCBpZiBub3QgYXV0aGVudGljYXRlZFxuICAgICAgaWYgKCFpc0F1dGhlbnRpY2F0ZWQgfHwgIXRva2VuKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gRmlyc3QgY2hlY2sgaWYgd2FsbGV0IGFscmVhZHkgZXhpc3RzXG4gICAgICBjb25zdCB3YWxsZXRSZXNwb25zZSA9IGF3YWl0IGFwaS5nZXQoQVBJX0VORFBPSU5UUy5XQUxMRVQuSU5GTywge30pO1xuICAgICAgXG4gICAgICAvLyBJZiBubyB3YWxsZXQgb3Igd2FsbGV0IGFkZHJlc3MgaXMgZW1wdHksIGdlbmVyYXRlIGEgbmV3IG9uZVxuICAgICAgaWYgKCF3YWxsZXRSZXNwb25zZS5zdWNjZXNzIHx8IFxuICAgICAgICAgICF3YWxsZXRSZXNwb25zZS5kYXRhPy53YWxsZXQ/LndhbGxldF9hZGRyZXNzKSB7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnTm8gd2FsbGV0IGZvdW5kIGZvciB1c2VyLCBnZW5lcmF0aW5nIGEgbmV3IGludGVybmFsIHdhbGxldC4uLicpO1xuICAgICAgICBcbiAgICAgICAgLy8gR2VuZXJhdGUgYSBuZXcgd2FsbGV0XG4gICAgICAgIGNvbnN0IGdlbmVyYXRlUmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdChBUElfRU5EUE9JTlRTLldBTExFVC5HRU5FUkFURSwge30pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGdlbmVyYXRlUmVzcG9uc2Uuc3VjY2Vzcykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdXYWxsZXQgZ2VuZXJhdGVkIHN1Y2Nlc3NmdWxseTonLCBcbiAgICAgICAgICAgIGdlbmVyYXRlUmVzcG9uc2UuZGF0YT8ud2FsbGV0Py53YWxsZXRfYWRkcmVzcyk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gWW91IGNvdWxkIHNldCB3YWxsZXQgaW5mbyBpbiBzdGF0ZSBoZXJlIGlmIG5lZWRlZFxuICAgICAgICAgIHJldHVybiBnZW5lcmF0ZVJlc3BvbnNlLmRhdGE/LndhbGxldDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgd2FsbGV0OicsIGdlbmVyYXRlUmVzcG9uc2UuZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygnVXNlciB3YWxsZXQgYWxyZWFkeSBleGlzdHM6JywgXG4gICAgICAgICAgd2FsbGV0UmVzcG9uc2UuZGF0YT8ud2FsbGV0Py53YWxsZXRfYWRkcmVzcyk7XG4gICAgICAgIHJldHVybiB3YWxsZXRSZXNwb25zZS5kYXRhPy53YWxsZXQ7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nL2dlbmVyYXRpbmcgd2FsbGV0OicsIFxuICAgICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyk7XG4gICAgfVxuICB9O1xuXG4gIC8vIEltcGxlbWVudCB0b2tlbiByZWZyZXNoIGZ1bmN0aW9uYWxpdHkgd2l0aCBleHBvbmVudGlhbCBiYWNrb2ZmXG4gIGNvbnN0IHJlZnJlc2hUb2tlbiA9IGFzeW5jIChyZXRyeUNvdW50ID0gMCk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgIGNvbnN0IE1BWF9SRVRSSUVTID0gMztcbiAgICBjb25zdCBCQVNFX0RFTEFZID0gMTAwMDsgLy8gMSBzZWNvbmQgaW5pdGlhbCBkZWxheVxuXG4gICAgdHJ5IHtcbiAgICAgIGxvZ0F1dGhFdmVudCgnVE9LRU5fUkVGUkVTSF9BVFRFTVBUJywgeyByZXRyeUNvdW50IH0pO1xuXG4gICAgICAvLyBFeHBvbmVudGlhbCBiYWNrb2ZmIHdpdGggaml0dGVyXG4gICAgICBpZiAocmV0cnlDb3VudCA+IDApIHtcbiAgICAgICAgY29uc3QgZGVsYXkgPSBCQVNFX0RFTEFZICogTWF0aC5wb3coMiwgcmV0cnlDb3VudCkgKiAoMSArIE1hdGgucmFuZG9tKCkpO1xuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcbiAgICAgIH1cblxuICAgICAgLy8gVXNlIHRoZSBkZWRpY2F0ZWQgcmVmcmVzaCB0b2tlbiBlbmRwb2ludFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBhcGkucG9zdDx7dG9rZW46IHN0cmluZywgdXNlcm5hbWU/OiBzdHJpbmd9PihBUElfRU5EUE9JTlRTLkFVVEguUkVGUkVTSF9UT0tFTiwge30pO1xuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLnN1Y2Nlc3MgfHwgIXJlc3BvbnNlLmRhdGE/LnRva2VuKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVG9rZW4gcmVmcmVzaCBmYWlsZWQ6IEludmFsaWQgcmVzcG9uc2UnKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgeyB0b2tlbiwgdXNlcm5hbWUgfSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICBcbiAgICAgIC8vIERldGVybWluZSBzdG9yYWdlIHR5cGUgYmFzZWQgb24gd2hlcmUgdGhlIGN1cnJlbnQgdG9rZW4gaXMgc3RvcmVkXG4gICAgICBjb25zdCBpbkxvY2FsU3RvcmFnZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRPS0VOX0tFWSkgIT09IG51bGw7XG4gICAgICBjb25zdCByZW1lbWJlck1lID0gaW5Mb2NhbFN0b3JhZ2U7IC8vIElmIGluIGxvY2FsU3RvcmFnZSwgdXNlciB3YW50ZWQgcGVyc2lzdGVudCBsb2dpblxuICAgICAgXG4gICAgICAvLyBTdG9yZSB0aGUgbmV3IHRva2VuIHdpdGggdGhlIHNhbWUgcHJlZmVyZW5jZVxuICAgICAgYXdhaXQgc3RvcmVBdXRoVG9rZW4odG9rZW4sIHJlbWVtYmVyTWUpO1xuICAgICAgXG4gICAgICAvLyBVcGRhdGUgbG9jYWwgdG9rZW4gc3RhdGVcbiAgICAgIHNldFRva2VuKHRva2VuKTtcbiAgICAgIHNldElzQXV0aGVudGljYXRlZCh0cnVlKTtcbiAgICAgIFxuICAgICAgLy8gT3B0aW9uYWw6IFVwZGF0ZSB1c2VybmFtZSBpZiBwcm92aWRlZFxuICAgICAgaWYgKHVzZXJuYW1lKSB7XG4gICAgICAgIHNldFVzZXIocHJldlVzZXIgPT4gKHsgLi4ucHJldlVzZXIsIHVzZXJuYW1lIH0pKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgbG9nQXV0aEV2ZW50KCdUT0tFTl9SRUZSRVNIX1NVQ0NFU1MnLCB7IHVzZXJuYW1lIH0pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gcmVmcmVzaCBlcnJvcic7XG4gICAgICBcbiAgICAgIGxvZ0F1dGhFdmVudCgnVE9LRU5fUkVGUkVTSF9GQUlMVVJFJywgeyBcbiAgICAgICAgZXJyb3JNZXNzYWdlLCBcbiAgICAgICAgcmV0cnlDb3VudCxcbiAgICAgICAgZXJyb3JTdGFjazogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLnN0YWNrIDogdW5kZWZpbmVkXG4gICAgICB9KTtcblxuICAgICAgLy8gSW1wbGVtZW50IHJldHJ5IG1lY2hhbmlzbVxuICAgICAgaWYgKHJldHJ5Q291bnQgPCBNQVhfUkVUUklFUykge1xuICAgICAgICBjb25zb2xlLndhcm4oYFRva2VuIHJlZnJlc2ggYXR0ZW1wdCAke3JldHJ5Q291bnQgKyAxfSBmYWlsZWQuIFJldHJ5aW5nLi4uYCk7XG4gICAgICAgIHJldHVybiByZWZyZXNoVG9rZW4ocmV0cnlDb3VudCArIDEpO1xuICAgICAgfVxuXG4gICAgICAvLyBGaW5hbCBmYWxsYmFjazogbG9nb3V0IGFmdGVyIG1heCByZXRyaWVzXG4gICAgICBjb25zb2xlLmVycm9yKCdUb2tlbiByZWZyZXNoIGZhaWxlZCBhZnRlciBtYXhpbXVtIHJldHJpZXMnKTtcbiAgICAgIGxvZ291dCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICAvLyBMb2dpbiB3aXRoIGNyZWRlbnRpYWxzXG4gIGNvbnN0IGxvZ2luID0gYXN5bmMgKGRhdGE6IGFueSk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygnQXV0aENvbnRleHQ6IGxvZ2luIGZ1bmN0aW9uIGNhbGxlZCB3aXRoIGRhdGE6JywgZGF0YSk7XG4gICAgICAvLyBTb21lIEFQSSBjbGllbnRzIHNhdmUgdGhlIHRva2VuIGRpcmVjdGx5IHRvIHN0b3JhZ2UgYW5kIHN0cmlwIGl0IGZyb20gcGF5bG9hZFxuICAgICAgLy8gRmFsbCBiYWNrIHRvIHJlYWRpbmcgZnJvbSBzdG9yYWdlIGlmIG5vdCBwcmVzZW50IG9uIHRoZSByZXNwb25zZSBvYmplY3RcbiAgICAgIGlmICghZGF0YS50b2tlbikge1xuICAgICAgICBjb25zdCBzdG9yZWRUb2tlbiA9IGdldEF1dGhUb2tlbigpO1xuICAgICAgICBjb25zb2xlLmxvZygnQXV0aENvbnRleHQ6IHRva2VuIG1pc3NpbmcgaW4gcGF5bG9hZCwgdXNpbmcgc3RvcmVkIHRva2VuOicsICEhc3RvcmVkVG9rZW4pO1xuICAgICAgICBpZiAoc3RvcmVkVG9rZW4pIHtcbiAgICAgICAgICBkYXRhLnRva2VuID0gc3RvcmVkVG9rZW47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB0b2tlbiBmb3VuZCBpbiBsb2dpbiBkYXRhIG9yIHN0b3JhZ2UnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnQXV0aENvbnRleHQ6IFByb2Nlc3NpbmcgbG9naW4gd2l0aCB0b2tlbicpO1xuICAgICAgXG4gICAgICAvLyBTdG9yZSB0b2tlbiB3aXRoIHJlbWVtYmVyIG1lIHByZWZlcmVuY2UgaWYgcHJvdmlkZWRcbiAgICAgIGNvbnN0IHJlbWVtYmVyTWUgPSBkYXRhLnJlbWVtYmVyX21lICE9PSB1bmRlZmluZWQgPyBkYXRhLnJlbWVtYmVyX21lIDogdHJ1ZTsgLy8gRGVmYXVsdCB0byB0cnVlIGZvciBwZXJzaXN0ZW50IGxvZ2luXG4gICAgICBcbiAgICAgIC8vIFN0b3JlIHRva2VuIGFuZCB3YWl0IGZvciBpdCB0byBjb21wbGV0ZVxuICAgICAgYXdhaXQgc3RvcmVBdXRoVG9rZW4oZGF0YS50b2tlbiwgcmVtZW1iZXJNZSk7XG4gICAgICBjb25zb2xlLmxvZygnQXV0aENvbnRleHQ6IFRva2VuIHN0b3JlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgIFxuICAgICAgLy8gVXBkYXRlIGFwcGxpY2F0aW9uIHN0YXRlXG4gICAgICBzZXRUb2tlbihkYXRhLnRva2VuKTsgLy8gRW5zdXJlIHRva2VuIHN0YXRlIGlzIHN5bmNocm9uaXplZFxuICAgICAgc2V0VXNlcihkYXRhLnVzZXIgfHwge30pO1xuICAgICAgc2V0SXNBdXRoZW50aWNhdGVkKHRydWUpO1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7IC8vIEVuc3VyZSBsb2FkaW5nIHN0YXRlIGlzIHR1cm5lZCBvZmZcbiAgICAgIGNvbnNvbGUubG9nKCdBdXRoQ29udGV4dDogU3RhdGUgdXBkYXRlZCAtIGlzQXV0aGVudGljYXRlZDogdHJ1ZSwgdXNlcjonLCBkYXRhLnVzZXIpO1xuICAgICAgXG4gICAgICAvLyBDYXB0dXJlIG1pbmltYWwgc2Vzc2lvbiBkYXRhIGFmdGVyIHN1Y2Nlc3NmdWwgbG9naW5cbiAgICAgIGlmIChkYXRhLnVzZXIpIHtcbiAgICAgICAgU2Vzc2lvblBlcnNpc3RlbmNlLmNhcHR1cmVTbmFwc2hvdChkYXRhLnVzZXIsIGRhdGEudG9rZW4pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTZXQgZmxhZyB0byBza2lwIG5leHQgdmVyaWZpY2F0aW9uIGN5Y2xlIHRvIGF2b2lkIHJhY2UgY29uZGl0aW9uXG4gICAgICBzZXRTa2lwTmV4dFZlcmlmaWNhdGlvbih0cnVlKTtcbiAgICAgIFxuICAgICAgLy8gTG9nIHN1Y2Nlc3NmdWwgbG9naW4gc3RhdGUgdXBkYXRlXG4gICAgICBjb25zb2xlLmxvZygnQXV0aENvbnRleHQ6IExvZ2luIGNvbXBsZXRlLCBhdXRoIHN0YXRlIHVwZGF0ZWQnKTtcbiAgICAgIFxuICAgICAgLy8gQXV0b21hdGljYWxseSBjaGVjayBmb3Igd2FsbGV0IGFuZCBnZW5lcmF0ZSBpZiBuZWVkZWRcbiAgICAgIC8vIFRoaXMgZW5zdXJlcyBldmVyeSB1c2VyIGhhcyBhIHdhbGxldCBhdXRvbWF0aWNhbGx5XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY2hlY2tBbmRHZW5lcmF0ZVdhbGxldCgpO1xuICAgICAgfSwgNTAwKTsgLy8gU21hbGwgZGVsYXkgdG8gZW5zdXJlIGF1dGggaXMgZnVsbHkgZXN0YWJsaXNoZWRcbiAgICAgIFxuICAgICAgcmV0dXJuIHRydWU7IC8vIFNpZ25hbCBzdWNjZXNzZnVsIGxvZ2luXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvZ2luIGZhaWxlZDonLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyk7XG4gICAgICAvLyBFbnN1cmUgYXV0aCBzdGF0ZSBpcyByZXNldCBpZiBsb2dpbiBmYWlsc1xuICAgICAgY2xlYXJBdXRoVG9rZW5zKCk7XG4gICAgICBTZXNzaW9uUGVyc2lzdGVuY2UuY2xlYXJTbmFwc2hvdCgpO1xuICAgICAgXG4gICAgICBzZXRUb2tlbihudWxsKTtcbiAgICAgIHNldFVzZXIobnVsbCk7XG4gICAgICBzZXRJc0F1dGhlbnRpY2F0ZWQoZmFsc2UpO1xuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICBcbiAgICAgIHJldHVybiBmYWxzZTsgLy8gU2lnbmFsIGZhaWxlZCBsb2dpblxuICAgIH1cbiAgfTtcblxuICAvLyBDbGVhciBhdXRoIHN0YXRlIC0gcmV1c2FibGUgZnVuY3Rpb24gZm9yIGJvdGggbG9nb3V0IGFuZCBmYWlsZWQgYXV0aFxuICBjb25zdCBjbGVhckF1dGhTdGF0ZSA9ICgpID0+IHtcbiAgICBjbGVhckF1dGhUb2tlbnMoKTtcbiAgICBzZXRUb2tlbihudWxsKTtcbiAgICBzZXRVc2VyKG51bGwpO1xuICAgIHNldElzQXV0aGVudGljYXRlZChmYWxzZSk7XG4gICAgU2Vzc2lvblBlcnNpc3RlbmNlLmNsZWFyU25hcHNob3QoKTtcbiAgfTtcbiAgXG4gIC8vIENsZWFyIGF1dGggc3RhdGVcbiAgY29uc3QgbG9nb3V0ID0gYXN5bmMgKCkgPT4ge1xuICAgIGxvZ0F1dGhFdmVudCgnbG9nb3V0X2luaXRpYXRlZCcpO1xuICAgIHRyeSB7XG4gICAgICAvLyBBdHRlbXB0IHRvIGNhbGwgbG9nb3V0IGVuZHBvaW50IGlmIHdlIGhhdmUgYSB0b2tlblxuICAgICAgaWYgKGdldEF1dGhUb2tlbigpKSB7XG4gICAgICAgIGF3YWl0IGFwaS5wb3N0KEFQSV9FTkRQT0lOVFMuQVVUSC5MT0dPVVQsIHt9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIGxvZ291dDonLCBlcnJvcik7XG4gICAgICAvLyBDb250aW51ZSB3aXRoIGxvZ291dCByZWdhcmRsZXNzIG9mIEFQSSBlcnJvcnNcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gQWx3YXlzIGNsZWFyIGxvY2FsIHN0YXRlIGFuZCBzdG9yYWdlXG4gICAgICBjbGVhckF1dGhTdGF0ZSgpO1xuICAgICAgXG4gICAgICAvLyBMb2cgdGhlIGV2ZW50XG4gICAgICBsb2dBdXRoRXZlbnQoJ2xvZ291dF9jb21wbGV0ZScpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxBdXRoQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17eyBcbiAgICAgIHVzZXIsIFxuICAgICAgbG9naW4sIFxuICAgICAgbG9nb3V0LCBcbiAgICAgIGxvYWRpbmcsXG4gICAgICByZWZyZXNoVG9rZW4sXG4gICAgICBpc0F1dGhlbnRpY2F0ZWRcbiAgICB9fT5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICA8L0F1dGhDb250ZXh0LlByb3ZpZGVyPlxuICApO1xufVxuXG5leHBvcnQgY29uc3QgdXNlQXV0aCA9ICgpOiBBdXRoQ29udGV4dFR5cGUgPT4ge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChBdXRoQ29udGV4dCk7XG4gIGlmICghY29udGV4dCkge1xuICAgIHRocm93IG5ldyBFcnJvcigndXNlQXV0aCBtdXN0IGJlIHVzZWQgd2l0aGluIGFuIEF1dGhQcm92aWRlcicpO1xuICB9XG4gIHJldHVybiBjb250ZXh0O1xufTtcbiJdLCJuYW1lcyI6WyJSZWFjdCIsImNyZWF0ZUNvbnRleHQiLCJ1c2VDb250ZXh0IiwidXNlRWZmZWN0IiwidXNlU3RhdGUiLCJBUElfRU5EUE9JTlRTIiwiYXBpIiwiaGFzQWRtaW5CeXBhc3MiLCJieXBhc3NMb2dpbiIsImdldEF1dGhUb2tlbiIsInN0b3JlQXV0aFRva2VuIiwiY2xlYXJBdXRoVG9rZW5zIiwiVE9LRU5fS0VZIiwiVE9LRU5fRVhQSVJZX0tFWSIsIlJFRlJFU0hfVE9LRU5fS0VZIiwiVE9LRU5fVkVSSUZZX0lOVEVSVkFMIiwiU2Vzc2lvblBlcnNpc3RlbmNlIiwiU1RPUkFHRV9LRVkiLCJjYXB0dXJlU25hcHNob3QiLCJ1c2VyIiwidG9rZW4iLCJjbGVhclNuYXBzaG90Iiwic25hcHNob3QiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiaWQiLCJ1c2VybmFtZSIsImVtYWlsIiwiYXV0aGVudGljYXRlZCIsInNlc3Npb25TdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwicmV0cmlldmVTbmFwc2hvdCIsInNuYXBzaG90U3RyIiwiZ2V0SXRlbSIsInBhcnNlIiwiTUFYX0FHRSIsImlzRXhwaXJlZCIsInJlbW92ZUl0ZW0iLCJBdXRoQ29udGV4dCIsIkF1dGhQcm92aWRlciIsImNoaWxkcmVuIiwic2V0VXNlciIsImxvYWRpbmciLCJzZXRMb2FkaW5nIiwiaXNBdXRoZW50aWNhdGVkIiwic2V0SXNBdXRoZW50aWNhdGVkIiwic2V0VG9rZW4iLCJza2lwTmV4dFZlcmlmaWNhdGlvbiIsInNldFNraXBOZXh0VmVyaWZpY2F0aW9uIiwibG9naW4iLCJpc01vdW50ZWQiLCJ2ZXJpZnlPbk1vdW50IiwibG9nIiwidmVyaWZ5VG9rZW4iLCJpbnRlcnZhbCIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInJlc3BvbnNlIiwiZ2V0IiwiQVVUSCIsIlZFUklGWV9UT0tFTiIsInN1Y2Nlc3MiLCJkYXRhIiwic3RhdHVzIiwic3RhdHVzQ29kZSIsImNsZWFyQXV0aFN0YXRlIiwibXNnIiwiRXJyb3IiLCJtZXNzYWdlIiwibG9nQXV0aEV2ZW50IiwiZXZlbnRUeXBlIiwiZGV0YWlscyIsInRvSVNPU3RyaW5nIiwibG9nRW50cnkiLCJhdXRoTG9ncyIsImxvY2FsU3RvcmFnZSIsInB1c2giLCJzbGljZSIsImUiLCJjaGVja0FuZEdlbmVyYXRlV2FsbGV0Iiwid2FsbGV0UmVzcG9uc2UiLCJXQUxMRVQiLCJJTkZPIiwid2FsbGV0Iiwid2FsbGV0X2FkZHJlc3MiLCJnZW5lcmF0ZVJlc3BvbnNlIiwicG9zdCIsIkdFTkVSQVRFIiwicmVmcmVzaFRva2VuIiwicmV0cnlDb3VudCIsIk1BWF9SRVRSSUVTIiwiQkFTRV9ERUxBWSIsImRlbGF5IiwiTWF0aCIsInBvdyIsInJhbmRvbSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIlJFRlJFU0hfVE9LRU4iLCJpbkxvY2FsU3RvcmFnZSIsInJlbWVtYmVyTWUiLCJwcmV2VXNlciIsImVycm9yTWVzc2FnZSIsImVycm9yU3RhY2siLCJzdGFjayIsInVuZGVmaW5lZCIsImxvZ291dCIsInN0b3JlZFRva2VuIiwicmVtZW1iZXJfbWUiLCJMT0dPVVQiLCJQcm92aWRlciIsInZhbHVlIiwidXNlQXV0aCIsImNvbnRleHQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/AuthContext.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/ChatStatePersistence.tsx":
/*!*********************************************!*\
  !*** ./components/ChatStatePersistence.tsx ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   useChatStatePersistence: () => (/* binding */ useChatStatePersistence)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _context_AppStateContext__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../context/AppStateContext */ \"(pages-dir-node)/./context/AppStateContext.tsx\");\n\n\n/**\n * Hook to manage chat state persistence\n * This syncs the Chat component state with our global persistence layer\n */ const useChatStatePersistence = (sessionId, sessions, messages, draftMessage = '')=>{\n    const { state, dispatch } = (0,_context_AppStateContext__WEBPACK_IMPORTED_MODULE_1__.useAppState)();\n    // Get stored sessions from state - ensure compatibility with Chat.tsx structure\n    const getStoredSessions = ()=>{\n        // First check if there are any sessions in our persistent state\n        if (state.chatState?.sessions && Object.keys(state.chatState.sessions).length > 0) {\n            // Convert the sessions object to a properly structured array\n            return Object.values(state.chatState.sessions || {}).map((session)=>{\n                // Ensure each session conforms to the ChatSession interface\n                return {\n                    id: session.id || session.session_id || '',\n                    session_id: session.session_id || session.id || '',\n                    name: session.name || session.topic || `Chat ${(session.session_id || session.id || '').slice(0, 6)}`,\n                    topic: session.topic || session.name || '',\n                    lastActivity: session.updated_at || new Date().toISOString(),\n                    messages: Array.isArray(session.messages) ? session.messages.map((msg)=>({\n                            sender: msg.role === 'user' ? 'user' : 'grace',\n                            text: msg.content || '',\n                            timestamp: msg.timestamp || new Date().toISOString(),\n                            user: msg.role === 'user' ? msg.content : undefined,\n                            bot: msg.role === 'assistant' ? msg.content : undefined\n                        })) : [],\n                    scrollPosition: session.scrollPosition,\n                    unread_count: session.unread_count || 0\n                };\n            });\n        }\n        // If no sessions in state, check localStorage cache\n        const activeSessionId = localStorage.getItem('activeSessionId');\n        if (activeSessionId) {\n            try {\n                // Try to load cached messages for this session\n                const cachedMessages = loadMessagesFromCache(activeSessionId);\n                if (cachedMessages.length > 0) {\n                    return [\n                        {\n                            id: activeSessionId,\n                            session_id: activeSessionId,\n                            name: `Chat ${activeSessionId.slice(0, 6)}`,\n                            topic: `Chat ${activeSessionId.slice(0, 6)}`,\n                            lastActivity: localStorage.getItem(`lastSynced_${activeSessionId}`) || new Date().toISOString(),\n                            messages: cachedMessages\n                        }\n                    ];\n                }\n            } catch (e) {\n                console.error('Error loading sessions from cache:', e);\n            }\n        }\n        return [];\n    };\n    // Helper to load messages from cache - match the function in Chat.tsx\n    const loadMessagesFromCache = (sid)=>{\n        if (!sid) return [];\n        // Try multiple sources in order of preference\n        try {\n            // 1. First check persistent global state\n            const sessionMessages = state.chatState?.sessions?.[sid]?.messages;\n            if (Array.isArray(sessionMessages) && sessionMessages.length > 0) {\n                console.log(`Restoring ${sessionMessages.length} messages from global state for session ${sid}`);\n                return sessionMessages.map((msg)=>({\n                        sender: msg.role === 'user' ? 'user' : 'grace',\n                        text: msg.content || '',\n                        timestamp: msg.timestamp || new Date().toISOString(),\n                        user: msg.role === 'user' ? msg.content : undefined,\n                        bot: msg.role === 'assistant' ? msg.content : undefined\n                    }));\n            }\n            // 2. Then check localStorage\n            const savedMessages = localStorage.getItem(`messages_${sid}`);\n            if (savedMessages) {\n                const parsedMessages = JSON.parse(savedMessages);\n                if (Array.isArray(parsedMessages) && parsedMessages.length > 0) {\n                    console.log(`Restoring ${parsedMessages.length} messages from localStorage for session ${sid}`);\n                    return parsedMessages;\n                }\n            }\n        } catch (e) {\n            console.error('Error loading messages from cache:', e);\n        }\n        return [];\n    };\n    // Effect to log when we have sessions available in state\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)({\n        \"useChatStatePersistence.useEffect\": ()=>{\n            const storedSessions = getStoredSessions();\n            if (storedSessions.length > 0 && sessions.length === 0) {\n                console.log('Chat sessions available in persistent state', storedSessions);\n            }\n        }\n    }[\"useChatStatePersistence.useEffect\"], [\n        state.chatState?.sessions,\n        sessions\n    ]);\n    // Save the current session state whenever it changes\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)({\n        \"useChatStatePersistence.useEffect\": ()=>{\n            if (sessionId && sessions.length > 0) {\n                // Convert sessions array to a record indexed by session ID\n                // Use the same sessionId format as in Chat.tsx\n                const sessionMap = sessions.reduce({\n                    \"useChatStatePersistence.useEffect.sessionMap\": (acc, session)=>{\n                        const sessionKey = session.session_id || session.id;\n                        if (sessionKey) {\n                            // Transform to the format our persistence expects\n                            acc[sessionKey] = {\n                                id: session.id,\n                                session_id: session.session_id || session.id,\n                                topic: session.topic || session.name,\n                                name: session.name,\n                                created_at: session.created_at || session.lastActivity,\n                                // IMPORTANT: Avoid generating a fresh timestamp on every render which\n                                // causes JSON.stringify(sessionMap) to change and retrigger dispatch loops.\n                                // Prefer stable values in this effect.\n                                updated_at: // keep any existing persisted updated_at if available\n                                state.chatState?.sessions?.[sessionKey]?.updated_at || session.updated_at || session.lastActivity,\n                                preview_message: session.messages && session.messages.length > 0 ? session.messages[session.messages.length - 1].text || session.messages[session.messages.length - 1].user || session.messages[session.messages.length - 1].bot : '',\n                                // Preserve existing messages reference from global state to keep\n                                // sessionMap stable and avoid flip-flopping with the messages sync effect.\n                                messages: state.chatState?.sessions?.[sessionKey]?.messages || [],\n                                scrollPosition: session.scrollPosition,\n                                unread_count: session.unread_count || 0\n                            };\n                        }\n                        return acc;\n                    }\n                }[\"useChatStatePersistence.useEffect.sessionMap\"], {});\n                // Guard: Only dispatch if something actually changed\n                const prev = state.chatState || {};\n                const prevActive = Array.isArray(prev.activeSessions) ? prev.activeSessions.join('|') : '';\n                const nextActive = sessions.map({\n                    \"useChatStatePersistence.useEffect.nextActive\": (s)=>s.session_id || s.id\n                }[\"useChatStatePersistence.useEffect.nextActive\"]).join('|');\n                const prevCurrent = prev.currentSessionId || '';\n                const prevDraft = prev.draftMessages?.[sessionId] || '';\n                const nextDraft = draftMessage || '';\n                const prevSessionsStr = JSON.stringify(prev.sessions || {});\n                const nextSessionsStr = JSON.stringify(sessionMap);\n                const changed = prevActive !== nextActive || prevCurrent !== sessionId || prevDraft !== nextDraft || prevSessionsStr !== nextSessionsStr;\n                if (changed) {\n                    dispatch({\n                        type: 'SET_CHAT_STATE',\n                        payload: {\n                            activeSessions: sessions.map({\n                                \"useChatStatePersistence.useEffect\": (s)=>s.session_id || s.id\n                            }[\"useChatStatePersistence.useEffect\"]),\n                            currentSessionId: sessionId,\n                            sessions: sessionMap,\n                            draftMessages: {\n                                ...state.chatState?.draftMessages || {},\n                                [sessionId]: draftMessage\n                            }\n                        }\n                    });\n                }\n                // Persist to localStorage only (avoid dispatch from here to prevent loops)\n                const currentSession = sessions.find({\n                    \"useChatStatePersistence.useEffect.currentSession\": (s)=>s.id === sessionId || s.session_id === sessionId\n                }[\"useChatStatePersistence.useEffect.currentSession\"]);\n                if (currentSession && Array.isArray(currentSession.messages) && currentSession.messages.length > 0) {\n                    persistMessages(sessionId, currentSession.messages);\n                }\n            }\n        }\n    }[\"useChatStatePersistence.useEffect\"], [\n        sessions,\n        sessionId,\n        messages,\n        draftMessage,\n        dispatch\n    ]);\n    // Sync message state between local and global\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)({\n        \"useChatStatePersistence.useEffect\": ()=>{\n            if (sessionId && messages.length > 0 && state.chatState?.sessions) {\n                const sessionKey = sessionId;\n                const currentSession = state.chatState.sessions[sessionKey];\n                if (currentSession && !arraysEqual(currentSession.messages || [], messages)) {\n                    const updatedSessions = {\n                        ...state.chatState.sessions,\n                        [sessionKey]: {\n                            ...currentSession,\n                            messages: messages,\n                            // Only bump updated_at when messages actually change; otherwise leave as-is\n                            updated_at: new Date().toISOString()\n                        }\n                    };\n                    dispatch({\n                        type: 'SET_CHAT_STATE',\n                        payload: {\n                            sessions: updatedSessions\n                        }\n                    });\n                }\n            }\n        }\n    }[\"useChatStatePersistence.useEffect\"], [\n        messages,\n        sessionId,\n        state.chatState?.sessions,\n        dispatch\n    ]);\n    // Helper to compare arrays\n    const arraysEqual = (a, b)=>{\n        if (a === b) return true;\n        if (!Array.isArray(a) || !Array.isArray(b)) return false;\n        if (a.length !== b.length) return false;\n        // Deep-ish compare by value; messages are small arrays\n        try {\n            return JSON.stringify(a) === JSON.stringify(b);\n        } catch  {\n            return false;\n        }\n    };\n    // Helper function to persist messages - match the function in Chat.tsx\n    const persistMessages = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n        \"useChatStatePersistence.useCallback[persistMessages]\": (sid, msgs)=>{\n            if (!sid || !msgs || msgs.length === 0) {\n                // Skip persisting empty arrays to avoid loops and noise\n                return;\n            }\n            try {\n                console.log(`Persisting ${msgs.length} messages for session ${sid}`);\n                // Only store a limited number of messages to prevent localStorage overflows\n                const messagesToStore = msgs.slice(-100); // Store more messages (up to 100)\n                // Store in localStorage as a backup\n                localStorage.setItem(`messages_${sid}`, JSON.stringify(messagesToStore));\n                localStorage.setItem(`lastSynced_${sid}`, new Date().toISOString());\n                localStorage.setItem('activeSessionId', sid);\n            // Note: Do NOT dispatch global state updates here to avoid recursive update loops.\n            } catch (e) {\n                console.error('Failed to store messages:', e);\n            }\n        }\n    }[\"useChatStatePersistence.useCallback[persistMessages]\"], []);\n    // Function to initialize sessions from persisted state if available\n    const initializeFromPersistedState = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n        \"useChatStatePersistence.useCallback[initializeFromPersistedState]\": (setSessionsFunc, setSessionIdFunc)=>{\n            const storedSessions = getStoredSessions();\n            if (storedSessions.length > 0 && sessions.length === 0) {\n                // Set the sessions from storage\n                setSessionsFunc(storedSessions);\n                // Set the active session ID if available - use same approach as Chat.tsx\n                const activeSessionId = localStorage.getItem('activeSessionId');\n                if (activeSessionId) {\n                    // Check if this session exists in our stored sessions\n                    const sessionExists = storedSessions.some({\n                        \"useChatStatePersistence.useCallback[initializeFromPersistedState].sessionExists\": (s)=>s.session_id === activeSessionId || s.id === activeSessionId\n                    }[\"useChatStatePersistence.useCallback[initializeFromPersistedState].sessionExists\"]);\n                    if (sessionExists) {\n                        setSessionIdFunc(activeSessionId);\n                    } else if (state.chatState?.currentSessionId) {\n                        setSessionIdFunc(state.chatState.currentSessionId);\n                    } else {\n                        // Fall back to first session\n                        setSessionIdFunc(storedSessions[0].session_id || storedSessions[0].id);\n                    }\n                } else if (state.chatState?.currentSessionId) {\n                    setSessionIdFunc(state.chatState.currentSessionId);\n                } else {\n                    // Fall back to first session\n                    setSessionIdFunc(storedSessions[0].session_id || storedSessions[0].id);\n                }\n                return true; // Indicate that we restored from persisted state\n            }\n            return false; // Indicate that we did not restore (no stored sessions or sessions already loaded)\n        }\n    }[\"useChatStatePersistence.useCallback[initializeFromPersistedState]\"], [\n        sessions.length,\n        state.chatState?.currentSessionId\n    ]);\n    return {\n        // Main functions for state initialization and persistence\n        initializeFromPersistedState,\n        getStoredSessions,\n        loadMessagesFromCache,\n        persistMessages,\n        // Functions to sync specific aspects of chat state\n        syncScrollPosition: (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n            \"useChatStatePersistence.useCallback\": (position)=>{\n                if (!sessionId) return;\n                // Save scroll position in both localStorage and global state\n                localStorage.setItem(`scrollPosition_${sessionId}`, position.toString());\n                dispatch({\n                    type: 'SET_CHAT_STATE',\n                    payload: {\n                        sessions: {\n                            ...state.chatState?.sessions || {},\n                            [sessionId]: {\n                                ...state.chatState?.sessions?.[sessionId] || {},\n                                scrollPosition: position\n                            }\n                        }\n                    }\n                });\n            }\n        }[\"useChatStatePersistence.useCallback\"], [\n            sessionId,\n            state.chatState?.sessions,\n            dispatch\n        ]),\n        // Get saved scroll position for current session - check both localStorage and global state\n        getSavedScrollPosition: (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n            \"useChatStatePersistence.useCallback\": ()=>{\n                if (!sessionId) return null;\n                // First check localStorage (Chat.tsx approach)\n                const localPosition = localStorage.getItem(`scrollPosition_${sessionId}`);\n                if (localPosition) {\n                    return parseInt(localPosition, 10);\n                }\n                // Fall back to global state\n                if (state.chatState?.sessions?.[sessionId]) {\n                    return state.chatState.sessions[sessionId].scrollPosition;\n                }\n                return null;\n            }\n        }[\"useChatStatePersistence.useCallback\"], [\n            sessionId,\n            state.chatState?.sessions\n        ]),\n        // Get saved draft message for current session\n        getSavedDraftMessage: (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n            \"useChatStatePersistence.useCallback\": ()=>{\n                if (!sessionId) return '';\n                // First check localStorage (Chat.tsx approach)\n                const localDraft = localStorage.getItem(`draft_${sessionId}`);\n                if (localDraft) {\n                    return localDraft;\n                }\n                // Fall back to global state\n                if (state.chatState?.draftMessages && sessionId in state.chatState.draftMessages) {\n                    return state.chatState.draftMessages[sessionId] || '';\n                }\n                return '';\n            }\n        }[\"useChatStatePersistence.useCallback\"], [\n            sessionId,\n            state.chatState?.draftMessages\n        ]),\n        // Directly update draft message\n        updateDraftMessage: (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)({\n            \"useChatStatePersistence.useCallback\": (message)=>{\n                if (!sessionId) return;\n                // Skip if unchanged to avoid noisy dispatch loops\n                const current = state.chatState?.draftMessages?.[sessionId] || '';\n                if (current === message) {\n                    return;\n                }\n                // Save in both localStorage and global state for consistent behavior with Chat.tsx\n                localStorage.setItem(`draft_${sessionId}`, message);\n                dispatch({\n                    type: 'SET_CHAT_STATE',\n                    payload: {\n                        draftMessages: {\n                            ...state.chatState?.draftMessages || {},\n                            [sessionId]: message\n                        }\n                    }\n                });\n            }\n        }[\"useChatStatePersistence.useCallback\"], [\n            sessionId,\n            dispatch\n        ])\n    };\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (useChatStatePersistence);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvQ2hhdFN0YXRlUGVyc2lzdGVuY2UudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXNEO0FBQ0c7QUE2Q3pEOzs7Q0FHQyxHQUNNLE1BQU1JLDBCQUEwQixDQUNyQ0MsV0FDQUMsVUFDQUMsVUFDQUMsZUFBdUIsRUFBRTtJQUV6QixNQUFNLEVBQUVDLEtBQUssRUFBRUMsUUFBUSxFQUFFLEdBQUdQLHFFQUFXQTtJQUV2QyxnRkFBZ0Y7SUFDaEYsTUFBTVEsb0JBQW9CO1FBQ3hCLGdFQUFnRTtRQUNoRSxJQUFJRixNQUFNRyxTQUFTLEVBQUVOLFlBQVlPLE9BQU9DLElBQUksQ0FBQ0wsTUFBTUcsU0FBUyxDQUFDTixRQUFRLEVBQUVTLE1BQU0sR0FBRyxHQUFHO1lBQ2pGLDZEQUE2RDtZQUM3RCxPQUFPRixPQUFPRyxNQUFNLENBQUNQLE1BQU1HLFNBQVMsQ0FBQ04sUUFBUSxJQUFJLENBQUMsR0FBR1csR0FBRyxDQUFDLENBQUNDO2dCQUN4RCw0REFBNEQ7Z0JBQzVELE9BQU87b0JBQ0xDLElBQUlELFFBQVFDLEVBQUUsSUFBSUQsUUFBUUUsVUFBVSxJQUFJO29CQUN4Q0EsWUFBWUYsUUFBUUUsVUFBVSxJQUFJRixRQUFRQyxFQUFFLElBQUk7b0JBQ2hERSxNQUFNSCxRQUFRRyxJQUFJLElBQUlILFFBQVFJLEtBQUssSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDSixRQUFRRSxVQUFVLElBQUlGLFFBQVFDLEVBQUUsSUFBSSxFQUFDLEVBQUdJLEtBQUssQ0FBQyxHQUFHLElBQUk7b0JBQ3JHRCxPQUFPSixRQUFRSSxLQUFLLElBQUlKLFFBQVFHLElBQUksSUFBSTtvQkFDeENHLGNBQWNOLFFBQVFPLFVBQVUsSUFBSSxJQUFJQyxPQUFPQyxXQUFXO29CQUMxRHBCLFVBQVVxQixNQUFNQyxPQUFPLENBQUNYLFFBQVFYLFFBQVEsSUFBSVcsUUFBUVgsUUFBUSxDQUFDVSxHQUFHLENBQUNhLENBQUFBLE1BQVE7NEJB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VUFBVSxFQUFFbUc7d0JBQ2Y7b0JBQ0Y7Z0JBQ0Y7WUFDRjtrREFBRztZQUFDbkc7WUFBV0s7U0FBUztJQUMxQjtBQUNGLEVBQUU7QUFFRixpRUFBZU4sdUJBQXVCQSxFQUFDIiwic291cmNlcyI6WyIvVXNlcnMvd29ua2Fzd29ybGQvRG93bmxvYWRzL2dyYWNlLXByb2plY3Qvc3JjL3VpL2NvbXBvbmVudHMvQ2hhdFN0YXRlUGVyc2lzdGVuY2UudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlQXBwU3RhdGUgfSBmcm9tICcuLi9jb250ZXh0L0FwcFN0YXRlQ29udGV4dCc7XG5cbi8vIE1hdGNoIHRoZSBleGFjdCBDaGF0TWVzc2FnZSBpbnRlcmZhY2UgZnJvbSBDaGF0LnRzeFxuaW50ZXJmYWNlIENoYXRNZXNzYWdlIHtcbiAgc2VuZGVyPzogJ3VzZXInIHwgJ2dyYWNlJztcbiAgdGV4dD86IHN0cmluZztcbiAgdGltZXN0YW1wPzogc3RyaW5nO1xuICB1c2VyPzogc3RyaW5nOyAvLyBGb3IgQVBJIHJlc3BvbnNlIGZvcm1hdFxuICBib3Q/OiBzdHJpbmc7IC8vIEZvciBBUEkgcmVzcG9uc2UgZm9ybWF0XG59XG5cbi8vIE1hdGNoIHRoZSBleGFjdCBDaGF0U2Vzc2lvbiBpbnRlcmZhY2UgZnJvbSBDaGF0LnRzeCB3aXRoIG5lY2Vzc2FyeSBleHRlbnNpb25zXG5pbnRlcmZhY2UgQ2hhdFNlc3Npb24ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGxhc3RBY3Rpdml0eTogc3RyaW5nO1xuICBtZXNzYWdlczogQ2hhdE1lc3NhZ2VbXTtcbiAgc2Vzc2lvbl9pZD86IHN0cmluZzsgLy8gRm9yIEFQSSBjb21wYXRpYmlsaXR5XG4gIHRvcGljPzogc3RyaW5nOyAvLyBGb3IgQVBJIGNvbXBhdGliaWxpdHlcbiAgLy8gQWRkaXRpb25hbCBmaWVsZHMgbmVlZGVkIGZvciBwZXJzaXN0ZW5jZVxuICBzY3JvbGxQb3NpdGlvbj86IG51bWJlcjtcbiAgdW5yZWFkX2NvdW50PzogbnVtYmVyO1xuICBjcmVhdGVkX2F0Pzogc3RyaW5nO1xuICB1cGRhdGVkX2F0Pzogc3RyaW5nO1xufVxuXG4vLyBUeXBlIGZvciB0aGUgc3RhdGUuY2hhdFN0YXRlLnNlc3Npb25zIGVudHJpZXNcbmludGVyZmFjZSBQZXJzaXN0ZW50Q2hhdFNlc3Npb24ge1xuICBpZDogc3RyaW5nO1xuICBzZXNzaW9uX2lkPzogc3RyaW5nO1xuICBuYW1lPzogc3RyaW5nO1xuICB0b3BpYz86IHN0cmluZztcbiAgY3JlYXRlZF9hdD86IHN0cmluZztcbiAgdXBkYXRlZF9hdD86IHN0cmluZztcbiAgcHJldmlld19tZXNzYWdlPzogc3RyaW5nO1xuICBtZXNzYWdlcz86IEFycmF5PHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGNvbnRlbnQ6IHN0cmluZztcbiAgICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JyB8ICdzeXN0ZW0nO1xuICAgIHRpbWVzdGFtcDogc3RyaW5nO1xuICB9PjtcbiAgdW5yZWFkX2NvdW50PzogbnVtYmVyO1xuICBzY3JvbGxQb3NpdGlvbj86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBIb29rIHRvIG1hbmFnZSBjaGF0IHN0YXRlIHBlcnNpc3RlbmNlXG4gKiBUaGlzIHN5bmNzIHRoZSBDaGF0IGNvbXBvbmVudCBzdGF0ZSB3aXRoIG91ciBnbG9iYWwgcGVyc2lzdGVuY2UgbGF5ZXJcbiAqL1xuZXhwb3J0IGNvbnN0IHVzZUNoYXRTdGF0ZVBlcnNpc3RlbmNlID0gKFxuICBzZXNzaW9uSWQ6IHN0cmluZyB8IG51bGwsXG4gIHNlc3Npb25zOiBDaGF0U2Vzc2lvbltdLFxuICBtZXNzYWdlczogQ2hhdE1lc3NhZ2VbXSxcbiAgZHJhZnRNZXNzYWdlOiBzdHJpbmcgPSAnJ1xuKSA9PiB7XG4gIGNvbnN0IHsgc3RhdGUsIGRpc3BhdGNoIH0gPSB1c2VBcHBTdGF0ZSgpO1xuXG4gIC8vIEdldCBzdG9yZWQgc2Vzc2lvbnMgZnJvbSBzdGF0ZSAtIGVuc3VyZSBjb21wYXRpYmlsaXR5IHdpdGggQ2hhdC50c3ggc3RydWN0dXJlXG4gIGNvbnN0IGdldFN0b3JlZFNlc3Npb25zID0gKCk6IENoYXRTZXNzaW9uW10gPT4ge1xuICAgIC8vIEZpcnN0IGNoZWNrIGlmIHRoZXJlIGFyZSBhbnkgc2Vzc2lvbnMgaW4gb3VyIHBlcnNpc3RlbnQgc3RhdGVcbiAgICBpZiAoc3RhdGUuY2hhdFN0YXRlPy5zZXNzaW9ucyAmJiBPYmplY3Qua2V5cyhzdGF0ZS5jaGF0U3RhdGUuc2Vzc2lvbnMpLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIENvbnZlcnQgdGhlIHNlc3Npb25zIG9iamVjdCB0byBhIHByb3Blcmx5IHN0cnVjdHVyZWQgYXJyYXlcbiAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHN0YXRlLmNoYXRTdGF0ZS5zZXNzaW9ucyB8fCB7fSkubWFwKChzZXNzaW9uOiBQZXJzaXN0ZW50Q2hhdFNlc3Npb24pID0+IHtcbiAgICAgICAgLy8gRW5zdXJlIGVhY2ggc2Vzc2lvbiBjb25mb3JtcyB0byB0aGUgQ2hhdFNlc3Npb24gaW50ZXJmYWNlXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IHNlc3Npb24uaWQgfHwgc2Vzc2lvbi5zZXNzaW9uX2lkIHx8ICcnLFxuICAgICAgICAgIHNlc3Npb25faWQ6IHNlc3Npb24uc2Vzc2lvbl9pZCB8fCBzZXNzaW9uLmlkIHx8ICcnLFxuICAgICAgICAgIG5hbWU6IHNlc3Npb24ubmFtZSB8fCBzZXNzaW9uLnRvcGljIHx8IGBDaGF0ICR7KHNlc3Npb24uc2Vzc2lvbl9pZCB8fCBzZXNzaW9uLmlkIHx8ICcnKS5zbGljZSgwLCA2KX1gLFxuICAgICAgICAgIHRvcGljOiBzZXNzaW9uLnRvcGljIHx8IHNlc3Npb24ubmFtZSB8fCAnJyxcbiAgICAgICAgICBsYXN0QWN0aXZpdHk6IHNlc3Npb24udXBkYXRlZF9hdCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgbWVzc2FnZXM6IEFycmF5LmlzQXJyYXkoc2Vzc2lvbi5tZXNzYWdlcykgPyBzZXNzaW9uLm1lc3NhZ2VzLm1hcChtc2cgPT4gKHtcbiAgICAgICAgICAgIHNlbmRlcjogbXNnLnJvbGUgPT09ICd1c2VyJyA/ICd1c2VyJyA6ICdncmFjZScsXG4gICAgICAgICAgICB0ZXh0OiBtc2cuY29udGVudCB8fCAnJyxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbXNnLnRpbWVzdGFtcCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICB1c2VyOiBtc2cucm9sZSA9PT0gJ3VzZXInID8gbXNnLmNvbnRlbnQgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBib3Q6IG1zZy5yb2xlID09PSAnYXNzaXN0YW50JyA/IG1zZy5jb250ZW50IDogdW5kZWZpbmVkXG4gICAgICAgICAgfSkpIDogW10sXG4gICAgICAgICAgc2Nyb2xsUG9zaXRpb246IHNlc3Npb24uc2Nyb2xsUG9zaXRpb24sXG4gICAgICAgICAgdW5yZWFkX2NvdW50OiBzZXNzaW9uLnVucmVhZF9jb3VudCB8fCAwXG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gSWYgbm8gc2Vzc2lvbnMgaW4gc3RhdGUsIGNoZWNrIGxvY2FsU3RvcmFnZSBjYWNoZVxuICAgIGNvbnN0IGFjdGl2ZVNlc3Npb25JZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY3RpdmVTZXNzaW9uSWQnKTtcbiAgICBpZiAoYWN0aXZlU2Vzc2lvbklkKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBUcnkgdG8gbG9hZCBjYWNoZWQgbWVzc2FnZXMgZm9yIHRoaXMgc2Vzc2lvblxuICAgICAgICBjb25zdCBjYWNoZWRNZXNzYWdlcyA9IGxvYWRNZXNzYWdlc0Zyb21DYWNoZShhY3RpdmVTZXNzaW9uSWQpO1xuICAgICAgICBpZiAoY2FjaGVkTWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJldHVybiBbe1xuICAgICAgICAgICAgaWQ6IGFjdGl2ZVNlc3Npb25JZCxcbiAgICAgICAgICAgIHNlc3Npb25faWQ6IGFjdGl2ZVNlc3Npb25JZCxcbiAgICAgICAgICAgIG5hbWU6IGBDaGF0ICR7YWN0aXZlU2Vzc2lvbklkLnNsaWNlKDAsIDYpfWAsXG4gICAgICAgICAgICB0b3BpYzogYENoYXQgJHthY3RpdmVTZXNzaW9uSWQuc2xpY2UoMCwgNil9YCxcbiAgICAgICAgICAgIGxhc3RBY3Rpdml0eTogbG9jYWxTdG9yYWdlLmdldEl0ZW0oYGxhc3RTeW5jZWRfJHthY3RpdmVTZXNzaW9uSWR9YCkgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgbWVzc2FnZXM6IGNhY2hlZE1lc3NhZ2VzXG4gICAgICAgICAgfV07XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyBzZXNzaW9ucyBmcm9tIGNhY2hlOicsIGUpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gW107XG4gIH07XG4gIFxuICAvLyBIZWxwZXIgdG8gbG9hZCBtZXNzYWdlcyBmcm9tIGNhY2hlIC0gbWF0Y2ggdGhlIGZ1bmN0aW9uIGluIENoYXQudHN4XG4gIGNvbnN0IGxvYWRNZXNzYWdlc0Zyb21DYWNoZSA9IChzaWQ6IHN0cmluZyk6IENoYXRNZXNzYWdlW10gPT4ge1xuICAgIGlmICghc2lkKSByZXR1cm4gW107XG4gICAgXG4gICAgLy8gVHJ5IG11bHRpcGxlIHNvdXJjZXMgaW4gb3JkZXIgb2YgcHJlZmVyZW5jZVxuICAgIHRyeSB7XG4gICAgICAvLyAxLiBGaXJzdCBjaGVjayBwZXJzaXN0ZW50IGdsb2JhbCBzdGF0ZVxuICAgICAgY29uc3Qgc2Vzc2lvbk1lc3NhZ2VzID0gc3RhdGUuY2hhdFN0YXRlPy5zZXNzaW9ucz8uW3NpZF0/Lm1lc3NhZ2VzO1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoc2Vzc2lvbk1lc3NhZ2VzKSAmJiBzZXNzaW9uTWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgUmVzdG9yaW5nICR7c2Vzc2lvbk1lc3NhZ2VzLmxlbmd0aH0gbWVzc2FnZXMgZnJvbSBnbG9iYWwgc3RhdGUgZm9yIHNlc3Npb24gJHtzaWR9YCk7XG4gICAgICAgIHJldHVybiBzZXNzaW9uTWVzc2FnZXMubWFwKG1zZyA9PiAoe1xuICAgICAgICAgIHNlbmRlcjogbXNnLnJvbGUgPT09ICd1c2VyJyA/ICd1c2VyJyA6ICdncmFjZScsXG4gICAgICAgICAgdGV4dDogbXNnLmNvbnRlbnQgfHwgJycsXG4gICAgICAgICAgdGltZXN0YW1wOiBtc2cudGltZXN0YW1wIHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICB1c2VyOiBtc2cucm9sZSA9PT0gJ3VzZXInID8gbXNnLmNvbnRlbnQgOiB1bmRlZmluZWQsXG4gICAgICAgICAgYm90OiBtc2cucm9sZSA9PT0gJ2Fzc2lzdGFudCcgPyBtc2cuY29udGVudCA6IHVuZGVmaW5lZFxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIDIuIFRoZW4gY2hlY2sgbG9jYWxTdG9yYWdlXG4gICAgICBjb25zdCBzYXZlZE1lc3NhZ2VzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oYG1lc3NhZ2VzXyR7c2lkfWApO1xuICAgICAgaWYgKHNhdmVkTWVzc2FnZXMpIHtcbiAgICAgICAgY29uc3QgcGFyc2VkTWVzc2FnZXMgPSBKU09OLnBhcnNlKHNhdmVkTWVzc2FnZXMpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJzZWRNZXNzYWdlcykgJiYgcGFyc2VkTWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBSZXN0b3JpbmcgJHtwYXJzZWRNZXNzYWdlcy5sZW5ndGh9IG1lc3NhZ2VzIGZyb20gbG9jYWxTdG9yYWdlIGZvciBzZXNzaW9uICR7c2lkfWApO1xuICAgICAgICAgIHJldHVybiBwYXJzZWRNZXNzYWdlcztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgbWVzc2FnZXMgZnJvbSBjYWNoZTonLCBlKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIFtdO1xuICB9O1xuICBcbiAgLy8gRWZmZWN0IHRvIGxvZyB3aGVuIHdlIGhhdmUgc2Vzc2lvbnMgYXZhaWxhYmxlIGluIHN0YXRlXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgc3RvcmVkU2Vzc2lvbnMgPSBnZXRTdG9yZWRTZXNzaW9ucygpO1xuICAgIGlmIChzdG9yZWRTZXNzaW9ucy5sZW5ndGggPiAwICYmIHNlc3Npb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS5sb2coJ0NoYXQgc2Vzc2lvbnMgYXZhaWxhYmxlIGluIHBlcnNpc3RlbnQgc3RhdGUnLCBzdG9yZWRTZXNzaW9ucyk7XG4gICAgfVxuICB9LCBbc3RhdGUuY2hhdFN0YXRlPy5zZXNzaW9ucywgc2Vzc2lvbnNdKTtcblxuICAvLyBTYXZlIHRoZSBjdXJyZW50IHNlc3Npb24gc3RhdGUgd2hlbmV2ZXIgaXQgY2hhbmdlc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChzZXNzaW9uSWQgJiYgc2Vzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgLy8gQ29udmVydCBzZXNzaW9ucyBhcnJheSB0byBhIHJlY29yZCBpbmRleGVkIGJ5IHNlc3Npb24gSURcbiAgICAgIC8vIFVzZSB0aGUgc2FtZSBzZXNzaW9uSWQgZm9ybWF0IGFzIGluIENoYXQudHN4XG4gICAgICBjb25zdCBzZXNzaW9uTWFwID0gc2Vzc2lvbnMucmVkdWNlPFJlY29yZDxzdHJpbmcsIFBlcnNpc3RlbnRDaGF0U2Vzc2lvbj4+KChhY2MsIHNlc3Npb24pID0+IHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbktleSA9IHNlc3Npb24uc2Vzc2lvbl9pZCB8fCBzZXNzaW9uLmlkO1xuICAgICAgICBpZiAoc2Vzc2lvbktleSkge1xuICAgICAgICAgIC8vIFRyYW5zZm9ybSB0byB0aGUgZm9ybWF0IG91ciBwZXJzaXN0ZW5jZSBleHBlY3RzXG4gICAgICAgICAgYWNjW3Nlc3Npb25LZXldID0ge1xuICAgICAgICAgICAgaWQ6IHNlc3Npb24uaWQsXG4gICAgICAgICAgICBzZXNzaW9uX2lkOiBzZXNzaW9uLnNlc3Npb25faWQgfHwgc2Vzc2lvbi5pZCxcbiAgICAgICAgICAgIHRvcGljOiBzZXNzaW9uLnRvcGljIHx8IHNlc3Npb24ubmFtZSxcbiAgICAgICAgICAgIG5hbWU6IHNlc3Npb24ubmFtZSxcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IHNlc3Npb24uY3JlYXRlZF9hdCB8fCBzZXNzaW9uLmxhc3RBY3Rpdml0eSxcbiAgICAgICAgICAgIC8vIElNUE9SVEFOVDogQXZvaWQgZ2VuZXJhdGluZyBhIGZyZXNoIHRpbWVzdGFtcCBvbiBldmVyeSByZW5kZXIgd2hpY2hcbiAgICAgICAgICAgIC8vIGNhdXNlcyBKU09OLnN0cmluZ2lmeShzZXNzaW9uTWFwKSB0byBjaGFuZ2UgYW5kIHJldHJpZ2dlciBkaXNwYXRjaCBsb29wcy5cbiAgICAgICAgICAgIC8vIFByZWZlciBzdGFibGUgdmFsdWVzIGluIHRoaXMgZWZmZWN0LlxuICAgICAgICAgICAgdXBkYXRlZF9hdDpcbiAgICAgICAgICAgICAgLy8ga2VlcCBhbnkgZXhpc3RpbmcgcGVyc2lzdGVkIHVwZGF0ZWRfYXQgaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICAgIChzdGF0ZS5jaGF0U3RhdGU/LnNlc3Npb25zPy5bc2Vzc2lvbktleV0/LnVwZGF0ZWRfYXQgYXMgc3RyaW5nIHwgdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAvLyBvdGhlcndpc2UgZmFsbCBiYWNrIHRvIHNlc3Npb24tcHJvdmlkZWQgdGltZXN0YW1wc1xuICAgICAgICAgICAgICB8fCBzZXNzaW9uLnVwZGF0ZWRfYXRcbiAgICAgICAgICAgICAgfHwgc2Vzc2lvbi5sYXN0QWN0aXZpdHksXG4gICAgICAgICAgICBwcmV2aWV3X21lc3NhZ2U6IHNlc3Npb24ubWVzc2FnZXMgJiYgc2Vzc2lvbi5tZXNzYWdlcy5sZW5ndGggPiAwID9cbiAgICAgICAgICAgICAgKHNlc3Npb24ubWVzc2FnZXNbc2Vzc2lvbi5tZXNzYWdlcy5sZW5ndGggLSAxXS50ZXh0IHx8XG4gICAgICAgICAgICAgICBzZXNzaW9uLm1lc3NhZ2VzW3Nlc3Npb24ubWVzc2FnZXMubGVuZ3RoIC0gMV0udXNlciB8fFxuICAgICAgICAgICAgICAgc2Vzc2lvbi5tZXNzYWdlc1tzZXNzaW9uLm1lc3NhZ2VzLmxlbmd0aCAtIDFdLmJvdCkgOiAnJyxcbiAgICAgICAgICAgIC8vIFByZXNlcnZlIGV4aXN0aW5nIG1lc3NhZ2VzIHJlZmVyZW5jZSBmcm9tIGdsb2JhbCBzdGF0ZSB0byBrZWVwXG4gICAgICAgICAgICAvLyBzZXNzaW9uTWFwIHN0YWJsZSBhbmQgYXZvaWQgZmxpcC1mbG9wcGluZyB3aXRoIHRoZSBtZXNzYWdlcyBzeW5jIGVmZmVjdC5cbiAgICAgICAgICAgIG1lc3NhZ2VzOiAoc3RhdGUuY2hhdFN0YXRlPy5zZXNzaW9ucz8uW3Nlc3Npb25LZXldPy5tZXNzYWdlcyBhcyBhbnlbXSkgfHwgW10sXG4gICAgICAgICAgICBzY3JvbGxQb3NpdGlvbjogc2Vzc2lvbi5zY3JvbGxQb3NpdGlvbixcbiAgICAgICAgICAgIHVucmVhZF9jb3VudDogc2Vzc2lvbi51bnJlYWRfY291bnQgfHwgMFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sIHt9KTtcblxuICAgICAgLy8gR3VhcmQ6IE9ubHkgZGlzcGF0Y2ggaWYgc29tZXRoaW5nIGFjdHVhbGx5IGNoYW5nZWRcbiAgICAgIGNvbnN0IHByZXYgPSBzdGF0ZS5jaGF0U3RhdGUgfHwge30gYXMgYW55O1xuICAgICAgY29uc3QgcHJldkFjdGl2ZSA9IEFycmF5LmlzQXJyYXkocHJldi5hY3RpdmVTZXNzaW9ucykgPyBwcmV2LmFjdGl2ZVNlc3Npb25zLmpvaW4oJ3wnKSA6ICcnO1xuICAgICAgY29uc3QgbmV4dEFjdGl2ZSA9IHNlc3Npb25zLm1hcChzID0+IHMuc2Vzc2lvbl9pZCB8fCBzLmlkKS5qb2luKCd8Jyk7XG4gICAgICBjb25zdCBwcmV2Q3VycmVudCA9IHByZXYuY3VycmVudFNlc3Npb25JZCB8fCAnJztcbiAgICAgIGNvbnN0IHByZXZEcmFmdCA9IHByZXYuZHJhZnRNZXNzYWdlcz8uW3Nlc3Npb25JZF0gfHwgJyc7XG4gICAgICBjb25zdCBuZXh0RHJhZnQgPSBkcmFmdE1lc3NhZ2UgfHwgJyc7XG4gICAgICBjb25zdCBwcmV2U2Vzc2lvbnNTdHIgPSBKU09OLnN0cmluZ2lmeShwcmV2LnNlc3Npb25zIHx8IHt9KTtcbiAgICAgIGNvbnN0IG5leHRTZXNzaW9uc1N0ciA9IEpTT04uc3RyaW5naWZ5KHNlc3Npb25NYXApO1xuXG4gICAgICBjb25zdCBjaGFuZ2VkID0gcHJldkFjdGl2ZSAhPT0gbmV4dEFjdGl2ZSB8fCBwcmV2Q3VycmVudCAhPT0gc2Vzc2lvbklkIHx8IHByZXZEcmFmdCAhPT0gbmV4dERyYWZ0IHx8IHByZXZTZXNzaW9uc1N0ciAhPT0gbmV4dFNlc3Npb25zU3RyO1xuXG4gICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogJ1NFVF9DSEFUX1NUQVRFJyxcbiAgICAgICAgICBwYXlsb2FkOiB7XG4gICAgICAgICAgICBhY3RpdmVTZXNzaW9uczogc2Vzc2lvbnMubWFwKHMgPT4gcy5zZXNzaW9uX2lkIHx8IHMuaWQpLFxuICAgICAgICAgICAgY3VycmVudFNlc3Npb25JZDogc2Vzc2lvbklkLFxuICAgICAgICAgICAgc2Vzc2lvbnM6IHNlc3Npb25NYXAsXG4gICAgICAgICAgICBkcmFmdE1lc3NhZ2VzOiB7XG4gICAgICAgICAgICAgIC4uLihzdGF0ZS5jaGF0U3RhdGU/LmRyYWZ0TWVzc2FnZXMgfHwge30pLFxuICAgICAgICAgICAgICBbc2Vzc2lvbklkXTogZHJhZnRNZXNzYWdlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gUGVyc2lzdCB0byBsb2NhbFN0b3JhZ2Ugb25seSAoYXZvaWQgZGlzcGF0Y2ggZnJvbSBoZXJlIHRvIHByZXZlbnQgbG9vcHMpXG4gICAgICBjb25zdCBjdXJyZW50U2Vzc2lvbiA9IHNlc3Npb25zLmZpbmQocyA9PiBzLmlkID09PSBzZXNzaW9uSWQgfHwgcy5zZXNzaW9uX2lkID09PSBzZXNzaW9uSWQpO1xuICAgICAgaWYgKGN1cnJlbnRTZXNzaW9uICYmIEFycmF5LmlzQXJyYXkoY3VycmVudFNlc3Npb24ubWVzc2FnZXMpICYmIGN1cnJlbnRTZXNzaW9uLm1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcGVyc2lzdE1lc3NhZ2VzKHNlc3Npb25JZCwgY3VycmVudFNlc3Npb24ubWVzc2FnZXMpO1xuICAgICAgfVxuICAgIH1cbiAgfSwgW3Nlc3Npb25zLCBzZXNzaW9uSWQsIG1lc3NhZ2VzLCBkcmFmdE1lc3NhZ2UsIGRpc3BhdGNoXSk7XG5cbiAgLy8gU3luYyBtZXNzYWdlIHN0YXRlIGJldHdlZW4gbG9jYWwgYW5kIGdsb2JhbFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChzZXNzaW9uSWQgJiYgbWVzc2FnZXMubGVuZ3RoID4gMCAmJiBzdGF0ZS5jaGF0U3RhdGU/LnNlc3Npb25zKSB7XG4gICAgICBjb25zdCBzZXNzaW9uS2V5ID0gc2Vzc2lvbklkO1xuICAgICAgY29uc3QgY3VycmVudFNlc3Npb24gPSBzdGF0ZS5jaGF0U3RhdGUuc2Vzc2lvbnNbc2Vzc2lvbktleV07XG4gICAgICBcbiAgICAgIGlmIChjdXJyZW50U2Vzc2lvbiAmJiAhYXJyYXlzRXF1YWwoY3VycmVudFNlc3Npb24ubWVzc2FnZXMgfHwgW10sIG1lc3NhZ2VzKSkge1xuICAgICAgICBjb25zdCB1cGRhdGVkU2Vzc2lvbnMgPSB7XG4gICAgICAgICAgLi4uc3RhdGUuY2hhdFN0YXRlLnNlc3Npb25zLFxuICAgICAgICAgIFtzZXNzaW9uS2V5XToge1xuICAgICAgICAgICAgLi4uY3VycmVudFNlc3Npb24sXG4gICAgICAgICAgICBtZXNzYWdlczogbWVzc2FnZXMsXG4gICAgICAgICAgICAvLyBPbmx5IGJ1bXAgdXBkYXRlZF9hdCB3aGVuIG1lc3NhZ2VzIGFjdHVhbGx5IGNoYW5nZTsgb3RoZXJ3aXNlIGxlYXZlIGFzLWlzXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBkaXNwYXRjaCh7XG4gICAgICAgICAgdHlwZTogJ1NFVF9DSEFUX1NUQVRFJyxcbiAgICAgICAgICBwYXlsb2FkOiB7XG4gICAgICAgICAgICBzZXNzaW9uczogdXBkYXRlZFNlc3Npb25zXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFttZXNzYWdlcywgc2Vzc2lvbklkLCBzdGF0ZS5jaGF0U3RhdGU/LnNlc3Npb25zLCBkaXNwYXRjaF0pO1xuXG4gIC8vIEhlbHBlciB0byBjb21wYXJlIGFycmF5c1xuICBjb25zdCBhcnJheXNFcXVhbCA9IChhOiBhbnlbXSwgYjogYW55W10pID0+IHtcbiAgICBpZiAoYSA9PT0gYikgcmV0dXJuIHRydWU7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGEpIHx8ICFBcnJheS5pc0FycmF5KGIpKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGEubGVuZ3RoICE9PSBiLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgIC8vIERlZXAtaXNoIGNvbXBhcmUgYnkgdmFsdWU7IG1lc3NhZ2VzIGFyZSBzbWFsbCBhcnJheXNcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGEpID09PSBKU09OLnN0cmluZ2lmeShiKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG5cbiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHBlcnNpc3QgbWVzc2FnZXMgLSBtYXRjaCB0aGUgZnVuY3Rpb24gaW4gQ2hhdC50c3hcbiAgY29uc3QgcGVyc2lzdE1lc3NhZ2VzID0gdXNlQ2FsbGJhY2soKHNpZDogc3RyaW5nLCBtc2dzOiBDaGF0TWVzc2FnZVtdKSA9PiB7XG4gICAgaWYgKCFzaWQgfHwgIW1zZ3MgfHwgbXNncy5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIFNraXAgcGVyc2lzdGluZyBlbXB0eSBhcnJheXMgdG8gYXZvaWQgbG9vcHMgYW5kIG5vaXNlXG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZyhgUGVyc2lzdGluZyAke21zZ3MubGVuZ3RofSBtZXNzYWdlcyBmb3Igc2Vzc2lvbiAke3NpZH1gKTtcbiAgICAgIFxuICAgICAgLy8gT25seSBzdG9yZSBhIGxpbWl0ZWQgbnVtYmVyIG9mIG1lc3NhZ2VzIHRvIHByZXZlbnQgbG9jYWxTdG9yYWdlIG92ZXJmbG93c1xuICAgICAgY29uc3QgbWVzc2FnZXNUb1N0b3JlID0gbXNncy5zbGljZSgtMTAwKTsgLy8gU3RvcmUgbW9yZSBtZXNzYWdlcyAodXAgdG8gMTAwKVxuICAgICAgXG4gICAgICAvLyBTdG9yZSBpbiBsb2NhbFN0b3JhZ2UgYXMgYSBiYWNrdXBcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGBtZXNzYWdlc18ke3NpZH1gLCBKU09OLnN0cmluZ2lmeShtZXNzYWdlc1RvU3RvcmUpKTtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGBsYXN0U3luY2VkXyR7c2lkfWAsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSk7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWN0aXZlU2Vzc2lvbklkJywgc2lkKTtcblxuICAgICAgLy8gTm90ZTogRG8gTk9UIGRpc3BhdGNoIGdsb2JhbCBzdGF0ZSB1cGRhdGVzIGhlcmUgdG8gYXZvaWQgcmVjdXJzaXZlIHVwZGF0ZSBsb29wcy5cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc3RvcmUgbWVzc2FnZXM6JywgZSk7XG4gICAgfVxuICB9LCBbXSk7XG4gIFxuICAvLyBGdW5jdGlvbiB0byBpbml0aWFsaXplIHNlc3Npb25zIGZyb20gcGVyc2lzdGVkIHN0YXRlIGlmIGF2YWlsYWJsZVxuICBjb25zdCBpbml0aWFsaXplRnJvbVBlcnNpc3RlZFN0YXRlID0gdXNlQ2FsbGJhY2soKHNldFNlc3Npb25zRnVuYzogKHNlc3Npb25zOiBDaGF0U2Vzc2lvbltdKSA9PiB2b2lkLCBzZXRTZXNzaW9uSWRGdW5jOiAoaWQ6IHN0cmluZyB8IG51bGwpID0+IHZvaWQpID0+IHtcbiAgICBjb25zdCBzdG9yZWRTZXNzaW9ucyA9IGdldFN0b3JlZFNlc3Npb25zKCk7XG4gICAgXG4gICAgaWYgKHN0b3JlZFNlc3Npb25zLmxlbmd0aCA+IDAgJiYgc2Vzc2lvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyBTZXQgdGhlIHNlc3Npb25zIGZyb20gc3RvcmFnZVxuICAgICAgc2V0U2Vzc2lvbnNGdW5jKHN0b3JlZFNlc3Npb25zKTtcbiAgICAgIFxuICAgICAgLy8gU2V0IHRoZSBhY3RpdmUgc2Vzc2lvbiBJRCBpZiBhdmFpbGFibGUgLSB1c2Ugc2FtZSBhcHByb2FjaCBhcyBDaGF0LnRzeFxuICAgICAgY29uc3QgYWN0aXZlU2Vzc2lvbklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjdGl2ZVNlc3Npb25JZCcpO1xuICAgICAgaWYgKGFjdGl2ZVNlc3Npb25JZCkge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGlzIHNlc3Npb24gZXhpc3RzIGluIG91ciBzdG9yZWQgc2Vzc2lvbnNcbiAgICAgICAgY29uc3Qgc2Vzc2lvbkV4aXN0cyA9IHN0b3JlZFNlc3Npb25zLnNvbWUocyA9PiBcbiAgICAgICAgICBzLnNlc3Npb25faWQgPT09IGFjdGl2ZVNlc3Npb25JZCB8fCBzLmlkID09PSBhY3RpdmVTZXNzaW9uSWRcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChzZXNzaW9uRXhpc3RzKSB7XG4gICAgICAgICAgc2V0U2Vzc2lvbklkRnVuYyhhY3RpdmVTZXNzaW9uSWQpO1xuICAgICAgICB9IGVsc2UgaWYgKHN0YXRlLmNoYXRTdGF0ZT8uY3VycmVudFNlc3Npb25JZCkge1xuICAgICAgICAgIHNldFNlc3Npb25JZEZ1bmMoc3RhdGUuY2hhdFN0YXRlLmN1cnJlbnRTZXNzaW9uSWQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEZhbGwgYmFjayB0byBmaXJzdCBzZXNzaW9uXG4gICAgICAgICAgc2V0U2Vzc2lvbklkRnVuYyhzdG9yZWRTZXNzaW9uc1swXS5zZXNzaW9uX2lkIHx8IHN0b3JlZFNlc3Npb25zWzBdLmlkKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChzdGF0ZS5jaGF0U3RhdGU/LmN1cnJlbnRTZXNzaW9uSWQpIHtcbiAgICAgICAgc2V0U2Vzc2lvbklkRnVuYyhzdGF0ZS5jaGF0U3RhdGUuY3VycmVudFNlc3Npb25JZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGYWxsIGJhY2sgdG8gZmlyc3Qgc2Vzc2lvblxuICAgICAgICBzZXRTZXNzaW9uSWRGdW5jKHN0b3JlZFNlc3Npb25zWzBdLnNlc3Npb25faWQgfHwgc3RvcmVkU2Vzc2lvbnNbMF0uaWQpO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gdHJ1ZTsgLy8gSW5kaWNhdGUgdGhhdCB3ZSByZXN0b3JlZCBmcm9tIHBlcnNpc3RlZCBzdGF0ZVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZmFsc2U7IC8vIEluZGljYXRlIHRoYXQgd2UgZGlkIG5vdCByZXN0b3JlIChubyBzdG9yZWQgc2Vzc2lvbnMgb3Igc2Vzc2lvbnMgYWxyZWFkeSBsb2FkZWQpXG4gIH0sIFtzZXNzaW9ucy5sZW5ndGgsIHN0YXRlLmNoYXRTdGF0ZT8uY3VycmVudFNlc3Npb25JZF0pO1xuICBcbiAgcmV0dXJuIHtcbiAgICAvLyBNYWluIGZ1bmN0aW9ucyBmb3Igc3RhdGUgaW5pdGlhbGl6YXRpb24gYW5kIHBlcnNpc3RlbmNlXG4gICAgaW5pdGlhbGl6ZUZyb21QZXJzaXN0ZWRTdGF0ZSxcbiAgICBnZXRTdG9yZWRTZXNzaW9ucyxcbiAgICBsb2FkTWVzc2FnZXNGcm9tQ2FjaGUsXG4gICAgcGVyc2lzdE1lc3NhZ2VzLFxuICAgIFxuICAgIC8vIEZ1bmN0aW9ucyB0byBzeW5jIHNwZWNpZmljIGFzcGVjdHMgb2YgY2hhdCBzdGF0ZVxuICAgIHN5bmNTY3JvbGxQb3NpdGlvbjogdXNlQ2FsbGJhY2soKHBvc2l0aW9uOiBudW1iZXIpID0+IHtcbiAgICAgIGlmICghc2Vzc2lvbklkKSByZXR1cm47XG4gICAgICBcbiAgICAgIC8vIFNhdmUgc2Nyb2xsIHBvc2l0aW9uIGluIGJvdGggbG9jYWxTdG9yYWdlIGFuZCBnbG9iYWwgc3RhdGVcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGBzY3JvbGxQb3NpdGlvbl8ke3Nlc3Npb25JZH1gLCBwb3NpdGlvbi50b1N0cmluZygpKTtcbiAgICAgIFxuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiAnU0VUX0NIQVRfU1RBVEUnLFxuICAgICAgICBwYXlsb2FkOiB7XG4gICAgICAgICAgc2Vzc2lvbnM6IHtcbiAgICAgICAgICAgIC4uLihzdGF0ZS5jaGF0U3RhdGU/LnNlc3Npb25zIHx8IHt9KSxcbiAgICAgICAgICAgIFtzZXNzaW9uSWRdOiB7XG4gICAgICAgICAgICAgIC4uLihzdGF0ZS5jaGF0U3RhdGU/LnNlc3Npb25zPy5bc2Vzc2lvbklkXSB8fCB7fSksXG4gICAgICAgICAgICAgIHNjcm9sbFBvc2l0aW9uOiBwb3NpdGlvblxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSwgW3Nlc3Npb25JZCwgc3RhdGUuY2hhdFN0YXRlPy5zZXNzaW9ucywgZGlzcGF0Y2hdKSxcbiAgICBcbiAgICAvLyBHZXQgc2F2ZWQgc2Nyb2xsIHBvc2l0aW9uIGZvciBjdXJyZW50IHNlc3Npb24gLSBjaGVjayBib3RoIGxvY2FsU3RvcmFnZSBhbmQgZ2xvYmFsIHN0YXRlXG4gICAgZ2V0U2F2ZWRTY3JvbGxQb3NpdGlvbjogdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgaWYgKCFzZXNzaW9uSWQpIHJldHVybiBudWxsO1xuICAgICAgXG4gICAgICAvLyBGaXJzdCBjaGVjayBsb2NhbFN0b3JhZ2UgKENoYXQudHN4IGFwcHJvYWNoKVxuICAgICAgY29uc3QgbG9jYWxQb3NpdGlvbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBzY3JvbGxQb3NpdGlvbl8ke3Nlc3Npb25JZH1gKTtcbiAgICAgIGlmIChsb2NhbFBvc2l0aW9uKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUludChsb2NhbFBvc2l0aW9uLCAxMCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEZhbGwgYmFjayB0byBnbG9iYWwgc3RhdGVcbiAgICAgIGlmIChzdGF0ZS5jaGF0U3RhdGU/LnNlc3Npb25zPy5bc2Vzc2lvbklkXSkge1xuICAgICAgICByZXR1cm4gc3RhdGUuY2hhdFN0YXRlLnNlc3Npb25zW3Nlc3Npb25JZF0uc2Nyb2xsUG9zaXRpb247XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0sIFtzZXNzaW9uSWQsIHN0YXRlLmNoYXRTdGF0ZT8uc2Vzc2lvbnNdKSxcbiAgICBcbiAgICAvLyBHZXQgc2F2ZWQgZHJhZnQgbWVzc2FnZSBmb3IgY3VycmVudCBzZXNzaW9uXG4gICAgZ2V0U2F2ZWREcmFmdE1lc3NhZ2U6IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgIGlmICghc2Vzc2lvbklkKSByZXR1cm4gJyc7XG4gICAgICBcbiAgICAgIC8vIEZpcnN0IGNoZWNrIGxvY2FsU3RvcmFnZSAoQ2hhdC50c3ggYXBwcm9hY2gpXG4gICAgICBjb25zdCBsb2NhbERyYWZ0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oYGRyYWZ0XyR7c2Vzc2lvbklkfWApO1xuICAgICAgaWYgKGxvY2FsRHJhZnQpIHtcbiAgICAgICAgcmV0dXJuIGxvY2FsRHJhZnQ7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEZhbGwgYmFjayB0byBnbG9iYWwgc3RhdGVcbiAgICAgIGlmIChzdGF0ZS5jaGF0U3RhdGU/LmRyYWZ0TWVzc2FnZXMgJiYgc2Vzc2lvbklkIGluIHN0YXRlLmNoYXRTdGF0ZS5kcmFmdE1lc3NhZ2VzKSB7XG4gICAgICAgIHJldHVybiBzdGF0ZS5jaGF0U3RhdGUuZHJhZnRNZXNzYWdlc1tzZXNzaW9uSWRdIHx8ICcnO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gJyc7XG4gICAgfSwgW3Nlc3Npb25JZCwgc3RhdGUuY2hhdFN0YXRlPy5kcmFmdE1lc3NhZ2VzXSksXG4gICAgXG4gICAgLy8gRGlyZWN0bHkgdXBkYXRlIGRyYWZ0IG1lc3NhZ2VcbiAgICB1cGRhdGVEcmFmdE1lc3NhZ2U6IHVzZUNhbGxiYWNrKChtZXNzYWdlOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmICghc2Vzc2lvbklkKSByZXR1cm47XG4gICAgICBcbiAgICAgIC8vIFNraXAgaWYgdW5jaGFuZ2VkIHRvIGF2b2lkIG5vaXN5IGRpc3BhdGNoIGxvb3BzXG4gICAgICBjb25zdCBjdXJyZW50ID0gc3RhdGUuY2hhdFN0YXRlPy5kcmFmdE1lc3NhZ2VzPy5bc2Vzc2lvbklkXSB8fCAnJztcbiAgICAgIGlmIChjdXJyZW50ID09PSBtZXNzYWdlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU2F2ZSBpbiBib3RoIGxvY2FsU3RvcmFnZSBhbmQgZ2xvYmFsIHN0YXRlIGZvciBjb25zaXN0ZW50IGJlaGF2aW9yIHdpdGggQ2hhdC50c3hcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGBkcmFmdF8ke3Nlc3Npb25JZH1gLCBtZXNzYWdlKTtcbiAgICAgIFxuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiAnU0VUX0NIQVRfU1RBVEUnLFxuICAgICAgICBwYXlsb2FkOiB7XG4gICAgICAgICAgZHJhZnRNZXNzYWdlczoge1xuICAgICAgICAgICAgLi4uKHN0YXRlLmNoYXRTdGF0ZT8uZHJhZnRNZXNzYWdlcyB8fCB7fSksXG4gICAgICAgICAgICBbc2Vzc2lvbklkXTogbWVzc2FnZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSwgW3Nlc3Npb25JZCwgZGlzcGF0Y2hdKVxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgdXNlQ2hhdFN0YXRlUGVyc2lzdGVuY2U7XG4iXSwibmFtZXMiOlsiUmVhY3QiLCJ1c2VFZmZlY3QiLCJ1c2VDYWxsYmFjayIsInVzZUFwcFN0YXRlIiwidXNlQ2hhdFN0YXRlUGVyc2lzdGVuY2UiLCJzZXNzaW9uSWQiLCJzZXNzaW9ucyIsIm1lc3NhZ2VzIiwiZHJhZnRNZXNzYWdlIiwic3RhdGUiLCJkaXNwYXRjaCIsImdldFN0b3JlZFNlc3Npb25zIiwiY2hhdFN0YXRlIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInZhbHVlcyIsIm1hcCIsInNlc3Npb24iLCJpZCIsInNlc3Npb25faWQiLCJuYW1lIiwidG9waWMiLCJzbGljZSIsImxhc3RBY3Rpdml0eSIsInVwZGF0ZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJBcnJheSIsImlzQXJyYXkiLCJtc2ciLCJzZW5kZXIiLCJyb2xlIiwidGV4dCIsImNvbnRlbnQiLCJ0aW1lc3RhbXAiLCJ1c2VyIiwidW5kZWZpbmVkIiwiYm90Iiwic2Nyb2xsUG9zaXRpb24iLCJ1bnJlYWRfY291bnQiLCJhY3RpdmVTZXNzaW9uSWQiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiY2FjaGVkTWVzc2FnZXMiLCJsb2FkTWVzc2FnZXNGcm9tQ2FjaGUiLCJlIiwiY29uc29sZSIsImVycm9yIiwic2lkIiwic2Vzc2lvbk1lc3NhZ2VzIiwibG9nIiwic2F2ZWRNZXNzYWdlcyIsInBhcnNlZE1lc3NhZ2VzIiwiSlNPTiIsInBhcnNlIiwic3RvcmVkU2Vzc2lvbnMiLCJzZXNzaW9uTWFwIiwicmVkdWNlIiwiYWNjIiwic2Vzc2lvbktleSIsImNyZWF0ZWRfYXQiLCJwcmV2aWV3X21lc3NhZ2UiLCJwcmV2IiwicHJldkFjdGl2ZSIsImFjdGl2ZVNlc3Npb25zIiwiam9pbiIsIm5leHRBY3RpdmUiLCJzIiwicHJldkN1cnJlbnQiLCJjdXJyZW50U2Vzc2lvbklkIiwicHJldkRyYWZ0IiwiZHJhZnRNZXNzYWdlcyIsIm5leHREcmFmdCIsInByZXZTZXNzaW9uc1N0ciIsInN0cmluZ2lmeSIsIm5leHRTZXNzaW9uc1N0ciIsImNoYW5nZWQiLCJ0eXBlIiwicGF5bG9hZCIsImN1cnJlbnRTZXNzaW9uIiwiZmluZCIsInBlcnNpc3RNZXNzYWdlcyIsImFycmF5c0VxdWFsIiwidXBkYXRlZFNlc3Npb25zIiwiYSIsImIiLCJtc2dzIiwibWVzc2FnZXNUb1N0b3JlIiwic2V0SXRlbSIsImluaXRpYWxpemVGcm9tUGVyc2lzdGVkU3RhdGUiLCJzZXRTZXNzaW9uc0Z1bmMiLCJzZXRTZXNzaW9uSWRGdW5jIiwic2Vzc2lvbkV4aXN0cyIsInNvbWUiLCJzeW5jU2Nyb2xsUG9zaXRpb24iLCJwb3NpdGlvbiIsInRvU3RyaW5nIiwiZ2V0U2F2ZWRTY3JvbGxQb3NpdGlvbiIsImxvY2FsUG9zaXRpb24iLCJwYXJzZUludCIsImdldFNhdmVkRHJhZnRNZXNzYWdlIiwibG9jYWxEcmFmdCIsInVwZGF0ZURyYWZ0TWVzc2FnZSIsIm1lc3NhZ2UiLCJjdXJyZW50Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/ChatStatePersistence.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/ErrorBoundary.tsx":
/*!**************************************!*\
  !*** ./components/ErrorBoundary.tsx ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\nclass ErrorBoundary extends react__WEBPACK_IMPORTED_MODULE_1__.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            hasError: false,\n            error: null\n        };\n    }\n    static getDerivedStateFromError(error) {\n        return {\n            hasError: true,\n            error\n        };\n    }\n    componentDidCatch(error, errorInfo) {\n        console.error(`Error in component ${this.props.componentName || 'unknown'}:`, error, errorInfo);\n        if (this.props.onError) {\n            this.props.onError(error, errorInfo);\n        }\n    }\n    render() {\n        if (this.state.hasError) {\n            if (this.props.fallback) {\n                return this.props.fallback;\n            }\n            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"error-boundary p-4 m-2 bg-red-100 border border-red-400 text-red-700 rounded\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                        className: \"font-bold\",\n                        children: [\n                            \"Something went wrong in \",\n                            this.props.componentName || 'this component'\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                        lineNumber: 43,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"details\", {\n                        className: \"whitespace-pre-wrap text-sm mt-2\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"summary\", {\n                                children: \"View error details\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                                lineNumber: 45,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                className: \"mt-1\",\n                                children: this.state.error?.toString()\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                                lineNumber: 46,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                        lineNumber: 44,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/ErrorBoundary.tsx\",\n                lineNumber: 42,\n                columnNumber: 9\n            }, this);\n        }\n        return this.props.children;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ErrorBoundary);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvRXJyb3JCb3VuZGFyeS50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQStEO0FBYy9ELE1BQU1FLHNCQUFzQkQsNENBQVNBO0lBQ25DLFlBQVlFLEtBQVksQ0FBRTtRQUN4QixLQUFLLENBQUNBO1FBQ04sSUFBSSxDQUFDQyxLQUFLLEdBQUc7WUFDWEMsVUFBVTtZQUNWQyxPQUFPO1FBQ1Q7SUFDRjtJQUVBLE9BQU9DLHlCQUF5QkQsS0FBWSxFQUFTO1FBQ25ELE9BQU87WUFBRUQsVUFBVTtZQUFNQztRQUFNO0lBQ2pDO0lBRUFFLGtCQUFrQkYsS0FBWSxFQUFFRyxTQUFvQixFQUFRO1FBQzFEQyxRQUFRSixLQUFLLENBQUMsQ0FBQyxtQkFBbUIsRUFBRSxJQUFJLENBQUNILEtBQUssQ0FBQ1EsYUFBYSxJQUFJLFVBQVUsQ0FBQyxDQUFDLEVBQUVMLE9BQU9HO1FBQ3JGLElBQUksSUFBSSxDQUFDTixLQUFLLENBQUNTLE9BQU8sRUFBRTtZQUN0QixJQUFJLENBQUNULEtBQUssQ0FBQ1MsT0FBTyxDQUFDTixPQUFPRztRQUM1QjtJQUNGO0lBRUFJLFNBQW9CO1FBQ2xCLElBQUksSUFBSSxDQUFDVCxLQUFLLENBQUNDLFFBQVEsRUFBRTtZQUN2QixJQUFJLElBQUksQ0FBQ0YsS0FBSyxDQUFDVyxRQUFRLEVBQUU7Z0JBQ3ZCLE9BQU8sSUFBSSxDQUFDWCxLQUFLLENBQUNXLFFBQVE7WUFDNUI7WUFFQSxxQkFDRSw4REFBQ0M7Z0JBQUlDLFdBQVU7O2tDQUNiLDhEQUFDQzt3QkFBR0QsV0FBVTs7NEJBQVk7NEJBQXlCLElBQUksQ0FBQ2IsS0FBSyxDQUFDUSxhQUFhLElBQUk7Ozs7Ozs7a0NBQy9FLDhEQUFDTzt3QkFBUUYsV0FBVTs7MENBQ2pCLDhEQUFDRzswQ0FBUTs7Ozs7OzBDQUNULDhEQUFDQztnQ0FBRUosV0FBVTswQ0FBUSxJQUFJLENBQUNaLEtBQUssQ0FBQ0UsS0FBSyxFQUFFZTs7Ozs7Ozs7Ozs7Ozs7Ozs7O1FBSS9DO1FBRUEsT0FBTyxJQUFJLENBQUNsQixLQUFLLENBQUNtQixRQUFRO0lBQzVCO0FBQ0Y7QUFFQSxpRUFBZXBCLGFBQWFBLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy93b25rYXN3b3JsZC9Eb3dubG9hZHMvZ3JhY2UtcHJvamVjdC9zcmMvdWkvY29tcG9uZW50cy9FcnJvckJvdW5kYXJ5LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50LCBFcnJvckluZm8sIFJlYWN0Tm9kZSB9IGZyb20gJ3JlYWN0JztcblxuaW50ZXJmYWNlIFByb3BzIHtcbiAgY2hpbGRyZW46IFJlYWN0Tm9kZTtcbiAgZmFsbGJhY2s/OiBSZWFjdE5vZGU7XG4gIG9uRXJyb3I/OiAoZXJyb3I6IEVycm9yLCBlcnJvckluZm86IEVycm9ySW5mbykgPT4gdm9pZDtcbiAgY29tcG9uZW50TmFtZT86IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgaGFzRXJyb3I6IGJvb2xlYW47XG4gIGVycm9yOiBFcnJvciB8IG51bGw7XG59XG5cbmNsYXNzIEVycm9yQm91bmRhcnkgZXh0ZW5kcyBDb21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0geyBcbiAgICAgIGhhc0Vycm9yOiBmYWxzZSxcbiAgICAgIGVycm9yOiBudWxsXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBnZXREZXJpdmVkU3RhdGVGcm9tRXJyb3IoZXJyb3I6IEVycm9yKTogU3RhdGUge1xuICAgIHJldHVybiB7IGhhc0Vycm9yOiB0cnVlLCBlcnJvciB9O1xuICB9XG5cbiAgY29tcG9uZW50RGlkQ2F0Y2goZXJyb3I6IEVycm9yLCBlcnJvckluZm86IEVycm9ySW5mbyk6IHZvaWQge1xuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGluIGNvbXBvbmVudCAke3RoaXMucHJvcHMuY29tcG9uZW50TmFtZSB8fCAndW5rbm93bid9OmAsIGVycm9yLCBlcnJvckluZm8pO1xuICAgIGlmICh0aGlzLnByb3BzLm9uRXJyb3IpIHtcbiAgICAgIHRoaXMucHJvcHMub25FcnJvcihlcnJvciwgZXJyb3JJbmZvKTtcbiAgICB9XG4gIH1cblxuICByZW5kZXIoKTogUmVhY3ROb2RlIHtcbiAgICBpZiAodGhpcy5zdGF0ZS5oYXNFcnJvcikge1xuICAgICAgaWYgKHRoaXMucHJvcHMuZmFsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZmFsbGJhY2s7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZXJyb3ItYm91bmRhcnkgcC00IG0tMiBiZy1yZWQtMTAwIGJvcmRlciBib3JkZXItcmVkLTQwMCB0ZXh0LXJlZC03MDAgcm91bmRlZFwiPlxuICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJmb250LWJvbGRcIj5Tb21ldGhpbmcgd2VudCB3cm9uZyBpbiB7dGhpcy5wcm9wcy5jb21wb25lbnROYW1lIHx8ICd0aGlzIGNvbXBvbmVudCd9PC9oMz5cbiAgICAgICAgICA8ZGV0YWlscyBjbGFzc05hbWU9XCJ3aGl0ZXNwYWNlLXByZS13cmFwIHRleHQtc20gbXQtMlwiPlxuICAgICAgICAgICAgPHN1bW1hcnk+VmlldyBlcnJvciBkZXRhaWxzPC9zdW1tYXJ5PlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwibXQtMVwiPnt0aGlzLnN0YXRlLmVycm9yPy50b1N0cmluZygpfTwvcD5cbiAgICAgICAgICA8L2RldGFpbHM+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5jaGlsZHJlbjtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBFcnJvckJvdW5kYXJ5O1xuIl0sIm5hbWVzIjpbIlJlYWN0IiwiQ29tcG9uZW50IiwiRXJyb3JCb3VuZGFyeSIsInByb3BzIiwic3RhdGUiLCJoYXNFcnJvciIsImVycm9yIiwiZ2V0RGVyaXZlZFN0YXRlRnJvbUVycm9yIiwiY29tcG9uZW50RGlkQ2F0Y2giLCJlcnJvckluZm8iLCJjb25zb2xlIiwiY29tcG9uZW50TmFtZSIsIm9uRXJyb3IiLCJyZW5kZXIiLCJmYWxsYmFjayIsImRpdiIsImNsYXNzTmFtZSIsImgzIiwiZGV0YWlscyIsInN1bW1hcnkiLCJwIiwidG9TdHJpbmciLCJjaGlsZHJlbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/ErrorBoundary.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/LoadingPage.tsx":
/*!************************************!*\
  !*** ./components/LoadingPage.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ LoadingPage)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\n/**\n * LoadingPage component\n * \n * Displays a consistent loading animation for transitions between pages\n * or during authentication processes.\n */ function LoadingPage({ message = 'Loading...', showLogo = true }) {\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"flex min-h-screen items-center justify-center bg-black text-white p-4\",\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"text-center\",\n            children: [\n                showLogo && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"mb-4 text-red-500 text-xl font-bold\",\n                    children: \"Grace\"\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/LoadingPage.tsx\",\n                    lineNumber: 22,\n                    columnNumber: 11\n                }, this),\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"flex items-center justify-center\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                            className: \"mr-2\",\n                            children: message\n                        }, void 0, false, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/LoadingPage.tsx\",\n                            lineNumber: 25,\n                            columnNumber: 11\n                        }, this),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"animate-pulse\",\n                            children: \"...\"\n                        }, void 0, false, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/LoadingPage.tsx\",\n                            lineNumber: 26,\n                            columnNumber: 11\n                        }, this)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/LoadingPage.tsx\",\n                    lineNumber: 24,\n                    columnNumber: 9\n                }, this)\n            ]\n        }, void 0, true, {\n            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/LoadingPage.tsx\",\n            lineNumber: 20,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/LoadingPage.tsx\",\n        lineNumber: 19,\n        columnNumber: 5\n    }, this);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvTG9hZGluZ1BhZ2UudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUEwQjtBQU8xQjs7Ozs7Q0FLQyxHQUNjLFNBQVNDLFlBQVksRUFDbENDLFVBQVUsWUFBWSxFQUN0QkMsV0FBVyxJQUFJLEVBQ0U7SUFDakIscUJBQ0UsOERBQUNDO1FBQUlDLFdBQVU7a0JBQ2IsNEVBQUNEO1lBQUlDLFdBQVU7O2dCQUNaRiwwQkFDQyw4REFBQ0M7b0JBQUlDLFdBQVU7OEJBQXNDOzs7Ozs7OEJBRXZELDhEQUFDRDtvQkFBSUMsV0FBVTs7c0NBQ2IsOERBQUNDOzRCQUFLRCxXQUFVO3NDQUFRSDs7Ozs7O3NDQUN4Qiw4REFBQ0U7NEJBQUlDLFdBQVU7c0NBQWdCOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUt6QyIsInNvdXJjZXMiOlsiL1VzZXJzL3dvbmthc3dvcmxkL0Rvd25sb2Fkcy9ncmFjZS1wcm9qZWN0L3NyYy91aS9jb21wb25lbnRzL0xvYWRpbmdQYWdlLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbnRlcmZhY2UgTG9hZGluZ1BhZ2VQcm9wcyB7XG4gIG1lc3NhZ2U/OiBzdHJpbmc7XG4gIHNob3dMb2dvPzogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBMb2FkaW5nUGFnZSBjb21wb25lbnRcbiAqIFxuICogRGlzcGxheXMgYSBjb25zaXN0ZW50IGxvYWRpbmcgYW5pbWF0aW9uIGZvciB0cmFuc2l0aW9ucyBiZXR3ZWVuIHBhZ2VzXG4gKiBvciBkdXJpbmcgYXV0aGVudGljYXRpb24gcHJvY2Vzc2VzLlxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBMb2FkaW5nUGFnZSh7IFxuICBtZXNzYWdlID0gJ0xvYWRpbmcuLi4nLCBcbiAgc2hvd0xvZ28gPSB0cnVlIFxufTogTG9hZGluZ1BhZ2VQcm9wcykge1xuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBtaW4taC1zY3JlZW4gaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIGJnLWJsYWNrIHRleHQtd2hpdGUgcC00XCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyXCI+XG4gICAgICAgIHtzaG93TG9nbyAmJiAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYi00IHRleHQtcmVkLTUwMCB0ZXh0LXhsIGZvbnQtYm9sZFwiPkdyYWNlPC9kaXY+XG4gICAgICAgICl9XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJtci0yXCI+e21lc3NhZ2V9PC9zcGFuPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYW5pbWF0ZS1wdWxzZVwiPi4uLjwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufVxuIl0sIm5hbWVzIjpbIlJlYWN0IiwiTG9hZGluZ1BhZ2UiLCJtZXNzYWdlIiwic2hvd0xvZ28iLCJkaXYiLCJjbGFzc05hbWUiLCJzcGFuIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/LoadingPage.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/LogoutButton.tsx":
/*!*************************************!*\
  !*** ./components/LogoutButton.tsx ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ LogoutButton)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/router */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/router.js\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _AuthContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n/* harmony import */ var _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/StatePersistence */ \"(pages-dir-node)/./utils/StatePersistence.ts\");\n// src/components/LogoutButton.tsx\n\n\n\n\n\nfunction LogoutButton() {\n    const router = (0,next_router__WEBPACK_IMPORTED_MODULE_2__.useRouter)();\n    const { logout } = (0,_AuthContext__WEBPACK_IMPORTED_MODULE_3__.useAuth)(); // Use the standardized logout function from AuthContext\n    const handleLogout = async ()=>{\n        try {\n            // Clear persistent state snapshot\n            _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_4__[\"default\"].clearSnapshot();\n            // Use the standardized logout function that handles everything\n            await logout();\n            // After successful logout, redirect to login page\n            router.push('/login');\n        } catch (err) {\n            console.error('Logout failed:', err);\n            // Still navigate to login even if the API call fails\n            router.push('/login');\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n        onClick: handleLogout,\n        className: \"transition-all hover:text-red-400 pb-1 text-white\",\n        children: \"Logout\"\n    }, void 0, false, {\n        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/LogoutButton.tsx\",\n        lineNumber: 32,\n        columnNumber: 5\n    }, this);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvTG9nb3V0QnV0dG9uLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQSxrQ0FBa0M7O0FBRVI7QUFDYztBQUNBO0FBR3dCO0FBRWpELFNBQVNJO0lBQ3RCLE1BQU1DLFNBQVNKLHNEQUFTQTtJQUN4QixNQUFNLEVBQUVLLE1BQU0sRUFBRSxHQUFHSixxREFBT0EsSUFBSSx3REFBd0Q7SUFFdEYsTUFBTUssZUFBZTtRQUNuQixJQUFJO1lBQ0Ysa0NBQWtDO1lBQ2xDSiw2RUFBcUM7WUFFckMsK0RBQStEO1lBQy9ELE1BQU1HO1lBRU4sa0RBQWtEO1lBQ2xERCxPQUFPSSxJQUFJLENBQUM7UUFDZCxFQUFFLE9BQU9DLEtBQUs7WUFDWkMsUUFBUUMsS0FBSyxDQUFDLGtCQUFrQkY7WUFDaEMscURBQXFEO1lBQ3JETCxPQUFPSSxJQUFJLENBQUM7UUFDZDtJQUNGO0lBRUEscUJBQ0UsOERBQUNJO1FBQ0NDLFNBQVNQO1FBQ1RRLFdBQVU7a0JBQ1g7Ozs7OztBQUlMIiwic291cmNlcyI6WyIvVXNlcnMvd29ua2Fzd29ybGQvRG93bmxvYWRzL2dyYWNlLXByb2plY3Qvc3JjL3VpL2NvbXBvbmVudHMvTG9nb3V0QnV0dG9uLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvY29tcG9uZW50cy9Mb2dvdXRCdXR0b24udHN4XG5cbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICduZXh0L3JvdXRlcic7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnLi9BdXRoQ29udGV4dCc7XG5pbXBvcnQgYXBpIGZyb20gJy4uL2FwaS9hcGlDbGllbnQnO1xuaW1wb3J0IHsgQVBJX0VORFBPSU5UUyB9IGZyb20gJy4uL2FwaS9hcGlDbGllbnQnO1xuaW1wb3J0IFN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyIGZyb20gJy4uL3V0aWxzL1N0YXRlUGVyc2lzdGVuY2UnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBMb2dvdXRCdXR0b24oKSB7XG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xuICBjb25zdCB7IGxvZ291dCB9ID0gdXNlQXV0aCgpOyAvLyBVc2UgdGhlIHN0YW5kYXJkaXplZCBsb2dvdXQgZnVuY3Rpb24gZnJvbSBBdXRoQ29udGV4dFxuXG4gIGNvbnN0IGhhbmRsZUxvZ291dCA9IGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQ2xlYXIgcGVyc2lzdGVudCBzdGF0ZSBzbmFwc2hvdFxuICAgICAgU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXIuY2xlYXJTbmFwc2hvdCgpO1xuICAgICAgXG4gICAgICAvLyBVc2UgdGhlIHN0YW5kYXJkaXplZCBsb2dvdXQgZnVuY3Rpb24gdGhhdCBoYW5kbGVzIGV2ZXJ5dGhpbmdcbiAgICAgIGF3YWl0IGxvZ291dCgpO1xuICAgICAgXG4gICAgICAvLyBBZnRlciBzdWNjZXNzZnVsIGxvZ291dCwgcmVkaXJlY3QgdG8gbG9naW4gcGFnZVxuICAgICAgcm91dGVyLnB1c2goJy9sb2dpbicpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcignTG9nb3V0IGZhaWxlZDonLCBlcnIpO1xuICAgICAgLy8gU3RpbGwgbmF2aWdhdGUgdG8gbG9naW4gZXZlbiBpZiB0aGUgQVBJIGNhbGwgZmFpbHNcbiAgICAgIHJvdXRlci5wdXNoKCcvbG9naW4nKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8YnV0dG9uXG4gICAgICBvbkNsaWNrPXtoYW5kbGVMb2dvdXR9XG4gICAgICBjbGFzc05hbWU9XCJ0cmFuc2l0aW9uLWFsbCBob3Zlcjp0ZXh0LXJlZC00MDAgcGItMSB0ZXh0LXdoaXRlXCJcbiAgICA+XG4gICAgICBMb2dvdXRcbiAgICA8L2J1dHRvbj5cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZVJvdXRlciIsInVzZUF1dGgiLCJTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlciIsIkxvZ291dEJ1dHRvbiIsInJvdXRlciIsImxvZ291dCIsImhhbmRsZUxvZ291dCIsImNsZWFyU25hcHNob3QiLCJwdXNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYnV0dG9uIiwib25DbGljayIsImNsYXNzTmFtZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/LogoutButton.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/StateLoader.tsx":
/*!************************************!*\
  !*** ./components/StateLoader.tsx ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _context_AppStateContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../context/AppStateContext */ \"(pages-dir-node)/./context/AppStateContext.tsx\");\n/* harmony import */ var _utils_StateBackupService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/StateBackupService */ \"(pages-dir-node)/./utils/StateBackupService.ts\");\n/* harmony import */ var _AuthContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n\n\n\n\n\nconst StateLoader = ({ children })=>{\n    const { isStateLoading, isStateHydrated, isStateRecovered, isStateSyncing, dispatch } = (0,_context_AppStateContext__WEBPACK_IMPORTED_MODULE_2__.useAppState)();\n    const { user, isAuthenticated } = (0,_AuthContext__WEBPACK_IMPORTED_MODULE_4__.useAuth)();\n    const [showSyncNotice, setShowSyncNotice] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [showHydrationNotice, setShowHydrationNotice] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [showRecoveryAttempt, setShowRecoveryAttempt] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const isInitialMount = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(true);\n    const backupService = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const recoveryAttemptMade = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    // Handle sync notice display and auto-hide\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"StateLoader.useEffect\": ()=>{\n            if (isStateSyncing) {\n                setShowSyncNotice(true);\n                // Auto-hide sync notice after 3 seconds\n                const timer = setTimeout({\n                    \"StateLoader.useEffect.timer\": ()=>setShowSyncNotice(false)\n                }[\"StateLoader.useEffect.timer\"], 3000);\n                return ({\n                    \"StateLoader.useEffect\": ()=>clearTimeout(timer)\n                })[\"StateLoader.useEffect\"];\n            }\n        }\n    }[\"StateLoader.useEffect\"], [\n        isStateSyncing\n    ]);\n    // Initialize the state backup service\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"StateLoader.useEffect\": ()=>{\n            if (isAuthenticated && user) {\n                try {\n                    // Initialize the backup service\n                    const service = _utils_StateBackupService__WEBPACK_IMPORTED_MODULE_3__[\"default\"].getInstance();\n                    backupService.current = service;\n                    service.initialize().then({\n                        \"StateLoader.useEffect\": (success)=>{\n                            console.log(`State backup service initialized: ${success ? 'success' : 'fallback mode'}`);\n                        }\n                    }[\"StateLoader.useEffect\"]);\n                } catch (error) {\n                    console.error('Failed to initialize state backup service:', error);\n                }\n            }\n            return ({\n                \"StateLoader.useEffect\": ()=>{\n                    // Clean up backup service on unmount\n                    if (backupService.current) {\n                        backupService.current.stopPeriodicBackup();\n                    }\n                }\n            })[\"StateLoader.useEffect\"];\n        }\n    }[\"StateLoader.useEffect\"], [\n        isAuthenticated,\n        user\n    ]);\n    // Attempt recovery if needed\n    const attemptStateRecovery = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"StateLoader.useCallback[attemptStateRecovery]\": async ()=>{\n            if (!isStateHydrated && !isStateLoading && !recoveryAttemptMade.current) {\n                recoveryAttemptMade.current = true;\n                setShowRecoveryAttempt(true);\n                try {\n                    if (backupService.current) {\n                        const recoveredState = await backupService.current.attemptRecovery();\n                        if (recoveredState) {\n                            console.log('Successfully recovered state from backup source');\n                            dispatch({\n                                type: 'HYDRATE_STATE',\n                                payload: recoveredState\n                            });\n                            setShowHydrationNotice(true);\n                            setTimeout({\n                                \"StateLoader.useCallback[attemptStateRecovery]\": ()=>setShowHydrationNotice(false)\n                            }[\"StateLoader.useCallback[attemptStateRecovery]\"], 3000);\n                        }\n                    }\n                } catch (error) {\n                    console.error('Error during state recovery attempt:', error);\n                } finally{\n                    setShowRecoveryAttempt(false);\n                }\n            }\n        }\n    }[\"StateLoader.useCallback[attemptStateRecovery]\"], [\n        dispatch,\n        isStateHydrated,\n        isStateLoading\n    ]);\n    // Trigger recovery attempt if state is not hydrated\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"StateLoader.useEffect\": ()=>{\n            if (isAuthenticated && !isStateHydrated && !isStateLoading) {\n                const timer = setTimeout({\n                    \"StateLoader.useEffect.timer\": ()=>{\n                        attemptStateRecovery();\n                    }\n                }[\"StateLoader.useEffect.timer\"], 1000); // Wait 1 second before attempting recovery\n                return ({\n                    \"StateLoader.useEffect\": ()=>clearTimeout(timer)\n                })[\"StateLoader.useEffect\"];\n            }\n        }\n    }[\"StateLoader.useEffect\"], [\n        isAuthenticated,\n        isStateHydrated,\n        isStateLoading,\n        attemptStateRecovery\n    ]);\n    // Handle hydration notice only for non-initial state hydrations\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"StateLoader.useEffect\": ()=>{\n            // Skip the initial mount effect - this prevents showing notification on first load\n            if (isInitialMount.current) {\n                isInitialMount.current = false;\n                return;\n            }\n            // Only show hydration notice for subsequent hydrations\n            if (isStateHydrated && !isStateLoading) {\n                setShowHydrationNotice(true);\n                const timer = setTimeout({\n                    \"StateLoader.useEffect.timer\": ()=>setShowHydrationNotice(false)\n                }[\"StateLoader.useEffect.timer\"], 3000);\n                return ({\n                    \"StateLoader.useEffect\": ()=>clearTimeout(timer)\n                })[\"StateLoader.useEffect\"];\n            }\n        }\n    }[\"StateLoader.useEffect\"], [\n        isStateHydrated,\n        isStateLoading\n    ]);\n    if (isStateLoading || showRecoveryAttempt) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-gray-900 p-6 rounded-lg shadow-lg text-center\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-gold mx-auto mb-4\"\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 108,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                        className: \"text-xl font-semibold text-gold mb-2\",\n                        children: showRecoveryAttempt ? 'Recovering Your Data' : 'Loading Your Trading State'\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 109,\n                        columnNumber: 11\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-gray-400\",\n                        children: showRecoveryAttempt ? 'Attempting to recover your session data...' : 'Restoring your previous session...'\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 112,\n                        columnNumber: 11\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                lineNumber: 107,\n                columnNumber: 9\n            }, undefined)\n        }, void 0, false, {\n            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n            lineNumber: 106,\n            columnNumber: 7\n        }, undefined);\n    }\n    // Show recovery notification if state was recovered from corruption\n    if (isStateRecovered) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"fixed bottom-4 right-4 bg-gray-900 text-yellow-500 px-4 py-2 rounded shadow-lg  border border-yellow-600 transition-opacity duration-1000 z-40\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                xmlns: \"http://www.w3.org/2000/svg\",\n                                className: \"h-5 w-5 mr-2\",\n                                fill: \"none\",\n                                viewBox: \"0 0 24 24\",\n                                stroke: \"currentColor\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                    strokeLinecap: \"round\",\n                                    strokeLinejoin: \"round\",\n                                    strokeWidth: 2,\n                                    d: \"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                    lineNumber: 130,\n                                    columnNumber: 15\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 129,\n                                columnNumber: 13\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                children: \"Session was partially recovered due to data corruption\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 132,\n                                columnNumber: 13\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 128,\n                        columnNumber: 11\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                    lineNumber: 126,\n                    columnNumber: 9\n                }, undefined),\n                children\n            ]\n        }, void 0, true);\n    }\n    // Show a brief flash notification when state is hydrated but not on initial load\n    if (showHydrationNotice) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"fixed bottom-4 right-4 bg-gray-900 text-green-400 px-4 py-2 rounded shadow-lg  transition-opacity duration-1000 z-40\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                xmlns: \"http://www.w3.org/2000/svg\",\n                                className: \"h-5 w-5 mr-2\",\n                                fill: \"none\",\n                                viewBox: \"0 0 24 24\",\n                                stroke: \"currentColor\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                    strokeLinecap: \"round\",\n                                    strokeLinejoin: \"round\",\n                                    strokeWidth: 2,\n                                    d: \"M5 13l4 4L19 7\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                    lineNumber: 148,\n                                    columnNumber: 15\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 147,\n                                columnNumber: 13\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                children: \"Session restored successfully\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 150,\n                                columnNumber: 13\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 146,\n                        columnNumber: 11\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                    lineNumber: 144,\n                    columnNumber: 9\n                }, undefined),\n                children\n            ]\n        }, void 0, true);\n    }\n    // Show cross-tab sync notification\n    if (showSyncNotice) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n            children: [\n                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"fixed bottom-4 right-4 bg-gray-800 text-blue-400 px-4 py-2 rounded shadow-lg  transition-opacity duration-300 z-40 border border-blue-600\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                xmlns: \"http://www.w3.org/2000/svg\",\n                                className: \"h-5 w-5 mr-2 animate-pulse\",\n                                fill: \"none\",\n                                viewBox: \"0 0 24 24\",\n                                stroke: \"currentColor\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                    strokeLinecap: \"round\",\n                                    strokeLinejoin: \"round\",\n                                    strokeWidth: 2,\n                                    d: \"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                    lineNumber: 166,\n                                    columnNumber: 15\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 165,\n                                columnNumber: 13\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                children: \"Syncing state from another tab...\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                                lineNumber: 168,\n                                columnNumber: 13\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                        lineNumber: 164,\n                        columnNumber: 11\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/StateLoader.tsx\",\n                    lineNumber: 162,\n                    columnNumber: 9\n                }, undefined),\n                children\n            ]\n        }, void 0, true);\n    }\n    // Default render\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: children\n    }, void 0, false);\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StateLoader);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvU3RhdGVMb2FkZXIudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF3RTtBQUNmO0FBQ0k7QUFDckI7QUFNeEMsTUFBTVEsY0FBMEMsQ0FBQyxFQUFFQyxRQUFRLEVBQUU7SUFDM0QsTUFBTSxFQUFFQyxjQUFjLEVBQUVDLGVBQWUsRUFBRUMsZ0JBQWdCLEVBQUVDLGNBQWMsRUFBRUMsUUFBUSxFQUFFLEdBQUdULHFFQUFXQTtJQUNuRyxNQUFNLEVBQUVVLElBQUksRUFBRUMsZUFBZSxFQUFFLEdBQUdULHFEQUFPQTtJQUN6QyxNQUFNLENBQUNVLGdCQUFnQkMsa0JBQWtCLEdBQUdoQiwrQ0FBUUEsQ0FBQztJQUNyRCxNQUFNLENBQUNpQixxQkFBcUJDLHVCQUF1QixHQUFHbEIsK0NBQVFBLENBQUM7SUFDL0QsTUFBTSxDQUFDbUIscUJBQXFCQyx1QkFBdUIsR0FBR3BCLCtDQUFRQSxDQUFDO0lBQy9ELE1BQU1xQixpQkFBaUJwQiw2Q0FBTUEsQ0FBQztJQUM5QixNQUFNcUIsZ0JBQWdCckIsNkNBQU1BLENBQTRCO0lBQ3hELE1BQU1zQixzQkFBc0J0Qiw2Q0FBTUEsQ0FBQztJQUVuQywyQ0FBMkM7SUFDM0NGLGdEQUFTQTtpQ0FBQztZQUNSLElBQUlZLGdCQUFnQjtnQkFDbEJLLGtCQUFrQjtnQkFDbEIsd0NBQXdDO2dCQUN4QyxNQUFNUSxRQUFRQzttREFBVyxJQUFNVCxrQkFBa0I7a0RBQVE7Z0JBQ3pEOzZDQUFPLElBQU1VLGFBQWFGOztZQUM1QjtRQUNGO2dDQUFHO1FBQUNiO0tBQWU7SUFFbkIsc0NBQXNDO0lBQ3RDWixnREFBU0E7aUNBQUM7WUFDUixJQUFJZSxtQkFBbUJELE1BQU07Z0JBQzNCLElBQUk7b0JBQ0YsZ0NBQWdDO29CQUNoQyxNQUFNYyxVQUFVdkIsNkVBQThCO29CQUM5Q2tCLGNBQWNPLE9BQU8sR0FBR0Y7b0JBQ3hCQSxRQUFRRyxVQUFVLEdBQUdDLElBQUk7aURBQUNDLENB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QUVBLGlGQUFpRjtJQUNqRixJQUFJVSxxQkFBcUI7UUFDdkIscUJBQ0U7OzhCQUNFLDhEQUFDeUI7b0JBQUlDLFdBQVU7OEJBRWIsNEVBQUNEO3dCQUFJQyxXQUFVOzswQ0FDYiw4REFBQ0c7Z0NBQUlDLE9BQU07Z0NBQTZCSixXQUFVO2dDQUFlSyxNQUFLO2dDQUFPQyxTQUFRO2dDQUFZQyxRQUFPOzBDQUN0Ryw0RUFBQ0M7b0NBQUtDLGVBQWM7b0NBQVFDLGdCQUFlO29DQUFRQyxhQUFhO29DQUFHQyxHQUFFOzs7Ozs7Ozs7OzswQ0FFdkUsOERBQUNDOzBDQUFLOzs7Ozs7Ozs7Ozs7Ozs7OztnQkFHVGpEOzs7SUFHUDtJQUVBLG1DQUFtQztJQUNuQyxJQUFJUSxnQkFBZ0I7UUFDbEIscUJBQ0U7OzhCQUNFLDhEQUFDMkI7b0JBQUlDLFdBQVU7OEJBRWIsNEVBQUNEO3dCQUFJQyxXQUFVOzswQ0FDYiw4REFBQ0c7Z0NBQUlDLE9BQU07Z0NBQTZCSixXQUFVO2dDQUE2QkssTUFBSztnQ0FBT0MsU0FBUTtnQ0FBWUMsUUFBTzswQ0FDcEgsNEVBQUNDO29DQUFLQyxlQUFjO29DQUFRQyxnQkFBZTtvQ0FBUUMsYUFBYTtvQ0FBR0MsR0FBRTs7Ozs7Ozs7Ozs7MENBRXZFLDhEQUFDQzswQ0FBSzs7Ozs7Ozs7Ozs7Ozs7Ozs7Z0JBR1RqRDs7O0lBR1A7SUFFQSxpQkFBaUI7SUFDakIscUJBQU87a0JBQUdBOztBQUNaO0FBRUEsaUVBQWVELFdBQVdBLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy93b25rYXN3b3JsZC9Eb3dubG9hZHMvZ3JhY2UtcHJvamVjdC9zcmMvdWkvY29tcG9uZW50cy9TdGF0ZUxvYWRlci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZVJlZiwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VBcHBTdGF0ZSB9IGZyb20gJy4uL2NvbnRleHQvQXBwU3RhdGVDb250ZXh0JztcbmltcG9ydCBTdGF0ZUJhY2t1cFNlcnZpY2UgZnJvbSAnLi4vdXRpbHMvU3RhdGVCYWNrdXBTZXJ2aWNlJztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuL0F1dGhDb250ZXh0JztcblxuaW50ZXJmYWNlIFN0YXRlTG9hZGVyUHJvcHMge1xuICBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlO1xufVxuXG5jb25zdCBTdGF0ZUxvYWRlcjogUmVhY3QuRkM8U3RhdGVMb2FkZXJQcm9wcz4gPSAoeyBjaGlsZHJlbiB9KSA9PiB7XG4gIGNvbnN0IHsgaXNTdGF0ZUxvYWRpbmcsIGlzU3RhdGVIeWRyYXRlZCwgaXNTdGF0ZVJlY292ZXJlZCwgaXNTdGF0ZVN5bmNpbmcsIGRpc3BhdGNoIH0gPSB1c2VBcHBTdGF0ZSgpO1xuICBjb25zdCB7IHVzZXIsIGlzQXV0aGVudGljYXRlZCB9ID0gdXNlQXV0aCgpO1xuICBjb25zdCBbc2hvd1N5bmNOb3RpY2UsIHNldFNob3dTeW5jTm90aWNlXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW3Nob3dIeWRyYXRpb25Ob3RpY2UsIHNldFNob3dIeWRyYXRpb25Ob3RpY2VdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2hvd1JlY292ZXJ5QXR0ZW1wdCwgc2V0U2hvd1JlY292ZXJ5QXR0ZW1wdF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGlzSW5pdGlhbE1vdW50ID0gdXNlUmVmKHRydWUpO1xuICBjb25zdCBiYWNrdXBTZXJ2aWNlID0gdXNlUmVmPFN0YXRlQmFja3VwU2VydmljZSB8IG51bGw+KG51bGwpO1xuICBjb25zdCByZWNvdmVyeUF0dGVtcHRNYWRlID0gdXNlUmVmKGZhbHNlKTtcbiAgXG4gIC8vIEhhbmRsZSBzeW5jIG5vdGljZSBkaXNwbGF5IGFuZCBhdXRvLWhpZGVcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoaXNTdGF0ZVN5bmNpbmcpIHtcbiAgICAgIHNldFNob3dTeW5jTm90aWNlKHRydWUpO1xuICAgICAgLy8gQXV0by1oaWRlIHN5bmMgbm90aWNlIGFmdGVyIDMgc2Vjb25kc1xuICAgICAgY29uc3QgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHNldFNob3dTeW5jTm90aWNlKGZhbHNlKSwgMzAwMCk7XG4gICAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICB9XG4gIH0sIFtpc1N0YXRlU3luY2luZ10pO1xuICBcbiAgLy8gSW5pdGlhbGl6ZSB0aGUgc3RhdGUgYmFja3VwIHNlcnZpY2VcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoaXNBdXRoZW50aWNhdGVkICYmIHVzZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIEluaXRpYWxpemUgdGhlIGJhY2t1cCBzZXJ2aWNlXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBTdGF0ZUJhY2t1cFNlcnZpY2UuZ2V0SW5zdGFuY2UoKTtcbiAgICAgICAgYmFja3VwU2VydmljZS5jdXJyZW50ID0gc2VydmljZTtcbiAgICAgICAgc2VydmljZS5pbml0aWFsaXplKCkudGhlbihzdWNjZXNzID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgU3RhdGUgYmFja3VwIHNlcnZpY2UgaW5pdGlhbGl6ZWQ6ICR7c3VjY2VzcyA/ICdzdWNjZXNzJyA6ICdmYWxsYmFjayBtb2RlJ31gKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBzdGF0ZSBiYWNrdXAgc2VydmljZTonLCBlcnJvcik7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAvLyBDbGVhbiB1cCBiYWNrdXAgc2VydmljZSBvbiB1bm1vdW50XG4gICAgICBpZiAoYmFja3VwU2VydmljZS5jdXJyZW50KSB7XG4gICAgICAgIGJhY2t1cFNlcnZpY2UuY3VycmVudC5zdG9wUGVyaW9kaWNCYWNrdXAoKTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbaXNBdXRoZW50aWNhdGVkLCB1c2VyXSk7XG4gIFxuICAvLyBBdHRlbXB0IHJlY292ZXJ5IGlmIG5lZWRlZFxuICBjb25zdCBhdHRlbXB0U3RhdGVSZWNvdmVyeSA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWlzU3RhdGVIeWRyYXRlZCAmJiAhaXNTdGF0ZUxvYWRpbmcgJiYgIXJlY292ZXJ5QXR0ZW1wdE1hZGUuY3VycmVudCkge1xuICAgICAgcmVjb3ZlcnlBdHRlbXB0TWFkZS5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgIHNldFNob3dSZWNvdmVyeUF0dGVtcHQodHJ1ZSk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChiYWNrdXBTZXJ2aWNlLmN1cnJlbnQpIHtcbiAgICAgICAgICBjb25zdCByZWNvdmVyZWRTdGF0ZSA9IGF3YWl0IGJhY2t1cFNlcnZpY2UuY3VycmVudC5hdHRlbXB0UmVjb3ZlcnkoKTtcbiAgICAgICAgICBpZiAocmVjb3ZlcmVkU3RhdGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgcmVjb3ZlcmVkIHN0YXRlIGZyb20gYmFja3VwIHNvdXJjZScpO1xuICAgICAgICAgICAgZGlzcGF0Y2goeyB0eXBlOiAnSFlEUkFURV9TVEFURScsIHBheWxvYWQ6IHJlY292ZXJlZFN0YXRlIH0pO1xuICAgICAgICAgICAgc2V0U2hvd0h5ZHJhdGlvbk5vdGljZSh0cnVlKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gc2V0U2hvd0h5ZHJhdGlvbk5vdGljZShmYWxzZSksIDMwMDApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZHVyaW5nIHN0YXRlIHJlY292ZXJ5IGF0dGVtcHQ6JywgZXJyb3IpO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgc2V0U2hvd1JlY292ZXJ5QXR0ZW1wdChmYWxzZSk7XG4gICAgICB9XG4gICAgfVxuICB9LCBbZGlzcGF0Y2gsIGlzU3RhdGVIeWRyYXRlZCwgaXNTdGF0ZUxvYWRpbmddKTtcbiAgXG4gIC8vIFRyaWdnZXIgcmVjb3ZlcnkgYXR0ZW1wdCBpZiBzdGF0ZSBpcyBub3QgaHlkcmF0ZWRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoaXNBdXRoZW50aWNhdGVkICYmICFpc1N0YXRlSHlkcmF0ZWQgJiYgIWlzU3RhdGVMb2FkaW5nKSB7XG4gICAgICBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBhdHRlbXB0U3RhdGVSZWNvdmVyeSgpO1xuICAgICAgfSwgMTAwMCk7IC8vIFdhaXQgMSBzZWNvbmQgYmVmb3JlIGF0dGVtcHRpbmcgcmVjb3ZlcnlcbiAgICAgIFxuICAgICAgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgfVxuICB9LCBbaXNBdXRoZW50aWNhdGVkLCBpc1N0YXRlSHlkcmF0ZWQsIGlzU3RhdGVMb2FkaW5nLCBhdHRlbXB0U3RhdGVSZWNvdmVyeV0pO1xuXG4gIC8vIEhhbmRsZSBoeWRyYXRpb24gbm90aWNlIG9ubHkgZm9yIG5vbi1pbml0aWFsIHN0YXRlIGh5ZHJhdGlvbnNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBTa2lwIHRoZSBpbml0aWFsIG1vdW50IGVmZmVjdCAtIHRoaXMgcHJldmVudHMgc2hvd2luZyBub3RpZmljYXRpb24gb24gZmlyc3QgbG9hZFxuICAgIGlmIChpc0luaXRpYWxNb3VudC5jdXJyZW50KSB7XG4gICAgICBpc0luaXRpYWxNb3VudC5jdXJyZW50ID0gZmFsc2U7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIE9ubHkgc2hvdyBoeWRyYXRpb24gbm90aWNlIGZvciBzdWJzZXF1ZW50IGh5ZHJhdGlvbnNcbiAgICBpZiAoaXNTdGF0ZUh5ZHJhdGVkICYmICFpc1N0YXRlTG9hZGluZykge1xuICAgICAgc2V0U2hvd0h5ZHJhdGlvbk5vdGljZSh0cnVlKTtcbiAgICAgIGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiBzZXRTaG93SHlkcmF0aW9uTm90aWNlKGZhbHNlKSwgMzAwMCk7XG4gICAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICB9XG4gIH0sIFtpc1N0YXRlSHlkcmF0ZWQsIGlzU3RhdGVMb2FkaW5nXSk7XG5cbiAgaWYgKGlzU3RhdGVMb2FkaW5nIHx8IHNob3dSZWNvdmVyeUF0dGVtcHQpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBpbnNldC0wIGJnLWJsYWNrIGJnLW9wYWNpdHktNzUgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgei01MFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLWdyYXktOTAwIHAtNiByb3VuZGVkLWxnIHNoYWRvdy1sZyB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYW5pbWF0ZS1zcGluIHJvdW5kZWQtZnVsbCBoLTEyIHctMTIgYm9yZGVyLXQtMiBib3JkZXItYi0yIGJvcmRlci1nb2xkIG14LWF1dG8gbWItNFwiPjwvZGl2PlxuICAgICAgICAgIDxoMyBjbGFzc05hbWU9XCJ0ZXh0LXhsIGZvbnQtc2VtaWJvbGQgdGV4dC1nb2xkIG1iLTJcIj5cbiAgICAgICAgICAgIHtzaG93UmVjb3ZlcnlBdHRlbXB0ID8gJ1JlY292ZXJpbmcgWW91ciBEYXRhJyA6ICdMb2FkaW5nIFlvdXIgVHJhZGluZyBTdGF0ZSd9XG4gICAgICAgICAgPC9oMz5cbiAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LWdyYXktNDAwXCI+XG4gICAgICAgICAgICB7c2hvd1JlY292ZXJ5QXR0ZW1wdCBcbiAgICAgICAgICAgICAgPyAnQXR0ZW1wdGluZyB0byByZWNvdmVyIHlvdXIgc2Vzc2lvbiBkYXRhLi4uJyBcbiAgICAgICAgICAgICAgOiAnUmVzdG9yaW5nIHlvdXIgcHJldmlvdXMgc2Vzc2lvbi4uLid9XG4gICAgICAgICAgPC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICAvLyBTaG93IHJlY292ZXJ5IG5vdGlmaWNhdGlvbiBpZiBzdGF0ZSB3YXMgcmVjb3ZlcmVkIGZyb20gY29ycnVwdGlvblxuICBpZiAoaXNTdGF0ZVJlY292ZXJlZCkge1xuICAgIHJldHVybiAoXG4gICAgICA8PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpeGVkIGJvdHRvbS00IHJpZ2h0LTQgYmctZ3JheS05MDAgdGV4dC15ZWxsb3ctNTAwIHB4LTQgcHktMiByb3VuZGVkIHNoYWRvdy1sZyBcbiAgICAgICAgICAgICAgICAgICAgICBib3JkZXIgYm9yZGVyLXllbGxvdy02MDAgdHJhbnNpdGlvbi1vcGFjaXR5IGR1cmF0aW9uLTEwMDAgei00MFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzTmFtZT1cImgtNSB3LTUgbXItMlwiIGZpbGw9XCJub25lXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiPlxuICAgICAgICAgICAgICA8cGF0aCBzdHJva2VMaW5lY2FwPVwicm91bmRcIiBzdHJva2VMaW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlV2lkdGg9ezJ9IGQ9XCJNMTIgOXYybTAgNGguMDFtLTYuOTM4IDRoMTMuODU2YzEuNTQgMCAyLjUwMi0xLjY2NyAxLjczMi0zTDEzLjczMiA0Yy0uNzctMS4zMzMtMi42OTQtMS4zMzMtMy40NjQgMEwzLjM0IDE2Yy0uNzcgMS4zMzMuMTkyIDMgMS43MzIgM3pcIiAvPlxuICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICA8c3Bhbj5TZXNzaW9uIHdhcyBwYXJ0aWFsbHkgcmVjb3ZlcmVkIGR1ZSB0byBkYXRhIGNvcnJ1cHRpb248L3NwYW4+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICB7Y2hpbGRyZW59XG4gICAgICA8Lz5cbiAgICApO1xuICB9XG4gIFxuICAvLyBTaG93IGEgYnJpZWYgZmxhc2ggbm90aWZpY2F0aW9uIHdoZW4gc3RhdGUgaXMgaHlkcmF0ZWQgYnV0IG5vdCBvbiBpbml0aWFsIGxvYWRcbiAgaWYgKHNob3dIeWRyYXRpb25Ob3RpY2UpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPD5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmaXhlZCBib3R0b20tNCByaWdodC00IGJnLWdyYXktOTAwIHRleHQtZ3JlZW4tNDAwIHB4LTQgcHktMiByb3VuZGVkIHNoYWRvdy1sZyBcbiAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbi1vcGFjaXR5IGR1cmF0aW9uLTEwMDAgei00MFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzTmFtZT1cImgtNSB3LTUgbXItMlwiIGZpbGw9XCJub25lXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiPlxuICAgICAgICAgICAgICA8cGF0aCBzdHJva2VMaW5lY2FwPVwicm91bmRcIiBzdHJva2VMaW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlV2lkdGg9ezJ9IGQ9XCJNNSAxM2w0IDRMMTkgN1wiIC8+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgIDxzcGFuPlNlc3Npb24gcmVzdG9yZWQgc3VjY2Vzc2Z1bGx5PC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgPC8+XG4gICAgKTtcbiAgfVxuICBcbiAgLy8gU2hvdyBjcm9zcy10YWIgc3luYyBub3RpZmljYXRpb25cbiAgaWYgKHNob3dTeW5jTm90aWNlKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDw+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZml4ZWQgYm90dG9tLTQgcmlnaHQtNCBiZy1ncmF5LTgwMCB0ZXh0LWJsdWUtNDAwIHB4LTQgcHktMiByb3VuZGVkIHNoYWRvdy1sZyBcbiAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbi1vcGFjaXR5IGR1cmF0aW9uLTMwMCB6LTQwIGJvcmRlciBib3JkZXItYmx1ZS02MDBcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyXCI+XG4gICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBjbGFzc05hbWU9XCJoLTUgdy01IG1yLTIgYW5pbWF0ZS1wdWxzZVwiIGZpbGw9XCJub25lXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiPlxuICAgICAgICAgICAgICA8cGF0aCBzdHJva2VMaW5lY2FwPVwicm91bmRcIiBzdHJva2VMaW5lam9pbj1cInJvdW5kXCIgc3Ryb2tlV2lkdGg9ezJ9IGQ9XCJNNCA0djVoLjU4Mm0xNS4zNTYgMkE4LjAwMSA4LjAwMSAwIDAwNC41ODIgOW0wIDBIOW0xMSAxMXYtNWgtLjU4MW0wIDBhOC4wMDMgOC4wMDMgMCAwMS0xNS4zNTctMm0xNS4zNTcgMkgxNVwiIC8+XG4gICAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgICAgIDxzcGFuPlN5bmNpbmcgc3RhdGUgZnJvbSBhbm90aGVyIHRhYi4uLjwvc3Bhbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIHtjaGlsZHJlbn1cbiAgICAgIDwvPlxuICAgICk7XG4gIH1cblxuICAvLyBEZWZhdWx0IHJlbmRlclxuICByZXR1cm4gPD57Y2hpbGRyZW59PC8+O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgU3RhdGVMb2FkZXI7XG4iXSwibmFtZXMiOlsiUmVhY3QiLCJ1c2VFZmZlY3QiLCJ1c2VTdGF0ZSIsInVzZVJlZiIsInVzZUNhbGxiYWNrIiwidXNlQXBwU3RhdGUiLCJTdGF0ZUJhY2t1cFNlcnZpY2UiLCJ1c2VBdXRoIiwiU3RhdGVMb2FkZXIiLCJjaGlsZHJlbiIsImlzU3RhdGVMb2FkaW5nIiwiaXNTdGF0ZUh5ZHJhdGVkIiwiaXNTdGF0ZVJlY292ZXJlZCIsImlzU3RhdGVTeW5jaW5nIiwiZGlzcGF0Y2giLCJ1c2VyIiwiaXNBdXRoZW50aWNhdGVkIiwic2hvd1N5bmNOb3RpY2UiLCJzZXRTaG93U3luY05vdGljZSIsInNob3dIeWRyYXRpb25Ob3RpY2UiLCJzZXRTaG93SHlkcmF0aW9uTm90aWNlIiwic2hvd1JlY292ZXJ5QXR0ZW1wdCIsInNldFNob3dSZWNvdmVyeUF0dGVtcHQiLCJpc0luaXRpYWxNb3VudCIsImJhY2t1cFNlcnZpY2UiLCJyZWNvdmVyeUF0dGVtcHRNYWRlIiwidGltZXIiLCJzZXRUaW1lb3V0IiwiY2xlYXJUaW1lb3V0Iiwic2VydmljZSIsImdldEluc3RhbmNlIiwiY3VycmVudCIsImluaXRpYWxpemUiLCJ0aGVuIiwic3VjY2VzcyIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsInN0b3BQZXJpb2RpY0JhY2t1cCIsImF0dGVtcHRTdGF0ZVJlY292ZXJ5IiwicmVjb3ZlcmVkU3RhdGUiLCJhdHRlbXB0UmVjb3ZlcnkiLCJ0eXBlIiwicGF5bG9hZCIsImRpdiIsImNsYXNzTmFtZSIsImgzIiwicCIsInN2ZyIsInhtbG5zIiwiZmlsbCIsInZpZXdCb3giLCJzdHJva2UiLCJwYXRoIiwic3Ryb2tlTGluZWNhcCIsInN0cm9rZUxpbmVqb2luIiwic3Ryb2tlV2lkdGgiLCJkIiwic3BhbiJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/StateLoader.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./components/XFeed.tsx":
/*!******************************!*\
  !*** ./components/XFeed.tsx ***!
  \******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _barrel_optimize_names_ArrowPathIcon_ArrowPathRoundedSquareIcon_Cog6ToothIcon_HeartIcon_PlusIcon_TrashIcon_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! __barrel_optimize__?names=ArrowPathIcon,ArrowPathRoundedSquareIcon,Cog6ToothIcon,HeartIcon,PlusIcon,TrashIcon!=!@heroicons/react/24/outline */ \"(pages-dir-node)/__barrel_optimize__?names=ArrowPathIcon,ArrowPathRoundedSquareIcon,Cog6ToothIcon,HeartIcon,PlusIcon,TrashIcon!=!./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/index.js\");\n/* harmony import */ var _barrel_optimize_names_Dialog_Transition_headlessui_react__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! __barrel_optimize__?names=Dialog,Transition!=!@headlessui/react */ \"(pages-dir-node)/__barrel_optimize__?names=Dialog,Transition!=!./node_modules/.pnpm/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/@headlessui/react/dist/headlessui.esm.js\");\n/* harmony import */ var _context_AppStateContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../context/AppStateContext */ \"(pages-dir-node)/./context/AppStateContext.tsx\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! axios */ \"axios\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_3__]);\naxios__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\nconst XFeed = ({ maxItems = 5 })=>{\n    const { state, dispatch } = (0,_context_AppStateContext__WEBPACK_IMPORTED_MODULE_2__.useAppState)();\n    const [tweets, setTweets] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [openSettings, setOpenSettings] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [newHandle, setNewHandle] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)('');\n    // Get followed accounts from app state or initialize empty array\n    const followedAccounts = state.xfeed?.followedAccounts || [];\n    // Load tweets on component mount and when followed accounts change\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"XFeed.useEffect\": ()=>{\n            if (followedAccounts.length > 0) {\n                fetchTweets();\n            }\n        }\n    }[\"XFeed.useEffect\"], [\n        followedAccounts\n    ]);\n    // Fetch tweets from followed accounts\n    const fetchTweets = async ()=>{\n        if (followedAccounts.length === 0) return;\n        setLoading(true);\n        setError(null);\n        try {\n            // Create promises for each account\n            const promises = followedAccounts.map((handle)=>{\n                // Format handle for Twitter search according to social_media_service.py\n                // For user tweets, we should use 'from:username' format\n                const formattedQuery = `from:${handle.replace('@', '')}`;\n                console.log(`Fetching tweets for ${handle} with query: ${formattedQuery}`);\n                // Update to match the correct endpoint in social_media_service.py\n                return axios__WEBPACK_IMPORTED_MODULE_3__[\"default\"].get(`/api/social/tweets`, {\n                    params: {\n                        query: formattedQuery,\n                        search_type: 'tweets',\n                        count: Math.ceil(maxItems / followedAccounts.length),\n                        include_media: true\n                    }\n                });\n            });\n            // Execute all requests in parallel\n            const results = await Promise.all(promises);\n            // Combine and sort tweets\n            let allTweets = [];\n            results.forEach((response, index)=>{\n                const data = response.data.data || {};\n                if (data.results && Array.isArray(data.results)) {\n                    const accountTweets = data.results.map((tweet)=>({\n                            id: tweet.id,\n                            text: tweet.text,\n                            created_at: tweet.created_at,\n                            username: tweet.user?.username || followedAccounts[index],\n                            name: tweet.user?.name || followedAccounts[index],\n                            profile_image_url: tweet.user?.profile_image_url,\n                            media: tweet.media,\n                            heat_score: calculateHeatScore(tweet),\n                            likes_count: tweet.likes_count || 0,\n                            retweets_count: tweet.retweets_count || 0\n                        }));\n                    allTweets = [\n                        ...allTweets,\n                        ...accountTweets\n                    ];\n                }\n            });\n            // Sort by date (newest first)\n            allTweets.sort((a, b)=>new Date(b.created_at).getTime() - new Date(a.created_at).getTime());\n            // Limit to max items\n            setTweets(allTweets.slice(0, maxItems));\n        } catch (err) {\n            console.error('Error fetching tweets:', err);\n            setError('Failed to load tweets. Please try again later.');\n        } finally{\n            setLoading(false);\n        }\n    };\n    // Calculate heat score based on likes, retweets, etc.\n    const calculateHeatScore = (tweet)=>{\n        const likesWeight = 1;\n        const retweetsWeight = 2;\n        const recencyWeight = 3;\n        const likes = tweet.likes_count || 0;\n        const retweets = tweet.retweets_count || 0;\n        // Calculate recency score (higher for newer tweets)\n        const tweetDate = new Date(tweet.created_at);\n        const now = new Date();\n        const ageInHours = (now.getTime() - tweetDate.getTime()) / (1000 * 60 * 60);\n        const recencyScore = ageInHours < 24 ? (24 - ageInHours) / 24 : 0;\n        // Calculate raw score\n        const rawScore = likes * likesWeight + retweets * retweetsWeight + recencyScore * 100 * recencyWeight;\n        // Normalize to 0-100 scale (arbitrary scaling factor of 1000)\n        return Math.min(100, Math.round(rawScore / 10));\n    };\n    // Add a new Twitter handle to follow\n    const addHandle = ()=>{\n        if (!newHandle.trim()) return;\n        // Remove @ if present and clean the handle\n        let handle = newHandle.trim();\n        if (handle.startsWith('@')) {\n            handle = handle.substring(1);\n        }\n        // Further clean the handle - remove any spaces or special characters\n        handle = handle.replace(/[^a-zA-Z0-9_]/g, '');\n        if (!handle) return; // Don't add empty handles\n        // Check if already in list\n        if (followedAccounts.includes(handle)) {\n            setNewHandle('');\n            return;\n        }\n        // Update state\n        const updatedAccounts = [\n            ...followedAccounts,\n            handle\n        ];\n        dispatch({\n            type: 'UPDATE_XFEED',\n            payload: {\n                followedAccounts: updatedAccounts\n            }\n        });\n        setNewHandle('');\n        // Fetch tweets immediately if this is the first account added\n        if (followedAccounts.length === 0) {\n            fetchTweets();\n        }\n    };\n    // Remove an account from followed list\n    const handleRemoveAccount = (handle)=>{\n        const updatedAccounts = followedAccounts.filter((h)=>h !== handle);\n        // Update app state\n        dispatch({\n            type: 'UPDATE_XFEED',\n            payload: {\n                followedAccounts: updatedAccounts\n            }\n        });\n    };\n    // Format tweet date\n    const formatDate = (dateString)=>{\n        try {\n            const date = new Date(dateString);\n            const now = new Date();\n            const diffMs = now.getTime() - date.getTime();\n            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n            if (diffDays === 0) {\n                // Today - show hours/minutes ago\n                const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n                if (diffHours === 0) {\n                    const diffMinutes = Math.floor(diffMs / (1000 * 60));\n                    return `${diffMinutes} min${diffMinutes !== 1 ? 's' : ''} ago`;\n                }\n                return `${diffHours} hour${diffHours !== 1 ? 's' : ''} ago`;\n            } else if (diffDays === 1) {\n                return 'Yesterday';\n            } else if (diffDays < 7) {\n                return `${diffDays} days ago`;\n            } else {\n                return date.toLocaleDateString();\n            }\n        } catch (e) {\n            return dateString;\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"p-4 h-full flex flex-col overflow-hidden bg-white rounded-md shadow\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex items-center mb-4\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                        className: \"text-lg font-semibold flex-grow\",\n                        children: \"X Feed\"\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                        lineNumber: 220,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex space-x-2\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                className: `p-1 rounded-full hover:bg-gray-100 transition-colors ${loading ? 'opacity-50 cursor-not-allowed' : ''}`,\n                                onClick: fetchTweets,\n                                disabled: loading,\n                                \"aria-label\": \"Refresh feed\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowPathIcon_ArrowPathRoundedSquareIcon_Cog6ToothIcon_HeartIcon_PlusIcon_TrashIcon_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__.ArrowPathIcon, {\n                                    className: \"h-5 w-5\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                    lineNumber: 228,\n                                    columnNumber: 13\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                lineNumber: 222,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                className: \"p-1 rounded-full hover:bg-gray-100 transition-colors\",\n                                onClick: ()=>setOpenSettings(true),\n                                \"aria-label\": \"Feed settings\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowPathIcon_ArrowPathRoundedSquareIcon_Cog6ToothIcon_HeartIcon_PlusIcon_TrashIcon_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__.Cog6ToothIcon, {\n                                    className: \"h-5 w-5\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                    lineNumber: 235,\n                                    columnNumber: 13\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                lineNumber: 230,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                        lineNumber: 221,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                lineNumber: 219,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"overflow-auto flex-1\",\n                children: followedAccounts.length === 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"p-4 text-center\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                            className: \"text-base text-gray-600\",\n                            children: \"No accounts followed\"\n                        }, void 0, false, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                            lineNumber: 243,\n                            columnNumber: 13\n                        }, undefined),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                            className: \"mt-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-md text-sm flex items-center mx-auto\",\n                            onClick: ()=>setOpenSettings(true),\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowPathIcon_ArrowPathRoundedSquareIcon_Cog6ToothIcon_HeartIcon_PlusIcon_TrashIcon_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__.PlusIcon, {\n                                    className: \"h-4 w-4 mr-1\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                    lineNumber: 248,\n                                    columnNumber: 15\n                                }, undefined),\n                                \"Add Accounts\"\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                            lineNumber: 244,\n                            columnNumber: 13\n                        }, undefined)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                    lineNumber: 242,\n                    columnNumber: 11\n                }, undefined) : loading ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"flex justify-center p-6\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500\"\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                        lineNumber: 254,\n                        columnNumber: 13\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                    lineNumber: 253,\n                    columnNumber: 11\n                }, undefined) : error ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"p-4 text-center\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-base text-red-600\",\n                        children: error\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                        lineNumber: 258,\n                        columnNumber: 13\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                    lineNumber: 257,\n                    columnNumber: 11\n                }, undefined) : tweets.length === 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"p-4 text-center\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-base text-gray-600\",\n                        children: \"No tweets found\"\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                        lineNumber: 262,\n                        columnNumber: 13\n                    }, undefined)\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                    lineNumber: 261,\n                    columnNumber: 11\n                }, undefined) : tweets.map((tweet)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"mb-4 p-3 bg-white rounded-lg border border-gray-200 hover:shadow-md transition-shadow\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"mr-3\",\n                                    children: tweet.profile_image_url ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                        src: tweet.profile_image_url,\n                                        alt: tweet.name,\n                                        className: \"w-10 h-10 rounded-full\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                        lineNumber: 270,\n                                        columnNumber: 21\n                                    }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center font-semibold\",\n                                        children: tweet.username.charAt(0).toUpperCase()\n                                    }, void 0, false, {\n                                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                        lineNumber: 276,\n                                        columnNumber: 21\n                                    }, undefined)\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                    lineNumber: 268,\n                                    columnNumber: 17\n                                }, undefined),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex-1\",\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"flex items-center\",\n                                            children: [\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"font-semibold text-sm\",\n                                                    children: tweet.name\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                    lineNumber: 283,\n                                                    columnNumber: 21\n                                                }, undefined),\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"ml-1 text-xs text-gray-500\",\n                                                    children: [\n                                                        \"@\",\n                                                        tweet.username\n                                                    ]\n                                                }, void 0, true, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                    lineNumber: 286,\n                                                    columnNumber: 21\n                                                }, undefined),\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"ml-auto text-xs text-gray-500\",\n                                                    children: formatDate(tweet.created_at)\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                    lineNumber: 289,\n                                                    columnNumber: 21\n                                                }, undefined)\n                                            ]\n                                        }, void 0, true, {\n                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                            lineNumber: 282,\n                                            columnNumber: 19\n                                        }, undefined),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"mt-1 text-sm\",\n                                            children: tweet.text\n                                        }, void 0, false, {\n                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                            lineNumber: 294,\n                                            columnNumber: 19\n                                        }, undefined),\n                                        tweet.media && tweet.media.length > 0 && tweet.media[0].type === 'photo' && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"mt-2\",\n                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                                src: tweet.media[0].url,\n                                                alt: \"Tweet media\",\n                                                className: \"max-h-[150px] object-contain rounded\"\n                                            }, void 0, false, {\n                                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                lineNumber: 300,\n                                                columnNumber: 23\n                                            }, undefined)\n                                        }, void 0, false, {\n                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                            lineNumber: 299,\n                                            columnNumber: 21\n                                        }, undefined),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"flex mt-2 text-xs text-gray-500 space-x-4\",\n                                            children: [\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: \"flex items-center\",\n                                                    children: [\n                                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowPathIcon_ArrowPathRoundedSquareIcon_Cog6ToothIcon_HeartIcon_PlusIcon_TrashIcon_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__.HeartIcon, {\n                                                            className: \"h-3 w-3 mr-1\"\n                                                        }, void 0, false, {\n                                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                            lineNumber: 310,\n                                                            columnNumber: 23\n                                                        }, undefined),\n                                                        tweet.likes_count\n                                                    ]\n                                                }, void 0, true, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                    lineNumber: 309,\n                                                    columnNumber: 21\n                                                }, undefined),\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: \"flex items-center\",\n                                                    children: [\n                                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowPathIcon_ArrowPathRoundedSquareIcon_Cog6ToothIcon_HeartIcon_PlusIcon_TrashIcon_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__.ArrowPathRoundedSquareIcon, {\n                                                            className: \"h-3 w-3 mr-1\"\n                                                        }, void 0, false, {\n                                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                            lineNumber: 314,\n                                                            columnNumber: 23\n                                                        }, undefined),\n                                                        tweet.retweets_count\n                                                    ]\n                                                }, void 0, true, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                    lineNumber: 313,\n                                                    columnNumber: 21\n                                                }, undefined),\n                                                tweet.heat_score !== undefined && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: `ml-auto px-1.5 py-0.5 rounded text-white text-xs ${tweet.heat_score > 80 ? 'bg-red-500' : tweet.heat_score > 50 ? 'bg-yellow-500' : 'bg-blue-500'}`,\n                                                    children: [\n                                                        tweet.heat_score,\n                                                        \"\\xb0\"\n                                                    ]\n                                                }, void 0, true, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                    lineNumber: 318,\n                                                    columnNumber: 23\n                                                }, undefined)\n                                            ]\n                                        }, void 0, true, {\n                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                            lineNumber: 308,\n                                            columnNumber: 19\n                                        }, undefined)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                    lineNumber: 281,\n                                    columnNumber: 17\n                                }, undefined)\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                            lineNumber: 267,\n                            columnNumber: 15\n                        }, undefined)\n                    }, tweet.id, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                        lineNumber: 266,\n                        columnNumber: 13\n                    }, undefined))\n            }, void 0, false, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                lineNumber: 240,\n                columnNumber: 7\n            }, undefined),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Dialog_Transition_headlessui_react__WEBPACK_IMPORTED_MODULE_5__.Transition, {\n                appear: true,\n                show: openSettings,\n                as: react__WEBPACK_IMPORTED_MODULE_1__.Fragment,\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Dialog_Transition_headlessui_react__WEBPACK_IMPORTED_MODULE_5__.Dialog, {\n                    as: \"div\",\n                    className: \"relative z-10\",\n                    onClose: ()=>setOpenSettings(false),\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Dialog_Transition_headlessui_react__WEBPACK_IMPORTED_MODULE_5__.Transition.Child, {\n                            as: react__WEBPACK_IMPORTED_MODULE_1__.Fragment,\n                            enter: \"ease-out duration-300\",\n                            enterFrom: \"opacity-0\",\n                            enterTo: \"opacity-100\",\n                            leave: \"ease-in duration-200\",\n                            leaveFrom: \"opacity-100\",\n                            leaveTo: \"opacity-0\",\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"fixed inset-0 bg-black bg-opacity-25\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                lineNumber: 346,\n                                columnNumber: 13\n                            }, undefined)\n                        }, void 0, false, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                            lineNumber: 337,\n                            columnNumber: 11\n                        }, undefined),\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"fixed inset-0 overflow-y-auto\",\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"flex min-h-full items-center justify-center p-4 text-center\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Dialog_Transition_headlessui_react__WEBPACK_IMPORTED_MODULE_5__.Transition.Child, {\n                                    as: react__WEBPACK_IMPORTED_MODULE_1__.Fragment,\n                                    enter: \"ease-out duration-300\",\n                                    enterFrom: \"opacity-0 scale-95\",\n                                    enterTo: \"opacity-100 scale-100\",\n                                    leave: \"ease-in duration-200\",\n                                    leaveFrom: \"opacity-100 scale-100\",\n                                    leaveTo: \"opacity-0 scale-95\",\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Dialog_Transition_headlessui_react__WEBPACK_IMPORTED_MODULE_5__.Dialog.Panel, {\n                                        className: \"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all\",\n                                        children: [\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_Dialog_Transition_headlessui_react__WEBPACK_IMPORTED_MODULE_5__.Dialog.Title, {\n                                                as: \"h3\",\n                                                className: \"text-lg font-medium leading-6 text-gray-900\",\n                                                children: \"X Feed Settings\"\n                                            }, void 0, false, {\n                                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                lineNumber: 361,\n                                                columnNumber: 19\n                                            }, undefined),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"mt-4\",\n                                                children: [\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h4\", {\n                                                        className: \"text-sm font-medium text-gray-700\",\n                                                        children: \"Add X accounts to follow\"\n                                                    }, void 0, false, {\n                                                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                        lineNumber: 369,\n                                                        columnNumber: 21\n                                                    }, undefined),\n                                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                        className: \"mt-2 flex\",\n                                                        children: [\n                                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                                                                type: \"text\",\n                                                                className: \"flex-grow rounded-md border border-gray-300 px-3 py-1.5 text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500\",\n                                                                placeholder: \"@username\",\n                                                                value: newHandle,\n                                                                onChange: (e)=>setNewHandle(e.target.value)\n                                                            }, void 0, false, {\n                                                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                                lineNumber: 372,\n                                                                columnNumber: 23\n                                                            }, undefined),\n                                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                                type: \"button\",\n                                                                className: `ml-2 rounded-md bg-blue-600 px-3.5 py-1.5 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 ${!newHandle.trim() ? 'opacity-50 cursor-not-allowed' : ''}`,\n                                                                onClick: addHandle,\n                                                                disabled: !newHandle.trim(),\n                                                                children: \"Add\"\n                                                            }, void 0, false, {\n                                                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                                lineNumber: 379,\n                                                                columnNumber: 23\n                                                            }, undefined)\n                                                        ]\n                                                    }, void 0, true, {\n                                                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                        lineNumber: 371,\n                                                        columnNumber: 21\n                                                    }, undefined)\n                                                ]\n                                            }, void 0, true, {\n                                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                lineNumber: 368,\n                                                columnNumber: 19\n                                            }, undefined),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"mt-4\",\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: \"border-t border-gray-200 pt-4\",\n                                                    children: [\n                                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h4\", {\n                                                            className: \"text-sm font-medium text-gray-700\",\n                                                            children: \"Followed Accounts\"\n                                                        }, void 0, false, {\n                                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                            lineNumber: 392,\n                                                            columnNumber: 23\n                                                        }, undefined),\n                                                        followedAccounts.length === 0 ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                                                            className: \"mt-1 text-sm text-gray-500\",\n                                                            children: \"No accounts added yet\"\n                                                        }, void 0, false, {\n                                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                            lineNumber: 395,\n                                                            columnNumber: 25\n                                                        }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"ul\", {\n                                                            className: \"mt-2 space-y-2\",\n                                                            children: followedAccounts.map((handle)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"li\", {\n                                                                    className: \"flex items-center justify-between\",\n                                                                    children: [\n                                                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                                            className: \"text-sm\",\n                                                                            children: [\n                                                                                \"@\",\n                                                                                handle\n                                                                            ]\n                                                                        }, void 0, true, {\n                                                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                                            lineNumber: 402,\n                                                                            columnNumber: 31\n                                                                        }, undefined),\n                                                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                                            type: \"button\",\n                                                                            onClick: ()=>handleRemoveAccount(handle),\n                                                                            className: \"rounded-full p-1 text-gray-400 hover:text-red-600 hover:bg-red-50\",\n                                                                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ArrowPathIcon_ArrowPathRoundedSquareIcon_Cog6ToothIcon_HeartIcon_PlusIcon_TrashIcon_heroicons_react_24_outline__WEBPACK_IMPORTED_MODULE_4__.TrashIcon, {\n                                                                                className: \"h-4 w-4\"\n                                                                            }, void 0, false, {\n                                                                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                                                lineNumber: 408,\n                                                                                columnNumber: 33\n                                                                            }, undefined)\n                                                                        }, void 0, false, {\n                                                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                                            lineNumber: 403,\n                                                                            columnNumber: 31\n                                                                        }, undefined)\n                                                                    ]\n                                                                }, handle, true, {\n                                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                                    lineNumber: 401,\n                                                                    columnNumber: 29\n                                                                }, undefined))\n                                                        }, void 0, false, {\n                                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                            lineNumber: 399,\n                                                            columnNumber: 25\n                                                        }, undefined)\n                                                    ]\n                                                }, void 0, true, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                    lineNumber: 391,\n                                                    columnNumber: 21\n                                                }, undefined)\n                                            }, void 0, false, {\n                                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                lineNumber: 390,\n                                                columnNumber: 19\n                                            }, undefined),\n                                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                className: \"mt-6 flex justify-end\",\n                                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                                    type: \"button\",\n                                                    className: \"rounded-md bg-gray-100 px-3.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm hover:bg-gray-200 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600\",\n                                                    onClick: ()=>setOpenSettings(false),\n                                                    children: \"Close\"\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                    lineNumber: 418,\n                                                    columnNumber: 21\n                                                }, undefined)\n                                            }, void 0, false, {\n                                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                                lineNumber: 417,\n                                                columnNumber: 19\n                                            }, undefined)\n                                        ]\n                                    }, void 0, true, {\n                                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                        lineNumber: 360,\n                                        columnNumber: 17\n                                    }, undefined)\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                    lineNumber: 351,\n                                    columnNumber: 15\n                                }, undefined)\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                                lineNumber: 350,\n                                columnNumber: 13\n                            }, undefined)\n                        }, void 0, false, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                            lineNumber: 349,\n                            columnNumber: 11\n                        }, undefined)\n                    ]\n                }, void 0, true, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                    lineNumber: 336,\n                    columnNumber: 9\n                }, undefined)\n            }, void 0, false, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n                lineNumber: 335,\n                columnNumber: 7\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/components/XFeed.tsx\",\n        lineNumber: 218,\n        columnNumber: 5\n    }, undefined);\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (XFeed);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbXBvbmVudHMvWEZlZWQudHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkQ7QUFDMEU7QUFDaEY7QUFDRTtBQUMvQjtBQXNCMUIsTUFBTWMsUUFBOEIsQ0FBQyxFQUFFQyxXQUFXLENBQUMsRUFBRTtJQUNuRCxNQUFNLEVBQUVDLEtBQUssRUFBRUMsUUFBUSxFQUFFLEdBQUdMLHFFQUFXQTtJQUN2QyxNQUFNLENBQUNNLFFBQVFDLFVBQVUsR0FBR2xCLCtDQUFRQSxDQUFVLEVBQUU7SUFDaEQsTUFBTSxDQUFDbUIsU0FBU0MsV0FBVyxHQUFHcEIsK0NBQVFBLENBQUM7SUFDdkMsTUFBTSxDQUFDcUIsT0FBT0MsU0FBUyxHQUFHdEIsK0NBQVFBLENBQWdCO0lBQ2xELE1BQU0sQ0FBQ3VCLGNBQWNDLGdCQUFnQixHQUFHeEIsK0NBQVFBLENBQUM7SUFDakQsTUFBTSxDQUFDeUIsV0FBV0MsYUFBYSxHQUFHMUIsK0NBQVFBLENBQUM7SUFFM0MsaUVBQWlFO0lBQ2pFLE1BQU0yQixtQkFBbUJaLE1BQU1hLEtBQUssRUFBRUQsb0JBQW9CLEVBQUU7SUFFNUQsbUVBQW1FO0lBQ25FMUIsZ0RBQVNBOzJCQUFDO1lBQ1IsSUFBSTBCLGlCQUFpQkUsTUFBTSxHQUFHLEdBQUc7Z0JBQy9CQztZQUNGO1FBQ0Y7MEJBQUc7UUFBQ0g7S0FBaUI7SUFhckIsc0NBQXNDO0lBQ3RDLE1BQU1HLGNBQWM7UUFDbEIsSUFBSUgsaUJBQWlCRSxNQUFNLEtBQUssR0FBRztRQUVuQ1QsV0FBVztRQUNYRSxTQUFTO1FBRVQsSUFBSTtZQUNGLG1DQUFtQztZQUNuQyxNQUFNUyxXQUFXSixpQkFBaUJLLEdBQUcsQ0FBQ0MsQ0FBQUE7Z0JBQ3BDLHdFQUF3RTtnQkFDeEUsd0RBQXdEO2dCQUN4RCxNQUFNQyxpQkFBaUIsQ0FBQyxLQUFLLEVBQUVELE9BQU9FLE9BQU8sQ0FBQyxLQUFLLEtBQUs7Z0JBRXhEQyxRQUFRQyxHQUFHLENBQUMsQ0FB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OERBQUN3Rjs0REFBRU4sV0FBVTtzRUFBNkI7Ozs7O3NGQUkxQyw4REFBQ2tDOzREQUFHbEMsV0FBVTtzRUFDWHBGLGlCQUFpQkssR0FBRyxDQUFDQyxDQUFBQSx1QkFDcEIsOERBQUNpSDtvRUFBZ0JuQyxXQUFVOztzRkFDekIsOERBQUNZOzRFQUFLWixXQUFVOztnRkFBVTtnRkFBRTlFOzs7Ozs7O3NGQUM1Qiw4REFBQ2dGOzRFQUNDbEIsTUFBSzs0RUFDTG1CLFNBQVMsSUFBTWpCLG9CQUFvQmhFOzRFQUNuQzhFLFdBQVU7c0ZBRVYsNEVBQUMzRyw0S0FBU0E7Z0ZBQUMyRyxXQUFVOzs7Ozs7Ozs7Ozs7bUVBUGhCOUU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzswREFnQm5CLDhEQUFDNkU7Z0RBQUlDLFdBQVU7MERBQ2IsNEVBQUNFO29EQUNDbEIsTUFBSztvREFDTGdCLFdBQVU7b0RBQ1ZHLFNBQVMsSUFBTTFGLGdCQUFnQjs4REFDaEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFZckI7QUFFQSxpRUFBZVgsS0FBS0EsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL3dvbmthc3dvcmxkL0Rvd25sb2Fkcy9ncmFjZS1wcm9qZWN0L3NyYy91aS9jb21wb25lbnRzL1hGZWVkLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgRnJhZ21lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBQbHVzSWNvbiwgVHJhc2hJY29uLCBBcnJvd1BhdGhJY29uLCBDb2c2VG9vdGhJY29uLCBIZWFydEljb24sIEFycm93UGF0aFJvdW5kZWRTcXVhcmVJY29uIH0gZnJvbSAnQGhlcm9pY29ucy9yZWFjdC8yNC9vdXRsaW5lJztcbmltcG9ydCB7IERpYWxvZywgVHJhbnNpdGlvbiB9IGZyb20gJ0BoZWFkbGVzc3VpL3JlYWN0JztcbmltcG9ydCB7IHVzZUFwcFN0YXRlIH0gZnJvbSAnLi4vY29udGV4dC9BcHBTdGF0ZUNvbnRleHQnO1xuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcblxuaW50ZXJmYWNlIFR3ZWV0IHtcbiAgaWQ6IHN0cmluZztcbiAgdGV4dDogc3RyaW5nO1xuICBjcmVhdGVkX2F0OiBzdHJpbmc7XG4gIHVzZXJuYW1lOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgcHJvZmlsZV9pbWFnZV91cmw/OiBzdHJpbmc7XG4gIG1lZGlhPzoge1xuICAgIHR5cGU6IHN0cmluZztcbiAgICB1cmw6IHN0cmluZztcbiAgfVtdO1xuICBoZWF0X3Njb3JlPzogbnVtYmVyO1xuICBsaWtlc19jb3VudDogbnVtYmVyO1xuICByZXR3ZWV0c19jb3VudDogbnVtYmVyO1xufVxuXG5pbnRlcmZhY2UgWEZlZWRQcm9wcyB7XG4gIG1heEl0ZW1zPzogbnVtYmVyO1xufVxuXG5jb25zdCBYRmVlZDogUmVhY3QuRkM8WEZlZWRQcm9wcz4gPSAoeyBtYXhJdGVtcyA9IDUgfSkgPT4ge1xuICBjb25zdCB7IHN0YXRlLCBkaXNwYXRjaCB9ID0gdXNlQXBwU3RhdGUoKTtcbiAgY29uc3QgW3R3ZWV0cywgc2V0VHdlZXRzXSA9IHVzZVN0YXRlPFR3ZWV0W10+KFtdKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbb3BlblNldHRpbmdzLCBzZXRPcGVuU2V0dGluZ3NdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbbmV3SGFuZGxlLCBzZXROZXdIYW5kbGVdID0gdXNlU3RhdGUoJycpO1xuICBcbiAgLy8gR2V0IGZvbGxvd2VkIGFjY291bnRzIGZyb20gYXBwIHN0YXRlIG9yIGluaXRpYWxpemUgZW1wdHkgYXJyYXlcbiAgY29uc3QgZm9sbG93ZWRBY2NvdW50cyA9IHN0YXRlLnhmZWVkPy5mb2xsb3dlZEFjY291bnRzIHx8IFtdO1xuXG4gIC8vIExvYWQgdHdlZXRzIG9uIGNvbXBvbmVudCBtb3VudCBhbmQgd2hlbiBmb2xsb3dlZCBhY2NvdW50cyBjaGFuZ2VcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoZm9sbG93ZWRBY2NvdW50cy5sZW5ndGggPiAwKSB7XG4gICAgICBmZXRjaFR3ZWV0cygpO1xuICAgIH1cbiAgfSwgW2ZvbGxvd2VkQWNjb3VudHNdKTtcblxuICAvLyBBUEkgcmVzcG9uc2UgdHlwZVxuICBpbnRlcmZhY2UgQXBpUmVzcG9uc2Uge1xuICAgIHN1Y2Nlc3M6IGJvb2xlYW47XG4gICAgZGF0YToge1xuICAgICAgcmVzdWx0cz86IGFueVtdO1xuICAgICAgcXVlcnk/OiBzdHJpbmc7XG4gICAgICBzZWFyY2hfdHlwZT86IHN0cmluZztcbiAgICAgIGNvdW50PzogbnVtYmVyO1xuICAgIH07XG4gIH1cblxuICAvLyBGZXRjaCB0d2VldHMgZnJvbSBmb2xsb3dlZCBhY2NvdW50c1xuICBjb25zdCBmZXRjaFR3ZWV0cyA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoZm9sbG93ZWRBY2NvdW50cy5sZW5ndGggPT09IDApIHJldHVybjtcbiAgICBcbiAgICBzZXRMb2FkaW5nKHRydWUpO1xuICAgIHNldEVycm9yKG51bGwpO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgcHJvbWlzZXMgZm9yIGVhY2ggYWNjb3VudFxuICAgICAgY29uc3QgcHJvbWlzZXMgPSBmb2xsb3dlZEFjY291bnRzLm1hcChoYW5kbGUgPT4ge1xuICAgICAgICAvLyBGb3JtYXQgaGFuZGxlIGZvciBUd2l0dGVyIHNlYXJjaCBhY2NvcmRpbmcgdG8gc29jaWFsX21lZGlhX3NlcnZpY2UucHlcbiAgICAgICAgLy8gRm9yIHVzZXIgdHdlZXRzLCB3ZSBzaG91bGQgdXNlICdmcm9tOnVzZXJuYW1lJyBmb3JtYXRcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkUXVlcnkgPSBgZnJvbToke2hhbmRsZS5yZXBsYWNlKCdAJywgJycpfWA7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgRmV0Y2hpbmcgdHdlZXRzIGZvciAke2hhbmRsZX0gd2l0aCBxdWVyeTogJHtmb3JtYXR0ZWRRdWVyeX1gKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSB0byBtYXRjaCB0aGUgY29ycmVjdCBlbmRwb2ludCBpbiBzb2NpYWxfbWVkaWFfc2VydmljZS5weVxuICAgICAgICByZXR1cm4gYXhpb3MuZ2V0PEFwaVJlc3BvbnNlPihgL2FwaS9zb2NpYWwvdHdlZXRzYCwge1xuICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgcXVlcnk6IGZvcm1hdHRlZFF1ZXJ5LFxuICAgICAgICAgICAgc2VhcmNoX3R5cGU6ICd0d2VldHMnLFxuICAgICAgICAgICAgY291bnQ6IE1hdGguY2VpbChtYXhJdGVtcyAvIGZvbGxvd2VkQWNjb3VudHMubGVuZ3RoKSxcbiAgICAgICAgICAgIGluY2x1ZGVfbWVkaWE6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIEV4ZWN1dGUgYWxsIHJlcXVlc3RzIGluIHBhcmFsbGVsXG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgICAgXG4gICAgICAvLyBDb21iaW5lIGFuZCBzb3J0IHR3ZWV0c1xuICAgICAgbGV0IGFsbFR3ZWV0czogVHdlZXRbXSA9IFtdO1xuICAgICAgXG4gICAgICByZXN1bHRzLmZvckVhY2goKHJlc3BvbnNlLCBpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YS5kYXRhIHx8IHt9O1xuICAgICAgICBpZiAoZGF0YS5yZXN1bHRzICYmIEFycmF5LmlzQXJyYXkoZGF0YS5yZXN1bHRzKSkge1xuICAgICAgICAgIGNvbnN0IGFjY291bnRUd2VldHMgPSBkYXRhLnJlc3VsdHMubWFwKCh0d2VldDogYW55KSA9PiAoe1xuICAgICAgICAgICAgaWQ6IHR3ZWV0LmlkLFxuICAgICAgICAgICAgdGV4dDogdHdlZXQudGV4dCxcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IHR3ZWV0LmNyZWF0ZWRfYXQsXG4gICAgICAgICAgICB1c2VybmFtZTogdHdlZXQudXNlcj8udXNlcm5hbWUgfHwgZm9sbG93ZWRBY2NvdW50c1tpbmRleF0sXG4gICAgICAgICAgICBuYW1lOiB0d2VldC51c2VyPy5uYW1lIHx8IGZvbGxvd2VkQWNjb3VudHNbaW5kZXhdLFxuICAgICAgICAgICAgcHJvZmlsZV9pbWFnZV91cmw6IHR3ZWV0LnVzZXI/LnByb2ZpbGVfaW1hZ2VfdXJsLFxuICAgICAgICAgICAgbWVkaWE6IHR3ZWV0Lm1lZGlhLFxuICAgICAgICAgICAgaGVhdF9zY29yZTogY2FsY3VsYXRlSGVhdFNjb3JlKHR3ZWV0KSxcbiAgICAgICAgICAgIGxpa2VzX2NvdW50OiB0d2VldC5saWtlc19jb3VudCB8fCAwLFxuICAgICAgICAgICAgcmV0d2VldHNfY291bnQ6IHR3ZWV0LnJldHdlZXRzX2NvdW50IHx8IDBcbiAgICAgICAgICB9KSk7XG4gICAgICAgICAgXG4gICAgICAgICAgYWxsVHdlZXRzID0gWy4uLmFsbFR3ZWV0cywgLi4uYWNjb3VudFR3ZWV0c107XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBTb3J0IGJ5IGRhdGUgKG5ld2VzdCBmaXJzdClcbiAgICAgIGFsbFR3ZWV0cy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLmNyZWF0ZWRfYXQpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEuY3JlYXRlZF9hdCkuZ2V0VGltZSgpKTtcbiAgICAgIFxuICAgICAgLy8gTGltaXQgdG8gbWF4IGl0ZW1zXG4gICAgICBzZXRUd2VldHMoYWxsVHdlZXRzLnNsaWNlKDAsIG1heEl0ZW1zKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyB0d2VldHM6JywgZXJyKTtcbiAgICAgIHNldEVycm9yKCdGYWlsZWQgdG8gbG9hZCB0d2VldHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICAvLyBDYWxjdWxhdGUgaGVhdCBzY29yZSBiYXNlZCBvbiBsaWtlcywgcmV0d2VldHMsIGV0Yy5cbiAgY29uc3QgY2FsY3VsYXRlSGVhdFNjb3JlID0gKHR3ZWV0OiBhbnkpOiBudW1iZXIgPT4ge1xuICAgIGNvbnN0IGxpa2VzV2VpZ2h0ID0gMTtcbiAgICBjb25zdCByZXR3ZWV0c1dlaWdodCA9IDI7XG4gICAgY29uc3QgcmVjZW5jeVdlaWdodCA9IDM7XG4gICAgXG4gICAgY29uc3QgbGlrZXMgPSB0d2VldC5saWtlc19jb3VudCB8fCAwO1xuICAgIGNvbnN0IHJldHdlZXRzID0gdHdlZXQucmV0d2VldHNfY291bnQgfHwgMDtcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgcmVjZW5jeSBzY29yZSAoaGlnaGVyIGZvciBuZXdlciB0d2VldHMpXG4gICAgY29uc3QgdHdlZXREYXRlID0gbmV3IERhdGUodHdlZXQuY3JlYXRlZF9hdCk7XG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICBjb25zdCBhZ2VJbkhvdXJzID0gKG5vdy5nZXRUaW1lKCkgLSB0d2VldERhdGUuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCk7XG4gICAgY29uc3QgcmVjZW5jeVNjb3JlID0gYWdlSW5Ib3VycyA8IDI0ID8gKDI0IC0gYWdlSW5Ib3VycykgLyAyNCA6IDA7XG4gICAgXG4gICAgLy8gQ2FsY3VsYXRlIHJhdyBzY29yZVxuICAgIGNvbnN0IHJhd1Njb3JlID0gKGxpa2VzICogbGlrZXNXZWlnaHQpICsgKHJldHdlZXRzICogcmV0d2VldHNXZWlnaHQpICsgKHJlY2VuY3lTY29yZSAqIDEwMCAqIHJlY2VuY3lXZWlnaHQpO1xuICAgIFxuICAgIC8vIE5vcm1hbGl6ZSB0byAwLTEwMCBzY2FsZSAoYXJiaXRyYXJ5IHNjYWxpbmcgZmFjdG9yIG9mIDEwMDApXG4gICAgcmV0dXJuIE1hdGgubWluKDEwMCwgTWF0aC5yb3VuZChyYXdTY29yZSAvIDEwKSk7XG4gIH07XG5cbiAgLy8gQWRkIGEgbmV3IFR3aXR0ZXIgaGFuZGxlIHRvIGZvbGxvd1xuICBjb25zdCBhZGRIYW5kbGUgPSAoKSA9PiB7XG4gICAgaWYgKCFuZXdIYW5kbGUudHJpbSgpKSByZXR1cm47XG4gICAgXG4gICAgLy8gUmVtb3ZlIEAgaWYgcHJlc2VudCBhbmQgY2xlYW4gdGhlIGhhbmRsZVxuICAgIGxldCBoYW5kbGUgPSBuZXdIYW5kbGUudHJpbSgpO1xuICAgIGlmIChoYW5kbGUuc3RhcnRzV2l0aCgnQCcpKSB7XG4gICAgICBoYW5kbGUgPSBoYW5kbGUuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICBcbiAgICAvLyBGdXJ0aGVyIGNsZWFuIHRoZSBoYW5kbGUgLSByZW1vdmUgYW55IHNwYWNlcyBvciBzcGVjaWFsIGNoYXJhY3RlcnNcbiAgICBoYW5kbGUgPSBoYW5kbGUucmVwbGFjZSgvW15hLXpBLVowLTlfXS9nLCAnJyk7XG4gICAgXG4gICAgaWYgKCFoYW5kbGUpIHJldHVybjsgLy8gRG9uJ3QgYWRkIGVtcHR5IGhhbmRsZXNcbiAgICBcbiAgICAvLyBDaGVjayBpZiBhbHJlYWR5IGluIGxpc3RcbiAgICBpZiAoZm9sbG93ZWRBY2NvdW50cy5pbmNsdWRlcyhoYW5kbGUpKSB7XG4gICAgICBzZXROZXdIYW5kbGUoJycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICAvLyBVcGRhdGUgc3RhdGVcbiAgICBjb25zdCB1cGRhdGVkQWNjb3VudHMgPSBbLi4uZm9sbG93ZWRBY2NvdW50cywgaGFuZGxlXTtcbiAgICBkaXNwYXRjaCh7IHR5cGU6ICdVUERBVEVfWEZFRUQnLCBwYXlsb2FkOiB7IGZvbGxvd2VkQWNjb3VudHM6IHVwZGF0ZWRBY2NvdW50cyB9IH0pO1xuICAgIHNldE5ld0hhbmRsZSgnJyk7XG4gICAgXG4gICAgLy8gRmV0Y2ggdHdlZXRzIGltbWVkaWF0ZWx5IGlmIHRoaXMgaXMgdGhlIGZpcnN0IGFjY291bnQgYWRkZWRcbiAgICBpZiAoZm9sbG93ZWRBY2NvdW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgIGZldGNoVHdlZXRzKCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIFJlbW92ZSBhbiBhY2NvdW50IGZyb20gZm9sbG93ZWQgbGlzdFxuICBjb25zdCBoYW5kbGVSZW1vdmVBY2NvdW50ID0gKGhhbmRsZTogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgdXBkYXRlZEFjY291bnRzID0gZm9sbG93ZWRBY2NvdW50cy5maWx0ZXIoaCA9PiBoICE9PSBoYW5kbGUpO1xuICAgIFxuICAgIC8vIFVwZGF0ZSBhcHAgc3RhdGVcbiAgICBkaXNwYXRjaCh7XG4gICAgICB0eXBlOiAnVVBEQVRFX1hGRUVEJyxcbiAgICAgIHBheWxvYWQ6IHtcbiAgICAgICAgZm9sbG93ZWRBY2NvdW50czogdXBkYXRlZEFjY291bnRzXG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gRm9ybWF0IHR3ZWV0IGRhdGVcbiAgY29uc3QgZm9ybWF0RGF0ZSA9IChkYXRlU3RyaW5nOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cmluZyk7XG4gICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgY29uc3QgZGlmZk1zID0gbm93LmdldFRpbWUoKSAtIGRhdGUuZ2V0VGltZSgpO1xuICAgICAgY29uc3QgZGlmZkRheXMgPSBNYXRoLmZsb29yKGRpZmZNcyAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG4gICAgICBcbiAgICAgIGlmIChkaWZmRGF5cyA9PT0gMCkge1xuICAgICAgICAvLyBUb2RheSAtIHNob3cgaG91cnMvbWludXRlcyBhZ29cbiAgICAgICAgY29uc3QgZGlmZkhvdXJzID0gTWF0aC5mbG9vcihkaWZmTXMgLyAoMTAwMCAqIDYwICogNjApKTtcbiAgICAgICAgaWYgKGRpZmZIb3VycyA9PT0gMCkge1xuICAgICAgICAgIGNvbnN0IGRpZmZNaW51dGVzID0gTWF0aC5mbG9vcihkaWZmTXMgLyAoMTAwMCAqIDYwKSk7XG4gICAgICAgICAgcmV0dXJuIGAke2RpZmZNaW51dGVzfSBtaW4ke2RpZmZNaW51dGVzICE9PSAxID8gJ3MnIDogJyd9IGFnb2A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGAke2RpZmZIb3Vyc30gaG91ciR7ZGlmZkhvdXJzICE9PSAxID8gJ3MnIDogJyd9IGFnb2A7XG4gICAgICB9IGVsc2UgaWYgKGRpZmZEYXlzID09PSAxKSB7XG4gICAgICAgIHJldHVybiAnWWVzdGVyZGF5JztcbiAgICAgIH0gZWxzZSBpZiAoZGlmZkRheXMgPCA3KSB7XG4gICAgICAgIHJldHVybiBgJHtkaWZmRGF5c30gZGF5cyBhZ29gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGRhdGVTdHJpbmc7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJwLTQgaC1mdWxsIGZsZXggZmxleC1jb2wgb3ZlcmZsb3ctaGlkZGVuIGJnLXdoaXRlIHJvdW5kZWQtbWQgc2hhZG93XCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIG1iLTRcIj5cbiAgICAgICAgPGgyIGNsYXNzTmFtZT1cInRleHQtbGcgZm9udC1zZW1pYm9sZCBmbGV4LWdyb3dcIj5YIEZlZWQ8L2gyPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggc3BhY2UteC0yXCI+XG4gICAgICAgICAgPGJ1dHRvbiBcbiAgICAgICAgICAgIGNsYXNzTmFtZT17YHAtMSByb3VuZGVkLWZ1bGwgaG92ZXI6YmctZ3JheS0xMDAgdHJhbnNpdGlvbi1jb2xvcnMgJHtsb2FkaW5nID8gJ29wYWNpdHktNTAgY3Vyc29yLW5vdC1hbGxvd2VkJyA6ICcnfWB9XG4gICAgICAgICAgICBvbkNsaWNrPXtmZXRjaFR3ZWV0c30gXG4gICAgICAgICAgICBkaXNhYmxlZD17bG9hZGluZ31cbiAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJSZWZyZXNoIGZlZWRcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxBcnJvd1BhdGhJY29uIGNsYXNzTmFtZT1cImgtNSB3LTVcIiAvPlxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDxidXR0b24gXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJwLTEgcm91bmRlZC1mdWxsIGhvdmVyOmJnLWdyYXktMTAwIHRyYW5zaXRpb24tY29sb3JzXCJcbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldE9wZW5TZXR0aW5ncyh0cnVlKX1cbiAgICAgICAgICAgIGFyaWEtbGFiZWw9XCJGZWVkIHNldHRpbmdzXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8Q29nNlRvb3RoSWNvbiBjbGFzc05hbWU9XCJoLTUgdy01XCIgLz5cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJvdmVyZmxvdy1hdXRvIGZsZXgtMVwiPlxuICAgICAgICB7Zm9sbG93ZWRBY2NvdW50cy5sZW5ndGggPT09IDAgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTQgdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtYmFzZSB0ZXh0LWdyYXktNjAwXCI+Tm8gYWNjb3VudHMgZm9sbG93ZWQ8L3A+XG4gICAgICAgICAgICA8YnV0dG9uIFxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtdC0yIGJnLWJsdWUtNjAwIGhvdmVyOmJnLWJsdWUtNzAwIHRleHQtd2hpdGUgcHgtMyBweS0xIHJvdW5kZWQtbWQgdGV4dC1zbSBmbGV4IGl0ZW1zLWNlbnRlciBteC1hdXRvXCJcbiAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0T3BlblNldHRpbmdzKHRydWUpfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8UGx1c0ljb24gY2xhc3NOYW1lPVwiaC00IHctNCBtci0xXCIgLz5cbiAgICAgICAgICAgICAgQWRkIEFjY291bnRzXG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IGxvYWRpbmcgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGp1c3RpZnktY2VudGVyIHAtNlwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbmltYXRlLXNwaW4gcm91bmRlZC1mdWxsIGgtOCB3LTggYm9yZGVyLXQtMiBib3JkZXItYi0yIGJvcmRlci1ibHVlLTUwMFwiPjwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogZXJyb3IgPyAoXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJwLTQgdGV4dC1jZW50ZXJcIj5cbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQtYmFzZSB0ZXh0LXJlZC02MDBcIj57ZXJyb3J9PC9wPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICApIDogdHdlZXRzLmxlbmd0aCA9PT0gMCA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInAtNCB0ZXh0LWNlbnRlclwiPlxuICAgICAgICAgICAgPHAgY2xhc3NOYW1lPVwidGV4dC1iYXNlIHRleHQtZ3JheS02MDBcIj5ObyB0d2VldHMgZm91bmQ8L3A+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgdHdlZXRzLm1hcCh0d2VldCA9PiAoXG4gICAgICAgICAgICA8ZGl2IGtleT17dHdlZXQuaWR9IGNsYXNzTmFtZT1cIm1iLTQgcC0zIGJnLXdoaXRlIHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1ncmF5LTIwMCBob3ZlcjpzaGFkb3ctbWQgdHJhbnNpdGlvbi1zaGFkb3dcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtci0zXCI+XG4gICAgICAgICAgICAgICAgICB7dHdlZXQucHJvZmlsZV9pbWFnZV91cmwgPyAoXG4gICAgICAgICAgICAgICAgICAgIDxpbWcgXG4gICAgICAgICAgICAgICAgICAgICAgc3JjPXt0d2VldC5wcm9maWxlX2ltYWdlX3VybH0gXG4gICAgICAgICAgICAgICAgICAgICAgYWx0PXt0d2VldC5uYW1lfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctMTAgaC0xMCByb3VuZGVkLWZ1bGxcIlxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTEwIGgtMTAgcm91bmRlZC1mdWxsIGJnLWJsdWUtNjAwIHRleHQtd2hpdGUgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgZm9udC1zZW1pYm9sZFwiPlxuICAgICAgICAgICAgICAgICAgICAgIHt0d2VldC51c2VybmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xXCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImZvbnQtc2VtaWJvbGQgdGV4dC1zbVwiPlxuICAgICAgICAgICAgICAgICAgICAgIHt0d2VldC5uYW1lfVxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm1sLTEgdGV4dC14cyB0ZXh0LWdyYXktNTAwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgQHt0d2VldC51c2VybmFtZX1cbiAgICAgICAgICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJtbC1hdXRvIHRleHQteHMgdGV4dC1ncmF5LTUwMFwiPlxuICAgICAgICAgICAgICAgICAgICAgIHtmb3JtYXREYXRlKHR3ZWV0LmNyZWF0ZWRfYXQpfVxuICAgICAgICAgICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC0xIHRleHQtc21cIj5cbiAgICAgICAgICAgICAgICAgICAge3R3ZWV0LnRleHR9XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAge3R3ZWV0Lm1lZGlhICYmIHR3ZWV0Lm1lZGlhLmxlbmd0aCA+IDAgJiYgdHdlZXQubWVkaWFbMF0udHlwZSA9PT0gJ3Bob3RvJyAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMlwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxpbWdcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYz17dHdlZXQubWVkaWFbMF0udXJsfVxuICAgICAgICAgICAgICAgICAgICAgICAgYWx0PVwiVHdlZXQgbWVkaWFcIlxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibWF4LWgtWzE1MHB4XSBvYmplY3QtY29udGFpbiByb3VuZGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBtdC0yIHRleHQteHMgdGV4dC1ncmF5LTUwMCBzcGFjZS14LTRcIj5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxIZWFydEljb24gY2xhc3NOYW1lPVwiaC0zIHctMyBtci0xXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICB7dHdlZXQubGlrZXNfY291bnR9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgPEFycm93UGF0aFJvdW5kZWRTcXVhcmVJY29uIGNsYXNzTmFtZT1cImgtMyB3LTMgbXItMVwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAge3R3ZWV0LnJldHdlZXRzX2NvdW50fVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAge3R3ZWV0LmhlYXRfc2NvcmUgIT09IHVuZGVmaW5lZCAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BtbC1hdXRvIHB4LTEuNSBweS0wLjUgcm91bmRlZCB0ZXh0LXdoaXRlIHRleHQteHMgJHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR3ZWV0LmhlYXRfc2NvcmUgPiA4MCA/ICdiZy1yZWQtNTAwJyA6IFxuICAgICAgICAgICAgICAgICAgICAgICAgdHdlZXQuaGVhdF9zY29yZSA+IDUwID8gJ2JnLXllbGxvdy01MDAnIDogXG4gICAgICAgICAgICAgICAgICAgICAgICAnYmctYmx1ZS01MDAnXG4gICAgICAgICAgICAgICAgICAgICAgfWB9PlxuICAgICAgICAgICAgICAgICAgICAgICAge3R3ZWV0LmhlYXRfc2NvcmV9wrBcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICkpXG4gICAgICAgICl9XG4gICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgICB7LyogU2V0dGluZ3MgRGlhbG9nICovfVxuICAgICAgPFRyYW5zaXRpb24gYXBwZWFyIHNob3c9e29wZW5TZXR0aW5nc30gYXM9e0ZyYWdtZW50fT5cbiAgICAgICAgPERpYWxvZyBhcz1cImRpdlwiIGNsYXNzTmFtZT1cInJlbGF0aXZlIHotMTBcIiBvbkNsb3NlPXsoKSA9PiBzZXRPcGVuU2V0dGluZ3MoZmFsc2UpfT5cbiAgICAgICAgICA8VHJhbnNpdGlvbi5DaGlsZFxuICAgICAgICAgICAgYXM9e0ZyYWdtZW50fVxuICAgICAgICAgICAgZW50ZXI9XCJlYXNlLW91dCBkdXJhdGlvbi0zMDBcIlxuICAgICAgICAgICAgZW50ZXJGcm9tPVwib3BhY2l0eS0wXCJcbiAgICAgICAgICAgIGVudGVyVG89XCJvcGFjaXR5LTEwMFwiXG4gICAgICAgICAgICBsZWF2ZT1cImVhc2UtaW4gZHVyYXRpb24tMjAwXCJcbiAgICAgICAgICAgIGxlYXZlRnJvbT1cIm9wYWNpdHktMTAwXCJcbiAgICAgICAgICAgIGxlYXZlVG89XCJvcGFjaXR5LTBcIlxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZml4ZWQgaW5zZXQtMCBiZy1ibGFjayBiZy1vcGFjaXR5LTI1XCIgLz5cbiAgICAgICAgICA8L1RyYW5zaXRpb24uQ2hpbGQ+XG5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZpeGVkIGluc2V0LTAgb3ZlcmZsb3cteS1hdXRvXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggbWluLWgtZnVsbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcC00IHRleHQtY2VudGVyXCI+XG4gICAgICAgICAgICAgIDxUcmFuc2l0aW9uLkNoaWxkXG4gICAgICAgICAgICAgICAgYXM9e0ZyYWdtZW50fVxuICAgICAgICAgICAgICAgIGVudGVyPVwiZWFzZS1vdXQgZHVyYXRpb24tMzAwXCJcbiAgICAgICAgICAgICAgICBlbnRlckZyb209XCJvcGFjaXR5LTAgc2NhbGUtOTVcIlxuICAgICAgICAgICAgICAgIGVudGVyVG89XCJvcGFjaXR5LTEwMCBzY2FsZS0xMDBcIlxuICAgICAgICAgICAgICAgIGxlYXZlPVwiZWFzZS1pbiBkdXJhdGlvbi0yMDBcIlxuICAgICAgICAgICAgICAgIGxlYXZlRnJvbT1cIm9wYWNpdHktMTAwIHNjYWxlLTEwMFwiXG4gICAgICAgICAgICAgICAgbGVhdmVUbz1cIm9wYWNpdHktMCBzY2FsZS05NVwiXG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICA8RGlhbG9nLlBhbmVsIGNsYXNzTmFtZT1cInctZnVsbCBtYXgtdy1tZCB0cmFuc2Zvcm0gb3ZlcmZsb3ctaGlkZGVuIHJvdW5kZWQtMnhsIGJnLXdoaXRlIHAtNiB0ZXh0LWxlZnQgYWxpZ24tbWlkZGxlIHNoYWRvdy14bCB0cmFuc2l0aW9uLWFsbFwiPlxuICAgICAgICAgICAgICAgICAgPERpYWxvZy5UaXRsZVxuICAgICAgICAgICAgICAgICAgICBhcz1cImgzXCJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidGV4dC1sZyBmb250LW1lZGl1bSBsZWFkaW5nLTYgdGV4dC1ncmF5LTkwMFwiXG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIFggRmVlZCBTZXR0aW5nc1xuICAgICAgICAgICAgICAgICAgPC9EaWFsb2cuVGl0bGU+XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtNFwiPlxuICAgICAgICAgICAgICAgICAgICA8aDQgY2xhc3NOYW1lPVwidGV4dC1zbSBmb250LW1lZGl1bSB0ZXh0LWdyYXktNzAwXCI+QWRkIFggYWNjb3VudHMgdG8gZm9sbG93PC9oND5cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMiBmbGV4XCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGlucHV0XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4LWdyb3cgcm91bmRlZC1tZCBib3JkZXIgYm9yZGVyLWdyYXktMzAwIHB4LTMgcHktMS41IHRleHQtc20gZm9jdXM6Ym9yZGVyLWJsdWUtNTAwIGZvY3VzOnJpbmctMSBmb2N1czpyaW5nLWJsdWUtNTAwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiQHVzZXJuYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtuZXdIYW5kbGV9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldE5ld0hhbmRsZShlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YG1sLTIgcm91bmRlZC1tZCBiZy1ibHVlLTYwMCBweC0zLjUgcHktMS41IHRleHQtc20gZm9udC1zZW1pYm9sZCB0ZXh0LXdoaXRlIHNoYWRvdy1zbSBob3ZlcjpiZy1ibHVlLTUwMCBmb2N1cy12aXNpYmxlOm91dGxpbmUgZm9jdXMtdmlzaWJsZTpvdXRsaW5lLTIgZm9jdXMtdmlzaWJsZTpvdXRsaW5lLW9mZnNldC0yIGZvY3VzLXZpc2libGU6b3V0bGluZS1ibHVlLTYwMCAkeyFuZXdIYW5kbGUudHJpbSgpID8gJ29wYWNpdHktNTAgY3Vyc29yLW5vdC1hbGxvd2VkJyA6ICcnfWB9XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXthZGRIYW5kbGV9XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IW5ld0hhbmRsZS50cmltKCl9XG4gICAgICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICAgICAgQWRkXG4gICAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtNFwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJvcmRlci10IGJvcmRlci1ncmF5LTIwMCBwdC00XCI+XG4gICAgICAgICAgICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT1cInRleHQtc20gZm9udC1tZWRpdW0gdGV4dC1ncmF5LTcwMFwiPkZvbGxvd2VkIEFjY291bnRzPC9oND5cbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICB7Zm9sbG93ZWRBY2NvdW50cy5sZW5ndGggPT09IDAgPyAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJtdC0xIHRleHQtc20gdGV4dC1ncmF5LTUwMFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgICBObyBhY2NvdW50cyBhZGRlZCB5ZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgICAgICAgICAgICApIDogKFxuICAgICAgICAgICAgICAgICAgICAgICAgPHVsIGNsYXNzTmFtZT1cIm10LTIgc3BhY2UteS0yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtmb2xsb3dlZEFjY291bnRzLm1hcChoYW5kbGUgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBrZXk9e2hhbmRsZX0gY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1iZXR3ZWVuXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXNtXCI+QHtoYW5kbGV9PC9zcGFuPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlUmVtb3ZlQWNjb3VudChoYW5kbGUpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJyb3VuZGVkLWZ1bGwgcC0xIHRleHQtZ3JheS00MDAgaG92ZXI6dGV4dC1yZWQtNjAwIGhvdmVyOmJnLXJlZC01MFwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxUcmFzaEljb24gY2xhc3NOYW1lPVwiaC00IHctNFwiIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgICApKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cblxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC02IGZsZXgganVzdGlmeS1lbmRcIj5cbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInJvdW5kZWQtbWQgYmctZ3JheS0xMDAgcHgtMy41IHB5LTEuNSB0ZXh0LXNtIGZvbnQtc2VtaWJvbGQgdGV4dC1ncmF5LTkwMCBzaGFkb3ctc20gaG92ZXI6YmctZ3JheS0yMDAgZm9jdXMtdmlzaWJsZTpvdXRsaW5lIGZvY3VzLXZpc2libGU6b3V0bGluZS0yIGZvY3VzLXZpc2libGU6b3V0bGluZS1vZmZzZXQtMiBmb2N1cy12aXNpYmxlOm91dGxpbmUtZ3JheS02MDBcIlxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldE9wZW5TZXR0aW5ncyhmYWxzZSl9XG4gICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICBDbG9zZVxuICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvRGlhbG9nLlBhbmVsPlxuICAgICAgICAgICAgICA8L1RyYW5zaXRpb24uQ2hpbGQ+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9EaWFsb2c+XG4gICAgICA8L1RyYW5zaXRpb24+XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBYRmVlZDsiXSwibmFtZXMiOlsiUmVhY3QiLCJ1c2VTdGF0ZSIsInVzZUVmZmVjdCIsIkZyYWdtZW50IiwiUGx1c0ljb24iLCJUcmFzaEljb24iLCJBcnJvd1BhdGhJY29uIiwiQ29nNlRvb3RoSWNvbiIsIkhlYXJ0SWNvbiIsIkFycm93UGF0aFJvdW5kZWRTcXVhcmVJY29uIiwiRGlhbG9nIiwiVHJhbnNpdGlvbiIsInVzZUFwcFN0YXRlIiwiYXhpb3MiLCJYRmVlZCIsIm1heEl0ZW1zIiwic3RhdGUiLCJkaXNwYXRjaCIsInR3ZWV0cyIsInNldFR3ZWV0cyIsImxvYWRpbmciLCJzZXRMb2FkaW5nIiwiZXJyb3IiLCJzZXRFcnJvciIsIm9wZW5TZXR0aW5ncyIsInNldE9wZW5TZXR0aW5ncyIsIm5ld0hhbmRsZSIsInNldE5ld0hhbmRsZSIsImZvbGxvd2VkQWNjb3VudHMiLCJ4ZmVlZCIsImxlbmd0aCIsImZldGNoVHdlZXRzIiwicHJvbWlzZXMiLCJtYXAiLCJoYW5kbGUiLCJmb3JtYXR0ZWRRdWVyeSIsInJlcGxhY2UiLCJjb25zb2xlIiwibG9nIiwiZ2V0IiwicGFyYW1zIiwicXVlcnkiLCJzZWFyY2hfdHlwZSIsImNvdW50IiwiTWF0aCIsImNlaWwiLCJpbmNsdWRlX21lZGlhIiwicmVzdWx0cyIsIlByb21pc2UiLCJhbGwiLCJhbGxUd2VldHMiLCJmb3JFYWNoIiwicmVzcG9uc2UiLCJpbmRleCIsImRhdGEiLCJBcnJheSIsImlzQXJyYXkiLCJhY2NvdW50VHdlZXRzIiwidHdlZXQiLCJpZCIsInRleHQiLCJjcmVhdGVkX2F0IiwidXNlcm5hbWUiLCJ1c2VyIiwibmFtZSIsInByb2ZpbGVfaW1hZ2VfdXJsIiwibWVkaWEiLCJoZWF0X3Njb3JlIiwiY2FsY3VsYXRlSGVhdFNjb3JlIiwibGlrZXNfY291bnQiLCJyZXR3ZWV0c19jb3VudCIsInNvcnQiLCJhIiwiYiIsIkRhdGUiLCJnZXRUaW1lIiwic2xpY2UiLCJlcnIiLCJsaWtlc1dlaWdodCIsInJldHdlZXRzV2VpZ2h0IiwicmVjZW5jeVdlaWdodCIsImxpa2VzIiwicmV0d2VldHMiLCJ0d2VldERhdGUiLCJub3ciLCJhZ2VJbkhvdXJzIiwicmVjZW5jeVNjb3JlIiwicmF3U2NvcmUiLCJtaW4iLCJyb3VuZCIsImFkZEhhbmRsZSIsInRyaW0iLCJzdGFydHNXaXRoIiwic3Vic3RyaW5nIiwiaW5jbHVkZXMiLCJ1cGRhdGVkQWNjb3VudHMiLCJ0eXBlIiwicGF5bG9hZCIsImhhbmRsZVJlbW92ZUFjY291bnQiLCJmaWx0ZXIiLCJoIiwiZm9ybWF0RGF0ZSIsImRhdGVTdHJpbmciLCJkYXRlIiwiZGlmZk1zIiwiZGlmZkRheXMiLCJmbG9vciIsImRpZmZIb3VycyIsImRpZmZNaW51dGVzIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiZSIsImRpdiIsImNsYXNzTmFtZSIsImgyIiwiYnV0dG9uIiwib25DbGljayIsImRpc2FibGVkIiwiYXJpYS1sYWJlbCIsInAiLCJpbWciLCJzcmMiLCJhbHQiLCJjaGFyQXQiLCJ0b1VwcGVyQ2FzZSIsInNwYW4iLCJ1cmwiLCJ1bmRlZmluZWQiLCJhcHBlYXIiLCJzaG93IiwiYXMiLCJvbkNsb3NlIiwiQ2hpbGQiLCJlbnRlciIsImVudGVyRnJvbSIsImVudGVyVG8iLCJsZWF2ZSIsImxlYXZlRnJvbSIsImxlYXZlVG8iLCJQYW5lbCIsIlRpdGxlIiwiaDQiLCJpbnB1dCIsInBsYWNlaG9sZGVyIiwidmFsdWUiLCJvbkNoYW5nZSIsInRhcmdldCIsInVsIiwibGkiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./components/XFeed.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./context/AppStateContext.tsx":
/*!*************************************!*\
  !*** ./context/AppStateContext.tsx ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppStateProvider: () => (/* binding */ AppStateProvider),\n/* harmony export */   useAppState: () => (/* binding */ useAppState)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StatePersistence */ \"(pages-dir-node)/./utils/StatePersistence.ts\");\n/* harmony import */ var _components_AuthContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n\n\n\n\n// Initial state object\nconst initialState = {\n    timestamp: Date.now(),\n    userSession: {},\n    authSession: {},\n    // Standard chatContext from DynamicStateSnapshot\n    chatContext: {\n        currentConversationId: undefined,\n        draftMessage: '',\n        lastMessageTimestamp: 0\n    },\n    // Extended chat state\n    chatState: {\n        activeSessions: [],\n        sessions: {},\n        draftMessages: {}\n    },\n    pageState: {},\n    widgetStates: {},\n    // State metadata\n    isHydrated: false,\n    isLoading: false,\n    lastSaved: 0,\n    // Extended state\n    tradingState: {},\n    walletState: {},\n    socialState: {},\n    uiState: {\n        darkMode: true,\n        sidebarOpen: true\n    },\n    xfeed: {\n        followedAccounts: [],\n        lastUpdated: undefined\n    }\n};\n// State reducer\nfunction appStateReducer(state, action) {\n    switch(action.type){\n        case 'SET_TRADING_STATE':\n            return {\n                ...state,\n                tradingState: {\n                    ...state.tradingState,\n                    ...action.payload\n                }\n            };\n        case 'SET_WALLET_STATE':\n            return {\n                ...state,\n                walletState: {\n                    ...state.walletState,\n                    ...action.payload\n                }\n            };\n        case 'SET_CHAT_STATE':\n            return {\n                ...state,\n                chatState: {\n                    ...state.chatState,\n                    ...action.payload\n                }\n            };\n        case 'SET_SOCIAL_STATE':\n            return {\n                ...state,\n                socialState: {\n                    ...state.socialState,\n                    ...action.payload\n                }\n            };\n        case 'SET_UI_STATE':\n            return {\n                ...state,\n                uiState: {\n                    ...state.uiState,\n                    ...action.payload\n                }\n            };\n        case 'SET_PAGE_STATE':\n            return {\n                ...state,\n                pageState: {\n                    ...state.pageState,\n                    ...action.payload\n                }\n            };\n        case 'SET_WIDGET_STATES':\n            return {\n                ...state,\n                widgetStates: {\n                    ...state.widgetStates,\n                    ...action.payload\n                }\n            };\n        case 'SET_CHAT_CONTEXT':\n            return {\n                ...state,\n                chatContext: {\n                    ...state.chatContext,\n                    ...action.payload\n                }\n            };\n        case 'SET_USER_SESSION':\n            return {\n                ...state,\n                userSession: {\n                    ...state.userSession,\n                    ...action.payload\n                }\n            };\n        case 'UPDATE_AUTH':\n            const { user, token } = action.payload;\n            return {\n                ...state,\n                userSession: {\n                    ...state.userSession,\n                    token: token || '',\n                    username: user?.username || ''\n                },\n                authSession: {\n                    ...state.authSession,\n                    token: token || '',\n                    expiresAt: token ? Math.floor(Date.now() / 1000) + 24 * 60 * 60 : undefined\n                }\n            };\n        case 'UPDATE_XFEED':\n            return {\n                ...state,\n                xfeed: {\n                    ...state.xfeed,\n                    ...action.payload,\n                    lastUpdated: Date.now()\n                }\n            };\n        case 'HYDRATE_STATE':\n            return {\n                ...action.payload\n            };\n        case 'RESET_STATE':\n            return initialState;\n        // Compatibility aliases\n        case 'HYDRATE':\n            return {\n                ...action.payload\n            };\n        case 'RESET':\n            return initialState;\n        default:\n            return state;\n    }\n}\nconst AppStateContext = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(undefined);\nfunction AppStateProvider({ children }) {\n    const [state, dispatch] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useReducer)(appStateReducer, initialState);\n    const [isStateLoading, setIsStateLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(true);\n    const [isStateHydrated, setIsStateHydrated] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [isStateRecovered, setIsStateRecovered] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [isStateSyncing, setIsStateSyncing] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const isUpdatingFromStorage = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    // Get auth state from AuthContext\n    const { user, isAuthenticated } = (0,_components_AuthContext__WEBPACK_IMPORTED_MODULE_3__.useAuth)();\n    // Sync auth state with AppState\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AppStateProvider.useEffect\": ()=>{\n            dispatch({\n                type: 'UPDATE_AUTH',\n                payload: {\n                    user: isAuthenticated ? user : null,\n                    token: isAuthenticated ? localStorage.getItem('authToken') : null\n                }\n            });\n        }\n    }[\"AppStateProvider.useEffect\"], [\n        user,\n        isAuthenticated\n    ]);\n    // Hydrate state from storage on initial load\n    const hydrateFromStorage = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"AppStateProvider.useCallback[hydrateFromStorage]\": async (navigate)=>{\n            try {\n                setIsStateLoading(true);\n                // Get the stored state using the synchronous retrieveSnapshot method\n                const storedState = _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_2__[\"default\"].retrieveSnapshot();\n                if (!storedState) {\n                    console.log('No stored state found');\n                    setIsStateHydrated(true);\n                    return;\n                }\n                console.log('Hydrating state from storage:', storedState);\n                // Create a clean state object with proper defaults\n                const hydratedState = {\n                    // Required fields from AppState\n                    timestamp: storedState.timestamp || Date.now(),\n                    isHydrated: true,\n                    lastSaved: 0,\n                    // Map user session\n                    userSession: {\n                        token: storedState.userSession?.token || '',\n                        username: storedState.userSession?.username || ''\n                    },\n                    // Map chat context (required by DynamicStateSnapshot)\n                    chatContext: {\n                        currentConversationId: storedState.chatContext?.currentConversationId,\n                        draftMessage: storedState.chatContext?.draftMessage || '',\n                        lastMessageTimestamp: storedState.chatContext?.lastMessageTimestamp || 0\n                    },\n                    // Map page state\n                    pageState: {\n                        lastVisitedPath: storedState.pageState?.lastVisitedPath || '/',\n                        scrollPositions: storedState.pageState?.scrollPositions || {}\n                    },\n                    // Map widget states\n                    widgetStates: {\n                        tradingPositions: storedState.widgetStates?.tradingPositions || [],\n                        walletBalance: storedState.widgetStates?.walletBalance || 0\n                    },\n                    // Map extended chat state\n                    chatState: {\n                        activeSessions: storedState.chatState?.activeSessions || [],\n                        currentSessionId: storedState.chatState?.currentSessionId,\n                        sessions: storedState.chatState?.sessions || {},\n                        draftMessages: storedState.chatState?.draftMessages || {}\n                    },\n                    // Map trading state\n                    tradingState: storedState.tradingState ? {\n                        selectedToken: storedState.tradingState.selectedToken,\n                        watchlist: storedState.tradingState.watchlist || [],\n                        tradeHistory: storedState.tradingState.tradeHistory || [],\n                        tradeForm: storedState.tradingState.tradeForm,\n                        resolution: storedState.tradingState.resolution,\n                        search: storedState.tradingState.search,\n                        positions: storedState.tradingState.positions || []\n                    } : {},\n                    // Map wallet state\n                    walletState: storedState.walletState ? {\n                        connectedWallets: storedState.walletState.connectedWallets || [],\n                        transactions: storedState.walletState.transactions || []\n                    } : {},\n                    // Map social state\n                    socialState: storedState.socialState ? {\n                        posts: storedState.socialState.posts || [],\n                        following: storedState.socialState.following || [],\n                        notifications: storedState.socialState.notifications || []\n                    } : {},\n                    // Map UI state with defaults\n                    uiState: {\n                        darkMode: storedState.uiState?.darkMode ?? true,\n                        sidebarOpen: storedState.uiState?.sidebarOpen ?? true,\n                        activeTabs: storedState.uiState?.activeTabs || {}\n                    },\n                    // Initialize xfeed with default values since it's not in DynamicStateSnapshot\n                    xfeed: {\n                        followedAccounts: [],\n                        lastUpdated: undefined\n                    }\n                };\n                // Apply the hydrated state\n                dispatch({\n                    type: 'HYDRATE_STATE',\n                    payload: hydratedState\n                });\n                // Handle navigation if needed\n                if (navigate && hydratedState.pageState?.lastVisitedPath) {\n                    navigate(hydratedState.pageState.lastVisitedPath);\n                    // Restore scroll position after a small delay\n                    if (hydratedState.pageState.scrollPositions) {\n                        setTimeout({\n                            \"AppStateProvider.useCallback[hydrateFromStorage]\": ()=>{\n                                const scrollY = hydratedState.pageState?.scrollPositions?.[hydratedState.pageState.lastVisitedPath || ''];\n                                if (typeof scrollY === 'number') {\n                                    window.scrollTo(0, scrollY);\n                                }\n                            }\n                        }[\"AppStateProvider.useCallback[hydrateFromStorage]\"], 100);\n                    }\n                }\n                // Check for active session in localStorage\n                const activeSessionId = localStorage.getItem('activeSessionId');\n                if (activeSessionId && !hydratedState.chatContext?.currentConversationId) {\n                    dispatch({\n                        type: 'SET_CHAT_CONTEXT',\n                        payload: {\n                            ...hydratedState.chatContext,\n                            currentConversationId: activeSessionId\n                        }\n                    });\n                }\n                // Mark as hydrated\n                setIsStateHydrated(true);\n            } catch (error) {\n                console.error('Error hydrating state:', error);\n                // Even if there's an error, we should mark as hydrated to prevent infinite loading\n                setIsStateHydrated(true);\n            } finally{\n                setIsStateLoading(false);\n            }\n        }\n    }[\"AppStateProvider.useCallback[hydrateFromStorage]\"], []);\n    // Initial hydration on mount\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AppStateProvider.useEffect\": ()=>{\n            // Set loading state\n            dispatch({\n                type: 'SET_UI_STATE',\n                payload: {\n                    isLoading: true\n                }\n            });\n            // Small delay to allow UI to render loading state\n            const timer = setTimeout({\n                \"AppStateProvider.useEffect.timer\": ()=>{\n                    hydrateFromStorage();\n                    dispatch({\n                        type: 'SET_UI_STATE',\n                        payload: {\n                            isLoading: false\n                        }\n                    });\n                }\n            }[\"AppStateProvider.useEffect.timer\"], 300);\n            return ({\n                \"AppStateProvider.useEffect\": ()=>clearTimeout(timer)\n            })[\"AppStateProvider.useEffect\"];\n        }\n    }[\"AppStateProvider.useEffect\"], [\n        hydrateFromStorage\n    ]);\n    // Listen for changes from other tabs\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AppStateProvider.useEffect\": ()=>{\n            const handleStorageChange = {\n                \"AppStateProvider.useEffect.handleStorageChange\": (event)=>{\n                    // Only process events for our storage key\n                    const STORAGE_KEY = 'GRACE_DYNAMIC_SNAPSHOT'; // Must match the key in StatePersistenceManager\n                    if (event.key === STORAGE_KEY) {\n                        // Prevent processing our own updates\n                        if (isUpdatingFromStorage.current) {\n                            return;\n                        }\n                        console.log('State changed in another tab, synchronizing...');\n                        try {\n                            // Update flag to prevent circular updates\n                            isUpdatingFromStorage.current = true;\n                            // Parse new state from storage\n                            const newState = event.newValue ? JSON.parse(event.newValue) : null;\n                            // Validate state before applying\n                            if (newState && typeof newState === 'object' && newState.timestamp) {\n                                // Signal that we're syncing from another tab\n                                setIsStateSyncing(true);\n                                // Only apply if the timestamp is newer\n                                if (!state.timestamp || newState.timestamp > state.timestamp) {\n                                    dispatch({\n                                        type: 'HYDRATE_STATE',\n                                        payload: newState\n                                    });\n                                    console.log('State synchronized from another tab');\n                                }\n                            }\n                            // Reset syncing state after a delay\n                            setTimeout({\n                                \"AppStateProvider.useEffect.handleStorageChange\": ()=>setIsStateSyncing(false)\n                            }[\"AppStateProvider.useEffect.handleStorageChange\"], 1000);\n                        } catch (error) {\n                            console.error('Error synchronizing state from another tab:', error);\n                        } finally{\n                            // Reset flag after a short delay\n                            setTimeout({\n                                \"AppStateProvider.useEffect.handleStorageChange\": ()=>{\n                                    isUpdatingFromStorage.current = false;\n                                }\n                            }[\"AppStateProvider.useEffect.handleStorageChange\"], 100);\n                        }\n                    }\n                }\n            }[\"AppStateProvider.useEffect.handleStorageChange\"];\n            // Add event listener for storage events\n            window.addEventListener('storage', handleStorageChange);\n            // Cleanup event listener on unmount\n            return ({\n                \"AppStateProvider.useEffect\": ()=>{\n                    window.removeEventListener('storage', handleStorageChange);\n                }\n            })[\"AppStateProvider.useEffect\"];\n        }\n    }[\"AppStateProvider.useEffect\"], [\n        state.timestamp\n    ]);\n    // Save state to storage whenever it changes with debounce to prevent race conditions\n    const debouncedSaveTimeout = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const lastSavedTimestamp = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AppStateProvider.useEffect\": ()=>{\n            // Skip initial render to avoid overwriting with empty state\n            // Only proceed if we have some meaningful state to save\n            const hasContent = Object.keys(state.tradingState || {}).length > 0 || Object.keys(state.walletState || {}).length > 0 || Object.keys(state.chatContext || {}).length > 0 || Object.keys(state.chatState?.sessions || {}).length > 0;\n            if (hasContent) {\n                // Clear any existing timeout to debounce frequent updates\n                if (debouncedSaveTimeout.current !== null) {\n                    clearTimeout(debouncedSaveTimeout.current);\n                }\n                // Debounce state saves to prevent excessive writes and race conditions\n                debouncedSaveTimeout.current = window.setTimeout({\n                    \"AppStateProvider.useEffect\": ()=>{\n                        // Only save if we're not currently processing an update from storage\n                        if (!isUpdatingFromStorage.current) {\n                            // Don't save too frequently - at most once every 2 seconds\n                            const now = Date.now();\n                            if (now - lastSavedTimestamp.current > 2000) {\n                                lastSavedTimestamp.current = now;\n                                // Ensure timestamp is updated\n                                const stateToSave = {\n                                    ...state,\n                                    timestamp: now\n                                };\n                                // Add metadata for debugging\n                                if (state.chatContext?.currentConversationId) {\n                                    console.log(`Saving state with active conversation: ${state.chatContext.currentConversationId}`);\n                                }\n                                try {\n                                    ({\n                                        \"AppStateProvider.useEffect\": async ()=>{\n                                            try {\n                                                await _utils_StatePersistence__WEBPACK_IMPORTED_MODULE_2__[\"default\"].captureSnapshot(stateToSave);\n                                                console.log('State saved to localStorage', new Date().toISOString());\n                                                // Also ensure the activeSessionId is set in localStorage if we have a current conversation\n                                                if (state.chatContext?.currentConversationId) {\n                                                    localStorage.setItem('activeSessionId', state.chatContext.currentConversationId);\n                                                }\n                                            } catch (error) {\n                                                console.error('Error saving state to localStorage:', error);\n                                            }\n                                        }\n                                    })[\"AppStateProvider.useEffect\"]();\n                                } catch (error) {\n                                    console.error('Error in state persistence flow:', error);\n                                }\n                            }\n                        }\n                        debouncedSaveTimeout.current = null;\n                    }\n                }[\"AppStateProvider.useEffect\"], 300); // 300ms debounce time\n            }\n            // Cleanup timeout on unmount\n            return ({\n                \"AppStateProvider.useEffect\": ()=>{\n                    if (debouncedSaveTimeout.current !== null) {\n                        clearTimeout(debouncedSaveTimeout.current);\n                    }\n                }\n            })[\"AppStateProvider.useEffect\"];\n        }\n    }[\"AppStateProvider.useEffect\"], [\n        state\n    ]);\n    const contextValue = {\n        state,\n        dispatch,\n        isStateLoading,\n        isStateHydrated,\n        isStateRecovered,\n        isStateSyncing,\n        hydrateFromStorage\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AppStateContext.Provider, {\n        value: contextValue,\n        children: children\n    }, void 0, false, {\n        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/context/AppStateContext.tsx\",\n        lineNumber: 548,\n        columnNumber: 5\n    }, this);\n}\n// Custom hook for using the app state\nfunction useAppState() {\n    const context = (0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(AppStateContext);\n    if (context === undefined) {\n        throw new Error('useAppState must be used within an AppStateProvider');\n    }\n    return context;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL2NvbnRleHQvQXBwU3RhdGVDb250ZXh0LnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBMEg7QUFDaEM7QUFFdEM7QUF5R3BELHVCQUF1QjtBQUN2QixNQUFNVSxlQUF5QjtJQUM3QkMsV0FBV0MsS0FBS0MsR0FBRztJQUNuQkMsYUFBYSxDQUFDO0lBQ2RDLGFBQWEsQ0FBQztJQUNkLGlEQUFpRDtJQUNqREMsYUFBYTtRQUNYQyx1QkFBdUJDO1FBQ3ZCQyxjQUFjO1FBQ2RDLHNCQUFzQjtJQUN4QjtJQUNBLHNCQUFzQjtJQUN0QkMsV0FBVztRQUNUQyxnQkFBZ0IsRUFBRTtRQUNsQkMsVUFBVSxDQUFDO1FBQ1hDLGVBQWUsQ0FBQztJQUNsQjtJQUNBQyxXQUFXLENBQUM7SUFDWkMsY0FBYyxDQUFDO0lBQ2YsaUJBQWlCO0lBQ2pCQyxZQUFZO0lBQ1pDLFdBQVc7SUFDWEMsV0FBVztJQUNYLGlCQUFpQjtJQUNqQkMsY0FBYyxDQUFDO0lBQ2ZDLGFBQWEsQ0FBQztJQUNkQyxhQUFhLENBQUM7SUFDZEMsU0FBUztRQUNQQyxVQUFVO1FBQ1ZDLGFBQWE7SUFDZjtJQUNBQyxPQUFPO1FBQ0xDLGtCQUFrQixFQUFFO1FBQ3BCQyxhQUFhcEI7SUFDZjtBQUNGO0FBb0JBLGdCQUFnQjtBQUNoQixTQUFTcUIsZ0JBQWdCQyxLQUFlLEVBQUVDLE1BQWtCO0lBQzFELE9BQVFBLE9BQU9DLElBQUk7UUFDakIsS0FBSztZQUNILE9BQU87Z0JBQUUsR0FBR0YsS0FBSztnQkFBRVYsY0FBYztvQkFBRSxHQUFHVSxNQUFNVixZQUFZO29CQUFFLEdBQUdXLE9BQU9FLE9BQU87Z0JBQUM7WUFBRTtRQUNoRixLQUFLO1lBQ0gsT0FBTztnQkFBRSxHQUFHSCxLQUFLO2dCQUFFVCxhQUFhO29CQUFFLEdBQUdTLE1BQU1ULFdBQVc7b0JBQUUsR0FBR1UsT0FBT0UsT0FBTztnQkFBQztZQUFFO1FBQzlFLEtBQUs7WUFDSCxPQUFPO2dCQUFFLEdBQUdI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QUFFLE9BQU8rRSxPQUFPO2dEQUNkMUIsUUFBUTBCLEtBQUssQ0FBQyx1Q0FBdUNBOzRDQUN2RDt3Q0FDRjs7Z0NBQ0YsRUFBRSxPQUFPQSxPQUFPO29DQUNkMUIsUUFBUTBCLEtBQUssQ0FBQyxvQ0FBb0NBO2dDQUNwRDs0QkFDRjt3QkFDRjt3QkFDQWMscUJBQXFCUCxPQUFPLEdBQUc7b0JBQ2pDO2lEQUFHLE1BQU0sc0JBQXNCO1lBQ2pDO1lBRUEsNkJBQTZCO1lBQzdCOzhDQUFPO29CQUNMLElBQUlPLHFCQUFxQlAsT0FBTyxLQUFLLE1BQU07d0JBQ3pDTCxhQUFhWSxxQkFBcUJQLE9BQU87b0JBQzNDO2dCQUNGOztRQUNGO3FDQUFHO1FBQUMvRDtLQUFNO0lBR1YsTUFBTWdGLGVBQW9DO1FBQ3hDaEY7UUFDQWE7UUFDQUM7UUFDQUU7UUFDQUU7UUFDQUU7UUFDQU07SUFDRjtJQUVBLHFCQUNFLDhEQUFDaEIsZ0JBQWdCdUUsUUFBUTtRQUFDQyxPQUFPRjtrQkFDOUJwRTs7Ozs7O0FBR1A7QUFFQSxzQ0FBc0M7QUFDL0IsU0FBU3VFO0lBQ2QsTUFBTUMsVUFBVTFILGlEQUFVQSxDQUFDZ0Q7SUFDM0IsSUFBSTBFLFlBQVkxRyxXQUFXO1FBQ3pCLE1BQU0sSUFBSTJHLE1BQU07SUFDbEI7SUFDQSxPQUFPRDtBQUNUIiwic291cmNlcyI6WyIvVXNlcnMvd29ua2Fzd29ybGQvRG93bmxvYWRzL2dyYWNlLXByb2plY3Qvc3JjL3VpL2NvbnRleHQvQXBwU3RhdGVDb250ZXh0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgY3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlUmVkdWNlciwgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlLCBSZWFjdE5vZGUsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyLCB7IER5bmFtaWNTdGF0ZVNuYXBzaG90IH0gZnJvbSAnLi4vdXRpbHMvU3RhdGVQZXJzaXN0ZW5jZSc7XG5pbXBvcnQgeyBOYXZpZ2F0ZUZ1bmN0aW9uIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSAnLi4vY29tcG9uZW50cy9BdXRoQ29udGV4dCc7XG5cbi8vIEV4dGVuZCB0aGUgRHluYW1pY1N0YXRlU25hcHNob3QgaW50ZXJmYWNlIHRvIGluY2x1ZGUgb3VyIGFkZGl0aW9uYWwgYXBwIHN0YXRlXG4vLyBPdXIgZXh0ZW5kZWQgYXBwIHN0YXRlIGludGVyZmFjZSB0aGF0IG1haW50YWlucyBjb21wYXRpYmlsaXR5IHdpdGggRHluYW1pY1N0YXRlU25hcHNob3RcbmV4cG9ydCBpbnRlcmZhY2UgQXBwU3RhdGUge1xuICAvLyBGcm9tIER5bmFtaWNTdGF0ZVNuYXBzaG90IGJhc2VcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIHVzZXJTZXNzaW9uOiB7XG4gICAgdG9rZW4/OiBzdHJpbmc7XG4gICAgdXNlcm5hbWU/OiBzdHJpbmc7XG4gIH07XG4gIHBhZ2VTdGF0ZToge1xuICAgIGxhc3RWaXNpdGVkUGF0aD86IHN0cmluZztcbiAgICBzY3JvbGxQb3NpdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICB9O1xuICB3aWRnZXRTdGF0ZXM6IHtcbiAgICB0cmFkaW5nUG9zaXRpb25zPzogYW55W107XG4gICAgd2FsbGV0QmFsYW5jZT86IG51bWJlcjtcbiAgfTtcbiAgXG4gIC8vIENvcmUgRHluYW1pY1N0YXRlU25hcHNob3QgY2hhdENvbnRleHQgLSB3ZSBtdXN0IG1haW50YWluIHRoaXMgZXhhY3Qgc3RydWN0dXJlXG4gIGNoYXRDb250ZXh0OiB7XG4gICAgY3VycmVudENvbnZlcnNhdGlvbklkPzogc3RyaW5nO1xuICAgIGRyYWZ0TWVzc2FnZT86IHN0cmluZztcbiAgICBsYXN0TWVzc2FnZVRpbWVzdGFtcD86IG51bWJlcjtcbiAgfTtcbiAgXG4gIC8vIEFwcGxpY2F0aW9uIHN0YXRlIG1ldGFkYXRhXG4gIGlzSHlkcmF0ZWQ/OiBib29sZWFuO1xuICBpc0xvYWRpbmc/OiBib29sZWFuO1xuICBsYXN0U2F2ZWQ/OiBudW1iZXI7XG4gIFxuICAvLyBBdXRoIGFuZCB1c2VyIHNlc3Npb24gc3RhdGUgLSBhbGlnbnMgd2l0aCBBdXRoQ29udGV4dFxuICBhdXRoU2Vzc2lvbj86IHtcbiAgICB0b2tlbj86IHN0cmluZztcbiAgICBleHBpcmVzQXQ/OiBudW1iZXI7XG4gICAgcmVmcmVzaFRva2VuPzogc3RyaW5nO1xuICB9O1xuICBcbiAgLy8gVHJhZGluZyBzdGF0ZSBleHRlbnNpb25zXG4gIHRyYWRpbmdTdGF0ZT86IHtcbiAgICBzZWxlY3RlZFRva2VuPzogYW55O1xuICAgIHdhdGNobGlzdD86IHN0cmluZ1tdO1xuICAgIHRyYWRlSGlzdG9yeT86IGFueVtdO1xuICAgIHRyYWRlRm9ybT86IGFueTtcbiAgICByZXNvbHV0aW9uPzogc3RyaW5nO1xuICAgIHNlYXJjaD86IHN0cmluZztcbiAgICBwb3NpdGlvbnM/OiBhbnlbXTtcbiAgfTtcbiAgXG4gIC8vIFNvY2lhbCBtZWRpYSBmZWVkIHNldHRpbmdzXG4gIHhmZWVkPzoge1xuICAgIGZvbGxvd2VkQWNjb3VudHM6IHN0cmluZ1tdO1xuICAgIGxhc3RVcGRhdGVkPzogbnVtYmVyO1xuICB9O1xuICBcbiAgLy8gV2FsbGV0IHN0YXRlIGV4dGVuc2lvbnNcbiAgd2FsbGV0U3RhdGU/OiB7XG4gICAgY29ubmVjdGVkV2FsbGV0cz86IGFueVtdO1xuICAgIHRyYW5zYWN0aW9ucz86IGFueVtdO1xuICB9O1xuICBcbiAgLy8gRXh0ZW5kZWQgY2hhdCBzdGF0ZSAtIHNlcGFyYXRlIGZyb20gdGhlIGJhc2UgY2hhdENvbnRleHQgdG8gYXZvaWQgdHlwZSBjb25mbGljdHNcbiAgLy8gV2lsbCBiZSBzeW5jZWQgd2l0aCB0aGUgbWFpbiBjaGF0Q29udGV4dCBhcyBuZWVkZWRcbiAgY2hhdFN0YXRlPzoge1xuICAgIGFjdGl2ZVNlc3Npb25zPzogc3RyaW5nW107XG4gICAgY3VycmVudFNlc3Npb25JZD86IHN0cmluZztcbiAgICBzZXNzaW9ucz86IHtcbiAgICAgIFtzZXNzaW9uSWQ6IHN0cmluZ106IHtcbiAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgdG9waWM/OiBzdHJpbmc7XG4gICAgICAgIG5hbWU/OiBzdHJpbmc7XG4gICAgICAgIGNyZWF0ZWRfYXQ/OiBzdHJpbmc7XG4gICAgICAgIHVwZGF0ZWRfYXQ/OiBzdHJpbmc7XG4gICAgICAgIHByZXZpZXdfbWVzc2FnZT86IHN0cmluZztcbiAgICAgICAgbWVzc2FnZXM/OiBBcnJheTx7XG4gICAgICAgICAgaWQ6IHN0cmluZztcbiAgICAgICAgICBjb250ZW50OiBzdHJpbmc7XG4gICAgICAgICAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCcgfCAnc3lzdGVtJztcbiAgICAgICAgICB0aW1lc3RhbXA6IHN0cmluZztcbiAgICAgICAgfT47XG4gICAgICAgIHVucmVhZF9jb3VudD86IG51bWJlcjtcbiAgICAgICAgc2Nyb2xsUG9zaXRpb24/OiBudW1iZXI7XG4gICAgICB9O1xuICAgIH07XG4gICAgZHJhZnRNZXNzYWdlcz86IHtcbiAgICAgIFtzZXNzaW9uSWQ6IHN0cmluZ106IHN0cmluZztcbiAgICB9O1xuICB9O1xuICBcbiAgLy8gU29jaWFsIHN0YXRlXG4gIHNvY2lhbFN0YXRlPzoge1xuICAgIHBvc3RzPzogYW55W107XG4gICAgZm9sbG93aW5nPzogc3RyaW5nW107XG4gICAgbm90aWZpY2F0aW9ucz86IGFueVtdO1xuICB9O1xuICBcbiAgLy8gVUkgc3RhdGVcbiAgdWlTdGF0ZT86IHtcbiAgICBkYXJrTW9kZT86IGJvb2xlYW47XG4gICAgc2lkZWJhck9wZW4/OiBib29sZWFuO1xuICAgIGFjdGl2ZVRhYnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICB9O1xufVxuXG4vLyBJbml0aWFsIHN0YXRlIG9iamVjdFxuY29uc3QgaW5pdGlhbFN0YXRlOiBBcHBTdGF0ZSA9IHtcbiAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICB1c2VyU2Vzc2lvbjoge30sXG4gIGF1dGhTZXNzaW9uOiB7fSxcbiAgLy8gU3RhbmRhcmQgY2hhdENvbnRleHQgZnJvbSBEeW5hbWljU3RhdGVTbmFwc2hvdFxuICBjaGF0Q29udGV4dDoge1xuICAgIGN1cnJlbnRDb252ZXJzYXRpb25JZDogdW5kZWZpbmVkLFxuICAgIGRyYWZ0TWVzc2FnZTogJycsXG4gICAgbGFzdE1lc3NhZ2VUaW1lc3RhbXA6IDBcbiAgfSxcbiAgLy8gRXh0ZW5kZWQgY2hhdCBzdGF0ZVxuICBjaGF0U3RhdGU6IHtcbiAgICBhY3RpdmVTZXNzaW9uczogW10sXG4gICAgc2Vzc2lvbnM6IHt9LFxuICAgIGRyYWZ0TWVzc2FnZXM6IHt9XG4gIH0sXG4gIHBhZ2VTdGF0ZToge30sXG4gIHdpZGdldFN0YXRlczoge30sXG4gIC8vIFN0YXRlIG1ldGFkYXRhXG4gIGlzSHlkcmF0ZWQ6IGZhbHNlLFxuICBpc0xvYWRpbmc6IGZhbHNlLFxuICBsYXN0U2F2ZWQ6IDAsXG4gIC8vIEV4dGVuZGVkIHN0YXRlXG4gIHRyYWRpbmdTdGF0ZToge30sXG4gIHdhbGxldFN0YXRlOiB7fSxcbiAgc29jaWFsU3RhdGU6IHt9LFxuICB1aVN0YXRlOiB7XG4gICAgZGFya01vZGU6IHRydWUsXG4gICAgc2lkZWJhck9wZW46IHRydWUsXG4gIH0sXG4gIHhmZWVkOiB7XG4gICAgZm9sbG93ZWRBY2NvdW50czogW10sXG4gICAgbGFzdFVwZGF0ZWQ6IHVuZGVmaW5lZFxuICB9XG59O1xuXG4vLyBBY3Rpb24gdHlwZXNcbnR5cGUgQWN0aW9uVHlwZSA9XG4gIHwgeyB0eXBlOiAnU0VUX1RSQURJTkdfU1RBVEUnOyBwYXlsb2FkOiBhbnkgfVxuICB8IHsgdHlwZTogJ1NFVF9XQUxMRVRfU1RBVEUnOyBwYXlsb2FkOiBhbnkgfVxuICB8IHsgdHlwZTogJ1NFVF9DSEFUX0NPTlRFWFQnOyBwYXlsb2FkOiBhbnkgfVxuICB8IHsgdHlwZTogJ1NFVF9DSEFUX1NUQVRFJzsgcGF5bG9hZDogYW55IH1cbiAgfCB7IHR5cGU6ICdTRVRfU09DSUFMX1NUQVRFJzsgcGF5bG9hZDogYW55IH1cbiAgfCB7IHR5cGU6ICdTRVRfVUlfU1RBVEUnOyBwYXlsb2FkOiBhbnkgfVxuICB8IHsgdHlwZTogJ1NFVF9QQUdFX1NUQVRFJzsgcGF5bG9hZDogYW55IH1cbiAgfCB7IHR5cGU6ICdTRVRfV0lER0VUX1NUQVRFUyc7IHBheWxvYWQ6IGFueSB9XG4gIHwgeyB0eXBlOiAnU0VUX1VTRVJfU0VTU0lPTic7IHBheWxvYWQ6IGFueSB9XG4gIHwgeyB0eXBlOiAnVVBEQVRFX1hGRUVEJzsgcGF5bG9hZDogYW55IH1cbiAgfCB7IHR5cGU6ICdIWURSQVRFX1NUQVRFJzsgcGF5bG9hZDogQXBwU3RhdGUgfVxuICB8IHsgdHlwZTogJ1JFU0VUX1NUQVRFJyB9XG4gIHwgeyB0eXBlOiAnSFlEUkFURSc7IHBheWxvYWQ6IEFwcFN0YXRlIH1cbiAgfCB7IHR5cGU6ICdSRVNFVCcgfVxuICB8IHsgdHlwZTogJ1VQREFURV9BVVRIJzsgcGF5bG9hZDogeyB1c2VyOiBhbnk7IHRva2VuOiBzdHJpbmcgfCBudWxsIH0gfTtcblxuLy8gU3RhdGUgcmVkdWNlclxuZnVuY3Rpb24gYXBwU3RhdGVSZWR1Y2VyKHN0YXRlOiBBcHBTdGF0ZSwgYWN0aW9uOiBBY3Rpb25UeXBlKTogQXBwU3RhdGUge1xuICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgY2FzZSAnU0VUX1RSQURJTkdfU1RBVEUnOlxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIHRyYWRpbmdTdGF0ZTogeyAuLi5zdGF0ZS50cmFkaW5nU3RhdGUsIC4uLmFjdGlvbi5wYXlsb2FkIH0gfTtcbiAgICBjYXNlICdTRVRfV0FMTEVUX1NUQVRFJzpcbiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCB3YWxsZXRTdGF0ZTogeyAuLi5zdGF0ZS53YWxsZXRTdGF0ZSwgLi4uYWN0aW9uLnBheWxvYWQgfSB9O1xuICAgIGNhc2UgJ1NFVF9DSEFUX1NUQVRFJzpcbiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCBjaGF0U3RhdGU6IHsgLi4uc3RhdGUuY2hhdFN0YXRlLCAuLi5hY3Rpb24ucGF5bG9hZCB9IH07XG4gICAgY2FzZSAnU0VUX1NPQ0lBTF9TVEFURSc6XG4gICAgICByZXR1cm4geyAuLi5zdGF0ZSwgc29jaWFsU3RhdGU6IHsgLi4uc3RhdGUuc29jaWFsU3RhdGUsIC4uLmFjdGlvbi5wYXlsb2FkIH0gfTtcbiAgICBjYXNlICdTRVRfVUlfU1RBVEUnOlxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIHVpU3RhdGU6IHsgLi4uc3RhdGUudWlTdGF0ZSwgLi4uYWN0aW9uLnBheWxvYWQgfSB9O1xuICAgIGNhc2UgJ1NFVF9QQUdFX1NUQVRFJzpcbiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCBwYWdlU3RhdGU6IHsgLi4uc3RhdGUucGFnZVN0YXRlLCAuLi5hY3Rpb24ucGF5bG9hZCB9IH07XG4gICAgY2FzZSAnU0VUX1dJREdFVF9TVEFURVMnOlxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIHdpZGdldFN0YXRlczogeyAuLi5zdGF0ZS53aWRnZXRTdGF0ZXMsIC4uLmFjdGlvbi5wYXlsb2FkIH0gfTtcbiAgICBjYXNlICdTRVRfQ0hBVF9DT05URVhUJzpcbiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCBjaGF0Q29udGV4dDogeyAuLi5zdGF0ZS5jaGF0Q29udGV4dCwgLi4uYWN0aW9uLnBheWxvYWQgfSB9O1xuICAgIGNhc2UgJ1NFVF9VU0VSX1NFU1NJT04nOlxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIHVzZXJTZXNzaW9uOiB7IC4uLnN0YXRlLnVzZXJTZXNzaW9uLCAuLi5hY3Rpb24ucGF5bG9hZCB9IH07XG4gICAgY2FzZSAnVVBEQVRFX0FVVEgnOlxuICAgICAgY29uc3QgeyB1c2VyLCB0b2tlbiB9ID0gYWN0aW9uLnBheWxvYWQ7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgdXNlclNlc3Npb246IHtcbiAgICAgICAgICAuLi5zdGF0ZS51c2VyU2Vzc2lvbixcbiAgICAgICAgICB0b2tlbjogdG9rZW4gfHwgJycsXG4gICAgICAgICAgdXNlcm5hbWU6IHVzZXI/LnVzZXJuYW1lIHx8ICcnXG4gICAgICAgIH0sXG4gICAgICAgIGF1dGhTZXNzaW9uOiB7XG4gICAgICAgICAgLi4uc3RhdGUuYXV0aFNlc3Npb24sXG4gICAgICAgICAgdG9rZW46IHRva2VuIHx8ICcnLFxuICAgICAgICAgIGV4cGlyZXNBdDogdG9rZW4gPyBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSArICgyNCAqIDYwICogNjApIDogdW5kZWZpbmVkXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgY2FzZSAnVVBEQVRFX1hGRUVEJzpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICB4ZmVlZDoge1xuICAgICAgICAgIC4uLnN0YXRlLnhmZWVkLFxuICAgICAgICAgIC4uLmFjdGlvbi5wYXlsb2FkLFxuICAgICAgICAgIGxhc3RVcGRhdGVkOiBEYXRlLm5vdygpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgY2FzZSAnSFlEUkFURV9TVEFURSc6XG4gICAgICByZXR1cm4geyAuLi5hY3Rpb24ucGF5bG9hZCB9O1xuICAgIGNhc2UgJ1JFU0VUX1NUQVRFJzpcbiAgICAgIHJldHVybiBpbml0aWFsU3RhdGU7XG4gICAgLy8gQ29tcGF0aWJpbGl0eSBhbGlhc2VzXG4gICAgY2FzZSAnSFlEUkFURSc6XG4gICAgICByZXR1cm4geyAuLi5hY3Rpb24ucGF5bG9hZCB9O1xuICAgIGNhc2UgJ1JFU0VUJzpcbiAgICAgIHJldHVybiBpbml0aWFsU3RhdGU7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBzdGF0ZTtcbiAgfVxufVxuXG4vLyBDcmVhdGUgY29udGV4dFxuaW50ZXJmYWNlIEFwcFN0YXRlQ29udGV4dFR5cGUge1xuICBzdGF0ZTogQXBwU3RhdGU7XG4gIGRpc3BhdGNoOiBSZWFjdC5EaXNwYXRjaDxBY3Rpb25UeXBlPjtcbiAgaXNTdGF0ZUxvYWRpbmc6IGJvb2xlYW47XG4gIGlzU3RhdGVIeWRyYXRlZDogYm9vbGVhbjtcbiAgaXNTdGF0ZVJlY292ZXJlZDogYm9vbGVhbjtcbiAgaXNTdGF0ZVN5bmNpbmc6IGJvb2xlYW47XG4gIGh5ZHJhdGVGcm9tU3RvcmFnZTogKG5hdmlnYXRlPzogTmF2aWdhdGVGdW5jdGlvbikgPT4gUHJvbWlzZTx2b2lkPjtcbn1cblxuY29uc3QgQXBwU3RhdGVDb250ZXh0ID0gY3JlYXRlQ29udGV4dDxBcHBTdGF0ZUNvbnRleHRUeXBlIHwgdW5kZWZpbmVkPih1bmRlZmluZWQpO1xuXG4vLyBQcm92aWRlciBjb21wb25lbnRcbmludGVyZmFjZSBBcHBTdGF0ZVByb3ZpZGVyUHJvcHMge1xuICBjaGlsZHJlbjogUmVhY3ROb2RlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gQXBwU3RhdGVQcm92aWRlcih7IGNoaWxkcmVuIH06IEFwcFN0YXRlUHJvdmlkZXJQcm9wcykge1xuICBjb25zdCBbc3RhdGUsIGRpc3BhdGNoXSA9IHVzZVJlZHVjZXIoYXBwU3RhdGVSZWR1Y2VyLCBpbml0aWFsU3RhdGUpO1xuICBjb25zdCBbaXNTdGF0ZUxvYWRpbmcsIHNldElzU3RhdGVMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xuICBjb25zdCBbaXNTdGF0ZUh5ZHJhdGVkLCBzZXRJc1N0YXRlSHlkcmF0ZWRdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaXNTdGF0ZVJlY292ZXJlZCwgc2V0SXNTdGF0ZVJlY292ZXJlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtpc1N0YXRlU3luY2luZywgc2V0SXNTdGF0ZVN5bmNpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBpc1VwZGF0aW5nRnJvbVN0b3JhZ2UgPSB1c2VSZWYoZmFsc2UpO1xuICBcbiAgLy8gR2V0IGF1dGggc3RhdGUgZnJvbSBBdXRoQ29udGV4dFxuICBjb25zdCB7IHVzZXIsIGlzQXV0aGVudGljYXRlZCB9ID0gdXNlQXV0aCgpO1xuXG4gIC8vIFN5bmMgYXV0aCBzdGF0ZSB3aXRoIEFwcFN0YXRlXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogJ1VQREFURV9BVVRIJyxcbiAgICAgIHBheWxvYWQ6IHtcbiAgICAgICAgdXNlcjogaXNBdXRoZW50aWNhdGVkID8gdXNlciA6IG51bGwsXG4gICAgICAgIHRva2VuOiBpc0F1dGhlbnRpY2F0ZWQgPyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYXV0aFRva2VuJykgOiBudWxsXG4gICAgICB9XG4gICAgfSk7XG4gIH0sIFt1c2VyLCBpc0F1dGhlbnRpY2F0ZWRdKTtcblxuICAvLyBIeWRyYXRlIHN0YXRlIGZyb20gc3RvcmFnZSBvbiBpbml0aWFsIGxvYWRcbiAgY29uc3QgaHlkcmF0ZUZyb21TdG9yYWdlID0gdXNlQ2FsbGJhY2soYXN5bmMgKG5hdmlnYXRlPzogTmF2aWdhdGVGdW5jdGlvbikgPT4ge1xuICAgIHRyeSB7XG4gICAgICBzZXRJc1N0YXRlTG9hZGluZyh0cnVlKTtcbiAgICAgIFxuICAgICAgLy8gR2V0IHRoZSBzdG9yZWQgc3RhdGUgdXNpbmcgdGhlIHN5bmNocm9ub3VzIHJldHJpZXZlU25hcHNob3QgbWV0aG9kXG4gICAgICBjb25zdCBzdG9yZWRTdGF0ZSA9IFN0YXRlUGVyc2lzdGVuY2VNYW5hZ2VyLnJldHJpZXZlU25hcHNob3QoKTtcbiAgICAgIFxuICAgICAgaWYgKCFzdG9yZWRTdGF0ZSkge1xuICAgICAgICBjb25zb2xlLmxvZygnTm8gc3RvcmVkIHN0YXRlIGZvdW5kJyk7XG4gICAgICAgIHNldElzU3RhdGVIeWRyYXRlZCh0cnVlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnSHlkcmF0aW5nIHN0YXRlIGZyb20gc3RvcmFnZTonLCBzdG9yZWRTdGF0ZSk7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBhIGNsZWFuIHN0YXRlIG9iamVjdCB3aXRoIHByb3BlciBkZWZhdWx0c1xuICAgICAgY29uc3QgaHlkcmF0ZWRTdGF0ZTogQXBwU3RhdGUgPSB7XG4gICAgICAgIC8vIFJlcXVpcmVkIGZpZWxkcyBmcm9tIEFwcFN0YXRlXG4gICAgICAgIHRpbWVzdGFtcDogc3RvcmVkU3RhdGUudGltZXN0YW1wIHx8IERhdGUubm93KCksXG4gICAgICAgIGlzSHlkcmF0ZWQ6IHRydWUsXG4gICAgICAgIGxhc3RTYXZlZDogMCwgLy8gV2lsbCBiZSB1cGRhdGVkIG9uIG5leHQgc2F2ZVxuICAgICAgICBcbiAgICAgICAgLy8gTWFwIHVzZXIgc2Vzc2lvblxuICAgICAgICB1c2VyU2Vzc2lvbjoge1xuICAgICAgICAgIHRva2VuOiBzdG9yZWRTdGF0ZS51c2VyU2Vzc2lvbj8udG9rZW4gfHwgJycsXG4gICAgICAgICAgdXNlcm5hbWU6IHN0b3JlZFN0YXRlLnVzZXJTZXNzaW9uPy51c2VybmFtZSB8fCAnJ1xuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy8gTWFwIGNoYXQgY29udGV4dCAocmVxdWlyZWQgYnkgRHluYW1pY1N0YXRlU25hcHNob3QpXG4gICAgICAgIGNoYXRDb250ZXh0OiB7XG4gICAgICAgICAgY3VycmVudENvbnZlcnNhdGlvbklkOiBzdG9yZWRTdGF0ZS5jaGF0Q29udGV4dD8uY3VycmVudENvbnZlcnNhdGlvbklkLFxuICAgICAgICAgIGRyYWZ0TWVzc2FnZTogc3RvcmVkU3RhdGUuY2hhdENvbnRleHQ/LmRyYWZ0TWVzc2FnZSB8fCAnJyxcbiAgICAgICAgICBsYXN0TWVzc2FnZVRpbWVzdGFtcDogc3RvcmVkU3RhdGUuY2hhdENvbnRleHQ/Lmxhc3RNZXNzYWdlVGltZXN0YW1wIHx8IDBcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vIE1hcCBwYWdlIHN0YXRlXG4gICAgICAgIHBhZ2VTdGF0ZToge1xuICAgICAgICAgIGxhc3RWaXNpdGVkUGF0aDogc3RvcmVkU3RhdGUucGFnZVN0YXRlPy5sYXN0VmlzaXRlZFBhdGggfHwgJy8nLFxuICAgICAgICAgIHNjcm9sbFBvc2l0aW9uczogc3RvcmVkU3RhdGUucGFnZVN0YXRlPy5zY3JvbGxQb3NpdGlvbnMgfHwge31cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIC8vIE1hcCB3aWRnZXQgc3RhdGVzXG4gICAgICAgIHdpZGdldFN0YXRlczoge1xuICAgICAgICAgIHRyYWRpbmdQb3NpdGlvbnM6IHN0b3JlZFN0YXRlLndpZGdldFN0YXRlcz8udHJhZGluZ1Bvc2l0aW9ucyB8fCBbXSxcbiAgICAgICAgICB3YWxsZXRCYWxhbmNlOiBzdG9yZWRTdGF0ZS53aWRnZXRTdGF0ZXM/LndhbGxldEJhbGFuY2UgfHwgMFxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy8gTWFwIGV4dGVuZGVkIGNoYXQgc3RhdGVcbiAgICAgICAgY2hhdFN0YXRlOiB7XG4gICAgICAgICAgYWN0aXZlU2Vzc2lvbnM6IHN0b3JlZFN0YXRlLmNoYXRTdGF0ZT8uYWN0aXZlU2Vzc2lvbnMgfHwgW10sXG4gICAgICAgICAgY3VycmVudFNlc3Npb25JZDogc3RvcmVkU3RhdGUuY2hhdFN0YXRlPy5jdXJyZW50U2Vzc2lvbklkLFxuICAgICAgICAgIHNlc3Npb25zOiBzdG9yZWRTdGF0ZS5jaGF0U3RhdGU/LnNlc3Npb25zIHx8IHt9LFxuICAgICAgICAgIGRyYWZ0TWVzc2FnZXM6IHN0b3JlZFN0YXRlLmNoYXRTdGF0ZT8uZHJhZnRNZXNzYWdlcyB8fCB7fVxuICAgICAgICB9LFxuICAgICAgICBcbiAgICAgICAgLy8gTWFwIHRyYWRpbmcgc3RhdGVcbiAgICAgICAgdHJhZGluZ1N0YXRlOiBzdG9yZWRTdGF0ZS50cmFkaW5nU3RhdGUgPyB7XG4gICAgICAgICAgc2VsZWN0ZWRUb2tlbjogc3RvcmVkU3RhdGUudHJhZGluZ1N0YXRlLnNlbGVjdGVkVG9rZW4sXG4gICAgICAgICAgd2F0Y2hsaXN0OiBzdG9yZWRTdGF0ZS50cmFkaW5nU3RhdGUud2F0Y2hsaXN0IHx8IFtdLFxuICAgICAgICAgIHRyYWRlSGlzdG9yeTogc3RvcmVkU3RhdGUudHJhZGluZ1N0YXRlLnRyYWRlSGlzdG9yeSB8fCBbXSxcbiAgICAgICAgICB0cmFkZUZvcm06IHN0b3JlZFN0YXRlLnRyYWRpbmdTdGF0ZS50cmFkZUZvcm0sXG4gICAgICAgICAgcmVzb2x1dGlvbjogc3RvcmVkU3RhdGUudHJhZGluZ1N0YXRlLnJlc29sdXRpb24sXG4gICAgICAgICAgc2VhcmNoOiBzdG9yZWRTdGF0ZS50cmFkaW5nU3RhdGUuc2VhcmNoLFxuICAgICAgICAgIHBvc2l0aW9uczogc3RvcmVkU3RhdGUudHJhZGluZ1N0YXRlLnBvc2l0aW9ucyB8fCBbXVxuICAgICAgICB9IDoge30sXG4gICAgICAgIFxuICAgICAgICAvLyBNYXAgd2FsbGV0IHN0YXRlXG4gICAgICAgIHdhbGxldFN0YXRlOiBzdG9yZWRTdGF0ZS53YWxsZXRTdGF0ZSA/IHtcbiAgICAgICAgICBjb25uZWN0ZWRXYWxsZXRzOiBzdG9yZWRTdGF0ZS53YWxsZXRTdGF0ZS5jb25uZWN0ZWRXYWxsZXRzIHx8IFtdLFxuICAgICAgICAgIHRyYW5zYWN0aW9uczogc3RvcmVkU3RhdGUud2FsbGV0U3RhdGUudHJhbnNhY3Rpb25zIHx8IFtdXG4gICAgICAgIH0gOiB7fSxcbiAgICAgICAgXG4gICAgICAgIC8vIE1hcCBzb2NpYWwgc3RhdGVcbiAgICAgICAgc29jaWFsU3RhdGU6IHN0b3JlZFN0YXRlLnNvY2lhbFN0YXRlID8ge1xuICAgICAgICAgIHBvc3RzOiBzdG9yZWRTdGF0ZS5zb2NpYWxTdGF0ZS5wb3N0cyB8fCBbXSxcbiAgICAgICAgICBmb2xsb3dpbmc6IHN0b3JlZFN0YXRlLnNvY2lhbFN0YXRlLmZvbGxvd2luZyB8fCBbXSxcbiAgICAgICAgICBub3RpZmljYXRpb25zOiBzdG9yZWRTdGF0ZS5zb2NpYWxTdGF0ZS5ub3RpZmljYXRpb25zIHx8IFtdXG4gICAgICAgIH0gOiB7fSxcbiAgICAgICAgXG4gICAgICAgIC8vIE1hcCBVSSBzdGF0ZSB3aXRoIGRlZmF1bHRzXG4gICAgICAgIHVpU3RhdGU6IHtcbiAgICAgICAgICBkYXJrTW9kZTogc3RvcmVkU3RhdGUudWlTdGF0ZT8uZGFya01vZGUgPz8gdHJ1ZSxcbiAgICAgICAgICBzaWRlYmFyT3Blbjogc3RvcmVkU3RhdGUudWlTdGF0ZT8uc2lkZWJhck9wZW4gPz8gdHJ1ZSxcbiAgICAgICAgICBhY3RpdmVUYWJzOiBzdG9yZWRTdGF0ZS51aVN0YXRlPy5hY3RpdmVUYWJzIHx8IHt9XG4gICAgICAgIH0sXG4gICAgICAgIFxuICAgICAgICAvLyBJbml0aWFsaXplIHhmZWVkIHdpdGggZGVmYXVsdCB2YWx1ZXMgc2luY2UgaXQncyBub3QgaW4gRHluYW1pY1N0YXRlU25hcHNob3RcbiAgICAgICAgeGZlZWQ6IHtcbiAgICAgICAgICBmb2xsb3dlZEFjY291bnRzOiBbXSxcbiAgICAgICAgICBsYXN0VXBkYXRlZDogdW5kZWZpbmVkXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIEFwcGx5IHRoZSBoeWRyYXRlZCBzdGF0ZVxuICAgICAgZGlzcGF0Y2goeyB0eXBlOiAnSFlEUkFURV9TVEFURScsIHBheWxvYWQ6IGh5ZHJhdGVkU3RhdGUgfSk7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBuYXZpZ2F0aW9uIGlmIG5lZWRlZFxuICAgICAgaWYgKG5hdmlnYXRlICYmIGh5ZHJhdGVkU3RhdGUucGFnZVN0YXRlPy5sYXN0VmlzaXRlZFBhdGgpIHtcbiAgICAgICAgbmF2aWdhdGUoaHlkcmF0ZWRTdGF0ZS5wYWdlU3RhdGUubGFzdFZpc2l0ZWRQYXRoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlc3RvcmUgc2Nyb2xsIHBvc2l0aW9uIGFmdGVyIGEgc21hbGwgZGVsYXlcbiAgICAgICAgaWYgKGh5ZHJhdGVkU3RhdGUucGFnZVN0YXRlLnNjcm9sbFBvc2l0aW9ucykge1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsWSA9IGh5ZHJhdGVkU3RhdGUucGFnZVN0YXRlPy5zY3JvbGxQb3NpdGlvbnM/LltoeWRyYXRlZFN0YXRlLnBhZ2VTdGF0ZS5sYXN0VmlzaXRlZFBhdGggfHwgJyddO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBzY3JvbGxZID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgc2Nyb2xsWSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDaGVjayBmb3IgYWN0aXZlIHNlc3Npb24gaW4gbG9jYWxTdG9yYWdlXG4gICAgICBjb25zdCBhY3RpdmVTZXNzaW9uSWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWN0aXZlU2Vzc2lvbklkJyk7XG4gICAgICBpZiAoYWN0aXZlU2Vzc2lvbklkICYmICFoeWRyYXRlZFN0YXRlLmNoYXRDb250ZXh0Py5jdXJyZW50Q29udmVyc2F0aW9uSWQpIHtcbiAgICAgICAgZGlzcGF0Y2goe1xuICAgICAgICAgIHR5cGU6ICdTRVRfQ0hBVF9DT05URVhUJyxcbiAgICAgICAgICBwYXlsb2FkOiB7XG4gICAgICAgICAgICAuLi5oeWRyYXRlZFN0YXRlLmNoYXRDb250ZXh0LFxuICAgICAgICAgICAgY3VycmVudENvbnZlcnNhdGlvbklkOiBhY3RpdmVTZXNzaW9uSWRcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBNYXJrIGFzIGh5ZHJhdGVkXG4gICAgICBzZXRJc1N0YXRlSHlkcmF0ZWQodHJ1ZSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGh5ZHJhdGluZyBzdGF0ZTonLCBlcnJvcik7XG4gICAgICAvLyBFdmVuIGlmIHRoZXJlJ3MgYW4gZXJyb3IsIHdlIHNob3VsZCBtYXJrIGFzIGh5ZHJhdGVkIHRvIHByZXZlbnQgaW5maW5pdGUgbG9hZGluZ1xuICAgICAgc2V0SXNTdGF0ZUh5ZHJhdGVkKHRydWUpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc1N0YXRlTG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgLy8gSW5pdGlhbCBoeWRyYXRpb24gb24gbW91bnRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAvLyBTZXQgbG9hZGluZyBzdGF0ZVxuICAgIGRpc3BhdGNoKHsgdHlwZTogJ1NFVF9VSV9TVEFURScsIHBheWxvYWQ6IHsgaXNMb2FkaW5nOiB0cnVlIH0gfSk7XG4gICAgXG4gICAgLy8gU21hbGwgZGVsYXkgdG8gYWxsb3cgVUkgdG8gcmVuZGVyIGxvYWRpbmcgc3RhdGVcbiAgICBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgaHlkcmF0ZUZyb21TdG9yYWdlKCk7XG4gICAgICBkaXNwYXRjaCh7IHR5cGU6ICdTRVRfVUlfU1RBVEUnLCBwYXlsb2FkOiB7IGlzTG9hZGluZzogZmFsc2UgfSB9KTtcbiAgICB9LCAzMDApO1xuICAgIFxuICAgIHJldHVybiAoKSA9PiBjbGVhclRpbWVvdXQodGltZXIpO1xuICB9LCBbaHlkcmF0ZUZyb21TdG9yYWdlXSk7XG4gIFxuICAvLyBMaXN0ZW4gZm9yIGNoYW5nZXMgZnJvbSBvdGhlciB0YWJzXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlU3RvcmFnZUNoYW5nZSA9IChldmVudDogU3RvcmFnZUV2ZW50KSA9PiB7XG4gICAgICAvLyBPbmx5IHByb2Nlc3MgZXZlbnRzIGZvciBvdXIgc3RvcmFnZSBrZXlcbiAgICAgIGNvbnN0IFNUT1JBR0VfS0VZID0gJ0dSQUNFX0RZTkFNSUNfU05BUFNIT1QnOyAvLyBNdXN0IG1hdGNoIHRoZSBrZXkgaW4gU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXJcbiAgICAgIGlmIChldmVudC5rZXkgPT09IFNUT1JBR0VfS0VZKSB7XG4gICAgICAgIC8vIFByZXZlbnQgcHJvY2Vzc2luZyBvdXIgb3duIHVwZGF0ZXNcbiAgICAgICAgaWYgKGlzVXBkYXRpbmdGcm9tU3RvcmFnZS5jdXJyZW50KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnU3RhdGUgY2hhbmdlZCBpbiBhbm90aGVyIHRhYiwgc3luY2hyb25pemluZy4uLicpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIFVwZGF0ZSBmbGFnIHRvIHByZXZlbnQgY2lyY3VsYXIgdXBkYXRlc1xuICAgICAgICAgIGlzVXBkYXRpbmdGcm9tU3RvcmFnZS5jdXJyZW50ID0gdHJ1ZTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBQYXJzZSBuZXcgc3RhdGUgZnJvbSBzdG9yYWdlXG4gICAgICAgICAgY29uc3QgbmV3U3RhdGUgPSBldmVudC5uZXdWYWx1ZSA/IEpTT04ucGFyc2UoZXZlbnQubmV3VmFsdWUpIDogbnVsbDtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBWYWxpZGF0ZSBzdGF0ZSBiZWZvcmUgYXBwbHlpbmdcbiAgICAgICAgICBpZiAobmV3U3RhdGUgJiYgdHlwZW9mIG5ld1N0YXRlID09PSAnb2JqZWN0JyAmJiBuZXdTdGF0ZS50aW1lc3RhbXApIHtcbiAgICAgICAgICAgIC8vIFNpZ25hbCB0aGF0IHdlJ3JlIHN5bmNpbmcgZnJvbSBhbm90aGVyIHRhYlxuICAgICAgICAgICAgc2V0SXNTdGF0ZVN5bmNpbmcodHJ1ZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE9ubHkgYXBwbHkgaWYgdGhlIHRpbWVzdGFtcCBpcyBuZXdlclxuICAgICAgICAgICAgaWYgKCFzdGF0ZS50aW1lc3RhbXAgfHwgbmV3U3RhdGUudGltZXN0YW1wID4gc3RhdGUudGltZXN0YW1wKSB7XG4gICAgICAgICAgICAgIGRpc3BhdGNoKHsgdHlwZTogJ0hZRFJBVEVfU1RBVEUnLCBwYXlsb2FkOiBuZXdTdGF0ZSB9KTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1N0YXRlIHN5bmNocm9uaXplZCBmcm9tIGFub3RoZXIgdGFiJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIFJlc2V0IHN5bmNpbmcgc3RhdGUgYWZ0ZXIgYSBkZWxheVxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gc2V0SXNTdGF0ZVN5bmNpbmcoZmFsc2UpLCAxMDAwKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzeW5jaHJvbml6aW5nIHN0YXRlIGZyb20gYW5vdGhlciB0YWI6JywgZXJyb3IpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIC8vIFJlc2V0IGZsYWcgYWZ0ZXIgYSBzaG9ydCBkZWxheVxuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgaXNVcGRhdGluZ0Zyb21TdG9yYWdlLmN1cnJlbnQgPSBmYWxzZTtcbiAgICAgICAgICB9LCAxMDApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBcbiAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXIgZm9yIHN0b3JhZ2UgZXZlbnRzXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3N0b3JhZ2UnLCBoYW5kbGVTdG9yYWdlQ2hhbmdlKTtcbiAgICBcbiAgICAvLyBDbGVhbnVwIGV2ZW50IGxpc3RlbmVyIG9uIHVubW91bnRcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N0b3JhZ2UnLCBoYW5kbGVTdG9yYWdlQ2hhbmdlKTtcbiAgICB9O1xuICB9LCBbc3RhdGUudGltZXN0YW1wXSk7XG4gIFxuICAvLyBTYXZlIHN0YXRlIHRvIHN0b3JhZ2Ugd2hlbmV2ZXIgaXQgY2hhbmdlcyB3aXRoIGRlYm91bmNlIHRvIHByZXZlbnQgcmFjZSBjb25kaXRpb25zXG4gIGNvbnN0IGRlYm91bmNlZFNhdmVUaW1lb3V0ID0gdXNlUmVmPG51bWJlciB8IG51bGw+KG51bGwpO1xuICBjb25zdCBsYXN0U2F2ZWRUaW1lc3RhbXAgPSB1c2VSZWY8bnVtYmVyPigwKTtcbiAgXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gU2tpcCBpbml0aWFsIHJlbmRlciB0byBhdm9pZCBvdmVyd3JpdGluZyB3aXRoIGVtcHR5IHN0YXRlXG4gICAgLy8gT25seSBwcm9jZWVkIGlmIHdlIGhhdmUgc29tZSBtZWFuaW5nZnVsIHN0YXRlIHRvIHNhdmVcbiAgICBjb25zdCBoYXNDb250ZW50ID0gXG4gICAgICBPYmplY3Qua2V5cyhzdGF0ZS50cmFkaW5nU3RhdGUgfHwge30pLmxlbmd0aCA+IDAgfHwgXG4gICAgICBPYmplY3Qua2V5cyhzdGF0ZS53YWxsZXRTdGF0ZSB8fCB7fSkubGVuZ3RoID4gMCB8fFxuICAgICAgT2JqZWN0LmtleXMoc3RhdGUuY2hhdENvbnRleHQgfHwge30pLmxlbmd0aCA+IDAgfHxcbiAgICAgIE9iamVjdC5rZXlzKHN0YXRlLmNoYXRTdGF0ZT8uc2Vzc2lvbnMgfHwge30pLmxlbmd0aCA+IDA7XG4gICAgXG4gICAgaWYgKGhhc0NvbnRlbnQpIHtcbiAgICAgIC8vIENsZWFyIGFueSBleGlzdGluZyB0aW1lb3V0IHRvIGRlYm91bmNlIGZyZXF1ZW50IHVwZGF0ZXNcbiAgICAgIGlmIChkZWJvdW5jZWRTYXZlVGltZW91dC5jdXJyZW50ICE9PSBudWxsKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChkZWJvdW5jZWRTYXZlVGltZW91dC5jdXJyZW50KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gRGVib3VuY2Ugc3RhdGUgc2F2ZXMgdG8gcHJldmVudCBleGNlc3NpdmUgd3JpdGVzIGFuZCByYWNlIGNvbmRpdGlvbnNcbiAgICAgIGRlYm91bmNlZFNhdmVUaW1lb3V0LmN1cnJlbnQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIC8vIE9ubHkgc2F2ZSBpZiB3ZSdyZSBub3QgY3VycmVudGx5IHByb2Nlc3NpbmcgYW4gdXBkYXRlIGZyb20gc3RvcmFnZVxuICAgICAgICBpZiAoIWlzVXBkYXRpbmdGcm9tU3RvcmFnZS5jdXJyZW50KSB7XG4gICAgICAgICAgLy8gRG9uJ3Qgc2F2ZSB0b28gZnJlcXVlbnRseSAtIGF0IG1vc3Qgb25jZSBldmVyeSAyIHNlY29uZHNcbiAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgICAgIGlmIChub3cgLSBsYXN0U2F2ZWRUaW1lc3RhbXAuY3VycmVudCA+IDIwMDApIHtcbiAgICAgICAgICAgIGxhc3RTYXZlZFRpbWVzdGFtcC5jdXJyZW50ID0gbm93O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBFbnN1cmUgdGltZXN0YW1wIGlzIHVwZGF0ZWRcbiAgICAgICAgICAgIGNvbnN0IHN0YXRlVG9TYXZlID0ge1xuICAgICAgICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgICAgICAgdGltZXN0YW1wOiBub3dcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCBtZXRhZGF0YSBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgICBpZiAoc3RhdGUuY2hhdENvbnRleHQ/LmN1cnJlbnRDb252ZXJzYXRpb25JZCkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgU2F2aW5nIHN0YXRlIHdpdGggYWN0aXZlIGNvbnZlcnNhdGlvbjogJHtzdGF0ZS5jaGF0Q29udGV4dC5jdXJyZW50Q29udmVyc2F0aW9uSWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIC8vIENvbnZlcnQgdG8gYXN5bmMvYXdhaXQgcGF0dGVybiB0byBwcm9wZXJseSBoYW5kbGUgUHJvbWlzZVxuICAgICAgICAgICAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICBhd2FpdCBTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlci5jYXB0dXJlU25hcHNob3Qoc3RhdGVUb1NhdmUpO1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1N0YXRlIHNhdmVkIHRvIGxvY2FsU3RvcmFnZScsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIC8vIEFsc28gZW5zdXJlIHRoZSBhY3RpdmVTZXNzaW9uSWQgaXMgc2V0IGluIGxvY2FsU3RvcmFnZSBpZiB3ZSBoYXZlIGEgY3VycmVudCBjb252ZXJzYXRpb25cbiAgICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5jaGF0Q29udGV4dD8uY3VycmVudENvbnZlcnNhdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVTZXNzaW9uSWQnLCBzdGF0ZS5jaGF0Q29udGV4dC5jdXJyZW50Q29udmVyc2F0aW9uSWQpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgc3RhdGUgdG8gbG9jYWxTdG9yYWdlOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBzdGF0ZSBwZXJzaXN0ZW5jZSBmbG93OicsIGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZGVib3VuY2VkU2F2ZVRpbWVvdXQuY3VycmVudCA9IG51bGw7XG4gICAgICB9LCAzMDApOyAvLyAzMDBtcyBkZWJvdW5jZSB0aW1lXG4gICAgfVxuICAgIFxuICAgIC8vIENsZWFudXAgdGltZW91dCBvbiB1bm1vdW50XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlmIChkZWJvdW5jZWRTYXZlVGltZW91dC5jdXJyZW50ICE9PSBudWxsKSB7XG4gICAgICAgIGNsZWFyVGltZW91dChkZWJvdW5jZWRTYXZlVGltZW91dC5jdXJyZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbc3RhdGVdKTtcbiAgXG4gIFxuICBjb25zdCBjb250ZXh0VmFsdWU6IEFwcFN0YXRlQ29udGV4dFR5cGUgPSB7XG4gICAgc3RhdGUsXG4gICAgZGlzcGF0Y2gsXG4gICAgaXNTdGF0ZUxvYWRpbmcsXG4gICAgaXNTdGF0ZUh5ZHJhdGVkLFxuICAgIGlzU3RhdGVSZWNvdmVyZWQsXG4gICAgaXNTdGF0ZVN5bmNpbmcsXG4gICAgaHlkcmF0ZUZyb21TdG9yYWdlLFxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPEFwcFN0YXRlQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17Y29udGV4dFZhbHVlfT5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICA8L0FwcFN0YXRlQ29udGV4dC5Qcm92aWRlcj5cbiAgKTtcbn1cblxuLy8gQ3VzdG9tIGhvb2sgZm9yIHVzaW5nIHRoZSBhcHAgc3RhdGVcbmV4cG9ydCBmdW5jdGlvbiB1c2VBcHBTdGF0ZSgpIHtcbiAgY29uc3QgY29udGV4dCA9IHVzZUNvbnRleHQoQXBwU3RhdGVDb250ZXh0KTtcbiAgaWYgKGNvbnRleHQgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFcnJvcigndXNlQXBwU3RhdGUgbXVzdCBiZSB1c2VkIHdpdGhpbiBhbiBBcHBTdGF0ZVByb3ZpZGVyJyk7XG4gIH1cbiAgcmV0dXJuIGNvbnRleHQ7XG59XG4iXSwibmFtZXMiOlsiUmVhY3QiLCJjcmVhdGVDb250ZXh0IiwidXNlQ29udGV4dCIsInVzZVJlZHVjZXIiLCJ1c2VFZmZlY3QiLCJ1c2VSZWYiLCJ1c2VTdGF0ZSIsInVzZUNhbGxiYWNrIiwiU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXIiLCJ1c2VBdXRoIiwiaW5pdGlhbFN0YXRlIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInVzZXJTZXNzaW9uIiwiYXV0aFNlc3Npb24iLCJjaGF0Q29udGV4dCIsImN1cnJlbnRDb252ZXJzYXRpb25JZCIsInVuZGVmaW5lZCIsImRyYWZ0TWVzc2FnZSIsImxhc3RNZXNzYWdlVGltZXN0YW1wIiwiY2hhdFN0YXRlIiwiYWN0aXZlU2Vzc2lvbnMiLCJzZXNzaW9ucyIsImRyYWZ0TWVzc2FnZXMiLCJwYWdlU3RhdGUiLCJ3aWRnZXRTdGF0ZXMiLCJpc0h5ZHJhdGVkIiwiaXNMb2FkaW5nIiwibGFzdFNhdmVkIiwidHJhZGluZ1N0YXRlIiwid2FsbGV0U3RhdGUiLCJzb2NpYWxTdGF0ZSIsInVpU3RhdGUiLCJkYXJrTW9kZSIsInNpZGViYXJPcGVuIiwieGZlZWQiLCJmb2xsb3dlZEFjY291bnRzIiwibGFzdFVwZGF0ZWQiLCJhcHBTdGF0ZVJlZHVjZXIiLCJzdGF0ZSIsImFjdGlvbiIsInR5cGUiLCJwYXlsb2FkIiwidXNlciIsInRva2VuIiwidXNlcm5hbWUiLCJleHBpcmVzQXQiLCJNYXRoIiwiZmxvb3IiLCJBcHBTdGF0ZUNvbnRleHQiLCJBcHBTdGF0ZVByb3ZpZGVyIiwiY2hpbGRyZW4iLCJkaXNwYXRjaCIsImlzU3RhdGVMb2FkaW5nIiwic2V0SXNTdGF0ZUxvYWRpbmciLCJpc1N0YXRlSHlkcmF0ZWQiLCJzZXRJc1N0YXRlSHlkcmF0ZWQiLCJpc1N0YXRlUmVjb3ZlcmVkIiwic2V0SXNTdGF0ZVJlY292ZXJlZCIsImlzU3RhdGVTeW5jaW5nIiwic2V0SXNTdGF0ZVN5bmNpbmciLCJpc1VwZGF0aW5nRnJvbVN0b3JhZ2UiLCJpc0F1dGhlbnRpY2F0ZWQiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiaHlkcmF0ZUZyb21TdG9yYWdlIiwibmF2aWdhdGUiLCJzdG9yZWRTdGF0ZSIsInJldHJpZXZlU25hcHNob3QiLCJjb25zb2xlIiwibG9nIiwiaHlkcmF0ZWRTdGF0ZSIsImxhc3RWaXNpdGVkUGF0aCIsInNjcm9sbFBvc2l0aW9ucyIsInRyYWRpbmdQb3NpdGlvbnMiLCJ3YWxsZXRCYWxhbmNlIiwiY3VycmVudFNlc3Npb25JZCIsInNlbGVjdGVkVG9rZW4iLCJ3YXRjaGxpc3QiLCJ0cmFkZUhpc3RvcnkiLCJ0cmFkZUZvcm0iLCJyZXNvbHV0aW9uIiwic2VhcmNoIiwicG9zaXRpb25zIiwiY29ubmVjdGVkV2FsbGV0cyIsInRyYW5zYWN0aW9ucyIsInBvc3RzIiwiZm9sbG93aW5nIiwibm90aWZpY2F0aW9ucyIsImFjdGl2ZVRhYnMiLCJzZXRUaW1lb3V0Iiwic2Nyb2xsWSIsIndpbmRvdyIsInNjcm9sbFRvIiwiYWN0aXZlU2Vzc2lvbklkIiwiZXJyb3IiLCJ0aW1lciIsImNsZWFyVGltZW91dCIsImhhbmRsZVN0b3JhZ2VDaGFuZ2UiLCJldmVudCIsIlNUT1JBR0VfS0VZIiwia2V5IiwiY3VycmVudCIsIm5ld1N0YXRlIiwibmV3VmFsdWUiLCJKU09OIiwicGFyc2UiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImRlYm91bmNlZFNhdmVUaW1lb3V0IiwibGFzdFNhdmVkVGltZXN0YW1wIiwiaGFzQ29udGVudCIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJzdGF0ZVRvU2F2ZSIsImNhcHR1cmVTbmFwc2hvdCIsInRvSVNPU3RyaW5nIiwic2V0SXRlbSIsImNvbnRleHRWYWx1ZSIsIlByb3ZpZGVyIiwidmFsdWUiLCJ1c2VBcHBTdGF0ZSIsImNvbnRleHQiLCJFcnJvciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./context/AppStateContext.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./index.css":
/*!*******************!*\
  !*** ./index.css ***!
  \*******************/
/***/ (() => {



/***/ }),

/***/ "(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fchat.tsx&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fchat.tsx&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getServerSideProps: () => (/* binding */ getServerSideProps),\n/* harmony export */   getStaticPaths: () => (/* binding */ getStaticPaths),\n/* harmony export */   getStaticProps: () => (/* binding */ getStaticProps),\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   reportWebVitals: () => (/* binding */ reportWebVitals),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   unstable_getServerProps: () => (/* binding */ unstable_getServerProps),\n/* harmony export */   unstable_getServerSideProps: () => (/* binding */ unstable_getServerSideProps),\n/* harmony export */   unstable_getStaticParams: () => (/* binding */ unstable_getStaticParams),\n/* harmony export */   unstable_getStaticPaths: () => (/* binding */ unstable_getStaticPaths),\n/* harmony export */   unstable_getStaticProps: () => (/* binding */ unstable_getStaticProps)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages/module.compiled */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/route-modules/pages/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/format-url */ \"next/dist/shared/lib/router/utils/format-url\");\n/* harmony import */ var next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_app_render_interop_default__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/app-render/interop-default */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/app-render/interop-default.js\");\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_shared_lib_page_path_normalize_data_path__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/shared/lib/page-path/normalize-data-path */ \"next/dist/shared/lib/page-path/normalize-data-path\");\n/* harmony import */ var next_dist_shared_lib_page_path_normalize_data_path__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_page_path_normalize_data_path__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var private_next_pages_document__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! private-next-pages/_document */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/pages/_document.js\");\n/* harmony import */ var private_next_pages_document__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(private_next_pages_document__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var private_next_pages_app__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! private-next-pages/_app */ \"(pages-dir-node)/./pages/_app.tsx\");\n/* harmony import */ var _pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./pages/chat.tsx */ \"(pages-dir-node)/./pages/chat.tsx\");\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_shared_lib_utils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/shared/lib/utils */ \"next/dist/shared/lib/utils\");\n/* harmony import */ var next_dist_shared_lib_utils__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_utils__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var next_dist_lib_redirect_status__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! next/dist/lib/redirect-status */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/lib/redirect-status.js\");\n/* harmony import */ var next_dist_lib_redirect_status__WEBPACK_IMPORTED_MODULE_16___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_redirect_status__WEBPACK_IMPORTED_MODULE_16__);\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! next/dist/lib/constants */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_17___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_17__);\n/* harmony import */ var next_dist_server_send_payload__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! next/dist/server/send-payload */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/send-payload.js\");\n/* harmony import */ var next_dist_server_send_payload__WEBPACK_IMPORTED_MODULE_18___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_send_payload__WEBPACK_IMPORTED_MODULE_18__);\n/* harmony import */ var next_dist_server_render_result__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! next/dist/server/render-result */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/render-result.js\");\n/* harmony import */ var next_dist_server_response_cache_utils__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! next/dist/server/response-cache/utils */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/response-cache/utils.js\");\n/* harmony import */ var next_dist_server_response_cache_utils__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache_utils__WEBPACK_IMPORTED_MODULE_20__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21__);\n/* harmony import */ var next_dist_client_components_redirect_status_code__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! next/dist/client/components/redirect-status-code */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/client/components/redirect-status-code.js\");\n/* harmony import */ var next_dist_client_components_redirect_status_code__WEBPACK_IMPORTED_MODULE_22___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_redirect_status_code__WEBPACK_IMPORTED_MODULE_22__);\n/* harmony import */ var next_dist_shared_lib_router_utils_is_bot__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/is-bot */ \"next/dist/shared/lib/router/utils/is-bot\");\n/* harmony import */ var next_dist_shared_lib_router_utils_is_bot__WEBPACK_IMPORTED_MODULE_23___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_is_bot__WEBPACK_IMPORTED_MODULE_23__);\n/* harmony import */ var next_dist_shared_lib_router_utils_add_path_prefix__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/add-path-prefix */ \"next/dist/shared/lib/router/utils/add-path-prefix\");\n/* harmony import */ var next_dist_shared_lib_router_utils_add_path_prefix__WEBPACK_IMPORTED_MODULE_24___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_add_path_prefix__WEBPACK_IMPORTED_MODULE_24__);\n/* harmony import */ var next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/remove-trailing-slash */ \"next/dist/shared/lib/router/utils/remove-trailing-slash\");\n/* harmony import */ var next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([private_next_pages_app__WEBPACK_IMPORTED_MODULE_12__, _pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__]);\n([private_next_pages_app__WEBPACK_IMPORTED_MODULE_12__, _pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\n\n\n\n\n\n// Import the app and document modules.\n\n\n// Import the userland code.\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Re-export the component (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'default'));\n// Re-export methods.\nconst getStaticProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'getStaticProps');\nconst getStaticPaths = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'getStaticPaths');\nconst getServerSideProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'getServerSideProps');\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'config');\nconst reportWebVitals = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'reportWebVitals');\n// Re-export legacy methods.\nconst unstable_getStaticProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getStaticProps');\nconst unstable_getStaticPaths = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getStaticPaths');\nconst unstable_getStaticParams = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getStaticParams');\nconst unstable_getServerProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getServerProps');\nconst unstable_getServerSideProps = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_10__.hoist)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__, 'unstable_getServerSideProps');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES,\n        page: \"/chat\",\n        pathname: \"/chat\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    distDir: \".next\" || 0,\n    projectDir:  false || '',\n    components: {\n        // default export might not exist when optimized for data only\n        App: private_next_pages_app__WEBPACK_IMPORTED_MODULE_12__[\"default\"],\n        Document: (private_next_pages_document__WEBPACK_IMPORTED_MODULE_11___default())\n    },\n    userland: _pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__\n});\nasync function handler(req, res, ctx) {\n    var _serverFilesManifest_config_experimental, _serverFilesManifest_config;\n    let srcPage = \"/chat\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = \"false\";\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { buildId, query, params, parsedUrl, originalQuery, originalPathname, buildManifest, nextFontManifest, serverFilesManifest, reactLoadableManifest, prerenderManifest, isDraftMode, isOnDemandRevalidate, revalidateOnlyGenerated, locale, locales, defaultLocale, routerServerContext, nextConfig, resolvedPathname } = prepareResult;\n    const isExperimentalCompile = serverFilesManifest == null ? void 0 : (_serverFilesManifest_config = serverFilesManifest.config) == null ? void 0 : (_serverFilesManifest_config_experimental = _serverFilesManifest_config.experimental) == null ? void 0 : _serverFilesManifest_config_experimental.isExperimentalCompile;\n    const hasServerProps = Boolean(getServerSideProps);\n    const hasStaticProps = Boolean(getStaticProps);\n    const hasStaticPaths = Boolean(getStaticPaths);\n    const hasGetInitialProps = Boolean((_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__[\"default\"] || _pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__).getInitialProps);\n    const isAmp = query.amp && config.amp;\n    let cacheKey = null;\n    let isIsrFallback = false;\n    let isNextDataRequest = prepareResult.isNextDataRequest && (hasStaticProps || hasServerProps);\n    const is404Page = srcPage === '/404';\n    const is500Page = srcPage === '/500';\n    const isErrorPage = srcPage === '/_error';\n    if (!routeModule.isDev && !isDraftMode && hasStaticProps) {\n        cacheKey = `${locale ? `/${locale}` : ''}${(srcPage === '/' || resolvedPathname === '/') && locale ? '' : resolvedPathname}${isAmp ? '.amp' : ''}`;\n        if (is404Page || is500Page || isErrorPage) {\n            cacheKey = `${locale ? `/${locale}` : ''}${srcPage}${isAmp ? '.amp' : ''}`;\n        }\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    if (hasStaticPaths && !isDraftMode) {\n        const decodedPathname = (0,next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25__.removeTrailingSlash)(locale ? (0,next_dist_shared_lib_router_utils_add_path_prefix__WEBPACK_IMPORTED_MODULE_24__.addPathPrefix)(resolvedPathname, `/${locale}`) : resolvedPathname);\n        const isPrerendered = Boolean(prerenderManifest.routes[decodedPathname]) || prerenderManifest.notFoundRoutes.includes(decodedPathname);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[srcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21__.NoFallbackError();\n            }\n            if (typeof prerenderInfo.fallback === 'string' && !isPrerendered && !isNextDataRequest) {\n                isIsrFallback = true;\n            }\n        }\n    }\n    // When serving a bot request, we want to serve a blocking render and not\n    // the prerendered page. This ensures that the correct content is served\n    // to the bot in the head.\n    if (isIsrFallback && (0,next_dist_shared_lib_router_utils_is_bot__WEBPACK_IMPORTED_MODULE_23__.isBot)(req.headers['user-agent'] || '') || (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'minimalMode')) {\n        isIsrFallback = false;\n    }\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    try {\n        const method = req.method || 'GET';\n        const resolvedUrl = (0,next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4__.formatUrl)({\n            pathname: nextConfig.trailingSlash ? parsedUrl.pathname : (0,next_dist_shared_lib_router_utils_remove_trailing_slash__WEBPACK_IMPORTED_MODULE_25__.removeTrailingSlash)(parsedUrl.pathname || '/'),\n            // make sure to only add query values from original URL\n            query: hasStaticProps ? {} : originalQuery\n        });\n        const publicRuntimeConfig = (routerServerContext == null ? void 0 : routerServerContext.publicRuntimeConfig) || nextConfig.publicRuntimeConfig;\n        const handleResponse = async (span)=>{\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                var _previousCacheEntry_value;\n                const doRender = async ()=>{\n                    try {\n                        var _nextConfig_i18n, _nextConfig_experimental_amp, _nextConfig_experimental_amp1;\n                        return await routeModule.render(req, res, {\n                            query: hasStaticProps && !isExperimentalCompile ? {\n                                ...params,\n                                ...isAmp ? {\n                                    amp: query.amp\n                                } : {}\n                            } : {\n                                ...query,\n                                ...params\n                            },\n                            params,\n                            page: srcPage,\n                            renderContext: {\n                                isDraftMode,\n                                isFallback: isIsrFallback,\n                                developmentNotFoundSourcePage: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'developmentNotFoundSourcePage')\n                            },\n                            sharedContext: {\n                                buildId,\n                                customServer: Boolean(routerServerContext == null ? void 0 : routerServerContext.isCustomServer) || undefined,\n                                deploymentId: false\n                            },\n                            renderOpts: {\n                                params,\n                                routeModule,\n                                page: srcPage,\n                                pageConfig: config || {},\n                                Component: (0,next_dist_server_app_render_interop_default__WEBPACK_IMPORTED_MODULE_6__.interopDefault)(_pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__),\n                                ComponentMod: _pages_chat_tsx__WEBPACK_IMPORTED_MODULE_13__,\n                                getStaticProps,\n                                getStaticPaths,\n                                getServerSideProps,\n                                supportsDynamicResponse: !hasStaticProps,\n                                buildManifest,\n                                nextFontManifest,\n                                reactLoadableManifest,\n                                assetPrefix: nextConfig.assetPrefix,\n                                strictNextHead: nextConfig.experimental.strictNextHead ?? true,\n                                previewProps: prerenderManifest.preview,\n                                images: nextConfig.images,\n                                nextConfigOutput: nextConfig.output,\n                                optimizeCss: Boolean(nextConfig.experimental.optimizeCss),\n                                nextScriptWorkers: Boolean(nextConfig.experimental.nextScriptWorkers),\n                                domainLocales: (_nextConfig_i18n = nextConfig.i18n) == null ? void 0 : _nextConfig_i18n.domains,\n                                crossOrigin: nextConfig.crossOrigin,\n                                multiZoneDraftMode,\n                                basePath: nextConfig.basePath,\n                                canonicalBase: nextConfig.amp.canonicalBase || '',\n                                ampOptimizerConfig: (_nextConfig_experimental_amp = nextConfig.experimental.amp) == null ? void 0 : _nextConfig_experimental_amp.optimizer,\n                                disableOptimizedLoading: nextConfig.experimental.disableOptimizedLoading,\n                                largePageDataBytes: nextConfig.experimental.largePageDataBytes,\n                                // Only the `publicRuntimeConfig` key is exposed to the client side\n                                // It'll be rendered as part of __NEXT_DATA__ on the client side\n                                runtimeConfig: Object.keys(publicRuntimeConfig).length > 0 ? publicRuntimeConfig : undefined,\n                                isExperimentalCompile,\n                                experimental: {\n                                    clientTraceMetadata: nextConfig.experimental.clientTraceMetadata || []\n                                },\n                                locale,\n                                locales,\n                                defaultLocale,\n                                setIsrStatus: routerServerContext == null ? void 0 : routerServerContext.setIsrStatus,\n                                isNextDataRequest: isNextDataRequest && (hasServerProps || hasStaticProps),\n                                resolvedUrl,\n                                // For getServerSideProps and getInitialProps we need to ensure we use the original URL\n                                // and not the resolved URL to prevent a hydration mismatch on\n                                // asPath\n                                resolvedAsPath: hasServerProps || hasGetInitialProps ? (0,next_dist_shared_lib_router_utils_format_url__WEBPACK_IMPORTED_MODULE_4__.formatUrl)({\n                                    // we use the original URL pathname less the _next/data prefix if\n                                    // present\n                                    pathname: isNextDataRequest ? (0,next_dist_shared_lib_page_path_normalize_data_path__WEBPACK_IMPORTED_MODULE_8__.normalizeDataPath)(originalPathname) : originalPathname,\n                                    query: originalQuery\n                                }) : resolvedUrl,\n                                isOnDemandRevalidate,\n                                ErrorDebug: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'PagesErrorDebug'),\n                                err: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'invokeError'),\n                                dev: routeModule.isDev,\n                                // needed for experimental.optimizeCss feature\n                                distDir: `${routeModule.projectDir}/${routeModule.distDir}`,\n                                ampSkipValidation: (_nextConfig_experimental_amp1 = nextConfig.experimental.amp) == null ? void 0 : _nextConfig_experimental_amp1.skipValidation,\n                                ampValidator: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'ampValidator')\n                            }\n                        }).then((renderResult)=>{\n                            const { metadata } = renderResult;\n                            let cacheControl = metadata.cacheControl;\n                            if ('isNotFound' in metadata && metadata.isNotFound) {\n                                return {\n                                    value: null,\n                                    cacheControl\n                                };\n                            }\n                            // Handle `isRedirect`.\n                            if (metadata.isRedirect) {\n                                return {\n                                    value: {\n                                        kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.REDIRECT,\n                                        props: metadata.pageData ?? metadata.flightData\n                                    },\n                                    cacheControl\n                                };\n                            }\n                            return {\n                                value: {\n                                    kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.PAGES,\n                                    html: renderResult,\n                                    pageData: renderResult.metadata.pageData,\n                                    headers: renderResult.metadata.headers,\n                                    status: renderResult.metadata.statusCode\n                                },\n                                cacheControl\n                            };\n                        }).finally(()=>{\n                            if (!span) return;\n                            span.setAttributes({\n                                'http.status_code': res.statusCode,\n                                'next.rsc': false\n                            });\n                            const rootSpanAttributes = tracer.getRootSpanAttributes();\n                            // We were unable to get attributes, probably OTEL is not enabled\n                            if (!rootSpanAttributes) {\n                                return;\n                            }\n                            if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2__.BaseServerSpan.handleRequest) {\n                                console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                                return;\n                            }\n                            const route = rootSpanAttributes.get('next.route');\n                            if (route) {\n                                const name = `${method} ${route}`;\n                                span.setAttributes({\n                                    'next.route': route,\n                                    'http.route': route,\n                                    'next.span_name': name\n                                });\n                                span.updateName(name);\n                            } else {\n                                span.updateName(`${method} ${req.url}`);\n                            }\n                        });\n                    } catch (err) {\n                        // if this is a background revalidate we need to report\n                        // the request error here as it won't be bubbled\n                        if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                            await routeModule.onRequestError(req, err, {\n                                routerKind: 'Pages Router',\n                                routePath: srcPage,\n                                routeType: 'render',\n                                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_7__.getRevalidateReason)({\n                                    isRevalidate: hasStaticProps,\n                                    isOnDemandRevalidate\n                                })\n                            }, routerServerContext);\n                        }\n                        throw err;\n                    }\n                };\n                // if we've already generated this page we no longer\n                // serve the fallback\n                if (previousCacheEntry) {\n                    isIsrFallback = false;\n                }\n                if (isIsrFallback) {\n                    const fallbackResponse = await routeModule.getResponseCache(req).get(routeModule.isDev ? null : locale ? `/${locale}${srcPage}` : srcPage, async ({ previousCacheEntry: previousFallbackCacheEntry = null })=>{\n                        if (!routeModule.isDev) {\n                            return (0,next_dist_server_response_cache_utils__WEBPACK_IMPORTED_MODULE_20__.toResponseCacheEntry)(previousFallbackCacheEntry);\n                        }\n                        return doRender();\n                    }, {\n                        routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES,\n                        isFallback: true,\n                        isRoutePPREnabled: false,\n                        isOnDemandRevalidate: false,\n                        incrementalCache: await routeModule.getIncrementalCache(req, nextConfig, prerenderManifest),\n                        waitUntil: ctx.waitUntil\n                    });\n                    if (fallbackResponse) {\n                        // Remove the cache control from the response to prevent it from being\n                        // used in the surrounding cache.\n                        delete fallbackResponse.cacheControl;\n                        fallbackResponse.isMiss = true;\n                        return fallbackResponse;\n                    }\n                }\n                if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                    res.statusCode = 404;\n                    // on-demand revalidate always sets this header\n                    res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                    res.end('This page could not be found');\n                    return null;\n                }\n                if (isIsrFallback && (previousCacheEntry == null ? void 0 : (_previousCacheEntry_value = previousCacheEntry.value) == null ? void 0 : _previousCacheEntry_value.kind) === next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.PAGES) {\n                    return {\n                        value: {\n                            kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.PAGES,\n                            html: new next_dist_server_render_result__WEBPACK_IMPORTED_MODULE_19__[\"default\"](Buffer.from(previousCacheEntry.value.html), {\n                                contentType: 'text/html;utf-8',\n                                metadata: {\n                                    statusCode: previousCacheEntry.value.status,\n                                    headers: previousCacheEntry.value.headers\n                                }\n                            }),\n                            pageData: {},\n                            status: previousCacheEntry.value.status,\n                            headers: previousCacheEntry.value.headers\n                        },\n                        cacheControl: {\n                            revalidate: 0,\n                            expire: undefined\n                        }\n                    };\n                }\n                return doRender();\n            };\n            const result = await routeModule.handleResponse({\n                cacheKey,\n                req,\n                nextConfig,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                waitUntil: ctx.waitUntil,\n                responseGenerator: responseGenerator,\n                prerenderManifest\n            });\n            // if we got a cache hit this wasn't an ISR fallback\n            // but it wasn't generated during build so isn't in the\n            // prerender-manifest\n            if (isIsrFallback && !(result == null ? void 0 : result.isMiss)) {\n                isIsrFallback = false;\n            }\n            // response is finished is no cache entry\n            if (!result) {\n                return;\n            }\n            if (hasStaticProps && !(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : result.isMiss ? 'MISS' : result.isStale ? 'STALE' : 'HIT');\n            }\n            let cacheControl;\n            if (!hasStaticProps || isIsrFallback) {\n                if (!res.getHeader('Cache-Control')) {\n                    cacheControl = {\n                        revalidate: 0,\n                        expire: undefined\n                    };\n                }\n            } else if (is404Page) {\n                const notFoundRevalidate = (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'notFoundRevalidate');\n                cacheControl = {\n                    revalidate: typeof notFoundRevalidate === 'undefined' ? 0 : notFoundRevalidate,\n                    expire: undefined\n                };\n            } else if (is500Page) {\n                cacheControl = {\n                    revalidate: 0,\n                    expire: undefined\n                };\n            } else if (result.cacheControl) {\n                // If the cache entry has a cache control with a revalidate value that's\n                // a number, use it.\n                if (typeof result.cacheControl.revalidate === 'number') {\n                    var _result_cacheControl;\n                    if (result.cacheControl.revalidate < 1) {\n                        throw Object.defineProperty(new Error(`Invalid revalidate configuration provided: ${result.cacheControl.revalidate} < 1`), \"__NEXT_ERROR_CODE\", {\n                            value: \"E22\",\n                            enumerable: false,\n                            configurable: true\n                        });\n                    }\n                    cacheControl = {\n                        revalidate: result.cacheControl.revalidate,\n                        expire: ((_result_cacheControl = result.cacheControl) == null ? void 0 : _result_cacheControl.expire) ?? nextConfig.expireTime\n                    };\n                } else {\n                    // revalidate: false\n                    cacheControl = {\n                        revalidate: next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_17__.CACHE_ONE_YEAR,\n                        expire: undefined\n                    };\n                }\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheControl && !res.getHeader('Cache-Control')) {\n                res.setHeader('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_14__.getCacheControlHeader)(cacheControl));\n            }\n            // notFound: true case\n            if (!result.value) {\n                var _result_cacheControl1;\n                // add revalidate metadata before rendering 404 page\n                // so that we can use this as source of truth for the\n                // cache-control header instead of what the 404 page returns\n                // for the revalidate value\n                (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.addRequestMeta)(req, 'notFoundRevalidate', (_result_cacheControl1 = result.cacheControl) == null ? void 0 : _result_cacheControl1.revalidate);\n                res.statusCode = 404;\n                if (isNextDataRequest) {\n                    res.end('{\"notFound\":true}');\n                    return;\n                }\n                // TODO: should route-module itself handle rendering the 404\n                if (routerServerContext == null ? void 0 : routerServerContext.render404) {\n                    await routerServerContext.render404(req, res, parsedUrl, false);\n                } else {\n                    res.end('This page could not be found');\n                }\n                return;\n            }\n            if (result.value.kind === next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.REDIRECT) {\n                if (isNextDataRequest) {\n                    res.setHeader('content-type', 'application/json');\n                    res.end(JSON.stringify(result.value.props));\n                    return;\n                } else {\n                    const handleRedirect = (pageData)=>{\n                        const redirect = {\n                            destination: pageData.pageProps.__N_REDIRECT,\n                            statusCode: pageData.pageProps.__N_REDIRECT_STATUS,\n                            basePath: pageData.pageProps.__N_REDIRECT_BASE_PATH\n                        };\n                        const statusCode = (0,next_dist_lib_redirect_status__WEBPACK_IMPORTED_MODULE_16__.getRedirectStatus)(redirect);\n                        const { basePath } = nextConfig;\n                        if (basePath && redirect.basePath !== false && redirect.destination.startsWith('/')) {\n                            redirect.destination = `${basePath}${redirect.destination}`;\n                        }\n                        if (redirect.destination.startsWith('/')) {\n                            redirect.destination = (0,next_dist_shared_lib_utils__WEBPACK_IMPORTED_MODULE_15__.normalizeRepeatedSlashes)(redirect.destination);\n                        }\n                        res.statusCode = statusCode;\n                        res.setHeader('Location', redirect.destination);\n                        if (statusCode === next_dist_client_components_redirect_status_code__WEBPACK_IMPORTED_MODULE_22__.RedirectStatusCode.PermanentRedirect) {\n                            res.setHeader('Refresh', `0;url=${redirect.destination}`);\n                        }\n                        res.end(redirect.destination);\n                    };\n                    await handleRedirect(result.value.props);\n                    return null;\n                }\n            }\n            if (result.value.kind !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_9__.CachedRouteKind.PAGES) {\n                throw Object.defineProperty(new Error(`Invariant: received non-pages cache entry in pages handler`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E695\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            // In dev, we should not cache pages for any reason.\n            if (routeModule.isDev) {\n                res.setHeader('Cache-Control', 'no-store, must-revalidate');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            // when invoking _error before pages/500 we don't actually\n            // send the _error response\n            if ((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'customErrorRender') || isErrorPage && (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_5__.getRequestMeta)(req, 'minimalMode') && res.statusCode === 500) {\n                return null;\n            }\n            await (0,next_dist_server_send_payload__WEBPACK_IMPORTED_MODULE_18__.sendRenderResult)({\n                req,\n                res,\n                // If we are rendering the error page it's not a data request\n                // anymore\n                result: isNextDataRequest && !isErrorPage && !is500Page ? new next_dist_server_render_result__WEBPACK_IMPORTED_MODULE_19__[\"default\"](Buffer.from(JSON.stringify(result.value.pageData)), {\n                    contentType: 'application/json',\n                    metadata: result.value.html.metadata\n                }) : result.value.html,\n                generateEtags: nextConfig.generateEtags,\n                poweredByHeader: nextConfig.poweredByHeader,\n                cacheControl: routeModule.isDev ? undefined : cacheControl,\n                type: isNextDataRequest ? 'json' : 'html'\n            });\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse();\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_2__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_3__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_21__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'Pages Router',\n                routePath: srcPage,\n                routeType: 'render',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_7__.getRevalidateReason)({\n                    isRevalidate: hasStaticProps,\n                    isOnDemandRevalidate\n                })\n            }, routerServerContext);\n        }\n        // rethrow so that we can handle serving error page\n        throw err;\n    }\n}\n\n//# sourceMappingURL=pages.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL25vZGVfbW9kdWxlcy8ucG5wbS9uZXh0QDE1LjQuNV9AYmFiZWwrY29yZUA3LjI4LjBfcmVhY3QtZG9tQDE5LjEuMV9yZWFjdEAxOS4xLjFfX3JlYWN0QDE5LjEuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTJnBhZ2U9JTJGY2hhdCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGY2hhdC50c3gmYWJzb2x1dGVBcHBQYXRoPXByaXZhdGUtbmV4dC1wYWdlcyUyRl9hcHAmYWJzb2x1dGVEb2N1bWVudFBhdGg9cHJpdmF0ZS1uZXh0LXBhZ2VzJTJGX2RvY3VtZW50Jm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd0Y7QUFDaEM7QUFDYztBQUNFO0FBQ0M7QUFDTTtBQUNGO0FBQ0E7QUFDVTtBQUNyQjtBQUNSO0FBQzFEO0FBQ3lEO0FBQ1Y7QUFDL0M7QUFDNkM7QUFDOEI7QUFDTDtBQUNKO0FBQ1Q7QUFDUTtBQUNQO0FBQ21CO0FBQ0s7QUFDSTtBQUNyQjtBQUNpQjtBQUNZO0FBQzlGO0FBQ0EsaUVBQWUseUVBQUssQ0FBQyw2Q0FBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyx1QkFBdUIseUVBQUssQ0FBQyw2Q0FBUTtBQUNyQyx1QkFBdUIseUVBQUssQ0FBQyw2Q0FBUTtBQUNyQywyQkFBMkIseUVBQUssQ0FBQyw2Q0FBUTtBQUN6QyxlQUFlLHlFQUFLLENBQUMsNkNBQVE7QUFDN0Isd0JBQXdCLHlFQUFLLENBQUMsNkNBQVE7QUFDN0M7QUFDTyxnQ0FBZ0MseUVBQUssQ0FBQyw2Q0FBUTtBQUM5QyxnQ0FBZ0MseUVBQUssQ0FBQyw2Q0FBUTtB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Q0FBc0MsNEVBQWU7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiw2RUFBYyw2Q0FBNkMsNkVBQWM7QUFDekY7QUFDQTtBQUNBLGtCQUFrQixnRkFBZ0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4RUFBOEUsdUVBQVk7QUFDMUY7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWLDZFQUE2RSxnRkFBYztBQUMzRixpQ0FBaUMsUUFBUSxFQUFFLFFBQVE7QUFDbkQsMEJBQTBCLHVFQUFRO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsTUFBTTtBQUNOLDZCQUE2Qiw2RkFBZTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQyIsInNvdXJjZXMiOlsiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1tb2R1bGVzL3BhZ2VzL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgQmFzZVNlcnZlclNwYW4gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBnZXRUcmFjZXIsIFNwYW5LaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3RyYWNlL3RyYWNlclwiO1xuaW1wb3J0IHsgZm9ybWF0VXJsIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9mb3JtYXQtdXJsXCI7XG5pbXBvcnQgeyBhZGRSZXF1ZXN0TWV0YSwgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGludGVyb3BEZWZhdWx0IH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvYXBwLXJlbmRlci9pbnRlcm9wLWRlZmF1bHRcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZURhdGFQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3BhZ2UtcGF0aC9ub3JtYWxpemUtZGF0YS1wYXRoXCI7XG5pbXBvcnQgeyBDYWNoZWRSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXNwb25zZS1jYWNoZVwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIGFwcCBhbmQgZG9jdW1lbnQgbW9kdWxlcy5cbmltcG9ydCAqIGFzIGRvY3VtZW50IGZyb20gXCJwcml2YXRlLW5leHQtcGFnZXMvX2RvY3VtZW50XCI7XG5pbXBvcnQgKiBhcyBhcHAgZnJvbSBcInByaXZhdGUtbmV4dC1wYWdlcy9fYXBwXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9jaGF0LnRzeFwiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IG5vcm1hbGl6ZVJlcGVhdGVkU2xhc2hlcyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0UmVkaXJlY3RTdGF0dXMgfSBmcm9tIFwibmV4dC9kaXN0L2xpYi9yZWRpcmVjdC1zdGF0dXNcIjtcbmltcG9ydCB7IENBQ0hFX09ORV9ZRUFSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBzZW5kUmVuZGVyUmVzdWx0IH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvc2VuZC1wYXlsb2FkXCI7XG5pbXBvcnQgUmVuZGVyUmVzdWx0IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JlbmRlci1yZXN1bHRcIjtcbmltcG9ydCB7IHRvUmVzcG9uc2VDYWNoZUVudHJ5IH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcmVzcG9uc2UtY2FjaGUvdXRpbHNcIjtcbmltcG9ydCB7IE5vRmFsbGJhY2tFcnJvciB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9uby1mYWxsYmFjay1lcnJvci5leHRlcm5hbFwiO1xuaW1wb3J0IHsgUmVkaXJlY3RTdGF0dXNDb2RlIH0gZnJvbSBcIm5leHQvZGlzdC9jbGllbnQvY29tcG9uZW50cy9yZWRpcmVjdC1zdGF0dXMtY29kZVwiO1xuaW1wb3J0IHsgaXNCb3QgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvcm91dGVyL3V0aWxzL2lzLWJvdFwiO1xuaW1wb3J0IHsgYWRkUGF0aFByZWZpeCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2hhcmVkL2xpYi9yb3V0ZXIvdXRpbHMvYWRkLXBhdGgtcHJlZml4XCI7XG5pbXBvcnQgeyByZW1vdmVUcmFpbGluZ1NsYXNoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9yZW1vdmUtdHJhaWxpbmctc2xhc2hcIjtcbi8vIFJlLWV4cG9ydCB0aGUgY29tcG9uZW50IChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCAnZGVmYXVsdCcpO1xuLy8gUmUtZXhwb3J0IG1ldGhvZHMuXG5leHBvcnQgY29uc3QgZ2V0U3RhdGljUHJvcHMgPSBob2lzdCh1c2VybGFuZCwgJ2dldFN0YXRpY1Byb3BzJyk7XG5leHBvcnQgY29uc3QgZ2V0U3RhdGljUGF0aHMgPSBob2lzdCh1c2VybGFuZCwgJ2dldFN0YXRpY1BhdGhzJyk7XG5leHBvcnQgY29uc3QgZ2V0U2VydmVyU2lkZVByb3BzID0gaG9pc3QodXNlcmxhbmQsICdnZXRTZXJ2ZXJTaWRlUHJvcHMnKTtcbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgJ2NvbmZpZycpO1xuZXhwb3J0IGNvbnN0IHJlcG9ydFdlYlZpdGFscyA9IGhvaXN0KHVzZXJsYW5kLCAncmVwb3J0V2ViVml0YWxzJyk7XG4vLyBSZS1leHBvcnQgbGVnYWN5IG1ldGhvZHMuXG5leHBvcnQgY29uc3QgdW5zdGFibGVfZ2V0U3RhdGljUHJvcHMgPSBob2lzdCh1c2VybGFuZCwgJ3Vuc3RhYmxlX2dldFN0YXRpY1Byb3BzJyk7XG5leHBvcnQgY29uc3QgdW5zdGFibGVfZ2V0U3RhdGljUGF0aHMgPSBob2lzdCh1c2VybGFuZCwgJ3Vuc3RhYmxlX2dldFN0YXRpY1BhdGhzJyk7XG5leHBvcnQgY29uc3QgdW5zdGFibGVfZ2V0U3RhdGljUGFyYW1zID0gaG9pc3QodXNlcmxhbmQsICd1bnN0YWJsZV9nZXRTdGF0aWNQYXJhbXMnKTtcbmV4cG9ydCBjb25zdCB1bnN0YWJsZV9nZXRTZXJ2ZXJQcm9wcyA9IGhvaXN0KHVzZXJsYW5kLCAndW5zdGFibGVfZ2V0U2VydmVyUHJvcHMnKTtcbmV4cG9ydCBjb25zdCB1bnN0YWJsZV9nZXRTZXJ2ZXJTaWRlUHJvcHMgPSBob2lzdCh1c2VybGFuZCwgJ3Vuc3RhYmxlX2dldFNlcnZlclNpZGVQcm9wcycpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVMsXG4gICAgICAgIHBhZ2U6IFwiL2NoYXRcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2NoYXRcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICBkaXN0RGlyOiBwcm9jZXNzLmVudi5fX05FWFRfUkVMQVRJVkVfRElTVF9ESVIgfHwgJycsXG4gICAgcHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnLFxuICAgIGNvbXBvbmVudHM6IHtcbiAgICAgICAgLy8gZGVmYXVsdCBleHBvcnQgbWlnaHQgbm90IGV4aXN0IHdoZW4gb3B0aW1pemVkIGZvciBkYXRhIG9ubHlcbiAgICAgICAgQXBwOiBhcHAuZGVmYXVsdCxcbiAgICAgICAgRG9jdW1lbnQ6IGRvY3VtZW50LmRlZmF1bHRcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICB2YXIgX3NlcnZlckZpbGVzTWFuaWZlc3RfY29uZmlnX2V4cGVyaW1lbnRhbCwgX3NlcnZlckZpbGVzTWFuaWZlc3RfY29uZmlnO1xuICAgIGxldCBzcmNQYWdlID0gXCIvY2hhdFwiO1xuICAgIC8vIHR1cmJvcGFjayBkb2Vzbid0IG5vcm1hbGl6ZSBgL2luZGV4YCBpbiB0aGUgcGFnZSBuYW1lXG4gICAgLy8gc28gd2UgbmVlZCB0byB0byBwcm9jZXNzIGR5bmFtaWMgcm91dGVzIHByb3Blcmx5XG4gICAgLy8gVE9ETzogZml4IHR1cmJvcGFjayBwcm92aWRpbmcgZGlmZmVyaW5nIHZhbHVlIGZyb20gd2VicGFja1xuICAgIGlmIChwcm9jZXNzLmVudi5UVVJCT1BBQ0spIHtcbiAgICAgICAgc3JjUGFnZSA9IHNyY1BhZ2UucmVwbGFjZSgvXFwvaW5kZXgkLywgJycpIHx8ICcvJztcbiAgICB9IGVsc2UgaWYgKHNyY1BhZ2UgPT09ICcvaW5kZXgnKSB7XG4gICAgICAgIC8vIHdlIGFsd2F5cyBub3JtYWxpemUgL2luZGV4IHNwZWNpZmljYWxseVxuICAgICAgICBzcmNQYWdlID0gJy8nO1xuICAgIH1cbiAgICBjb25zdCBtdWx0aVpvbmVEcmFmdE1vZGUgPSBwcm9jZXNzLmVudi5fX05FWFRfTVVMVElfWk9ORV9EUkFGVF9NT0RFO1xuICAgIGNvbnN0IHByZXBhcmVSZXN1bHQgPSBhd2FpdCByb3V0ZU1vZHVsZS5wcmVwYXJlKHJlcSwgcmVzLCB7XG4gICAgICAgIHNyY1BhZ2UsXG4gICAgICAgIG11bHRpWm9uZURyYWZ0TW9kZVxuICAgIH0pO1xuICAgIGlmICghcHJlcGFyZVJlc3VsdCkge1xuICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwMDtcbiAgICAgICAgcmVzLmVuZCgnQmFkIFJlcXVlc3QnKTtcbiAgICAgICAgY3R4LndhaXRVbnRpbCA9PSBudWxsID8gdm9pZCAwIDogY3R4LndhaXRVbnRpbC5jYWxsKGN0eCwgUHJvbWlzZS5yZXNvbHZlKCkpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHsgYnVpbGRJZCwgcXVlcnksIHBhcmFtcywgcGFyc2VkVXJsLCBvcmlnaW5hbFF1ZXJ5LCBvcmlnaW5hbFBhdGhuYW1lLCBidWlsZE1hbmlmZXN0LCBuZXh0Rm9udE1hbmlmZXN0LCBzZXJ2ZXJGaWxlc01hbmlmZXN0LCByZWFjdExvYWRhYmxlTWFuaWZlc3QsIHByZXJlbmRlck1hbmlmZXN0LCBpc0RyYWZ0TW9kZSwgaXNPbkRlbWFuZFJldmFsaWRhdGUsIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkLCBsb2NhbGUsIGxvY2FsZXMsIGRlZmF1bHRMb2NhbGUsIHJvdXRlclNlcnZlckNvbnRleHQsIG5leHRDb25maWcsIHJlc29sdmVkUGF0aG5hbWUgfSA9IHByZXBhcmVSZXN1bHQ7XG4gICAgY29uc3QgaXNFeHBlcmltZW50YWxDb21waWxlID0gc2VydmVyRmlsZXNNYW5pZmVzdCA9PSBudWxsID8gdm9pZCAwIDogKF9zZXJ2ZXJGaWxlc01hbmlmZXN0X2NvbmZpZyA9IHNlcnZlckZpbGVzTWFuaWZlc3QuY29uZmlnKSA9PSBudWxsID8gdm9pZCAwIDogKF9zZXJ2ZXJGaWxlc01hbmlmZXN0X2NvbmZpZ19leHBlcmltZW50YWwgPSBfc2VydmVyRmlsZXNNYW5pZmVzdF9jb25maWcuZXhwZXJpbWVudGFsKSA9PSBudWxsID8gdm9pZCAwIDogX3NlcnZlckZpbGVzTWFuaWZlc3RfY29uZmlnX2V4cGVyaW1lbnRhbC5pc0V4cGVyaW1lbnRhbENvbXBpbGU7XG4gICAgY29uc3QgaGFzU2VydmVyUHJvcHMgPSBCb29sZWFuKGdldFNlcnZlclNpZGVQcm9wcyk7XG4gICAgY29uc3QgaGFzU3RhdGljUHJvcHMgPSBCb29sZWFuKGdldFN0YXRpY1Byb3BzKTtcbiAgICBjb25zdCBoYXNTdGF0aWNQYXRocyA9IEJvb2xlYW4oZ2V0U3RhdGljUGF0aHMpO1xuICAgIGNvbnN0IGhhc0dldEluaXRpYWxQcm9wcyA9IEJvb2xlYW4oKHVzZXJsYW5kLmRlZmF1bHQgfHwgdXNlcmxhbmQpLmdldEluaXRpYWxQcm9wcyk7XG4gICAgY29uc3QgaXNBbXAgPSBxdWVyeS5hbXAgJiYgY29uZmlnLmFtcDtcbiAgICBsZXQgY2FjaGVLZXkgPSBudWxsO1xuICAgIGxldCBpc0lzckZhbGxiYWNrID0gZmFsc2U7XG4gICAgbGV0IGlzTmV4dERhdGFSZXF1ZXN0ID0gcHJlcGFyZVJlc3VsdC5pc05leHREYXRhUmVxdWVzdCAmJiAoaGFzU3RhdGljUHJvcHMgfHwgaGFzU2VydmVyUHJvcHMpO1xuICAgIGNvbnN0IGlzNDA0UGFnZSA9IHNyY1BhZ2UgPT09ICcvNDA0JztcbiAgICBjb25zdCBpczUwMFBhZ2UgPSBzcmNQYWdlID09PSAnLzUwMCc7XG4gICAgY29uc3QgaXNFcnJvclBhZ2UgPSBzcmNQYWdlID09PSAnL19lcnJvcic7XG4gICAgaWYgKCFyb3V0ZU1vZHVsZS5pc0RldiAmJiAhaXNEcmFmdE1vZGUgJiYgaGFzU3RhdGljUHJvcHMpIHtcbiAgICAgICAgY2FjaGVLZXkgPSBgJHtsb2NhbGUgPyBgLyR7bG9jYWxlfWAgOiAnJ30keyhzcmNQYWdlID09PSAnLycgfHwgcmVzb2x2ZWRQYXRobmFtZSA9PT0gJy8nKSAmJiBsb2NhbGUgPyAnJyA6IHJlc29sdmVkUGF0aG5hbWV9JHtpc0FtcCA/ICcuYW1wJyA6ICcnfWA7XG4gICAgICAgIGlmIChpczQwNFBhZ2UgfHwgaXM1MDBQYWdlIHx8IGlzRXJyb3JQYWdlKSB7XG4gICAgICAgICAgICBjYWNoZUtleSA9IGAke2xvY2FsZSA/IGAvJHtsb2NhbGV9YCA6ICcnfSR7c3JjUGFnZX0ke2lzQW1wID8gJy5hbXAnIDogJyd9YDtcbiAgICAgICAgfVxuICAgICAgICAvLyBlbnN1cmUgL2luZGV4IGFuZCAvIGlzIG5vcm1hbGl6ZWQgdG8gb25lIGtleVxuICAgICAgICBjYWNoZUtleSA9IGNhY2hlS2V5ID09PSAnL2luZGV4JyA/ICcvJyA6IGNhY2hlS2V5O1xuICAgIH1cbiAgICBpZiAoaGFzU3RhdGljUGF0aHMgJiYgIWlzRHJhZnRNb2RlKSB7XG4gICAgICAgIGNvbnN0IGRlY29kZWRQYXRobmFtZSA9IHJlbW92ZVRyYWlsaW5nU2xhc2gobG9jYWxlID8gYWRkUGF0aFByZWZpeChyZXNvbHZlZFBhdGhuYW1lLCBgLyR7bG9jYWxlfWApIDogcmVzb2x2ZWRQYXRobmFtZSk7XG4gICAgICAgIGNvbnN0IGlzUHJlcmVuZGVyZWQgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tkZWNvZGVkUGF0aG5hbWVdKSB8fCBwcmVyZW5kZXJNYW5pZmVzdC5ub3RGb3VuZFJvdXRlcy5pbmNsdWRlcyhkZWNvZGVkUGF0aG5hbWUpO1xuICAgICAgICBjb25zdCBwcmVyZW5kZXJJbmZvID0gcHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tzcmNQYWdlXTtcbiAgICAgICAgaWYgKHByZXJlbmRlckluZm8pIHtcbiAgICAgICAgICAgIGlmIChwcmVyZW5kZXJJbmZvLmZhbGxiYWNrID09PSBmYWxzZSAmJiAhaXNQcmVyZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb0ZhbGxiYWNrRXJyb3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgcHJlcmVuZGVySW5mby5mYWxsYmFjayA9PT0gJ3N0cmluZycgJiYgIWlzUHJlcmVuZGVyZWQgJiYgIWlzTmV4dERhdGFSZXF1ZXN0KSB7XG4gICAgICAgICAgICAgICAgaXNJc3JGYWxsYmFjayA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gV2hlbiBzZXJ2aW5nIGEgYm90IHJlcXVlc3QsIHdlIHdhbnQgdG8gc2VydmUgYSBibG9ja2luZyByZW5kZXIgYW5kIG5vdFxuICAgIC8vIHRoZSBwcmVyZW5kZXJlZCBwYWdlLiBUaGlzIGVuc3VyZXMgdGhhdCB0aGUgY29ycmVjdCBjb250ZW50IGlzIHNlcnZlZFxuICAgIC8vIHRvIHRoZSBib3QgaW4gdGhlIGhlYWQuXG4gICAgaWYgKGlzSXNyRmFsbGJhY2sgJiYgaXNCb3QocmVxLmhlYWRlcnNbJ3VzZXItYWdlbnQnXSB8fCAnJykgfHwgZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSkge1xuICAgICAgICBpc0lzckZhbGxiYWNrID0gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHRyYWNlciA9IGdldFRyYWNlcigpO1xuICAgIGNvbnN0IGFjdGl2ZVNwYW4gPSB0cmFjZXIuZ2V0QWN0aXZlU2NvcGVTcGFuKCk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gcmVxLm1ldGhvZCB8fCAnR0VUJztcbiAgICAgICAgY29uc3QgcmVzb2x2ZWRVcmwgPSBmb3JtYXRVcmwoe1xuICAgICAgICAgICAgcGF0aG5hbWU6IG5leHRDb25maWcudHJhaWxpbmdTbGFzaCA/IHBhcnNlZFVybC5wYXRobmFtZSA6IHJlbW92ZVRyYWlsaW5nU2xhc2gocGFyc2VkVXJsLnBhdGhuYW1lIHx8ICcvJyksXG4gICAgICAgICAgICAvLyBtYWtlIHN1cmUgdG8gb25seSBhZGQgcXVlcnkgdmFsdWVzIGZyb20gb3JpZ2luYWwgVVJMXG4gICAgICAgICAgICBxdWVyeTogaGFzU3RhdGljUHJvcHMgPyB7fSA6IG9yaWdpbmFsUXVlcnlcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHB1YmxpY1J1bnRpbWVDb25maWcgPSAocm91dGVyU2VydmVyQ29udGV4dCA9PSBudWxsID8gdm9pZCAwIDogcm91dGVyU2VydmVyQ29udGV4dC5wdWJsaWNSdW50aW1lQ29uZmlnKSB8fCBuZXh0Q29uZmlnLnB1YmxpY1J1bnRpbWVDb25maWc7XG4gICAgICAgIGNvbnN0IGhhbmRsZVJlc3BvbnNlID0gYXN5bmMgKHNwYW4pPT57XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZUdlbmVyYXRvciA9IGFzeW5jICh7IHByZXZpb3VzQ2FjaGVFbnRyeSB9KT0+e1xuICAgICAgICAgICAgICAgIHZhciBfcHJldmlvdXNDYWNoZUVudHJ5X3ZhbHVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvUmVuZGVyID0gYXN5bmMgKCk9PntcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfbmV4dENvbmZpZ19pMThuLCBfbmV4dENvbmZpZ19leHBlcmltZW50YWxfYW1wLCBfbmV4dENvbmZpZ19leHBlcmltZW50YWxfYW1wMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCByb3V0ZU1vZHVsZS5yZW5kZXIocmVxLCByZXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWVyeTogaGFzU3RhdGljUHJvcHMgJiYgIWlzRXhwZXJpbWVudGFsQ29tcGlsZSA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLi4ucGFyYW1zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5pc0FtcCA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcDogcXVlcnkuYW1wXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gOiB7fVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLnF1ZXJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuLi5wYXJhbXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlOiBzcmNQYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlckNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNEcmFmdE1vZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRmFsbGJhY2s6IGlzSXNyRmFsbGJhY2ssXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldmVsb3BtZW50Tm90Rm91bmRTb3VyY2VQYWdlOiBnZXRSZXF1ZXN0TWV0YShyZXEsICdkZXZlbG9wbWVudE5vdEZvdW5kU291cmNlUGFnZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWRDb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1aWxkSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbVNlcnZlcjogQm9vbGVhbihyb3V0ZXJTZXJ2ZXJDb250ZXh0ID09IG51bGwgPyB2b2lkIDAgOiByb3V0ZXJTZXJ2ZXJDb250ZXh0LmlzQ3VzdG9tU2VydmVyKSB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcGxveW1lbnRJZDogcHJvY2Vzcy5lbnYuTkVYVF9ERVBMT1lNRU5UX0lEXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJPcHRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVNb2R1bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2U6IHNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VDb25maWc6IGNvbmZpZyB8fCB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ29tcG9uZW50OiBpbnRlcm9wRGVmYXVsdCh1c2VybGFuZCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvbXBvbmVudE1vZDogdXNlcmxhbmQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFN0YXRpY1Byb3BzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRTdGF0aWNQYXRocyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0U2VydmVyU2lkZVByb3BzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdXBwb3J0c0R5bmFtaWNSZXNwb25zZTogIWhhc1N0YXRpY1Byb3BzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBidWlsZE1hbmlmZXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0Rm9udE1hbmlmZXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFjdExvYWRhYmxlTWFuaWZlc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0UHJlZml4OiBuZXh0Q29uZmlnLmFzc2V0UHJlZml4LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpY3ROZXh0SGVhZDogbmV4dENvbmZpZy5leHBlcmltZW50YWwuc3RyaWN0TmV4dEhlYWQgPz8gdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld1Byb3BzOiBwcmVyZW5kZXJNYW5pZmVzdC5wcmV2aWV3LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZXM6IG5leHRDb25maWcuaW1hZ2VzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0Q29uZmlnT3V0cHV0OiBuZXh0Q29uZmlnLm91dHB1dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW1pemVDc3M6IEJvb2xlYW4obmV4dENvbmZpZy5leHBlcmltZW50YWwub3B0aW1pemVDc3MpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0U2NyaXB0V29ya2VyczogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5uZXh0U2NyaXB0V29ya2VycyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbWFpbkxvY2FsZXM6IChfbmV4dENvbmZpZ19pMThuID0gbmV4dENvbmZpZy5pMThuKSA9PSBudWxsID8gdm9pZCAwIDogX25leHRDb25maWdfaTE4bi5kb21haW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcm9zc09yaWdpbjogbmV4dENvbmZpZy5jcm9zc09yaWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXVsdGlab25lRHJhZnRNb2RlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlUGF0aDogbmV4dENvbmZpZy5iYXNlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2Fub25pY2FsQmFzZTogbmV4dENvbmZpZy5hbXAuY2Fub25pY2FsQmFzZSB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW1wT3B0aW1pemVyQ29uZmlnOiAoX25leHRDb25maWdfZXhwZXJpbWVudGFsX2FtcCA9IG5leHRDb25maWcuZXhwZXJpbWVudGFsLmFtcCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbF9hbXAub3B0aW1pemVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlT3B0aW1pemVkTG9hZGluZzogbmV4dENvbmZpZy5leHBlcmltZW50YWwuZGlzYWJsZU9wdGltaXplZExvYWRpbmcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhcmdlUGFnZURhdGFCeXRlczogbmV4dENvbmZpZy5leHBlcmltZW50YWwubGFyZ2VQYWdlRGF0YUJ5dGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHRoZSBgcHVibGljUnVudGltZUNvbmZpZ2Aga2V5IGlzIGV4cG9zZWQgdG8gdGhlIGNsaWVudCBzaWRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEl0J2xsIGJlIHJlbmRlcmVkIGFzIHBhcnQgb2YgX19ORVhUX0RBVEFfXyBvbiB0aGUgY2xpZW50IHNpZGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVudGltZUNvbmZpZzogT2JqZWN0LmtleXMocHVibGljUnVudGltZUNvbmZpZykubGVuZ3RoID4gMCA/IHB1YmxpY1J1bnRpbWVDb25maWcgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRXhwZXJpbWVudGFsQ29tcGlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwZXJpbWVudGFsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRUcmFjZU1ldGFkYXRhOiBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5jbGllbnRUcmFjZU1ldGFkYXRhIHx8IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdExvY2FsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0SXNyU3RhdHVzOiByb3V0ZXJTZXJ2ZXJDb250ZXh0ID09IG51bGwgPyB2b2lkIDAgOiByb3V0ZXJTZXJ2ZXJDb250ZXh0LnNldElzclN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNOZXh0RGF0YVJlcXVlc3Q6IGlzTmV4dERhdGFSZXF1ZXN0ICYmIChoYXNTZXJ2ZXJQcm9wcyB8fCBoYXNTdGF0aWNQcm9wcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVkVXJsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgZ2V0U2VydmVyU2lkZVByb3BzIGFuZCBnZXRJbml0aWFsUHJvcHMgd2UgbmVlZCB0byBlbnN1cmUgd2UgdXNlIHRoZSBvcmlnaW5hbCBVUkxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIG5vdCB0aGUgcmVzb2x2ZWQgVVJMIHRvIHByZXZlbnQgYSBoeWRyYXRpb24gbWlzbWF0Y2ggb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXNQYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVkQXNQYXRoOiBoYXNTZXJ2ZXJQcm9wcyB8fCBoYXNHZXRJbml0aWFsUHJvcHMgPyBmb3JtYXRVcmwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgdXNlIHRoZSBvcmlnaW5hbCBVUkwgcGF0aG5hbWUgbGVzcyB0aGUgX25leHQvZGF0YSBwcmVmaXggaWZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHByZXNlbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGhuYW1lOiBpc05leHREYXRhUmVxdWVzdCA/IG5vcm1hbGl6ZURhdGFQYXRoKG9yaWdpbmFsUGF0aG5hbWUpIDogb3JpZ2luYWxQYXRobmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5OiBvcmlnaW5hbFF1ZXJ5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIDogcmVzb2x2ZWRVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzT25EZW1hbmRSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBFcnJvckRlYnVnOiBnZXRSZXF1ZXN0TWV0YShyZXEsICdQYWdlc0Vycm9yRGVidWcnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyOiBnZXRSZXF1ZXN0TWV0YShyZXEsICdpbnZva2VFcnJvcicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXY6IHJvdXRlTW9kdWxlLmlzRGV2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBuZWVkZWQgZm9yIGV4cGVyaW1lbnRhbC5vcHRpbWl6ZUNzcyBmZWF0dXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3REaXI6IGAke3JvdXRlTW9kdWxlLnByb2plY3REaXJ9LyR7cm91dGVNb2R1bGUuZGlzdERpcn1gLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXBTa2lwVmFsaWRhdGlvbjogKF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbF9hbXAxID0gbmV4dENvbmZpZy5leHBlcmltZW50YWwuYW1wKSA9PSBudWxsID8gdm9pZCAwIDogX25leHRDb25maWdfZXhwZXJpbWVudGFsX2FtcDEuc2tpcFZhbGlkYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFtcFZhbGlkYXRvcjogZ2V0UmVxdWVzdE1ldGEocmVxLCAnYW1wVmFsaWRhdG9yJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKChyZW5kZXJSZXN1bHQpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBtZXRhZGF0YSB9ID0gcmVuZGVyUmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjYWNoZUNvbnRyb2wgPSBtZXRhZGF0YS5jYWNoZUNvbnRyb2w7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCdpc05vdEZvdW5kJyBpbiBtZXRhZGF0YSAmJiBtZXRhZGF0YS5pc05vdEZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgYGlzUmVkaXJlY3RgLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YS5pc1JlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IENhY2hlZFJvdXRlS2luZC5SRURJUkVDVCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wczogbWV0YWRhdGEucGFnZURhdGEgPz8gbWV0YWRhdGEuZmxpZ2h0RGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogQ2FjaGVkUm91dGVLaW5kLlBBR0VTLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbDogcmVuZGVyUmVzdWx0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnZURhdGE6IHJlbmRlclJlc3VsdC5tZXRhZGF0YS5wYWdlRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHJlbmRlclJlc3VsdC5tZXRhZGF0YS5oZWFkZXJzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZW5kZXJSZXN1bHQubWV0YWRhdGEuc3RhdHVzQ29kZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWNoZUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuZmluYWxseSgoKT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc3BhbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICduZXh0LnJzYyc6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIHdlcmUgdW5hYmxlIHRvIGdldCBhdHRyaWJ1dGVzLCBwcm9iYWJseSBPVEVMIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyb290U3BhbkF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKSAhPT0gQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGAke21ldGhvZH0gJHtyb3V0ZX1gO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKGAke21ldGhvZH0gJHtyZXEudXJsfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYSBiYWNrZ3JvdW5kIHJldmFsaWRhdGUgd2UgbmVlZCB0byByZXBvcnRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSByZXF1ZXN0IGVycm9yIGhlcmUgYXMgaXQgd29uJ3QgYmUgYnViYmxlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSA9PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNDYWNoZUVudHJ5LmlzU3RhbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnUGFnZXMgUm91dGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVQYXRoOiBzcmNQYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZVR5cGU6ICdyZW5kZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmV2YWxpZGF0ZTogaGFzU3RhdGljUHJvcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHJvdXRlclNlcnZlckNvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSd2ZSBhbHJlYWR5IGdlbmVyYXRlZCB0aGlzIHBhZ2Ugd2Ugbm8gbG9uZ2VyXG4gICAgICAgICAgICAgICAgLy8gc2VydmUgdGhlIGZhbGxiYWNrXG4gICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzQ2FjaGVFbnRyeSkge1xuICAgICAgICAgICAgICAgICAgICBpc0lzckZhbGxiYWNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpc0lzckZhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZhbGxiYWNrUmVzcG9uc2UgPSBhd2FpdCByb3V0ZU1vZHVsZS5nZXRSZXNwb25zZUNhY2hlKHJlcSkuZ2V0KHJvdXRlTW9kdWxlLmlzRGV2ID8gbnVsbCA6IGxvY2FsZSA/IGAvJHtsb2NhbGV9JHtzcmNQYWdlfWAgOiBzcmNQYWdlLCBhc3luYyAoeyBwcmV2aW91c0NhY2hlRW50cnk6IHByZXZpb3VzRmFsbGJhY2tDYWNoZUVudHJ5ID0gbnVsbCB9KT0+e1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyb3V0ZU1vZHVsZS5pc0Rldikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0b1Jlc3BvbnNlQ2FjaGVFbnRyeShwcmV2aW91c0ZhbGxiYWNrQ2FjaGVFbnRyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZG9SZW5kZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVLaW5kOiBSb3V0ZUtpbmQuUEFHRVMsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0ZhbGxiYWNrOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNSb3V0ZVBQUkVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW5jcmVtZW50YWxDYWNoZTogYXdhaXQgcm91dGVNb2R1bGUuZ2V0SW5jcmVtZW50YWxDYWNoZShyZXEsIG5leHRDb25maWcsIHByZXJlbmRlck1hbmlmZXN0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRVbnRpbDogY3R4LndhaXRVbnRpbFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZhbGxiYWNrUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgY2FjaGUgY29udHJvbCBmcm9tIHRoZSByZXNwb25zZSB0byBwcmV2ZW50IGl0IGZyb20gYmVpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzZWQgaW4gdGhlIHN1cnJvdW5kaW5nIGNhY2hlLlxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGZhbGxiYWNrUmVzcG9uc2UuY2FjaGVDb250cm9sO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFsbGJhY2tSZXNwb25zZS5pc01pc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbGxiYWNrUmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzT25EZW1hbmRSZXZhbGlkYXRlICYmIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkICYmICFwcmV2aW91c0NhY2hlRW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSA0MDQ7XG4gICAgICAgICAgICAgICAgICAgIC8vIG9uLWRlbWFuZCByZXZhbGlkYXRlIGFsd2F5cyBzZXRzIHRoaXMgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgJ1JFVkFMSURBVEVEJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5lbmQoJ1RoaXMgcGFnZSBjb3VsZCBub3QgYmUgZm91bmQnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChpc0lzckZhbGxiYWNrICYmIChwcmV2aW91c0NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfcHJldmlvdXNDYWNoZUVudHJ5X3ZhbHVlID0gcHJldmlvdXNDYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX3ByZXZpb3VzQ2FjaGVFbnRyeV92YWx1ZS5raW5kKSA9PT0gQ2FjaGVkUm91dGVLaW5kLlBBR0VTKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IENhY2hlZFJvdXRlS2luZC5QQUdFUyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sOiBuZXcgUmVuZGVyUmVzdWx0KEJ1ZmZlci5mcm9tKHByZXZpb3VzQ2FjaGVFbnRyeS52YWx1ZS5odG1sKSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ3RleHQvaHRtbDt1dGYtOCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBwcmV2aW91c0NhY2hlRW50cnkudmFsdWUuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogcHJldmlvdXNDYWNoZUVudHJ5LnZhbHVlLmhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VEYXRhOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHByZXZpb3VzQ2FjaGVFbnRyeS52YWx1ZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogcHJldmlvdXNDYWNoZUVudHJ5LnZhbHVlLmhlYWRlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjYWNoZUNvbnRyb2w6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZTogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBkb1JlbmRlcigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJvdXRlTW9kdWxlLmhhbmRsZVJlc3BvbnNlKHtcbiAgICAgICAgICAgICAgICBjYWNoZUtleSxcbiAgICAgICAgICAgICAgICByZXEsXG4gICAgICAgICAgICAgICAgbmV4dENvbmZpZyxcbiAgICAgICAgICAgICAgICByb3V0ZUtpbmQ6IFJvdXRlS2luZC5QQUdFUyxcbiAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlT25seUdlbmVyYXRlZCxcbiAgICAgICAgICAgICAgICB3YWl0VW50aWw6IGN0eC53YWl0VW50aWwsXG4gICAgICAgICAgICAgICAgcmVzcG9uc2VHZW5lcmF0b3I6IHJlc3BvbnNlR2VuZXJhdG9yLFxuICAgICAgICAgICAgICAgIHByZXJlbmRlck1hbmlmZXN0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGlmIHdlIGdvdCBhIGNhY2hlIGhpdCB0aGlzIHdhc24ndCBhbiBJU1IgZmFsbGJhY2tcbiAgICAgICAgICAgIC8vIGJ1dCBpdCB3YXNuJ3QgZ2VuZXJhdGVkIGR1cmluZyBidWlsZCBzbyBpc24ndCBpbiB0aGVcbiAgICAgICAgICAgIC8vIHByZXJlbmRlci1tYW5pZmVzdFxuICAgICAgICAgICAgaWYgKGlzSXNyRmFsbGJhY2sgJiYgIShyZXN1bHQgPT0gbnVsbCA/IHZvaWQgMCA6IHJlc3VsdC5pc01pc3MpKSB7XG4gICAgICAgICAgICAgICAgaXNJc3JGYWxsYmFjayA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gcmVzcG9uc2UgaXMgZmluaXNoZWQgaXMgbm8gY2FjaGUgZW50cnlcbiAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhhc1N0YXRpY1Byb3BzICYmICFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcigneC1uZXh0anMtY2FjaGUnLCBpc09uRGVtYW5kUmV2YWxpZGF0ZSA/ICdSRVZBTElEQVRFRCcgOiByZXN1bHQuaXNNaXNzID8gJ01JU1MnIDogcmVzdWx0LmlzU3RhbGUgPyAnU1RBTEUnIDogJ0hJVCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IGNhY2hlQ29udHJvbDtcbiAgICAgICAgICAgIGlmICghaGFzU3RhdGljUHJvcHMgfHwgaXNJc3JGYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmICghcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGU6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHBpcmU6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXM0MDRQYWdlKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm90Rm91bmRSZXZhbGlkYXRlID0gZ2V0UmVxdWVzdE1ldGEocmVxLCAnbm90Rm91bmRSZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICAgICAgY2FjaGVDb250cm9sID0ge1xuICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlOiB0eXBlb2Ygbm90Rm91bmRSZXZhbGlkYXRlID09PSAndW5kZWZpbmVkJyA/IDAgOiBub3RGb3VuZFJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgIGV4cGlyZTogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXM1MDBQYWdlKSB7XG4gICAgICAgICAgICAgICAgY2FjaGVDb250cm9sID0ge1xuICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlOiAwLFxuICAgICAgICAgICAgICAgICAgICBleHBpcmU6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5jYWNoZUNvbnRyb2wpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY2FjaGUgZW50cnkgaGFzIGEgY2FjaGUgY29udHJvbCB3aXRoIGEgcmV2YWxpZGF0ZSB2YWx1ZSB0aGF0J3NcbiAgICAgICAgICAgICAgICAvLyBhIG51bWJlciwgdXNlIGl0LlxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzdWx0LmNhY2hlQ29udHJvbC5yZXZhbGlkYXRlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3Jlc3VsdF9jYWNoZUNvbnRyb2w7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY2FjaGVDb250cm9sLnJldmFsaWRhdGUgPCAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3IEVycm9yKGBJbnZhbGlkIHJldmFsaWRhdGUgY29uZmlndXJhdGlvbiBwcm92aWRlZDogJHtyZXN1bHQuY2FjaGVDb250cm9sLnJldmFsaWRhdGV9IDwgMWApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJFMjJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGU6IHJlc3VsdC5jYWNoZUNvbnRyb2wucmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZTogKChfcmVzdWx0X2NhY2hlQ29udHJvbCA9IHJlc3VsdC5jYWNoZUNvbnRyb2wpID09IG51bGwgPyB2b2lkIDAgOiBfcmVzdWx0X2NhY2hlQ29udHJvbC5leHBpcmUpID8/IG5leHRDb25maWcuZXhwaXJlVGltZVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHJldmFsaWRhdGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlQ29udHJvbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGU6IENBQ0hFX09ORV9ZRUFSLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlOiB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiBjYWNoZSBjb250cm9sIGlzIGFscmVhZHkgc2V0IG9uIHRoZSByZXNwb25zZSB3ZSBkb24ndFxuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgaXQgdG8gYWxsb3cgdXNlcnMgdG8gY3VzdG9taXplIGl0IHZpYSBuZXh0LmNvbmZpZ1xuICAgICAgICAgICAgaWYgKGNhY2hlQ29udHJvbCAmJiAhcmVzLmdldEhlYWRlcignQ2FjaGUtQ29udHJvbCcpKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsIGdldENhY2hlQ29udHJvbEhlYWRlcihjYWNoZUNvbnRyb2wpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIG5vdEZvdW5kOiB0cnVlIGNhc2VcbiAgICAgICAgICAgIGlmICghcmVzdWx0LnZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9yZXN1bHRfY2FjaGVDb250cm9sMTtcbiAgICAgICAgICAgICAgICAvLyBhZGQgcmV2YWxpZGF0ZSBtZXRhZGF0YSBiZWZvcmUgcmVuZGVyaW5nIDQwNCBwYWdlXG4gICAgICAgICAgICAgICAgLy8gc28gdGhhdCB3ZSBjYW4gdXNlIHRoaXMgYXMgc291cmNlIG9mIHRydXRoIGZvciB0aGVcbiAgICAgICAgICAgICAgICAvLyBjYWNoZS1jb250cm9sIGhlYWRlciBpbnN0ZWFkIG9mIHdoYXQgdGhlIDQwNCBwYWdlIHJldHVybnNcbiAgICAgICAgICAgICAgICAvLyBmb3IgdGhlIHJldmFsaWRhdGUgdmFsdWVcbiAgICAgICAgICAgICAgICBhZGRSZXF1ZXN0TWV0YShyZXEsICdub3RGb3VuZFJldmFsaWRhdGUnLCAoX3Jlc3VsdF9jYWNoZUNvbnRyb2wxID0gcmVzdWx0LmNhY2hlQ29udHJvbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9yZXN1bHRfY2FjaGVDb250cm9sMS5yZXZhbGlkYXRlKTtcbiAgICAgICAgICAgICAgICByZXMuc3RhdHVzQ29kZSA9IDQwNDtcbiAgICAgICAgICAgICAgICBpZiAoaXNOZXh0RGF0YVJlcXVlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgne1wibm90Rm91bmRcIjp0cnVlfScpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHNob3VsZCByb3V0ZS1tb2R1bGUgaXRzZWxmIGhhbmRsZSByZW5kZXJpbmcgdGhlIDQwNFxuICAgICAgICAgICAgICAgIGlmIChyb3V0ZXJTZXJ2ZXJDb250ZXh0ID09IG51bGwgPyB2b2lkIDAgOiByb3V0ZXJTZXJ2ZXJDb250ZXh0LnJlbmRlcjQwNCkge1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCByb3V0ZXJTZXJ2ZXJDb250ZXh0LnJlbmRlcjQwNChyZXEsIHJlcywgcGFyc2VkVXJsLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLmVuZCgnVGhpcyBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzdWx0LnZhbHVlLmtpbmQgPT09IENhY2hlZFJvdXRlS2luZC5SRURJUkVDVCkge1xuICAgICAgICAgICAgICAgIGlmIChpc05leHREYXRhUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdjb250ZW50LXR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgICAgICAgICAgICAgICByZXMuZW5kKEpTT04uc3RyaW5naWZ5KHJlc3VsdC52YWx1ZS5wcm9wcykpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFuZGxlUmVkaXJlY3QgPSAocGFnZURhdGEpPT57XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWRpcmVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbjogcGFnZURhdGEucGFnZVByb3BzLl9fTl9SRURJUkVDVCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiBwYWdlRGF0YS5wYWdlUHJvcHMuX19OX1JFRElSRUNUX1NUQVRVUyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlUGF0aDogcGFnZURhdGEucGFnZVByb3BzLl9fTl9SRURJUkVDVF9CQVNFX1BBVEhcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0dXNDb2RlID0gZ2V0UmVkaXJlY3RTdGF0dXMocmVkaXJlY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBiYXNlUGF0aCB9ID0gbmV4dENvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYXNlUGF0aCAmJiByZWRpcmVjdC5iYXNlUGF0aCAhPT0gZmFsc2UgJiYgcmVkaXJlY3QuZGVzdGluYXRpb24uc3RhcnRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3QuZGVzdGluYXRpb24gPSBgJHtiYXNlUGF0aH0ke3JlZGlyZWN0LmRlc3RpbmF0aW9ufWA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVkaXJlY3QuZGVzdGluYXRpb24uc3RhcnRzV2l0aCgnLycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVkaXJlY3QuZGVzdGluYXRpb24gPSBub3JtYWxpemVSZXBlYXRlZFNsYXNoZXMocmVkaXJlY3QuZGVzdGluYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1c0NvZGUgPSBzdGF0dXNDb2RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignTG9jYXRpb24nLCByZWRpcmVjdC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdHVzQ29kZSA9PT0gUmVkaXJlY3RTdGF0dXNDb2RlLlBlcm1hbmVudFJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignUmVmcmVzaCcsIGAwO3VybD0ke3JlZGlyZWN0LmRlc3RpbmF0aW9ufWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzLmVuZChyZWRpcmVjdC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGhhbmRsZVJlZGlyZWN0KHJlc3VsdC52YWx1ZS5wcm9wcyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQudmFsdWUua2luZCAhPT0gQ2FjaGVkUm91dGVLaW5kLlBBR0VTKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ldyBFcnJvcihgSW52YXJpYW50OiByZWNlaXZlZCBub24tcGFnZXMgY2FjaGUgZW50cnkgaW4gcGFnZXMgaGFuZGxlcmApLCBcIl9fTkVYVF9FUlJPUl9DT0RFXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFwiRTY5NVwiLFxuICAgICAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJbiBkZXYsIHdlIHNob3VsZCBub3QgY2FjaGUgcGFnZXMgZm9yIGFueSByZWFzb24uXG4gICAgICAgICAgICBpZiAocm91dGVNb2R1bGUuaXNEZXYpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ25vLXN0b3JlLCBtdXN0LXJldmFsaWRhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIERyYWZ0IG1vZGUgc2hvdWxkIG5ldmVyIGJlIGNhY2hlZFxuICAgICAgICAgICAgaWYgKGlzRHJhZnRNb2RlKSB7XG4gICAgICAgICAgICAgICAgcmVzLnNldEhlYWRlcignQ2FjaGUtQ29udHJvbCcsICdwcml2YXRlLCBuby1jYWNoZSwgbm8tc3RvcmUsIG1heC1hZ2U9MCwgbXVzdC1yZXZhbGlkYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB3aGVuIGludm9raW5nIF9lcnJvciBiZWZvcmUgcGFnZXMvNTAwIHdlIGRvbid0IGFjdHVhbGx5XG4gICAgICAgICAgICAvLyBzZW5kIHRoZSBfZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgIGlmIChnZXRSZXF1ZXN0TWV0YShyZXEsICdjdXN0b21FcnJvclJlbmRlcicpIHx8IGlzRXJyb3JQYWdlICYmIGdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgcmVzLnN0YXR1c0NvZGUgPT09IDUwMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgc2VuZFJlbmRlclJlc3VsdCh7XG4gICAgICAgICAgICAgICAgcmVxLFxuICAgICAgICAgICAgICAgIHJlcyxcbiAgICAgICAgICAgICAgICAvLyBJZiB3ZSBhcmUgcmVuZGVyaW5nIHRoZSBlcnJvciBwYWdlIGl0J3Mgbm90IGEgZGF0YSByZXF1ZXN0XG4gICAgICAgICAgICAgICAgLy8gYW55bW9yZVxuICAgICAgICAgICAgICAgIHJlc3VsdDogaXNOZXh0RGF0YVJlcXVlc3QgJiYgIWlzRXJyb3JQYWdlICYmICFpczUwMFBhZ2UgPyBuZXcgUmVuZGVyUmVzdWx0KEJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KHJlc3VsdC52YWx1ZS5wYWdlRGF0YSkpLCB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiByZXN1bHQudmFsdWUuaHRtbC5tZXRhZGF0YVxuICAgICAgICAgICAgICAgIH0pIDogcmVzdWx0LnZhbHVlLmh0bWwsXG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVFdGFnczogbmV4dENvbmZpZy5nZW5lcmF0ZUV0YWdzLFxuICAgICAgICAgICAgICAgIHBvd2VyZWRCeUhlYWRlcjogbmV4dENvbmZpZy5wb3dlcmVkQnlIZWFkZXIsXG4gICAgICAgICAgICAgICAgY2FjaGVDb250cm9sOiByb3V0ZU1vZHVsZS5pc0RldiA/IHVuZGVmaW5lZCA6IGNhY2hlQ29udHJvbCxcbiAgICAgICAgICAgICAgICB0eXBlOiBpc05leHREYXRhUmVxdWVzdCA/ICdqc29uJyA6ICdodG1sJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIC8vIFRPRE86IGFjdGl2ZVNwYW4gY29kZSBwYXRoIGlzIGZvciB3aGVuIHdyYXBwZWQgYnlcbiAgICAgICAgLy8gbmV4dC1zZXJ2ZXIgY2FuIGJlIHJlbW92ZWQgd2hlbiB0aGlzIGlzIG5vIGxvbmdlciB1c2VkXG4gICAgICAgIGlmIChhY3RpdmVTcGFuKSB7XG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVSZXNwb25zZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYXdhaXQgdHJhY2VyLndpdGhQcm9wYWdhdGVkQ29udGV4dChyZXEuaGVhZGVycywgKCk9PnRyYWNlci50cmFjZShCYXNlU2VydmVyU3Bhbi5oYW5kbGVSZXF1ZXN0LCB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5OYW1lOiBgJHttZXRob2R9ICR7cmVxLnVybH1gLFxuICAgICAgICAgICAgICAgICAgICBraW5kOiBTcGFuS2luZC5TRVJWRVIsXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLm1ldGhvZCc6IG1ldGhvZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnRhcmdldCc6IHJlcS51cmxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIGhhbmRsZVJlc3BvbnNlKSk7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgaWYgKCEoZXJyIGluc3RhbmNlb2YgTm9GYWxsYmFja0Vycm9yKSkge1xuICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnUGFnZXMgUm91dGVyJyxcbiAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IHNyY1BhZ2UsXG4gICAgICAgICAgICAgICAgcm91dGVUeXBlOiAncmVuZGVyJyxcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgICAgaXNSZXZhbGlkYXRlOiBoYXNTdGF0aWNQcm9wcyxcbiAgICAgICAgICAgICAgICAgICAgaXNPbkRlbWFuZFJldmFsaWRhdGVcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSwgcm91dGVyU2VydmVyQ29udGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gcmV0aHJvdyBzbyB0aGF0IHdlIGNhbiBoYW5kbGUgc2VydmluZyBlcnJvciBwYWdlXG4gICAgICAgIHRocm93IGVycjtcbiAgICB9XG59XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fchat.tsx&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(pages-dir-node)/./pages/Layout.tsx":
/*!**************************!*\
  !*** ./pages/Layout.tsx ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Layout)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var next_link__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/link */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/link.js\");\n/* harmony import */ var next_link__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_link__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/router */ \"(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/router.js\");\n/* harmony import */ var next_router__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_router__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _components_AuthContext__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n/* harmony import */ var _context_AppStateContext__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../context/AppStateContext */ \"(pages-dir-node)/./context/AppStateContext.tsx\");\n/* harmony import */ var _components_LogoutButton__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/LogoutButton */ \"(pages-dir-node)/./components/LogoutButton.tsx\");\n// src/ui/pages/Layout.tsx\n\n\n\n\n\n\n\n// Use a static public path for the logo to avoid bundling object URLs\nconst logoPath = '/assets/grace_logo_gold.png';\nfunction Layout({ children }) {\n    const router = (0,next_router__WEBPACK_IMPORTED_MODULE_3__.useRouter)();\n    const { pathname } = router;\n    const { user } = (0,_components_AuthContext__WEBPACK_IMPORTED_MODULE_4__.useAuth)();\n    const [mobileMenuOpen, setMobileMenuOpen] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Use the AppState context\n    const { dispatch, hydrateFromStorage } = (0,_context_AppStateContext__WEBPACK_IMPORTED_MODULE_5__.useAppState)();\n    // Capture page state on path change\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Layout.useEffect\": ()=>{\n            if (user) {\n                dispatch({\n                    type: 'SET_PAGE_STATE',\n                    payload: {\n                        lastVisitedPath: pathname\n                    }\n                });\n            }\n        }\n    }[\"Layout.useEffect\"], [\n        pathname,\n        user,\n        dispatch\n    ]);\n    // Removed beforeunload prompt to allow smooth navigation\n    // Hydrate state on initial load\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Layout.useEffect\": ()=>{\n            if (user) {\n                hydrateFromStorage({\n                    \"Layout.useEffect\": (path)=>{\n                        router.push(path);\n                    }\n                }[\"Layout.useEffect\"]);\n            }\n        }\n    }[\"Layout.useEffect\"], [\n        user,\n        router,\n        hydrateFromStorage\n    ]);\n    const navLinks = [\n        {\n            name: 'Chat',\n            path: '/chat'\n        },\n        {\n            name: 'Wallet',\n            path: '/wallet'\n        },\n        {\n            name: 'Trading',\n            path: '/trading'\n        },\n        {\n            name: 'Social',\n            path: '/social'\n        },\n        {\n            name: 'Settings',\n            path: '/settings'\n        }\n    ];\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"min-h-screen bg-gradient-to-b from-[#140000] to-black text-white flex flex-col items-center\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"header\", {\n                className: \"w-full max-w-screen-md text-center border-b border-red-700 pb-1 mb-2\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                        src: logoPath,\n                        alt: \"Grace Logo\",\n                        className: \"w-48 md:w-56 mx-auto mt-2 mb-1\"\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                        lineNumber: 56,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        className: \"md:hidden absolute right-4 top-6 text-white p-2\",\n                        onClick: ()=>setMobileMenuOpen(!mobileMenuOpen),\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                            xmlns: \"http://www.w3.org/2000/svg\",\n                            className: \"h-6 w-6\",\n                            fill: \"none\",\n                            viewBox: \"0 0 24 24\",\n                            stroke: \"currentColor\",\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                strokeLinecap: \"round\",\n                                strokeLinejoin: \"round\",\n                                strokeWidth: 2,\n                                d: mobileMenuOpen ? \"M6 18L18 6M6 6l12 12\" : \"M4 6h16M4 12h16M4 18h16\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                                lineNumber: 64,\n                                columnNumber: 13\n                            }, this)\n                        }, void 0, false, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                            lineNumber: 63,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                        lineNumber: 59,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"nav\", {\n                        className: `\n          ${mobileMenuOpen ? 'flex' : 'hidden'} \n          md:flex \n          flex-col md:flex-row \n          justify-center \n          md:space-x-6 md:space-y-0 \n          space-y-4 \n          text-red-300 text-lg md:text-xl font-mono\n          w-full \n          pb-1\n        `,\n                        children: [\n                            navLinks.map((link)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)((next_link__WEBPACK_IMPORTED_MODULE_2___default()), {\n                                    href: link.path,\n                                    onClick: ()=>setMobileMenuOpen(false),\n                                    className: `transition-all hover:text-red-400 pb-1 ${pathname === link.path ? 'text-red-300 border-b border-red-500' : 'text-white'}`,\n                                    children: link.name\n                                }, link.path, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                                    lineNumber: 81,\n                                    columnNumber: 13\n                                }, this)),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LogoutButton__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {}, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                                lineNumber: 90,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                        lineNumber: 69,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                lineNumber: 55,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"main\", {\n                className: \"w-full max-w-screen-md px-4 py-3 flex-grow\",\n                children: children\n            }, void 0, false, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n                lineNumber: 93,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/Layout.tsx\",\n        lineNumber: 54,\n        columnNumber: 5\n    }, this);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3BhZ2VzL0xheW91dC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMEJBQTBCOztBQUVvQztBQUNqQztBQUNXO0FBQ1k7QUFDSztBQUNIO0FBRXRELHNFQUFzRTtBQUN0RSxNQUFNUSxXQUFXO0FBTUYsU0FBU0MsT0FBTyxFQUFFQyxRQUFRLEVBQWU7SUFDdEQsTUFBTUMsU0FBU1Asc0RBQVNBO0lBQ3hCLE1BQU0sRUFBRVEsUUFBUSxFQUFFLEdBQUdEO0lBQ3JCLE1BQU0sRUFBRUUsSUFBSSxFQUFFLEdBQUdSLGdFQUFPQTtJQUN4QixNQUFNLENBQUNTLGdCQUFnQkMsa0JBQWtCLEdBQUdkLCtDQUFRQSxDQUFDO0lBRXJELDJCQUEyQjtJQUMzQixNQUFNLEVBQUVlLFFBQVEsRUFBRUMsa0JBQWtCLEVBQUUsR0FBR1gscUVBQVdBO0lBRXBELG9DQUFvQztJQUNwQ0osZ0RBQVNBOzRCQUFDO1lBQ1IsSUFBSVcsTUFBTTtnQkFDUkcsU0FBUztvQkFDUEUsTUFBTTtvQkFDTkMsU0FBUzt3QkFBRUMsaUJBQWlCUjtvQkFBUztnQkFDdkM7WUFDRjtRQUNGOzJCQUFHO1FBQUNBO1FBQVVDO1FBQU1HO0tBQVM7SUFFN0IseURBQXlEO0lBRXpELGdDQUFnQztJQUNoQ2QsZ0RBQVNBOzRCQUFDO1lBQ1IsSUFBSVcsTUFBTTtnQkFDUkk7d0NBQW1CLENBQUNJO3dCQUFXVixPQUFPVyxJQUFJLENBQUNEO29CQUFPOztZQUNwRDtRQUNGOzJCQUFHO1FBQUNSO1FBQU1GO1FBQVFNO0tBQW1CO0lBRXJDLE1BQU1NLFdBQVc7UUFDZjtZQUFFQyxNQUFNO1lBQVFILE1BQU07UUFBUTtRQUM5QjtZQUFFRyxNQUFNO1lBQVVILE1BQU07UUFBVTtRQUNsQztZQUFFRyxNQUFNO1lBQVdILE1BQU07UUFBVztRQUNwQztZQUFFRyxNQUFNO1lBQVVILE1BQU07UUFBVTtRQUNsQztZQUFFRyxNQUFNO1lBQVlILE1BQU07UUFBWTtLQUN2QztJQUVELHFCQUNFLDhEQUFDSTtRQUFJQyxXQUFVOzswQkFDYiw4REFBQ0M7Z0JBQU9ELFdBQVU7O2tDQUNoQiw4REFBQ0U7d0JBQUlDLEtBQUtyQjt3QkFBVXNCLEtBQUk7d0JBQWFKLFdBQVU7Ozs7OztrQ0FHL0MsOERBQUNLO3dCQUNDTCxXQUFVO3dCQUNWTSxTQUFTLElBQU1qQixrQkFBa0IsQ0FBQ0Q7a0NBRWxDLDRFQUFDbUI7NEJBQUlDLE9BQU07NEJBQTZCUixXQUFVOzRCQUFVUyxNQUFLOzRCQUFPQyxTQUFROzRCQUFZQyxRQUFPO3NDQUNqRyw0RUFBQ2hCO2dDQUFLaUIsZUFBYztnQ0FBUUMsZ0JBQWU7Z0NBQVFDLGFBQWE7Z0NBQUdDLEdBQUczQixpQkFBaUIseUJBQXlCOzs7Ozs7Ozs7Ozs7Ozs7O2tDQUtwSCw4REFBQzRCO3dCQUFJaEIsV0FBVyxDQUFDO1VBQ2YsRUFBRVosaUJBQWlCLFNBQVMsU0FBUzs7Ozs7Ozs7O1FBU3ZDLENBQUM7OzRCQUNFUyxTQUFTb0IsR0FBRyxDQUFDLENBQUNDLHFCQUNiLDhEQUFDekMsa0RBQUlBO29DQUVIMEMsTUFBTUQsS0FBS3ZCLElBQUk7b0NBQ2ZXLFNBQVMsSUFBTWpCLGtCQUFrQjtvQ0FDakNXLFdBQVcsQ0FBQyx1Q0FBdUMsRUFBRWQsYUFBYWdDLEtBQUt2QixJQUFJLEdBQUcseUNBQXlDLGNBQWM7OENBRXBJdUIsS0FBS3BCLElBQUk7bUNBTExvQixLQUFLdkIsSUFBSTs7Ozs7MENBUWxCLDhEQUFDZCxnRUFBWUE7Ozs7Ozs7Ozs7Ozs7Ozs7OzBCQUdqQiw4REFBQ3VDO2dCQUFLcEIsV0FBVTswQkFDYmhCOzs7Ozs7Ozs7Ozs7QUFJVCIsInNvdXJjZXMiOlsiL1VzZXJzL3dvbmthc3dvcmxkL0Rvd25sb2Fkcy9ncmFjZS1wcm9qZWN0L3NyYy91aS9wYWdlcy9MYXlvdXQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy91aS9wYWdlcy9MYXlvdXQudHN4XG5cbmltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlRWZmZWN0LCBSZWFjdE5vZGUgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgTGluayBmcm9tICduZXh0L2xpbmsnO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSAnbmV4dC9yb3V0ZXInO1xuaW1wb3J0IHsgdXNlQXV0aCB9IGZyb20gJy4uL2NvbXBvbmVudHMvQXV0aENvbnRleHQnO1xuaW1wb3J0IHsgdXNlQXBwU3RhdGUgfSBmcm9tICcuLi9jb250ZXh0L0FwcFN0YXRlQ29udGV4dCc7XG5pbXBvcnQgTG9nb3V0QnV0dG9uIGZyb20gJy4uL2NvbXBvbmVudHMvTG9nb3V0QnV0dG9uJztcblxuLy8gVXNlIGEgc3RhdGljIHB1YmxpYyBwYXRoIGZvciB0aGUgbG9nbyB0byBhdm9pZCBidW5kbGluZyBvYmplY3QgVVJMc1xuY29uc3QgbG9nb1BhdGggPSAnL2Fzc2V0cy9ncmFjZV9sb2dvX2dvbGQucG5nJztcblxuaW50ZXJmYWNlIExheW91dFByb3BzIHtcbiAgY2hpbGRyZW4/OiBSZWFjdE5vZGU7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIExheW91dCh7IGNoaWxkcmVuIH06IExheW91dFByb3BzKSB7XG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xuICBjb25zdCB7IHBhdGhuYW1lIH0gPSByb3V0ZXI7XG4gIGNvbnN0IHsgdXNlciB9ID0gdXNlQXV0aCgpO1xuICBjb25zdCBbbW9iaWxlTWVudU9wZW4sIHNldE1vYmlsZU1lbnVPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICAvLyBVc2UgdGhlIEFwcFN0YXRlIGNvbnRleHRcbiAgY29uc3QgeyBkaXNwYXRjaCwgaHlkcmF0ZUZyb21TdG9yYWdlIH0gPSB1c2VBcHBTdGF0ZSgpO1xuICBcbiAgLy8gQ2FwdHVyZSBwYWdlIHN0YXRlIG9uIHBhdGggY2hhbmdlXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHVzZXIpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogJ1NFVF9QQUdFX1NUQVRFJyxcbiAgICAgICAgcGF5bG9hZDogeyBsYXN0VmlzaXRlZFBhdGg6IHBhdGhuYW1lIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSwgW3BhdGhuYW1lLCB1c2VyLCBkaXNwYXRjaF0pO1xuXG4gIC8vIFJlbW92ZWQgYmVmb3JldW5sb2FkIHByb21wdCB0byBhbGxvdyBzbW9vdGggbmF2aWdhdGlvblxuXG4gIC8vIEh5ZHJhdGUgc3RhdGUgb24gaW5pdGlhbCBsb2FkXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHVzZXIpIHtcbiAgICAgIGh5ZHJhdGVGcm9tU3RvcmFnZSgocGF0aCkgPT4geyByb3V0ZXIucHVzaChwYXRoKTsgfSk7XG4gICAgfVxuICB9LCBbdXNlciwgcm91dGVyLCBoeWRyYXRlRnJvbVN0b3JhZ2VdKTtcblxuICBjb25zdCBuYXZMaW5rcyA9IFtcbiAgICB7IG5hbWU6ICdDaGF0JywgcGF0aDogJy9jaGF0JyB9LFxuICAgIHsgbmFtZTogJ1dhbGxldCcsIHBhdGg6ICcvd2FsbGV0JyB9LFxuICAgIHsgbmFtZTogJ1RyYWRpbmcnLCBwYXRoOiAnL3RyYWRpbmcnIH0sXG4gICAgeyBuYW1lOiAnU29jaWFsJywgcGF0aDogJy9zb2NpYWwnIH0sXG4gICAgeyBuYW1lOiAnU2V0dGluZ3MnLCBwYXRoOiAnL3NldHRpbmdzJyB9LFxuICBdO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJtaW4taC1zY3JlZW4gYmctZ3JhZGllbnQtdG8tYiBmcm9tLVsjMTQwMDAwXSB0by1ibGFjayB0ZXh0LXdoaXRlIGZsZXggZmxleC1jb2wgaXRlbXMtY2VudGVyXCI+XG4gICAgICA8aGVhZGVyIGNsYXNzTmFtZT1cInctZnVsbCBtYXgtdy1zY3JlZW4tbWQgdGV4dC1jZW50ZXIgYm9yZGVyLWIgYm9yZGVyLXJlZC03MDAgcGItMSBtYi0yXCI+XG4gICAgICAgIDxpbWcgc3JjPXtsb2dvUGF0aH0gYWx0PVwiR3JhY2UgTG9nb1wiIGNsYXNzTmFtZT1cInctNDggbWQ6dy01NiBteC1hdXRvIG10LTIgbWItMVwiIC8+XG4gICAgICAgIFxuICAgICAgICB7LyogTW9iaWxlIGhhbWJ1cmdlciBidXR0b24gKi99XG4gICAgICAgIDxidXR0b24gXG4gICAgICAgICAgY2xhc3NOYW1lPVwibWQ6aGlkZGVuIGFic29sdXRlIHJpZ2h0LTQgdG9wLTYgdGV4dC13aGl0ZSBwLTJcIiBcbiAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRNb2JpbGVNZW51T3BlbighbW9iaWxlTWVudU9wZW4pfVxuICAgICAgICA+XG4gICAgICAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgY2xhc3NOYW1lPVwiaC02IHctNlwiIGZpbGw9XCJub25lXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiPlxuICAgICAgICAgICAgPHBhdGggc3Ryb2tlTGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlTGluZWpvaW49XCJyb3VuZFwiIHN0cm9rZVdpZHRoPXsyfSBkPXttb2JpbGVNZW51T3BlbiA/IFwiTTYgMThMMTggNk02IDZsMTIgMTJcIiA6IFwiTTQgNmgxNk00IDEyaDE2TTQgMThoMTZcIn0gLz5cbiAgICAgICAgICA8L3N2Zz5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICAgIFxuICAgICAgICB7LyogRGVza3RvcCBuYXYgYmFyICovfVxuICAgICAgICA8bmF2IGNsYXNzTmFtZT17YFxuICAgICAgICAgICR7bW9iaWxlTWVudU9wZW4gPyAnZmxleCcgOiAnaGlkZGVuJ30gXG4gICAgICAgICAgbWQ6ZmxleCBcbiAgICAgICAgICBmbGV4LWNvbCBtZDpmbGV4LXJvdyBcbiAgICAgICAgICBqdXN0aWZ5LWNlbnRlciBcbiAgICAgICAgICBtZDpzcGFjZS14LTYgbWQ6c3BhY2UteS0wIFxuICAgICAgICAgIHNwYWNlLXktNCBcbiAgICAgICAgICB0ZXh0LXJlZC0zMDAgdGV4dC1sZyBtZDp0ZXh0LXhsIGZvbnQtbW9ub1xuICAgICAgICAgIHctZnVsbCBcbiAgICAgICAgICBwYi0xXG4gICAgICAgIGB9PlxuICAgICAgICAgIHtuYXZMaW5rcy5tYXAoKGxpbmspID0+IChcbiAgICAgICAgICAgIDxMaW5rXG4gICAgICAgICAgICAgIGtleT17bGluay5wYXRofVxuICAgICAgICAgICAgICBocmVmPXtsaW5rLnBhdGh9XG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldE1vYmlsZU1lbnVPcGVuKGZhbHNlKX1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgdHJhbnNpdGlvbi1hbGwgaG92ZXI6dGV4dC1yZWQtNDAwIHBiLTEgJHtwYXRobmFtZSA9PT0gbGluay5wYXRoID8gJ3RleHQtcmVkLTMwMCBib3JkZXItYiBib3JkZXItcmVkLTUwMCcgOiAndGV4dC13aGl0ZSd9YH1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge2xpbmsubmFtZX1cbiAgICAgICAgICAgIDwvTGluaz5cbiAgICAgICAgICApKX1cbiAgICAgICAgICA8TG9nb3V0QnV0dG9uIC8+XG4gICAgICAgIDwvbmF2PlxuICAgICAgPC9oZWFkZXI+XG4gICAgICA8bWFpbiBjbGFzc05hbWU9XCJ3LWZ1bGwgbWF4LXctc2NyZWVuLW1kIHB4LTQgcHktMyBmbGV4LWdyb3dcIj5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgPC9tYWluPlxuICAgIDwvZGl2PlxuICApO1xufSJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwiTGluayIsInVzZVJvdXRlciIsInVzZUF1dGgiLCJ1c2VBcHBTdGF0ZSIsIkxvZ291dEJ1dHRvbiIsImxvZ29QYXRoIiwiTGF5b3V0IiwiY2hpbGRyZW4iLCJyb3V0ZXIiLCJwYXRobmFtZSIsInVzZXIiLCJtb2JpbGVNZW51T3BlbiIsInNldE1vYmlsZU1lbnVPcGVuIiwiZGlzcGF0Y2giLCJoeWRyYXRlRnJvbVN0b3JhZ2UiLCJ0eXBlIiwicGF5bG9hZCIsImxhc3RWaXNpdGVkUGF0aCIsInBhdGgiLCJwdXNoIiwibmF2TGlua3MiLCJuYW1lIiwiZGl2IiwiY2xhc3NOYW1lIiwiaGVhZGVyIiwiaW1nIiwic3JjIiwiYWx0IiwiYnV0dG9uIiwib25DbGljayIsInN2ZyIsInhtbG5zIiwiZmlsbCIsInZpZXdCb3giLCJzdHJva2UiLCJzdHJva2VMaW5lY2FwIiwic3Ryb2tlTGluZWpvaW4iLCJzdHJva2VXaWR0aCIsImQiLCJuYXYiLCJtYXAiLCJsaW5rIiwiaHJlZiIsIm1haW4iXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./pages/Layout.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./pages/_app.tsx":
/*!************************!*\
  !*** ./pages/_app.tsx ***!
  \************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ App)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _components_AuthContext__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n/* harmony import */ var _context_AppStateContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../context/AppStateContext */ \"(pages-dir-node)/./context/AppStateContext.tsx\");\n/* harmony import */ var _components_ErrorBoundary__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../components/ErrorBoundary */ \"(pages-dir-node)/./components/ErrorBoundary.tsx\");\n/* harmony import */ var _components_StateLoader__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/StateLoader */ \"(pages-dir-node)/./components/StateLoader.tsx\");\n/* harmony import */ var _components_LoadingPage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/LoadingPage */ \"(pages-dir-node)/./components/LoadingPage.tsx\");\n/* harmony import */ var react_toastify__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-toastify */ \"react-toastify\");\n/* harmony import */ var _Layout__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Layout */ \"(pages-dir-node)/./pages/Layout.tsx\");\n/* harmony import */ var _index_css__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../index.css */ \"(pages-dir-node)/./index.css\");\n/* harmony import */ var _index_css__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(_index_css__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var react_toastify_dist_ReactToastify_css__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! react-toastify/dist/ReactToastify.css */ \"(pages-dir-node)/./node_modules/.pnpm/react-toastify@10.0.6_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/react-toastify/dist/ReactToastify.css\");\n/* harmony import */ var react_toastify_dist_ReactToastify_css__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(react_toastify_dist_ReactToastify_css__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var _styles_animations_css__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../styles/animations.css */ \"(pages-dir-node)/./styles/animations.css\");\n/* harmony import */ var _styles_animations_css__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(_styles_animations_css__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var _api_apiClient__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../api/apiClient */ \"(pages-dir-node)/./api/apiClient.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([react_toastify__WEBPACK_IMPORTED_MODULE_7__]);\nreact_toastify__WEBPACK_IMPORTED_MODULE_7__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\n\n\n\n\n\n\n// Pages that should have the layout (header/navigation)\nconst pagesWithLayout = [\n    '/chat',\n    '/wallet',\n    '/trading',\n    '/social',\n    '/settings'\n];\n// Pages that don't require authentication\nconst publicPages = [\n    '/login',\n    '/register',\n    '/forgot',\n    '/reset'\n];\n// Auth guard component to protect routes\nfunction AuthGuard({ children, router }) {\n    const { user, loading, isAuthenticated } = (0,_components_AuthContext__WEBPACK_IMPORTED_MODULE_2__.useAuth)();\n    const isPublicPage = publicPages.includes(router.pathname);\n    const [isNavigating, setIsNavigating] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const lastRedirectAtRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    const initialLoadComplete = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    const unauthGraceUntilRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(0);\n    // Once the initial load is complete, we'll handle redirects\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthGuard.useEffect\": ()=>{\n            if (!loading) {\n                initialLoadComplete.current = true;\n                // If a token exists, provide a short grace window to avoid bouncing to login\n                const tokenExists = !!(0,_api_apiClient__WEBPACK_IMPORTED_MODULE_12__.getAuthToken)();\n                if (tokenExists) {\n                    unauthGraceUntilRef.current = Date.now() + 2000; // 2s grace to accommodate remounts\n                } else {\n                    unauthGraceUntilRef.current = 0;\n                }\n            }\n        }\n    }[\"AuthGuard.useEffect\"], [\n        loading\n    ]);\n    // Handle redirects separately, but only after initial auth check\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthGuard.useEffect\": ()=>{\n            if (!initialLoadComplete.current) return;\n            // If still loading auth, don't redirect yet\n            if (loading) return;\n            // Skip navigation if:\n            // 1. Still loading authentication state\n            // 2. Already navigating\n            // 3. Initial load hasn't completed\n            if (loading || isNavigating || !initialLoadComplete.current) {\n                return;\n            }\n            // If not authenticated and not on a public page, redirect to login\n            if (!isAuthenticated && !user && !isPublicPage) {\n                const now = Date.now();\n                const withinGrace = now < unauthGraceUntilRef.current;\n                const tokenExists = !!(0,_api_apiClient__WEBPACK_IMPORTED_MODULE_12__.getAuthToken)();\n                // Never redirect away from chat if a token exists; allow auth to settle\n                if (router.pathname === '/chat' && tokenExists) {\n                    console.log('AuthGuard: On /chat with token present; suppressing unauth redirect');\n                    return;\n                }\n                if (withinGrace || tokenExists) {\n                    // Skip redirect during grace or if a token exists; let AuthContext settle\n                    console.log('AuthGuard: Skipping unauth redirect (grace/token present)', {\n                        withinGrace,\n                        tokenExists\n                    });\n                } else {\n                    console.log('AuthGuard: Redirecting unauthenticated user to login');\n                    setIsNavigating(true);\n                    router.replace('/login').then({\n                        \"AuthGuard.useEffect\": ()=>setIsNavigating(false)\n                    }[\"AuthGuard.useEffect\"]).catch({\n                        \"AuthGuard.useEffect\": (error)=>{\n                            console.error('Navigation error:', error);\n                            setIsNavigating(false);\n                        }\n                    }[\"AuthGuard.useEffect\"]);\n                }\n            }\n            // If authenticated and on a public page, redirect to chat\n            // But only if there isn't an explicit navigation happening from login/register\n            // (which is handled by the useEffect in those components)\n            if (isAuthenticated && user && isPublicPage) {\n                // Coordination flag set by login/register to avoid double redirects\n                let skipPublicRedirect = false;\n                try {\n                    skipPublicRedirect = sessionStorage.getItem('GRACE_POST_LOGIN_REDIRECT') === '1';\n                } catch  {}\n                // Throttle repeated redirects within a short window\n                const now = Date.now();\n                const recentlyRedirected = now - lastRedirectAtRef.current < 1000;\n                // Persist a one-time guard to avoid repeated redirects across remounts\n                let alreadyRedirected = false;\n                try {\n                    alreadyRedirected = sessionStorage.getItem('GRACE_ALREADY_REDIRECTED') === '1';\n                } catch  {}\n                if (!skipPublicRedirect && !recentlyRedirected && !alreadyRedirected) {\n                    console.log('AuthGuard: Redirecting authenticated user to chat');\n                    lastRedirectAtRef.current = now;\n                    setIsNavigating(true);\n                    try {\n                        sessionStorage.setItem('GRACE_ALREADY_REDIRECTED', '1');\n                    } catch  {}\n                    router.replace('/chat').then({\n                        \"AuthGuard.useEffect\": ()=>setIsNavigating(false)\n                    }[\"AuthGuard.useEffect\"]).catch({\n                        \"AuthGuard.useEffect\": (error)=>{\n                            console.error('Navigation error:', error);\n                            setIsNavigating(false);\n                        }\n                    }[\"AuthGuard.useEffect\"]);\n                } else {\n                    // Clear the flag after the first pass to re-enable normal behavior\n                    try {\n                        sessionStorage.removeItem('GRACE_POST_LOGIN_REDIRECT');\n                    } catch  {}\n                }\n            }\n        }\n    }[\"AuthGuard.useEffect\"], [\n        isAuthenticated,\n        user,\n        isPublicPage,\n        loading,\n        router\n    ]);\n    // Clear the one-time redirect guard when we are on /chat\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"AuthGuard.useEffect\": ()=>{\n            if (router.pathname === '/chat') {\n                try {\n                    sessionStorage.removeItem('GRACE_ALREADY_REDIRECTED');\n                } catch  {}\n            }\n        }\n    }[\"AuthGuard.useEffect\"], [\n        router.pathname\n    ]);\n    // Show enhanced loading states\n    if (loading) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LoadingPage__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n            message: \"Loading authentication...\"\n        }, void 0, false, {\n            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n            lineNumber: 135,\n            columnNumber: 12\n        }, this);\n    }\n    // Show navigation state\n    if (isNavigating) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LoadingPage__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n            message: \"Navigating...\"\n        }, void 0, false, {\n            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n            lineNumber: 140,\n            columnNumber: 12\n        }, this);\n    }\n    // Don't render children until auth check is complete\n    if (!loading && !user && !isPublicPage) {\n        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_LoadingPage__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n            message: \"Redirecting to login...\"\n        }, void 0, false, {\n            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n            lineNumber: 145,\n            columnNumber: 12\n        }, this);\n    }\n    // Render children with proper layout\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {\n        children: children\n    }, void 0, false);\n}\nfunction App({ Component, pageProps, router }) {\n    const shouldHaveLayout = pagesWithLayout.includes(router.pathname);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ErrorBoundary__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n        componentName: \"Main App\",\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_AuthContext__WEBPACK_IMPORTED_MODULE_2__.AuthProvider, {\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_context_AppStateContext__WEBPACK_IMPORTED_MODULE_3__.AppStateProvider, {\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_StateLoader__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(AuthGuard, {\n                        router: router,\n                        children: [\n                            shouldHaveLayout ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_Layout__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Component, {\n                                    ...pageProps\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n                                    lineNumber: 163,\n                                    columnNumber: 19\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n                                lineNumber: 162,\n                                columnNumber: 17\n                            }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(Component, {\n                                ...pageProps\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n                                lineNumber: 166,\n                                columnNumber: 17\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_toastify__WEBPACK_IMPORTED_MODULE_7__.ToastContainer, {\n                                position: \"bottom-right\",\n                                theme: \"dark\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n                                lineNumber: 168,\n                                columnNumber: 15\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n                        lineNumber: 160,\n                        columnNumber: 13\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n                    lineNumber: 159,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n                lineNumber: 158,\n                columnNumber: 9\n            }, this)\n        }, void 0, false, {\n            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n            lineNumber: 157,\n            columnNumber: 7\n        }, this)\n    }, void 0, false, {\n        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/_app.tsx\",\n        lineNumber: 156,\n        columnNumber: 5\n    }, this);\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJdkIsY0FBYztRQUNoQixxQkFBTyw4REFBQ2YsK0RBQVdBO1lBQUNzQyxTQUFROzs7Ozs7SUFDOUI7SUFFQSxxREFBcUQ7SUFDckQsSUFBSSxDQUFDNUIsV0FBVyxDQUFDRCxRQUFRLENBQUNHLGNBQWM7UUFDdEMscUJBQU8sOERBQUNaLCtEQUFXQTtZQUFDc0MsU0FBUTs7Ozs7O0lBQzlCO0lBRUEscUNBQXFDO0lBQ3JDLHFCQUFPO2tCQUFHL0I7O0FBQ1o7QUFFZSxTQUFTZ0MsSUFBSSxFQUFFQyxTQUFTLEVBQUVDLFNBQVMsRUFBRWpDLE1BQU0sRUFBWTtJQUNwRSxNQUFNa0MsbUJBQW1CdEMsZ0JBQWdCUyxRQUFRLENBQUNMLE9BQU9NLFFBQVE7SUFFakUscUJBQ0UsOERBQUNoQixpRUFBYUE7UUFBQzZDLGVBQWM7a0JBQzNCLDRFQUFDaEQsaUVBQVlBO3NCQUNYLDRFQUFDRSxzRUFBZ0JBOzBCQUNmLDRFQUFDRSwrREFBV0E7OEJBQ1YsNEVBQUNPO3dCQUFVRSxRQUFRQTs7NEJBQ2hCa0MsaUNBQ0MsOERBQUN4QywrQ0FBTUE7MENBQ0wsNEVBQUNzQztvQ0FBVyxHQUFHQyxTQUFTOzs7Ozs7Ozs7O3FEQUcxQiw4REFBQ0Q7Z0NBQVcsR0FBR0MsU0FBUzs7Ozs7OzBDQUUxQiw4REFBQ3hDLDBEQUFjQTtnQ0FBQzJDLFVBQVM7Z0NBQWVDLE9BQU07Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTzVEIiwic291cmNlcyI6WyIvVXNlcnMvd29ua2Fzd29ybGQvRG93bmxvYWRzL2dyYWNlLXByb2plY3Qvc3JjL3VpL3BhZ2VzL19hcHAudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZVN0YXRlLCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBBcHBQcm9wcyB9IGZyb20gJ25leHQvYXBwJztcbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJztcbmltcG9ydCB7IEF1dGhQcm92aWRlciwgdXNlQXV0aCB9IGZyb20gJy4uL2NvbXBvbmVudHMvQXV0aENvbnRleHQnO1xuaW1wb3J0IHsgQXBwU3RhdGVQcm92aWRlciB9IGZyb20gJy4uL2NvbnRleHQvQXBwU3RhdGVDb250ZXh0JztcbmltcG9ydCBFcnJvckJvdW5kYXJ5IGZyb20gJy4uL2NvbXBvbmVudHMvRXJyb3JCb3VuZGFyeSc7XG5pbXBvcnQgU3RhdGVMb2FkZXIgZnJvbSAnLi4vY29tcG9uZW50cy9TdGF0ZUxvYWRlcic7XG5pbXBvcnQgTG9hZGluZ1BhZ2UgZnJvbSAnLi4vY29tcG9uZW50cy9Mb2FkaW5nUGFnZSc7XG5pbXBvcnQgeyBUb2FzdENvbnRhaW5lciB9IGZyb20gJ3JlYWN0LXRvYXN0aWZ5JztcbmltcG9ydCBMYXlvdXQgZnJvbSAnLi9MYXlvdXQnO1xuaW1wb3J0ICcuLi9pbmRleC5jc3MnO1xuaW1wb3J0ICdyZWFjdC10b2FzdGlmeS9kaXN0L1JlYWN0VG9hc3RpZnkuY3NzJztcbmltcG9ydCAnLi4vc3R5bGVzL2FuaW1hdGlvbnMuY3NzJztcbmltcG9ydCB7IGdldEF1dGhUb2tlbiB9IGZyb20gJy4uL2FwaS9hcGlDbGllbnQnO1xuXG4vLyBQYWdlcyB0aGF0IHNob3VsZCBoYXZlIHRoZSBsYXlvdXQgKGhlYWRlci9uYXZpZ2F0aW9uKVxuY29uc3QgcGFnZXNXaXRoTGF5b3V0ID0gWycvY2hhdCcsICcvd2FsbGV0JywgJy90cmFkaW5nJywgJy9zb2NpYWwnLCAnL3NldHRpbmdzJ107XG5cbi8vIFBhZ2VzIHRoYXQgZG9uJ3QgcmVxdWlyZSBhdXRoZW50aWNhdGlvblxuY29uc3QgcHVibGljUGFnZXMgPSBbJy9sb2dpbicsICcvcmVnaXN0ZXInLCAnL2ZvcmdvdCcsICcvcmVzZXQnXTtcblxuLy8gQXV0aCBndWFyZCBjb21wb25lbnQgdG8gcHJvdGVjdCByb3V0ZXNcbmZ1bmN0aW9uIEF1dGhHdWFyZCh7IGNoaWxkcmVuLCByb3V0ZXIgfTogeyBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlLCByb3V0ZXI6IGFueSB9KSB7XG4gIGNvbnN0IHsgdXNlciwgbG9hZGluZywgaXNBdXRoZW50aWNhdGVkIH0gPSB1c2VBdXRoKCk7XG4gIGNvbnN0IGlzUHVibGljUGFnZSA9IHB1YmxpY1BhZ2VzLmluY2x1ZGVzKHJvdXRlci5wYXRobmFtZSk7XG4gIGNvbnN0IFtpc05hdmlnYXRpbmcsIHNldElzTmF2aWdhdGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGxhc3RSZWRpcmVjdEF0UmVmID0gdXNlUmVmPG51bWJlcj4oMCk7XG4gIGNvbnN0IGluaXRpYWxMb2FkQ29tcGxldGUgPSB1c2VSZWYoZmFsc2UpO1xuICBjb25zdCB1bmF1dGhHcmFjZVVudGlsUmVmID0gdXNlUmVmPG51bWJlcj4oMCk7XG4gIFxuICAvLyBPbmNlIHRoZSBpbml0aWFsIGxvYWQgaXMgY29tcGxldGUsIHdlJ2xsIGhhbmRsZSByZWRpcmVjdHNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWxvYWRpbmcpIHtcbiAgICAgIGluaXRpYWxMb2FkQ29tcGxldGUuY3VycmVudCA9IHRydWU7XG4gICAgICAvLyBJZiBhIHRva2VuIGV4aXN0cywgcHJvdmlkZSBhIHNob3J0IGdyYWNlIHdpbmRvdyB0byBhdm9pZCBib3VuY2luZyB0byBsb2dpblxuICAgICAgY29uc3QgdG9rZW5FeGlzdHMgPSAhIWdldEF1dGhUb2tlbigpO1xuICAgICAgaWYgKHRva2VuRXhpc3RzKSB7XG4gICAgICAgIHVuYXV0aEdyYWNlVW50aWxSZWYuY3VycmVudCA9IERhdGUubm93KCkgKyAyMDAwOyAvLyAycyBncmFjZSB0byBhY2NvbW1vZGF0ZSByZW1vdW50c1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdW5hdXRoR3JhY2VVbnRpbFJlZi5jdXJyZW50ID0gMDtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtsb2FkaW5nXSk7XG4gIFxuICAvLyBIYW5kbGUgcmVkaXJlY3RzIHNlcGFyYXRlbHksIGJ1dCBvbmx5IGFmdGVyIGluaXRpYWwgYXV0aCBjaGVja1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghaW5pdGlhbExvYWRDb21wbGV0ZS5jdXJyZW50KSByZXR1cm47XG5cbiAgICAvLyBJZiBzdGlsbCBsb2FkaW5nIGF1dGgsIGRvbid0IHJlZGlyZWN0IHlldFxuICAgIGlmIChsb2FkaW5nKSByZXR1cm47XG5cbiAgICAvLyBTa2lwIG5hdmlnYXRpb24gaWY6XG4gICAgLy8gMS4gU3RpbGwgbG9hZGluZyBhdXRoZW50aWNhdGlvbiBzdGF0ZVxuICAgIC8vIDIuIEFscmVhZHkgbmF2aWdhdGluZ1xuICAgIC8vIDMuIEluaXRpYWwgbG9hZCBoYXNuJ3QgY29tcGxldGVkXG4gICAgaWYgKGxvYWRpbmcgfHwgaXNOYXZpZ2F0aW5nIHx8ICFpbml0aWFsTG9hZENvbXBsZXRlLmN1cnJlbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgLy8gSWYgbm90IGF1dGhlbnRpY2F0ZWQgYW5kIG5vdCBvbiBhIHB1YmxpYyBwYWdlLCByZWRpcmVjdCB0byBsb2dpblxuICAgIGlmICghaXNBdXRoZW50aWNhdGVkICYmICF1c2VyICYmICFpc1B1YmxpY1BhZ2UpIHtcbiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCB3aXRoaW5HcmFjZSA9IG5vdyA8IHVuYXV0aEdyYWNlVW50aWxSZWYuY3VycmVudDtcbiAgICAgIGNvbnN0IHRva2VuRXhpc3RzID0gISFnZXRBdXRoVG9rZW4oKTtcbiAgICAgIC8vIE5ldmVyIHJlZGlyZWN0IGF3YXkgZnJvbSBjaGF0IGlmIGEgdG9rZW4gZXhpc3RzOyBhbGxvdyBhdXRoIHRvIHNldHRsZVxuICAgICAgaWYgKHJvdXRlci5wYXRobmFtZSA9PT0gJy9jaGF0JyAmJiB0b2tlbkV4aXN0cykge1xuICAgICAgICBjb25zb2xlLmxvZygnQXV0aEd1YXJkOiBPbiAvY2hhdCB3aXRoIHRva2VuIHByZXNlbnQ7IHN1cHByZXNzaW5nIHVuYXV0aCByZWRpcmVjdCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAod2l0aGluR3JhY2UgfHwgdG9rZW5FeGlzdHMpIHtcbiAgICAgICAgLy8gU2tpcCByZWRpcmVjdCBkdXJpbmcgZ3JhY2Ugb3IgaWYgYSB0b2tlbiBleGlzdHM7IGxldCBBdXRoQ29udGV4dCBzZXR0bGVcbiAgICAgICAgY29uc29sZS5sb2coJ0F1dGhHdWFyZDogU2tpcHBpbmcgdW5hdXRoIHJlZGlyZWN0IChncmFjZS90b2tlbiBwcmVzZW50KScsIHtcbiAgICAgICAgICB3aXRoaW5HcmFjZSxcbiAgICAgICAgICB0b2tlbkV4aXN0cyxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygnQXV0aEd1YXJkOiBSZWRpcmVjdGluZyB1bmF1dGhlbnRpY2F0ZWQgdXNlciB0byBsb2dpbicpO1xuICAgICAgICBzZXRJc05hdmlnYXRpbmcodHJ1ZSk7XG4gICAgICAgIHJvdXRlci5yZXBsYWNlKCcvbG9naW4nKVxuICAgICAgICAgIC50aGVuKCgpID0+IHNldElzTmF2aWdhdGluZyhmYWxzZSkpXG4gICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignTmF2aWdhdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICBzZXRJc05hdmlnYXRpbmcoZmFsc2UpO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBJZiBhdXRoZW50aWNhdGVkIGFuZCBvbiBhIHB1YmxpYyBwYWdlLCByZWRpcmVjdCB0byBjaGF0XG4gICAgLy8gQnV0IG9ubHkgaWYgdGhlcmUgaXNuJ3QgYW4gZXhwbGljaXQgbmF2aWdhdGlvbiBoYXBwZW5pbmcgZnJvbSBsb2dpbi9yZWdpc3RlclxuICAgIC8vICh3aGljaCBpcyBoYW5kbGVkIGJ5IHRoZSB1c2VFZmZlY3QgaW4gdGhvc2UgY29tcG9uZW50cylcbiAgICBpZiAoaXNBdXRoZW50aWNhdGVkICYmIHVzZXIgJiYgaXNQdWJsaWNQYWdlKSB7XG4gICAgICAvLyBDb29yZGluYXRpb24gZmxhZyBzZXQgYnkgbG9naW4vcmVnaXN0ZXIgdG8gYXZvaWQgZG91YmxlIHJlZGlyZWN0c1xuICAgICAgbGV0IHNraXBQdWJsaWNSZWRpcmVjdCA9IGZhbHNlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgc2tpcFB1YmxpY1JlZGlyZWN0ID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnR1JBQ0VfUE9TVF9MT0dJTl9SRURJUkVDVCcpID09PSAnMSc7XG4gICAgICB9IGNhdGNoIHt9XG5cbiAgICAgIC8vIFRocm90dGxlIHJlcGVhdGVkIHJlZGlyZWN0cyB3aXRoaW4gYSBzaG9ydCB3aW5kb3dcbiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICBjb25zdCByZWNlbnRseVJlZGlyZWN0ZWQgPSBub3cgLSBsYXN0UmVkaXJlY3RBdFJlZi5jdXJyZW50IDwgMTAwMDtcblxuICAgICAgLy8gUGVyc2lzdCBhIG9uZS10aW1lIGd1YXJkIHRvIGF2b2lkIHJlcGVhdGVkIHJlZGlyZWN0cyBhY3Jvc3MgcmVtb3VudHNcbiAgICAgIGxldCBhbHJlYWR5UmVkaXJlY3RlZCA9IGZhbHNlO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYWxyZWFkeVJlZGlyZWN0ZWQgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdHUkFDRV9BTFJFQURZX1JFRElSRUNURUQnKSA9PT0gJzEnO1xuICAgICAgfSBjYXRjaCB7fVxuXG4gICAgICBpZiAoIXNraXBQdWJsaWNSZWRpcmVjdCAmJiAhcmVjZW50bHlSZWRpcmVjdGVkICYmICFhbHJlYWR5UmVkaXJlY3RlZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnQXV0aEd1YXJkOiBSZWRpcmVjdGluZyBhdXRoZW50aWNhdGVkIHVzZXIgdG8gY2hhdCcpO1xuICAgICAgICBsYXN0UmVkaXJlY3RBdFJlZi5jdXJyZW50ID0gbm93O1xuICAgICAgICBzZXRJc05hdmlnYXRpbmcodHJ1ZSk7XG4gICAgICAgIHRyeSB7IHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ0dSQUNFX0FMUkVBRFlfUkVESVJFQ1RFRCcsICcxJyk7IH0gY2F0Y2gge31cbiAgICAgICAgcm91dGVyLnJlcGxhY2UoJy9jaGF0JylcbiAgICAgICAgICAudGhlbigoKSA9PiBzZXRJc05hdmlnYXRpbmcoZmFsc2UpKVxuICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ05hdmlnYXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgc2V0SXNOYXZpZ2F0aW5nKGZhbHNlKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIENsZWFyIHRoZSBmbGFnIGFmdGVyIHRoZSBmaXJzdCBwYXNzIHRvIHJlLWVuYWJsZSBub3JtYWwgYmVoYXZpb3JcbiAgICAgICAgdHJ5IHsgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgnR1JBQ0VfUE9TVF9MT0dJTl9SRURJUkVDVCcpOyB9IGNhdGNoIHt9XG4gICAgICB9XG4gICAgfVxuICB9LCBbaXNBdXRoZW50aWNhdGVkLCB1c2VyLCBpc1B1YmxpY1BhZ2UsIGxvYWRpbmcsIHJvdXRlcl0pO1xuXG4gIC8vIENsZWFyIHRoZSBvbmUtdGltZSByZWRpcmVjdCBndWFyZCB3aGVuIHdlIGFyZSBvbiAvY2hhdFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChyb3V0ZXIucGF0aG5hbWUgPT09ICcvY2hhdCcpIHtcbiAgICAgIHRyeSB7IHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ0dSQUNFX0FMUkVBRFlfUkVESVJFQ1RFRCcpOyB9IGNhdGNoIHt9XG4gICAgfVxuICB9LCBbcm91dGVyLnBhdGhuYW1lXSk7XG5cbiAgLy8gU2hvdyBlbmhhbmNlZCBsb2FkaW5nIHN0YXRlc1xuICBpZiAobG9hZGluZykge1xuICAgIHJldHVybiA8TG9hZGluZ1BhZ2UgbWVzc2FnZT1cIkxvYWRpbmcgYXV0aGVudGljYXRpb24uLi5cIiAvPjtcbiAgfVxuICBcbiAgLy8gU2hvdyBuYXZpZ2F0aW9uIHN0YXRlXG4gIGlmIChpc05hdmlnYXRpbmcpIHtcbiAgICByZXR1cm4gPExvYWRpbmdQYWdlIG1lc3NhZ2U9XCJOYXZpZ2F0aW5nLi4uXCIgLz47XG4gIH1cbiAgXG4gIC8vIERvbid0IHJlbmRlciBjaGlsZHJlbiB1bnRpbCBhdXRoIGNoZWNrIGlzIGNvbXBsZXRlXG4gIGlmICghbG9hZGluZyAmJiAhdXNlciAmJiAhaXNQdWJsaWNQYWdlKSB7XG4gICAgcmV0dXJuIDxMb2FkaW5nUGFnZSBtZXNzYWdlPVwiUmVkaXJlY3RpbmcgdG8gbG9naW4uLi5cIiAvPjtcbiAgfVxuICBcbiAgLy8gUmVuZGVyIGNoaWxkcmVuIHdpdGggcHJvcGVyIGxheW91dFxuICByZXR1cm4gPD57Y2hpbGRyZW59PC8+O1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBBcHAoeyBDb21wb25lbnQsIHBhZ2VQcm9wcywgcm91dGVyIH06IEFwcFByb3BzKSB7XG4gIGNvbnN0IHNob3VsZEhhdmVMYXlvdXQgPSBwYWdlc1dpdGhMYXlvdXQuaW5jbHVkZXMocm91dGVyLnBhdGhuYW1lKTtcblxuICByZXR1cm4gKFxuICAgIDxFcnJvckJvdW5kYXJ5IGNvbXBvbmVudE5hbWU9XCJNYWluIEFwcFwiPlxuICAgICAgPEF1dGhQcm92aWRlcj5cbiAgICAgICAgPEFwcFN0YXRlUHJvdmlkZXI+XG4gICAgICAgICAgPFN0YXRlTG9hZGVyPlxuICAgICAgICAgICAgPEF1dGhHdWFyZCByb3V0ZXI9e3JvdXRlcn0+XG4gICAgICAgICAgICAgIHtzaG91bGRIYXZlTGF5b3V0ID8gKFxuICAgICAgICAgICAgICAgIDxMYXlvdXQ+XG4gICAgICAgICAgICAgICAgICA8Q29tcG9uZW50IHsuLi5wYWdlUHJvcHN9IC8+XG4gICAgICAgICAgICAgICAgPC9MYXlvdXQ+XG4gICAgICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICAgICAgPENvbXBvbmVudCB7Li4ucGFnZVByb3BzfSAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8VG9hc3RDb250YWluZXIgcG9zaXRpb249XCJib3R0b20tcmlnaHRcIiB0aGVtZT1cImRhcmtcIiAvPlxuICAgICAgICAgICAgPC9BdXRoR3VhcmQ+XG4gICAgICAgICAgPC9TdGF0ZUxvYWRlcj5cbiAgICAgICAgPC9BcHBTdGF0ZVByb3ZpZGVyPlxuICAgICAgPC9BdXRoUHJvdmlkZXI+XG4gICAgPC9FcnJvckJvdW5kYXJ5PlxuICApO1xufSJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZUVmZmVjdCIsInVzZVN0YXRlIiwidXNlUmVmIiwiQXV0aFByb3ZpZGVyIiwidXNlQXV0aCIsIkFwcFN0YXRlUHJvdmlkZXIiLCJFcnJvckJvdW5kYXJ5IiwiU3RhdGVMb2FkZXIiLCJMb2FkaW5nUGFnZSIsIlRvYXN0Q29udGFpbmVyIiwiTGF5b3V0IiwiZ2V0QXV0aFRva2VuIiwicGFnZXNXaXRoTGF5b3V0IiwicHVibGljUGFnZXMiLCJBdXRoR3VhcmQiLCJjaGlsZHJlbiIsInJvdXRlciIsInVzZXIiLCJsb2FkaW5nIiwiaXNBdXRoZW50aWNhdGVkIiwiaXNQdWJsaWNQYWdlIiwiaW5jbHVkZXMiLCJwYXRobmFtZSIsImlzTmF2aWdhdGluZyIsInNldElzTmF2aWdhdGluZyIsImxhc3RSZWRpcmVjdEF0UmVmIiwiaW5pdGlhbExvYWRDb21wbGV0ZSIsInVuYXV0aEdyYWNlVW50aWxSZWYiLCJjdXJyZW50IiwidG9rZW5FeGlzdHMiLCJEYXRlIiwibm93Iiwid2l0aGluR3JhY2UiLCJjb25zb2xlIiwibG9nIiwicmVwbGFjZSIsInRoZW4iLCJjYXRjaCIsImVycm9yIiwic2tpcFB1YmxpY1JlZGlyZWN0Iiwic2Vzc2lvblN0b3JhZ2UiLCJnZXRJdGVtIiwicmVjZW50bHlSZWRpcmVjdGVkIiwiYWxyZWFkeVJlZGlyZWN0ZWQiLCJzZXRJdGVtIiwicmVtb3ZlSXRlbSIsIm1lc3NhZ2UiLCJBcHAiLCJDb21wb25lbnQiLCJwYWdlUHJvcHMiLCJzaG91bGRIYXZlTGF5b3V0IiwiY29tcG9uZW50TmFtZSIsInBvc2l0aW9uIiwidGhlbWUiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./pages/_app.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./pages/chat.tsx":
/*!************************!*\
  !*** ./pages/chat.tsx ***!
  \************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Chat)\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"react/jsx-dev-runtime\");\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _api_apiClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../api/apiClient */ \"(pages-dir-node)/./api/apiClient.ts\");\n/* harmony import */ var _components_AuthContext__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../components/AuthContext */ \"(pages-dir-node)/./components/AuthContext.tsx\");\n/* harmony import */ var _utils_authUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/authUtils */ \"(pages-dir-node)/./utils/authUtils.ts\");\n/* harmony import */ var _components_ChatStatePersistence__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../components/ChatStatePersistence */ \"(pages-dir-node)/./components/ChatStatePersistence.tsx\");\n/* harmony import */ var _components_XFeed__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/XFeed */ \"(pages-dir-node)/./components/XFeed.tsx\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_components_XFeed__WEBPACK_IMPORTED_MODULE_6__]);\n_components_XFeed__WEBPACK_IMPORTED_MODULE_6__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// src/pages/Chat.tsx\n\n\n\n\n\n\n\nfunction Chat() {\n    // Use the Auth context for authentication state\n    const { user, isAuthenticated } = (0,_components_AuthContext__WEBPACK_IMPORTED_MODULE_3__.useAuth)();\n    // Use standardized token function from authUtils\n    const token = (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)();\n    const [sessions, setSessions] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [sessionId, setSessionId] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    const [input, setInput] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)('');\n    const [loading, setLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)('');\n    // Track if sessions have been loaded\n    const [sessionsLoaded, setSessionsLoaded] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Use ref to avoid duplicate session creation\n    const messagesEndRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    // Initialize chat state persistence hook\n    const { initializeFromPersistedState, getSavedDraftMessage, updateDraftMessage, syncScrollPosition, getSavedScrollPosition } = (0,_components_ChatStatePersistence__WEBPACK_IMPORTED_MODULE_5__.useChatStatePersistence)(sessionId, sessions, messages, input);\n    // Helper function to generate a simple topic from message content\n    const generateSimpleTopicFromMessage = (message)=>{\n        if (!message) return 'New Conversation';\n        try {\n            // Take first 30 characters from the message, or up to the first period\n            const firstSentence = message.split('.')[0].trim();\n            const topicText = firstSentence.length > 30 ? firstSentence.substring(0, 30) + '...' : firstSentence;\n            return topicText || 'New Conversation';\n        } catch (e) {\n            console.error('Error generating topic:', e);\n            return 'New Conversation';\n        }\n    };\n    // Helper function to persist messages to localStorage with timestamp\n    const persistMessages = (sid, msgs)=>{\n        if (!sid || !msgs || msgs.length === 0) return; // avoid persisting empty arrays\n        try {\n            // Only store a limited number of messages to prevent localStorage overflows\n            const messagesToStore = msgs.slice(-50); // Store just the last 50 messages\n            localStorage.setItem(`messages_${sid}`, JSON.stringify(messagesToStore));\n            // Store a timestamp with the messages to track freshness\n            localStorage.setItem(`lastSynced_${sid}`, new Date().toISOString());\n            // Always store the active session ID to ensure it's available when returning to the page\n            localStorage.setItem('activeSessionId', sid);\n        } catch (e) {\n            console.error('Failed to store messages in localStorage:', e);\n        }\n    };\n    // Helper function to load messages from cache\n    const loadMessagesFromCache = (sid)=>{\n        if (!sid) return [];\n        try {\n            const savedMessages = localStorage.getItem(`messages_${sid}`);\n            if (savedMessages) {\n                const parsedMessages = JSON.parse(savedMessages);\n                if (Array.isArray(parsedMessages) && parsedMessages.length > 0) {\n                    console.log('Loaded cached messages for session:', sid);\n                    return parsedMessages;\n                }\n            }\n        } catch (e) {\n            console.error('Failed to load messages from cache:', e);\n        }\n        return [];\n    };\n    // Track if component is mounted to prevent state updates after unmounting\n    const isMountedRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(true);\n    // Guard to ensure we only attempt session restoration once per mount\n    const restoredOnceRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(false);\n    // Dedup guard for history loads per session\n    const lastHistoryLoadRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)({});\n    // Initialize from persisted state on component mount\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            if (!sessionsLoaded && isAuthenticated) {\n                const restored = initializeFromPersistedState(setSessions, setSessionId);\n                if (restored) {\n                    setSessionsLoaded(true);\n                    console.log('Chat sessions restored from persisted state');\n                }\n            }\n        }\n    }[\"Chat.useEffect\"], [\n        sessionsLoaded,\n        isAuthenticated,\n        initializeFromPersistedState\n    ]);\n    // Restore draft message when session changes\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            if (sessionId) {\n                const savedDraft = getSavedDraftMessage();\n                if (savedDraft && savedDraft !== input) {\n                    setInput(savedDraft);\n                }\n            }\n        }\n    }[\"Chat.useEffect\"], [\n        sessionId,\n        getSavedDraftMessage\n    ]);\n    // Save draft message as user types\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            if (sessionId && input) {\n                updateDraftMessage(input);\n            }\n        }\n    }[\"Chat.useEffect\"], [\n        sessionId,\n        input,\n        updateDraftMessage\n    ]);\n    // Auto-scroll to bottom when messages change or restore saved scroll position\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            if (messagesEndRef.current) {\n                // Check if we have a saved scroll position\n                const savedPosition = getSavedScrollPosition();\n                if (savedPosition !== null) {\n                    // Use setTimeout to ensure the DOM is fully rendered\n                    setTimeout({\n                        \"Chat.useEffect\": ()=>{\n                            const chatContainer = messagesEndRef.current?.parentElement;\n                            if (chatContainer && typeof savedPosition === 'number' && !isNaN(savedPosition)) {\n                                chatContainer.scrollTop = savedPosition;\n                            }\n                        }\n                    }[\"Chat.useEffect\"], 100);\n                } else {\n                    // Default to scrolling to bottom\n                    messagesEndRef.current.scrollIntoView({\n                        behavior: 'smooth'\n                    });\n                }\n            }\n        }\n    }[\"Chat.useEffect\"], [\n        messages,\n        sessionId,\n        getSavedScrollPosition\n    ]);\n    // Save scroll position when user scrolls\n    const handleScroll = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"Chat.useCallback[handleScroll]\": (e)=>{\n            if (sessionId) {\n                syncScrollPosition(e.currentTarget.scrollTop);\n            }\n        }\n    }[\"Chat.useCallback[handleScroll]\"], [\n        sessionId,\n        syncScrollPosition\n    ]);\n    // Cleanup on unmount\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            return ({\n                \"Chat.useEffect\": ()=>{\n                    isMountedRef.current = false;\n                }\n            })[\"Chat.useEffect\"];\n        }\n    }[\"Chat.useEffect\"], []);\n    // Load sessions from backend when authenticated\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            const loadSessions = {\n                \"Chat.useEffect.loadSessions\": async ()=>{\n                    if (!isAuthenticated || !token) {\n                        // Clear sessions when not authenticated\n                        setSessions([]);\n                        setSessionId(null);\n                        setMessages([]);\n                        setSessionsLoaded(false); // Reset sessions loaded flag\n                        // Clean up localStorage when logging out\n                        try {\n                            const activeSessionIds = JSON.parse(localStorage.getItem('activeSessionIds') || '[]');\n                            // Clean up each session data\n                            activeSessionIds.forEach({\n                                \"Chat.useEffect.loadSessions\": (sid)=>{\n                                    localStorage.removeItem(`messages_${sid}`);\n                                }\n                            }[\"Chat.useEffect.loadSessions\"]);\n                            // Remove tracking keys\n                            localStorage.removeItem('activeSessionIds');\n                            localStorage.removeItem('activeSessionId');\n                        } catch (e) {\n                            console.error('Error cleaning up localStorage on logout:', e);\n                        }\n                        return;\n                    }\n                    try {\n                        const { data, success } = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__.api.get(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.CHAT.SESSIONS);\n                        if (success && data && Array.isArray(data)) {\n                            console.log('Loaded sessions:', data);\n                            // Map incoming sessions to our structure\n                            const formattedSessions = data.map({\n                                \"Chat.useEffect.loadSessions.formattedSessions\": (s)=>{\n                                    // Find a meaningful name for the session\n                                    let sessionName = s.topic || s.name;\n                                    if (!sessionName || sessionName === 'New Chat' || sessionName === 'New Conversation') {\n                                        // If no meaningful name, try to extract from first message if available\n                                        if (s.preview_message) {\n                                            sessionName = generateSimpleTopicFromMessage(s.preview_message);\n                                        } else if (s.messages && Array.isArray(s.messages) && s.messages.length > 0) {\n                                            // Try to use first message in the array if available\n                                            const firstMsg = s.messages[0];\n                                            const msgText = firstMsg.text || firstMsg.user || firstMsg.message;\n                                            sessionName = generateSimpleTopicFromMessage(msgText);\n                                        } else {\n                                            // Fallback to date-based name\n                                            sessionName = `Conversation ${new Date(s.lastActivity || s.created || new Date()).toLocaleDateString()}`;\n                                        }\n                                    }\n                                    return {\n                                        id: s.session_id || s.id,\n                                        name: sessionName,\n                                        lastActivity: s.lastActivity || s.last_activity || new Date().toISOString(),\n                                        messages: [],\n                                        session_id: s.session_id || s.id,\n                                        topic: sessionName\n                                    };\n                                }\n                            }[\"Chat.useEffect.loadSessions.formattedSessions\"]);\n                            // Sort by last activity, most recent first\n                            const sortedSessions = formattedSessions.sort({\n                                \"Chat.useEffect.loadSessions.sortedSessions\": (a, b)=>new Date(b.lastActivity).getTime() - new Date(a.lastActivity).getTime()\n                            }[\"Chat.useEffect.loadSessions.sortedSessions\"]);\n                            setSessions(sortedSessions);\n                            // Try to restore last active session from localStorage\n                            const savedSessionId = localStorage.getItem('activeSessionId');\n                            const sessionExists = sortedSessions.some({\n                                \"Chat.useEffect.loadSessions.sessionExists\": (s)=>s.session_id === savedSessionId || s.id === savedSessionId\n                            }[\"Chat.useEffect.loadSessions.sessionExists\"]);\n                            if (savedSessionId && sessionExists) {\n                                // Restore previous session\n                                setSessionId(savedSessionId);\n                                // Try to restore messages from localStorage first for instant display\n                                try {\n                                    const savedMessages = localStorage.getItem(`messages_${savedSessionId}`);\n                                    if (savedMessages) {\n                                        try {\n                                            const parsedMessages = JSON.parse(savedMessages);\n                                            console.log(`Restored ${parsedMessages.length} messages for session ${savedSessionId} from localStorage`);\n                                            setMessages(parsedMessages);\n                                            // Mark these messages as from cache, so backend fetch won't replace them if they're identical\n                                            setMessagesFromCache(true);\n                                            // Ensure the active session ID is saved in localStorage\n                                            localStorage.setItem('activeSessionId', savedSessionId);\n                                        } catch (parseError) {\n                                            console.error('Failed to parse saved messages:', parseError);\n                                        // If parsing fails, we'll rely solely on backend data\n                                        }\n                                    }\n                                } catch (e) {\n                                    console.error('Failed to access localStorage:', e);\n                                }\n                                // Still load messages from backend for latest updates\n                                loadSessionMessages(savedSessionId);\n                            } else if (sortedSessions.length > 0) {\n                                // Select first session if available\n                                setSessionId(sortedSessions[0].session_id || sortedSessions[0].id);\n                                // Load messages for this session\n                                loadSessionMessages(sortedSessions[0].session_id || sortedSessions[0].id);\n                            } else {\n                                // If no sessions, create a default session\n                                await createNewSession();\n                            }\n                        } else {\n                            // If no sessions or error, create a default session\n                            await createNewSession();\n                        }\n                    } catch (err) {\n                        console.error('Failed to load sessions:', err);\n                        setError('Failed to load chat sessions');\n                        // If error loading sessions, create a default one\n                        await createNewSession();\n                    }\n                }\n            }[\"Chat.useEffect.loadSessions\"];\n            loadSessions();\n        }\n    }[\"Chat.useEffect\"], [\n        isAuthenticated,\n        token\n    ]); // Re-run when auth state changes\n    // Track if messages were loaded from cache to handle merging with backend data\n    const [messagesFromCache, setMessagesFromCache] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Function to load messages for a session (memoized with useCallback)\n    const loadSessionMessages = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"Chat.useCallback[loadSessionMessages]\": async (sid)=>{\n            if (!sid || !isAuthenticated) return;\n            const now = Date.now();\n            const last = lastHistoryLoadRef.current[sid] || 0;\n            // Skip if called again within 800ms for the same session to avoid duplicates\n            if (now - last < 800) {\n                return;\n            }\n            lastHistoryLoadRef.current[sid] = now;\n            // Check if we have cached messages first\n            const cachedMessages = loadMessagesFromCache(sid);\n            const hasExistingMessages = cachedMessages.length > 0;\n            // If we have cached messages, use them immediately\n            if (hasExistingMessages) {\n                console.log('Using cached messages while backend loads for session:', sid);\n                // Only set messages if they're different from current messages to avoid unnecessary renders\n                if (JSON.stringify(cachedMessages) !== JSON.stringify(messages)) {\n                    setMessages(cachedMessages);\n                    // Mark these messages as from cache, so backend fetch won't replace them if they're identical\n                    setMessagesFromCache(true);\n                    // Ensure the active session is saved in localStorage\n                    localStorage.setItem('activeSessionId', sid);\n                }\n            }\n            try {\n                setError('');\n                // Get the auth token to ensure we're using the current one\n                const currentToken = (0,_utils_authUtils__WEBPACK_IMPORTED_MODULE_4__.getAuthToken)();\n                if (!currentToken) {\n                    console.error('No auth token available');\n                    return;\n                }\n                const { data, success } = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__.api.get(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.CHAT.HISTORY(sid));\n                if (success && data && Array.isArray(data)) {\n                    // Convert messages to our expected format\n                    const formattedMessages = data.map({\n                        \"Chat.useCallback[loadSessionMessages].formattedMessages\": (msg)=>{\n                            // Handle different possible message formats\n                            if (msg.user) {\n                                return {\n                                    sender: 'user',\n                                    text: msg.user,\n                                    timestamp: msg.timestamp\n                                };\n                            } else if (msg.bot) {\n                                return {\n                                    sender: 'grace',\n                                    text: msg.bot,\n                                    timestamp: msg.timestamp\n                                };\n                            } else {\n                                return msg; // Already in our format\n                            }\n                        }\n                    }[\"Chat.useCallback[loadSessionMessages].formattedMessages\"]);\n                    // If backend returned messages\n                    if (formattedMessages.length > 0) {\n                        // If we have cached messages, we need to handle merging carefully\n                        if (hasExistingMessages) {\n                            // If backend has more messages than cache, use backend data\n                            if (formattedMessages.length > cachedMessages.length) {\n                                console.log('Backend has more messages than cache, updating');\n                                setMessages(formattedMessages);\n                                persistMessages(sid, formattedMessages);\n                            } else {\n                                // Check for any local messages that might not have synced yet\n                                const lastServerMessageTime = formattedMessages.length > 0 ? new Date(formattedMessages[formattedMessages.length - 1].timestamp).getTime() : 0;\n                                // Keep local messages sent after the last server message\n                                const localNewMessages = cachedMessages.filter({\n                                    \"Chat.useCallback[loadSessionMessages].localNewMessages\": (m)=>new Date(m.timestamp || Date.now()).getTime() > lastServerMessageTime\n                                }[\"Chat.useCallback[loadSessionMessages].localNewMessages\"]);\n                                // Combine server messages with any newer local ones\n                                if (localNewMessages.length > 0) {\n                                    console.log('Merging backend messages with local messages');\n                                    const mergedMessages = [\n                                        ...formattedMessages,\n                                        ...localNewMessages\n                                    ];\n                                    setMessages(mergedMessages);\n                                    persistMessages(sid, mergedMessages);\n                                } else if (JSON.stringify(formattedMessages) !== JSON.stringify(cachedMessages)) {\n                                    // Only update if different to avoid unnecessary renders\n                                    setMessages(formattedMessages);\n                                    persistMessages(sid, formattedMessages);\n                                }\n                            }\n                        } else {\n                            // No cache, use backend data\n                            console.log('Setting messages from backend, no cache available');\n                            setMessages(formattedMessages);\n                            persistMessages(sid, formattedMessages);\n                        }\n                    } else if (!hasExistingMessages) {\n                        // Backend returned empty and we have no cache\n                        setMessages([]);\n                    }\n                }\n            } catch (err) {\n                console.error(`Failed to load messages for session ${sid}:`, err);\n                // If we have cached messages, keep using them on error\n                if (!hasExistingMessages) {\n                    setMessages([]);\n                }\n            }\n        }\n    }[\"Chat.useCallback[loadSessionMessages]\"], [\n        isAuthenticated\n    ]);\n    // Load messages when session ID changes\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            // If any required condition is missing, return early\n            if (!sessionId || !isAuthenticated || !sessionsLoaded) return;\n            console.log('Session ID changed, loading messages for:', sessionId);\n            // Store current session ID in localStorage to persist across page navigations\n            localStorage.setItem('activeSessionId', sessionId);\n            // Load from backend (our updated function now handles cache properly)\n            loadSessionMessages(sessionId);\n        }\n    }[\"Chat.useEffect\"], [\n        sessionId,\n        loadSessionMessages,\n        isAuthenticated,\n        sessionsLoaded\n    ]);\n    // On component mount, try to restore the last active session from localStorage\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            // If not authenticated or sessions not loaded yet, or already restored, return early\n            if (!isAuthenticated || !sessionsLoaded || restoredOnceRef.current) return;\n            console.log('Attempting to restore previous session');\n            // Sort sessions by last activity only if needed\n            const sorted = [\n                ...sessions\n            ].sort({\n                \"Chat.useEffect.sorted\": (a, b)=>{\n                    return new Date(b.lastActivity).getTime() - new Date(a.lastActivity).getTime();\n                }\n            }[\"Chat.useEffect.sorted\"]);\n            // Only update sessions if the order actually changed to avoid loops\n            const orderChanged = JSON.stringify(sessions.map({\n                \"Chat.useEffect\": (s)=>s.session_id || s.id\n            }[\"Chat.useEffect\"])) !== JSON.stringify(sorted.map({\n                \"Chat.useEffect\": (s)=>s.session_id || s.id\n            }[\"Chat.useEffect\"]));\n            if (orderChanged) {\n                setSessions(sorted);\n            }\n            // Try to restore previous session if available\n            const savedSessionId = localStorage.getItem('activeSessionId');\n            if (savedSessionId && sorted.some({\n                \"Chat.useEffect\": (s)=>(s.session_id || s.id) === savedSessionId\n            }[\"Chat.useEffect\"])) {\n                console.log('Found previous session in loaded sessions:', savedSessionId);\n                setSessionId(savedSessionId);\n            } else if (sorted.length > 0) {\n                console.log('No saved session found, selecting most recent session');\n                setSessionId(sorted[0].session_id || sorted[0].id);\n            }\n            // Mark restoration as done to prevent repeating\n            restoredOnceRef.current = true;\n        }\n    }[\"Chat.useEffect\"], [\n        isAuthenticated,\n        sessionsLoaded\n    ]);\n    // Scroll to bottom whenever messages change\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)({\n        \"Chat.useEffect\": ()=>{\n            // Scroll to bottom of messages\n            if (messagesEndRef.current) {\n                // Use a small timeout to ensure the DOM has updated\n                setTimeout({\n                    \"Chat.useEffect\": ()=>{\n                        messagesEndRef.current?.scrollIntoView({\n                            behavior: 'smooth'\n                        });\n                    }\n                }[\"Chat.useEffect\"], 100);\n            }\n            // Store messages in localStorage using our helper function\n            if (sessionId && messages.length > 0) {\n                persistMessages(sessionId, messages);\n            }\n        }\n    }[\"Chat.useEffect\"], [\n        messages,\n        sessionId\n    ]);\n    // Refresh sessions list from backend (memoized with useCallback)\n    const refreshSessions = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"Chat.useCallback[refreshSessions]\": async ()=>{\n            if (!isAuthenticated) return;\n            try {\n                const { data, success } = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__.api.get(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.CHAT.SESSIONS);\n                if (success && Array.isArray(data)) {\n                    // Sort sessions by lastActivity, newest first\n                    const sortedSessions = [\n                        ...data\n                    ].sort({\n                        \"Chat.useCallback[refreshSessions].sortedSessions\": (a, b)=>{\n                            return new Date(b.lastActivity).getTime() - new Date(a.lastActivity).getTime();\n                        }\n                    }[\"Chat.useCallback[refreshSessions].sortedSessions\"]);\n                    setSessions(sortedSessions);\n                }\n            } catch (err) {\n                console.error('Failed to refresh sessions:', err);\n            }\n        }\n    }[\"Chat.useCallback[refreshSessions]\"], [\n        isAuthenticated\n    ]);\n    // Create a new session with backend (memoized with useCallback)\n    const createNewSession = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)({\n        \"Chat.useCallback[createNewSession]\": async ()=>{\n            if (!isAuthenticated) return;\n            try {\n                setError('');\n                const { data, success } = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__.api.post(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.CHAT.NEW_SESSION, {});\n                if (success && data) {\n                    const newSession = {\n                        id: data.session_id,\n                        name: data.name || 'New Conversation',\n                        lastActivity: data.lastActivity || new Date().toISOString(),\n                        messages: [],\n                        session_id: data.session_id,\n                        topic: data.topic || 'New Conversation' // Better default topic\n                    };\n                    // Add to existing sessions\n                    setSessions({\n                        \"Chat.useCallback[createNewSession]\": (prev)=>[\n                                newSession,\n                                ...prev\n                            ]\n                    }[\"Chat.useCallback[createNewSession]\"]);\n                    // Clear messages first\n                    setMessages([]);\n                    // Set the session ID\n                    setSessionId(newSession.session_id);\n                    // Do not persist empty cache to avoid loops\n                    // Store the session ID in localStorage to maintain across page navigations\n                    localStorage.setItem('activeSessionId', newSession.session_id);\n                    // Mark this session as loaded from cache to prevent overwriting\n                    setMessagesFromCache(true);\n                    return newSession.session_id;\n                } else {\n                    throw new Error('Failed to create session');\n                }\n            } catch (err) {\n                console.error('Failed to create new session:', err);\n                setError('Failed to create new chat session');\n                // Create locally if backend fails\n                // Use random component for more uniqueness\n                const fallbackId = `session-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n                const fallbackSession = {\n                    id: fallbackId,\n                    name: 'New Conversation',\n                    lastActivity: new Date().toISOString(),\n                    messages: [],\n                    session_id: fallbackId,\n                    topic: 'New Conversation' // Better default topic\n                };\n                setSessions({\n                    \"Chat.useCallback[createNewSession]\": (prev)=>[\n                            fallbackSession,\n                            ...prev\n                        ]\n                }[\"Chat.useCallback[createNewSession]\"]);\n                // Clear messages first\n                setMessages([]);\n                // Set the session ID\n                setSessionId(fallbackId);\n                // Initialize empty cache for this session\n                // Do not persist empty cache to avoid loops\n                // Store even fallback session ID\n                localStorage.setItem('activeSessionId', fallbackId);\n                // Mark this session as loaded from cache to prevent overwriting\n                setMessagesFromCache(true);\n                return fallbackId;\n            }\n        }\n    }[\"Chat.useCallback[createNewSession]\"], [\n        isAuthenticated\n    ]);\n    // Send chat message with session ID\n    const sendMessage = async ()=>{\n        if (!input.trim() || !isAuthenticated || !sessionId) return;\n        // Create a temp message object to show immediately\n        const tempUserMessage = {\n            sender: 'user',\n            text: input,\n            timestamp: new Date().toISOString()\n        };\n        // Create updated messages array with the new message\n        const updatedMessages = [\n            ...messages,\n            tempUserMessage\n        ];\n        // Persist messages to localStorage immediately - do this BEFORE state update\n        // to avoid potential race conditions\n        persistMessages(sessionId, updatedMessages);\n        // Ensure the active session ID is saved in localStorage\n        localStorage.setItem('activeSessionId', sessionId);\n        // Add to UI immediately\n        setMessages(updatedMessages);\n        // Generate preliminary topic from first message if needed\n        const currentSession = sessions.find((s)=>s.session_id === sessionId || s.id === sessionId);\n        const isGenericTopic = currentSession && (!currentSession.topic || currentSession.topic === 'New Conversation' || currentSession.topic.startsWith('Chat ') || currentSession.topic.startsWith('Conversation '));\n        if (messages.length === 0 && isGenericTopic && input) {\n            try {\n                // This is the first message, use it to create a preliminary topic\n                const prelimTopic = generateSimpleTopicFromMessage(input);\n                // Update session with a meaningful name based on first message\n                const updatedSessions = sessions.map((s)=>s.session_id === sessionId || s.id === sessionId ? {\n                        ...s,\n                        topic: prelimTopic,\n                        name: prelimTopic\n                    } : s);\n                setSessions(updatedSessions);\n            } catch (e) {\n                console.error('Error updating session topic:', e);\n            }\n        }\n        // Clear input field\n        setInput('');\n        // Set loading state\n        setLoading(true);\n        try {\n            // Send message to API\n            const { data, success } = await _api_apiClient__WEBPACK_IMPORTED_MODULE_2__.api.post(_api_apiClient__WEBPACK_IMPORTED_MODULE_2__.API_ENDPOINTS.CHAT.MESSAGE, {\n                session_id: sessionId,\n                message: input\n            });\n            if (success && data) {\n                // Format the response to match our message structure\n                const botResponse = {\n                    sender: 'grace',\n                    text: data.response || '',\n                    timestamp: new Date().toISOString()\n                };\n                // Create final messages array with both user message and bot response\n                const finalMessages = [\n                    ...updatedMessages,\n                    botResponse\n                ];\n                // Persist the complete conversation including bot response - do this BEFORE state update\n                // to avoid potential race conditions\n                persistMessages(sessionId, finalMessages);\n                // Ensure the active session ID is saved in localStorage\n                localStorage.setItem('activeSessionId', sessionId);\n                // Add to messages\n                setMessages(finalMessages);\n                // Re-sync with server to ensure we have the latest data\n                loadSessionMessages(sessionId);\n                // Update session if the server provides a topic\n                if (data.topic) {\n                    try {\n                        // Replace our preliminary topic with server-generated one\n                        const updatedSessions = sessions.map((s)=>s.session_id === sessionId || s.id === sessionId ? {\n                                ...s,\n                                topic: data.topic,\n                                name: data.topic\n                            } : s);\n                        setSessions(updatedSessions);\n                    } catch (e) {\n                        console.error('Error updating session with server topic:', e);\n                    }\n                }\n            } else {\n                setError('Failed to get response');\n            }\n        } catch (err) {\n            console.error('Failed to send message:', err);\n            setError('Failed to send message');\n            // Even if there's an error, we should still show the user's message\n            // This ensures the user can see their message even if Grace doesn't respond\n            // Persist messages to localStorage first to avoid race conditions\n            persistMessages(sessionId, updatedMessages);\n            localStorage.setItem('activeSessionId', sessionId);\n            setMessages(updatedMessages);\n        } finally{\n            setLoading(false);\n            // Ensure we scroll to the latest message with a small delay to ensure DOM update\n            setTimeout(()=>{\n                if (messagesEndRef.current) {\n                    messagesEndRef.current.scrollIntoView({\n                        behavior: 'smooth'\n                    });\n                }\n            }, 100);\n        }\n    };\n    // State for mobile sidebar visibility\n    const [sidebarVisible, setSidebarVisible] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // ... (rest of the code remains the same)\n    // Toggle sidebar on mobile\n    const toggleSidebar = ()=>{\n        setSidebarVisible(!sidebarVisible);\n    };\n    // Simple function to rename a chat session\n    const handleSessionRename = (sessionId)=>{\n        try {\n            // Find the session to rename\n            const session = sessions.find((s)=>s.session_id === sessionId || s.id === sessionId);\n            if (!session) return;\n            // Get current name to show as default\n            const currentName = session.topic || session.name || `Chat ${sessionId.slice(0, 6)}`;\n            // Prompt for new name\n            const newName = prompt('Enter a new name for this chat:', currentName);\n            // Update if name provided\n            if (newName && newName.trim() && newName !== currentName) {\n                // Update locally\n                const updatedSessions = sessions.map((s)=>s.session_id === sessionId || s.id === sessionId ? {\n                        ...s,\n                        topic: newName.trim(),\n                        name: newName.trim()\n                    } : s);\n                setSessions(updatedSessions);\n            // Note: In a full implementation, you would also update the server\n            // But for this minimal improvement, we're just updating the UI\n            }\n        } catch (e) {\n            console.error('Error renaming session:', e);\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"flex h-[calc(100vh-16rem)] overflow-hidden rounded-lg border border-red-700\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                className: \"md:hidden absolute top-2 left-2 z-10 bg-red-800 rounded-full p-2 text-white shadow-md\",\n                onClick: toggleSidebar,\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                    xmlns: \"http://www.w3.org/2000/svg\",\n                    className: \"h-5 w-5\",\n                    viewBox: \"0 0 20 20\",\n                    fill: \"currentColor\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                        fillRule: \"evenodd\",\n                        d: \"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\",\n                        clipRule: \"evenodd\"\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 743,\n                        columnNumber: 13\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                    lineNumber: 742,\n                    columnNumber: 11\n                }, this)\n            }, void 0, false, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                lineNumber: 738,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"aside\", {\n                className: `${sidebarVisible ? 'block' : 'hidden'} md:block absolute md:relative md:w-64 w-3/4 bg-black border-r border-red-800 p-4 overflow-y-auto h-full z-10`,\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h2\", {\n                        className: \"text-red-300 text-lg font-mono mb-2 flex justify-between items-center\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                children: \"Sessions\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                lineNumber: 750,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: toggleSidebar,\n                                className: \"md:hidden text-red-300 hover:text-red-100\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                                    xmlns: \"http://www.w3.org/2000/svg\",\n                                    className: \"h-5 w-5\",\n                                    viewBox: \"0 0 20 20\",\n                                    fill: \"currentColor\",\n                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                        fillRule: \"evenodd\",\n                                        d: \"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\",\n                                        clipRule: \"evenodd\"\n                                    }, void 0, false, {\n                                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                        lineNumber: 753,\n                                        columnNumber: 17\n                                    }, this)\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                    lineNumber: 752,\n                                    columnNumber: 15\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                lineNumber: 751,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 749,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                        onClick: ()=>{\n                            createNewSession();\n                            setSidebarVisible(false);\n                        },\n                        className: \"w-full mb-4 rounded bg-red-700 px-4 py-2 hover:bg-red-900\",\n                        disabled: !isAuthenticated || loading,\n                        children: \"+ New Chat\"\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 757,\n                        columnNumber: 11\n                    }, this),\n                    error && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-red-500 text-xs mb-2\",\n                        children: error\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 768,\n                        columnNumber: 21\n                    }, this),\n                    !isAuthenticated && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"p\", {\n                        className: \"text-yellow-500 text-xs mb-2\",\n                        children: \"Please log in to use chat\"\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 771,\n                        columnNumber: 13\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"ul\", {\n                        className: \"space-y-2\",\n                        children: sessions.map((s)=>{\n                            // Safely get the session ID, checking both session_id and id\n                            const currentSessionId = s.session_id || s.id;\n                            if (!currentSessionId) return null; // Skip if no valid ID\n                            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"li\", {\n                                className: \"relative group\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                    onClick: ()=>{\n                                        // Clear current messages first to avoid UI flashing\n                                        setMessages([]);\n                                        // Set the session ID\n                                        setSessionId(currentSessionId);\n                                        // Immediately load messages from cache\n                                        const cachedMessages = loadMessagesFromCache(currentSessionId);\n                                        if (cachedMessages.length > 0) {\n                                            setMessages(cachedMessages);\n                                        }\n                                        // Store the active session ID\n                                        localStorage.setItem('activeSessionId', currentSessionId);\n                                        // Close sidebar on mobile after selection\n                                        setSidebarVisible(false);\n                                    },\n                                    className: `w-full text-left px-3 py-2 rounded text-sm hover:bg-red-800 ${sessionId === currentSessionId ? 'bg-red-900 text-white' : 'text-red-300'}`,\n                                    children: s.topic || s.name || `Chat ${currentSessionId.slice(0, 6)}`\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                    lineNumber: 781,\n                                    columnNumber: 19\n                                }, this)\n                            }, currentSessionId, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                lineNumber: 780,\n                                columnNumber: 17\n                            }, this);\n                        })\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 773,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                lineNumber: 748,\n                columnNumber: 9\n            }, this),\n            sidebarVisible && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"md:hidden fixed inset-0 bg-black bg-opacity-50 z-0\",\n                onClick: ()=>setSidebarVisible(false)\n            }, void 0, false, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                lineNumber: 811,\n                columnNumber: 11\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"main\", {\n                className: \"flex-1 bg-black flex flex-col\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex-1 overflow-y-auto p-6 space-y-4\",\n                        onScroll: handleScroll,\n                        children: [\n                            messages.length === 0 && !loading && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"text-center text-gray-500 my-8\",\n                                children: isAuthenticated ? 'No messages yet. Start a conversation!' : 'Please log in to start chatting'\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                lineNumber: 823,\n                                columnNumber: 15\n                            }, this),\n                            loading && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"text-center text-yellow-500 my-4 animate-pulse\",\n                                children: \"Grace is thinking...\"\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                lineNumber: 830,\n                                columnNumber: 15\n                            }, this),\n                            messages.map((msg, idx)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"mb-4\",\n                                    children: [\n                                        msg.sender === 'user' || msg.user ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"text-right p-2 rounded-lg bg-red-900/30 text-red-300\",\n                                            children: [\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"font-bold\",\n                                                    children: \"You:\"\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                                    lineNumber: 839,\n                                                    columnNumber: 21\n                                                }, this),\n                                                \" \",\n                                                msg.text || msg.user\n                                            ]\n                                        }, void 0, true, {\n                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                            lineNumber: 838,\n                                            columnNumber: 19\n                                        }, this) : null,\n                                        msg.sender === 'grace' || msg.bot ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"text-left p-2 rounded-lg bg-green-900/30 text-green-300\",\n                                            children: [\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"font-bold\",\n                                                    children: \"Grace:\"\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                                    lineNumber: 845,\n                                                    columnNumber: 21\n                                                }, this),\n                                                \" \",\n                                                msg.text || msg.bot\n                                            ]\n                                        }, void 0, true, {\n                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                            lineNumber: 844,\n                                            columnNumber: 19\n                                        }, this) : null\n                                    ]\n                                }, idx, true, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                    lineNumber: 836,\n                                    columnNumber: 15\n                                }, this)),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                ref: messagesEndRef\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                lineNumber: 852,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 818,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"footer\", {\n                        className: \"flex border-t border-red-800 bg-black p-4\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"textarea\", {\n                                className: \"flex-1 mr-2 rounded bg-white/10 p-2 text-white min-h-[60px] resize-none\",\n                                placeholder: isAuthenticated ? \"Type your message... (Shift+Enter for new line)\" : \"Please log in to chat\",\n                                value: input,\n                                onChange: (e)=>setInput(e.target.value),\n                                onKeyDown: (e)=>{\n                                    if (e.key === 'Enter' && !e.shiftKey) {\n                                        e.preventDefault(); // Prevent default to avoid new line\n                                        if (!loading && isAuthenticated && input.trim()) {\n                                            sendMessage();\n                                        }\n                                    }\n                                },\n                                disabled: !isAuthenticated || loading,\n                                autoFocus: true,\n                                \"aria-label\": \"Chat message input\",\n                                ref: (el)=>{\n                                    // Focus when session changes\n                                    if (el && isAuthenticated && !loading) {\n                                        setTimeout(()=>el.focus(), 100); // Small delay to ensure it works across browsers\n                                    }\n                                }\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                lineNumber: 856,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: sendMessage,\n                                disabled: loading || !isAuthenticated || !input.trim(),\n                                className: \"rounded bg-red-700 px-4 py-2 hover:bg-red-900 disabled:bg-gray-700 disabled:cursor-not-allowed\",\n                                children: loading ? '...' : 'Send'\n                            }, void 0, false, {\n                                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                lineNumber: 879,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 855,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"border-t border-red-800/50 p-4 bg-black/70\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"bg-transparent text-white p-4\",\n                            children: [\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex justify-between items-center mb-2\",\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                                            className: \"flex items-center text-red-500 font-bold relative pl-4 before:content-[''] before:absolute before:left-0 before:top-0 before:h-full before:w-1 before:bg-red-500\",\n                                            children: \"XFeed Channel\"\n                                        }, void 0, false, {\n                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                            lineNumber: 892,\n                                            columnNumber: 17\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                            onClick: ()=>{\n                                                // Find and click the settings button in XFeed\n                                                const settingsBtn = document.querySelector('[data-xfeed-settings]');\n                                                if (settingsBtn && settingsBtn instanceof HTMLElement) {\n                                                    settingsBtn.click();\n                                                }\n                                            },\n                                            className: \"text-xs px-2 py-1 rounded bg-red-900/50 text-red-200 hover:bg-red-800 flex items-center space-x-1\",\n                                            children: [\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    className: \"text-lg leading-none\",\n                                                    children: \"+\"\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                                    lineNumber: 906,\n                                                    columnNumber: 19\n                                                }, this),\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                                    children: \"Add Account\"\n                                                }, void 0, false, {\n                                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                                    lineNumber: 907,\n                                                    columnNumber: 19\n                                                }, this)\n                                            ]\n                                        }, void 0, true, {\n                                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                            lineNumber: 896,\n                                            columnNumber: 17\n                                        }, this)\n                                    ]\n                                }, void 0, true, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                    lineNumber: 891,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"hr\", {\n                                    className: \"border-gray-800 mb-4\"\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                    lineNumber: 910,\n                                    columnNumber: 15\n                                }, this),\n                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_XFeed__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n                                    maxItems: 3\n                                }, void 0, false, {\n                                    fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                                    lineNumber: 911,\n                                    columnNumber: 15\n                                }, this),\n                                \" \"\n                            ]\n                        }, void 0, true, {\n                            fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                            lineNumber: 890,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                        lineNumber: 889,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n                lineNumber: 817,\n                columnNumber: 9\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"/Users/wonkasworld/Downloads/grace-project/src/ui/pages/chat.tsx\",\n        lineNumber: 736,\n        columnNumber: 5\n    }, this);\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkcsYUFBYTtvREFDckRILFlBQVlJLEtBQUs7Z0RBQ25COzRDQUNGOzRDQUNBMUMsV0FBVTs7OERBRVYsOERBQUNhO29EQUFLYixXQUFVOzhEQUF1Qjs7Ozs7OzhEQUN2Qyw4REFBQ2E7OERBQUs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs4Q0FHViw4REFBQzhCO29DQUFHM0MsV0FBVTs7Ozs7OzhDQUNkLDhEQUFDaEsseURBQUtBO29DQUFDNE0sVUFBVTs7Ozs7O2dDQUFLOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFNcEMiLCJzb3VyY2VzIjpbIi9Vc2Vycy93b25rYXN3b3JsZC9Eb3dubG9hZHMvZ3JhY2UtcHJvamVjdC9zcmMvdWkvcGFnZXMvY2hhdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL3BhZ2VzL0NoYXQudHN4XG5cbmltcG9ydCBSZWFjdCwgeyB1c2VFZmZlY3QsIHVzZVN0YXRlLCBGb3JtRXZlbnQsIHVzZVJlZiwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBhcGksIEFQSV9FTkRQT0lOVFMgfSBmcm9tICcuLi9hcGkvYXBpQ2xpZW50JztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuLi9jb21wb25lbnRzL0F1dGhDb250ZXh0JztcbmltcG9ydCB7IGdldEF1dGhUb2tlbiB9IGZyb20gJy4uL3V0aWxzL2F1dGhVdGlscyc7XG5pbXBvcnQgeyB1c2VDaGF0U3RhdGVQZXJzaXN0ZW5jZSB9IGZyb20gJy4uL2NvbXBvbmVudHMvQ2hhdFN0YXRlUGVyc2lzdGVuY2UnO1xuaW1wb3J0IFhGZWVkIGZyb20gJy4uL2NvbXBvbmVudHMvWEZlZWQnO1xuXG5pbnRlcmZhY2UgQ2hhdE1lc3NhZ2Uge1xuICBzZW5kZXI/OiAndXNlcicgfCAnZ3JhY2UnO1xuICB0ZXh0Pzogc3RyaW5nO1xuICB0aW1lc3RhbXA/OiBzdHJpbmc7XG4gIHVzZXI/OiBzdHJpbmc7IC8vIEZvciBBUEkgcmVzcG9uc2UgZm9ybWF0XG4gIGJvdD86IHN0cmluZzsgLy8gRm9yIEFQSSByZXNwb25zZSBmb3JtYXRcbn1cblxuaW50ZXJmYWNlIENoYXRTZXNzaW9uIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBsYXN0QWN0aXZpdHk6IHN0cmluZztcbiAgbWVzc2FnZXM6IENoYXRNZXNzYWdlW107XG4gIHNlc3Npb25faWQ/OiBzdHJpbmc7IC8vIEZvciBBUEkgY29tcGF0aWJpbGl0eVxuICB0b3BpYz86IHN0cmluZzsgLy8gRm9yIEFQSSBjb21wYXRpYmlsaXR5XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIENoYXQoKSB7XG4gIC8vIFVzZSB0aGUgQXV0aCBjb250ZXh0IGZvciBhdXRoZW50aWNhdGlvbiBzdGF0ZVxuICBjb25zdCB7IHVzZXIsIGlzQXV0aGVudGljYXRlZCB9ID0gdXNlQXV0aCgpO1xuICAvLyBVc2Ugc3RhbmRhcmRpemVkIHRva2VuIGZ1bmN0aW9uIGZyb20gYXV0aFV0aWxzXG4gIGNvbnN0IHRva2VuID0gZ2V0QXV0aFRva2VuKCk7XG4gIFxuICBjb25zdCBbc2Vzc2lvbnMsIHNldFNlc3Npb25zXSA9IHVzZVN0YXRlPENoYXRTZXNzaW9uW10+KFtdKTtcbiAgY29uc3QgW3Nlc3Npb25JZCwgc2V0U2Vzc2lvbklkXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbbWVzc2FnZXMsIHNldE1lc3NhZ2VzXSA9IHVzZVN0YXRlPENoYXRNZXNzYWdlW10+KFtdKTtcbiAgY29uc3QgW2lucHV0LCBzZXRJbnB1dF0gPSB1c2VTdGF0ZTxzdHJpbmc+KCcnKTtcbiAgY29uc3QgW2xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPHN0cmluZz4oJycpO1xuICBcbiAgLy8gVHJhY2sgaWYgc2Vzc2lvbnMgaGF2ZSBiZWVuIGxvYWRlZFxuICBjb25zdCBbc2Vzc2lvbnNMb2FkZWQsIHNldFNlc3Npb25zTG9hZGVkXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgLy8gVXNlIHJlZiB0byBhdm9pZCBkdXBsaWNhdGUgc2Vzc2lvbiBjcmVhdGlvblxuICBjb25zdCBtZXNzYWdlc0VuZFJlZiA9IHVzZVJlZjxIVE1MRGl2RWxlbWVudD4obnVsbCk7XG5cbiAgLy8gSW5pdGlhbGl6ZSBjaGF0IHN0YXRlIHBlcnNpc3RlbmNlIGhvb2tcbiAgY29uc3Qge1xuICAgIGluaXRpYWxpemVGcm9tUGVyc2lzdGVkU3RhdGUsXG4gICAgZ2V0U2F2ZWREcmFmdE1lc3NhZ2UsXG4gICAgdXBkYXRlRHJhZnRNZXNzYWdlLFxuICAgIHN5bmNTY3JvbGxQb3NpdGlvbixcbiAgICBnZXRTYXZlZFNjcm9sbFBvc2l0aW9uXG4gIH0gPSB1c2VDaGF0U3RhdGVQZXJzaXN0ZW5jZShzZXNzaW9uSWQsIHNlc3Npb25zLCBtZXNzYWdlcywgaW5wdXQpO1xuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBnZW5lcmF0ZSBhIHNpbXBsZSB0b3BpYyBmcm9tIG1lc3NhZ2UgY29udGVudFxuICBjb25zdCBnZW5lcmF0ZVNpbXBsZVRvcGljRnJvbU1lc3NhZ2UgPSAobWVzc2FnZTogc3RyaW5nIHwgdW5kZWZpbmVkIHwgbnVsbCk6IHN0cmluZyA9PiB7XG4gICAgaWYgKCFtZXNzYWdlKSByZXR1cm4gJ05ldyBDb252ZXJzYXRpb24nO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBUYWtlIGZpcnN0IDMwIGNoYXJhY3RlcnMgZnJvbSB0aGUgbWVzc2FnZSwgb3IgdXAgdG8gdGhlIGZpcnN0IHBlcmlvZFxuICAgICAgY29uc3QgZmlyc3RTZW50ZW5jZSA9IG1lc3NhZ2Uuc3BsaXQoJy4nKVswXS50cmltKCk7XG4gICAgICBjb25zdCB0b3BpY1RleHQgPSBmaXJzdFNlbnRlbmNlLmxlbmd0aCA+IDMwID8gXG4gICAgICAgIGZpcnN0U2VudGVuY2Uuc3Vic3RyaW5nKDAsIDMwKSArICcuLi4nIDogXG4gICAgICAgIGZpcnN0U2VudGVuY2U7XG4gICAgICByZXR1cm4gdG9waWNUZXh0IHx8ICdOZXcgQ29udmVyc2F0aW9uJztcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIHRvcGljOicsIGUpO1xuICAgICAgcmV0dXJuICdOZXcgQ29udmVyc2F0aW9uJztcbiAgICB9XG4gIH07XG4gIFxuICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gcGVyc2lzdCBtZXNzYWdlcyB0byBsb2NhbFN0b3JhZ2Ugd2l0aCB0aW1lc3RhbXBcbiAgY29uc3QgcGVyc2lzdE1lc3NhZ2VzID0gKHNpZDogc3RyaW5nLCBtc2dzOiBDaGF0TWVzc2FnZVtdKSA9PiB7XG4gICAgaWYgKCFzaWQgfHwgIW1zZ3MgfHwgbXNncy5sZW5ndGggPT09IDApIHJldHVybjsgLy8gYXZvaWQgcGVyc2lzdGluZyBlbXB0eSBhcnJheXNcbiAgICB0cnkge1xuICAgICAgLy8gT25seSBzdG9yZSBhIGxpbWl0ZWQgbnVtYmVyIG9mIG1lc3NhZ2VzIHRvIHByZXZlbnQgbG9jYWxTdG9yYWdlIG92ZXJmbG93c1xuICAgICAgY29uc3QgbWVzc2FnZXNUb1N0b3JlID0gbXNncy5zbGljZSgtNTApOyAvLyBTdG9yZSBqdXN0IHRoZSBsYXN0IDUwIG1lc3NhZ2VzXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShgbWVzc2FnZXNfJHtzaWR9YCwgSlNPTi5zdHJpbmdpZnkobWVzc2FnZXNUb1N0b3JlKSk7XG4gICAgICBcbiAgICAgIC8vIFN0b3JlIGEgdGltZXN0YW1wIHdpdGggdGhlIG1lc3NhZ2VzIHRvIHRyYWNrIGZyZXNobmVzc1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYGxhc3RTeW5jZWRfJHtzaWR9YCwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpKTtcbiAgICAgIFxuICAgICAgLy8gQWx3YXlzIHN0b3JlIHRoZSBhY3RpdmUgc2Vzc2lvbiBJRCB0byBlbnN1cmUgaXQncyBhdmFpbGFibGUgd2hlbiByZXR1cm5pbmcgdG8gdGhlIHBhZ2VcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVTZXNzaW9uSWQnLCBzaWQpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSBtZXNzYWdlcyBpbiBsb2NhbFN0b3JhZ2U6JywgZSk7XG4gICAgfVxuICB9O1xuICBcbiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGxvYWQgbWVzc2FnZXMgZnJvbSBjYWNoZVxuICBjb25zdCBsb2FkTWVzc2FnZXNGcm9tQ2FjaGUgPSAoc2lkOiBzdHJpbmcpOiBDaGF0TWVzc2FnZVtdID0+IHtcbiAgICBpZiAoIXNpZCkgcmV0dXJuIFtdO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzYXZlZE1lc3NhZ2VzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oYG1lc3NhZ2VzXyR7c2lkfWApO1xuICAgICAgaWYgKHNhdmVkTWVzc2FnZXMpIHtcbiAgICAgICAgY29uc3QgcGFyc2VkTWVzc2FnZXMgPSBKU09OLnBhcnNlKHNhdmVkTWVzc2FnZXMpO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXJzZWRNZXNzYWdlcykgJiYgcGFyc2VkTWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2FkZWQgY2FjaGVkIG1lc3NhZ2VzIGZvciBzZXNzaW9uOicsIHNpZCk7XG4gICAgICAgICAgcmV0dXJuIHBhcnNlZE1lc3NhZ2VzO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgbWVzc2FnZXMgZnJvbSBjYWNoZTonLCBlKTtcbiAgICB9XG4gICAgcmV0dXJuIFtdO1xuICB9O1xuICBcbiAgLy8gVHJhY2sgaWYgY29tcG9uZW50IGlzIG1vdW50ZWQgdG8gcHJldmVudCBzdGF0ZSB1cGRhdGVzIGFmdGVyIHVubW91bnRpbmdcbiAgY29uc3QgaXNNb3VudGVkUmVmID0gdXNlUmVmKHRydWUpO1xuICAvLyBHdWFyZCB0byBlbnN1cmUgd2Ugb25seSBhdHRlbXB0IHNlc3Npb24gcmVzdG9yYXRpb24gb25jZSBwZXIgbW91bnRcbiAgY29uc3QgcmVzdG9yZWRPbmNlUmVmID0gdXNlUmVmKGZhbHNlKTtcbiAgLy8gRGVkdXAgZ3VhcmQgZm9yIGhpc3RvcnkgbG9hZHMgcGVyIHNlc3Npb25cbiAgY29uc3QgbGFzdEhpc3RvcnlMb2FkUmVmID0gdXNlUmVmPFJlY29yZDxzdHJpbmcsIG51bWJlcj4+KHt9KTtcbiAgXG4gIC8vIEluaXRpYWxpemUgZnJvbSBwZXJzaXN0ZWQgc3RhdGUgb24gY29tcG9uZW50IG1vdW50XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFzZXNzaW9uc0xvYWRlZCAmJiBpc0F1dGhlbnRpY2F0ZWQpIHtcbiAgICAgIGNvbnN0IHJlc3RvcmVkID0gaW5pdGlhbGl6ZUZyb21QZXJzaXN0ZWRTdGF0ZShzZXRTZXNzaW9ucywgc2V0U2Vzc2lvbklkKTtcbiAgICAgIGlmIChyZXN0b3JlZCkge1xuICAgICAgICBzZXRTZXNzaW9uc0xvYWRlZCh0cnVlKTtcbiAgICAgICAgY29uc29sZS5sb2coJ0NoYXQgc2Vzc2lvbnMgcmVzdG9yZWQgZnJvbSBwZXJzaXN0ZWQgc3RhdGUnKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtzZXNzaW9uc0xvYWRlZCwgaXNBdXRoZW50aWNhdGVkLCBpbml0aWFsaXplRnJvbVBlcnNpc3RlZFN0YXRlXSk7XG5cbiAgLy8gUmVzdG9yZSBkcmFmdCBtZXNzYWdlIHdoZW4gc2Vzc2lvbiBjaGFuZ2VzXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHNlc3Npb25JZCkge1xuICAgICAgY29uc3Qgc2F2ZWREcmFmdCA9IGdldFNhdmVkRHJhZnRNZXNzYWdlKCk7XG4gICAgICBpZiAoc2F2ZWREcmFmdCAmJiBzYXZlZERyYWZ0ICE9PSBpbnB1dCkge1xuICAgICAgICBzZXRJbnB1dChzYXZlZERyYWZ0KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFtzZXNzaW9uSWQsIGdldFNhdmVkRHJhZnRNZXNzYWdlXSk7XG5cbiAgLy8gU2F2ZSBkcmFmdCBtZXNzYWdlIGFzIHVzZXIgdHlwZXNcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoc2Vzc2lvbklkICYmIGlucHV0KSB7XG4gICAgICB1cGRhdGVEcmFmdE1lc3NhZ2UoaW5wdXQpO1xuICAgIH1cbiAgfSwgW3Nlc3Npb25JZCwgaW5wdXQsIHVwZGF0ZURyYWZ0TWVzc2FnZV0pO1xuICBcbiAgLy8gQXV0by1zY3JvbGwgdG8gYm90dG9tIHdoZW4gbWVzc2FnZXMgY2hhbmdlIG9yIHJlc3RvcmUgc2F2ZWQgc2Nyb2xsIHBvc2l0aW9uXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKG1lc3NhZ2VzRW5kUmVmLmN1cnJlbnQpIHtcbiAgICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgYSBzYXZlZCBzY3JvbGwgcG9zaXRpb25cbiAgICAgIGNvbnN0IHNhdmVkUG9zaXRpb24gPSBnZXRTYXZlZFNjcm9sbFBvc2l0aW9uKCk7XG4gICAgICBcbiAgICAgIGlmIChzYXZlZFBvc2l0aW9uICE9PSBudWxsKSB7XG4gICAgICAgIC8vIFVzZSBzZXRUaW1lb3V0IHRvIGVuc3VyZSB0aGUgRE9NIGlzIGZ1bGx5IHJlbmRlcmVkXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNoYXRDb250YWluZXIgPSBtZXNzYWdlc0VuZFJlZi5jdXJyZW50Py5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgIGlmIChjaGF0Q29udGFpbmVyICYmIHR5cGVvZiBzYXZlZFBvc2l0aW9uID09PSAnbnVtYmVyJyAmJiAhaXNOYU4oc2F2ZWRQb3NpdGlvbikpIHtcbiAgICAgICAgICAgIGNoYXRDb250YWluZXIuc2Nyb2xsVG9wID0gc2F2ZWRQb3NpdGlvbjtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIDEwMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBEZWZhdWx0IHRvIHNjcm9sbGluZyB0byBib3R0b21cbiAgICAgICAgbWVzc2FnZXNFbmRSZWYuY3VycmVudC5zY3JvbGxJbnRvVmlldyh7IGJlaGF2aW9yOiAnc21vb3RoJyB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIFttZXNzYWdlcywgc2Vzc2lvbklkLCBnZXRTYXZlZFNjcm9sbFBvc2l0aW9uXSk7XG4gIFxuICAvLyBTYXZlIHNjcm9sbCBwb3NpdGlvbiB3aGVuIHVzZXIgc2Nyb2xsc1xuICBjb25zdCBoYW5kbGVTY3JvbGwgPSB1c2VDYWxsYmFjaygoZTogUmVhY3QuVUlFdmVudDxIVE1MRGl2RWxlbWVudD4pID0+IHtcbiAgICBpZiAoc2Vzc2lvbklkKSB7XG4gICAgICBzeW5jU2Nyb2xsUG9zaXRpb24oZS5jdXJyZW50VGFyZ2V0LnNjcm9sbFRvcCk7XG4gICAgfVxuICB9LCBbc2Vzc2lvbklkLCBzeW5jU2Nyb2xsUG9zaXRpb25dKTtcbiAgXG4gIC8vIENsZWFudXAgb24gdW5tb3VudFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpc01vdW50ZWRSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgIH07XG4gIH0sIFtdKTtcbiAgXG4gIC8vIExvYWQgc2Vzc2lvbnMgZnJvbSBiYWNrZW5kIHdoZW4gYXV0aGVudGljYXRlZFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGxvYWRTZXNzaW9ucyA9IGFzeW5jICgpID0+IHtcbiAgICAgIGlmICghaXNBdXRoZW50aWNhdGVkIHx8ICF0b2tlbikge1xuICAgICAgICAvLyBDbGVhciBzZXNzaW9ucyB3aGVuIG5vdCBhdXRoZW50aWNhdGVkXG4gICAgICAgIHNldFNlc3Npb25zKFtdKTtcbiAgICAgICAgc2V0U2Vzc2lvbklkKG51bGwpO1xuICAgICAgICBzZXRNZXNzYWdlcyhbXSk7XG4gICAgICAgIHNldFNlc3Npb25zTG9hZGVkKGZhbHNlKTsgLy8gUmVzZXQgc2Vzc2lvbnMgbG9hZGVkIGZsYWdcbiAgICAgICAgXG4gICAgICAgIC8vIENsZWFuIHVwIGxvY2FsU3RvcmFnZSB3aGVuIGxvZ2dpbmcgb3V0XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgYWN0aXZlU2Vzc2lvbklkcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjdGl2ZVNlc3Npb25JZHMnKSB8fCAnW10nKTtcbiAgICAgICAgICAvLyBDbGVhbiB1cCBlYWNoIHNlc3Npb24gZGF0YVxuICAgICAgICAgIGFjdGl2ZVNlc3Npb25JZHMuZm9yRWFjaCgoc2lkOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGBtZXNzYWdlc18ke3NpZH1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyBSZW1vdmUgdHJhY2tpbmcga2V5c1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdhY3RpdmVTZXNzaW9uSWRzJyk7XG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FjdGl2ZVNlc3Npb25JZCcpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2xlYW5pbmcgdXAgbG9jYWxTdG9yYWdlIG9uIGxvZ291dDonLCBlKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGRhdGEsIHN1Y2Nlc3MgfSA9IGF3YWl0IGFwaS5nZXQoQVBJX0VORFBPSU5UUy5DSEFULlNFU1NJT05TKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChzdWNjZXNzICYmIGRhdGEgJiYgQXJyYXkuaXNBcnJheShkYXRhKSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2FkZWQgc2Vzc2lvbnM6JywgZGF0YSk7XG4gICAgICAgICAgLy8gTWFwIGluY29taW5nIHNlc3Npb25zIHRvIG91ciBzdHJ1Y3R1cmVcbiAgICAgICAgICBjb25zdCBmb3JtYXR0ZWRTZXNzaW9ucyA9IGRhdGEubWFwKChzOiBhbnkpID0+IHtcbiAgICAgICAgICAgIC8vIEZpbmQgYSBtZWFuaW5nZnVsIG5hbWUgZm9yIHRoZSBzZXNzaW9uXG4gICAgICAgICAgICBsZXQgc2Vzc2lvbk5hbWUgPSBzLnRvcGljIHx8IHMubmFtZTtcbiAgICAgICAgICAgIGlmICghc2Vzc2lvbk5hbWUgfHwgc2Vzc2lvbk5hbWUgPT09ICdOZXcgQ2hhdCcgfHwgc2Vzc2lvbk5hbWUgPT09ICdOZXcgQ29udmVyc2F0aW9uJykge1xuICAgICAgICAgICAgICAvLyBJZiBubyBtZWFuaW5nZnVsIG5hbWUsIHRyeSB0byBleHRyYWN0IGZyb20gZmlyc3QgbWVzc2FnZSBpZiBhdmFpbGFibGVcbiAgICAgICAgICAgICAgaWYgKHMucHJldmlld19tZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgc2Vzc2lvbk5hbWUgPSBnZW5lcmF0ZVNpbXBsZVRvcGljRnJvbU1lc3NhZ2Uocy5wcmV2aWV3X21lc3NhZ2UpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHMubWVzc2FnZXMgJiYgQXJyYXkuaXNBcnJheShzLm1lc3NhZ2VzKSAmJiBzLm1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBUcnkgdG8gdXNlIGZpcnN0IG1lc3NhZ2UgaW4gdGhlIGFycmF5IGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpcnN0TXNnID0gcy5tZXNzYWdlc1swXTtcbiAgICAgICAgICAgICAgICBjb25zdCBtc2dUZXh0ID0gZmlyc3RNc2cudGV4dCB8fCBmaXJzdE1zZy51c2VyIHx8IGZpcnN0TXNnLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgc2Vzc2lvbk5hbWUgPSBnZW5lcmF0ZVNpbXBsZVRvcGljRnJvbU1lc3NhZ2UobXNnVGV4dCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gZGF0ZS1iYXNlZCBuYW1lXG4gICAgICAgICAgICAgICAgc2Vzc2lvbk5hbWUgPSBgQ29udmVyc2F0aW9uICR7bmV3IERhdGUocy5sYXN0QWN0aXZpdHkgfHwgcy5jcmVhdGVkIHx8IG5ldyBEYXRlKCkpLnRvTG9jYWxlRGF0ZVN0cmluZygpfWA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgaWQ6IHMuc2Vzc2lvbl9pZCB8fCBzLmlkLFxuICAgICAgICAgICAgICBuYW1lOiBzZXNzaW9uTmFtZSxcbiAgICAgICAgICAgICAgbGFzdEFjdGl2aXR5OiBzLmxhc3RBY3Rpdml0eSB8fCBzLmxhc3RfYWN0aXZpdHkgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICBtZXNzYWdlczogW10sXG4gICAgICAgICAgICAgIHNlc3Npb25faWQ6IHMuc2Vzc2lvbl9pZCB8fCBzLmlkLFxuICAgICAgICAgICAgICB0b3BpYzogc2Vzc2lvbk5hbWVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU29ydCBieSBsYXN0IGFjdGl2aXR5LCBtb3N0IHJlY2VudCBmaXJzdFxuICAgICAgICAgIGNvbnN0IHNvcnRlZFNlc3Npb25zID0gZm9ybWF0dGVkU2Vzc2lvbnMuc29ydCgoYSwgYikgPT4gXG4gICAgICAgICAgICBuZXcgRGF0ZShiLmxhc3RBY3Rpdml0eSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5sYXN0QWN0aXZpdHkpLmdldFRpbWUoKVxuICAgICAgICAgICk7XG4gICAgICAgICAgXG4gICAgICAgICAgc2V0U2Vzc2lvbnMoc29ydGVkU2Vzc2lvbnMpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFRyeSB0byByZXN0b3JlIGxhc3QgYWN0aXZlIHNlc3Npb24gZnJvbSBsb2NhbFN0b3JhZ2VcbiAgICAgICAgICBjb25zdCBzYXZlZFNlc3Npb25JZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY3RpdmVTZXNzaW9uSWQnKTtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uRXhpc3RzID0gc29ydGVkU2Vzc2lvbnMuc29tZShzID0+IFxuICAgICAgICAgICAgcy5zZXNzaW9uX2lkID09PSBzYXZlZFNlc3Npb25JZCB8fCBzLmlkID09PSBzYXZlZFNlc3Npb25JZFxuICAgICAgICAgICk7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKHNhdmVkU2Vzc2lvbklkICYmIHNlc3Npb25FeGlzdHMpIHtcbiAgICAgICAgICAgIC8vIFJlc3RvcmUgcHJldmlvdXMgc2Vzc2lvblxuICAgICAgICAgICAgc2V0U2Vzc2lvbklkKHNhdmVkU2Vzc2lvbklkKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVHJ5IHRvIHJlc3RvcmUgbWVzc2FnZXMgZnJvbSBsb2NhbFN0b3JhZ2UgZmlyc3QgZm9yIGluc3RhbnQgZGlzcGxheVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3Qgc2F2ZWRNZXNzYWdlcyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBtZXNzYWdlc18ke3NhdmVkU2Vzc2lvbklkfWApO1xuICAgICAgICAgICAgICBpZiAoc2F2ZWRNZXNzYWdlcykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWRNZXNzYWdlcyA9IEpTT04ucGFyc2Uoc2F2ZWRNZXNzYWdlcyk7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgUmVzdG9yZWQgJHtwYXJzZWRNZXNzYWdlcy5sZW5ndGh9IG1lc3NhZ2VzIGZvciBzZXNzaW9uICR7c2F2ZWRTZXNzaW9uSWR9IGZyb20gbG9jYWxTdG9yYWdlYCk7XG4gICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlcyhwYXJzZWRNZXNzYWdlcyk7XG4gICAgICAgICAgICAgICAgICAvLyBNYXJrIHRoZXNlIG1lc3NhZ2VzIGFzIGZyb20gY2FjaGUsIHNvIGJhY2tlbmQgZmV0Y2ggd29uJ3QgcmVwbGFjZSB0aGVtIGlmIHRoZXkncmUgaWRlbnRpY2FsXG4gICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlc0Zyb21DYWNoZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgLy8gRW5zdXJlIHRoZSBhY3RpdmUgc2Vzc2lvbiBJRCBpcyBzYXZlZCBpbiBsb2NhbFN0b3JhZ2VcbiAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVTZXNzaW9uSWQnLCBzYXZlZFNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIHNhdmVkIG1lc3NhZ2VzOicsIHBhcnNlRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgLy8gSWYgcGFyc2luZyBmYWlscywgd2UnbGwgcmVseSBzb2xlbHkgb24gYmFja2VuZCBkYXRhXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBhY2Nlc3MgbG9jYWxTdG9yYWdlOicsIGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTdGlsbCBsb2FkIG1lc3NhZ2VzIGZyb20gYmFja2VuZCBmb3IgbGF0ZXN0IHVwZGF0ZXNcbiAgICAgICAgICAgIGxvYWRTZXNzaW9uTWVzc2FnZXMoc2F2ZWRTZXNzaW9uSWQpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoc29ydGVkU2Vzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgLy8gU2VsZWN0IGZpcnN0IHNlc3Npb24gaWYgYXZhaWxhYmxlXG4gICAgICAgICAgICBzZXRTZXNzaW9uSWQoc29ydGVkU2Vzc2lvbnNbMF0uc2Vzc2lvbl9pZCB8fCBzb3J0ZWRTZXNzaW9uc1swXS5pZCk7XG4gICAgICAgICAgICAvLyBMb2FkIG1lc3NhZ2VzIGZvciB0aGlzIHNlc3Npb25cbiAgICAgICAgICAgIGxvYWRTZXNzaW9uTWVzc2FnZXMoc29ydGVkU2Vzc2lvbnNbMF0uc2Vzc2lvbl9pZCB8fCBzb3J0ZWRTZXNzaW9uc1swXS5pZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIElmIG5vIHNlc3Npb25zLCBjcmVhdGUgYSBkZWZhdWx0IHNlc3Npb25cbiAgICAgICAgICAgIGF3YWl0IGNyZWF0ZU5ld1Nlc3Npb24oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gSWYgbm8gc2Vzc2lvbnMgb3IgZXJyb3IsIGNyZWF0ZSBhIGRlZmF1bHQgc2Vzc2lvblxuICAgICAgICAgIGF3YWl0IGNyZWF0ZU5ld1Nlc3Npb24oKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIHNlc3Npb25zOicsIGVycik7XG4gICAgICAgIHNldEVycm9yKCdGYWlsZWQgdG8gbG9hZCBjaGF0IHNlc3Npb25zJyk7XG4gICAgICAgIC8vIElmIGVycm9yIGxvYWRpbmcgc2Vzc2lvbnMsIGNyZWF0ZSBhIGRlZmF1bHQgb25lXG4gICAgICAgIGF3YWl0IGNyZWF0ZU5ld1Nlc3Npb24oKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIGxvYWRTZXNzaW9ucygpO1xuICB9LCBbaXNBdXRoZW50aWNhdGVkLCB0b2tlbl0pOyAvLyBSZS1ydW4gd2hlbiBhdXRoIHN0YXRlIGNoYW5nZXNcblxuICAvLyBUcmFjayBpZiBtZXNzYWdlcyB3ZXJlIGxvYWRlZCBmcm9tIGNhY2hlIHRvIGhhbmRsZSBtZXJnaW5nIHdpdGggYmFja2VuZCBkYXRhXG4gIGNvbnN0IFttZXNzYWdlc0Zyb21DYWNoZSwgc2V0TWVzc2FnZXNGcm9tQ2FjaGVdID0gdXNlU3RhdGU8Ym9vbGVhbj4oZmFsc2UpO1xuXG4gIC8vIEZ1bmN0aW9uIHRvIGxvYWQgbWVzc2FnZXMgZm9yIGEgc2Vzc2lvbiAobWVtb2l6ZWQgd2l0aCB1c2VDYWxsYmFjaylcbiAgY29uc3QgbG9hZFNlc3Npb25NZXNzYWdlcyA9IHVzZUNhbGxiYWNrKGFzeW5jIChzaWQ6IHN0cmluZykgPT4ge1xuICAgIGlmICghc2lkIHx8ICFpc0F1dGhlbnRpY2F0ZWQpIHJldHVybjtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGxhc3QgPSBsYXN0SGlzdG9yeUxvYWRSZWYuY3VycmVudFtzaWRdIHx8IDA7XG4gICAgLy8gU2tpcCBpZiBjYWxsZWQgYWdhaW4gd2l0aGluIDgwMG1zIGZvciB0aGUgc2FtZSBzZXNzaW9uIHRvIGF2b2lkIGR1cGxpY2F0ZXNcbiAgICBpZiAobm93IC0gbGFzdCA8IDgwMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsYXN0SGlzdG9yeUxvYWRSZWYuY3VycmVudFtzaWRdID0gbm93O1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgY2FjaGVkIG1lc3NhZ2VzIGZpcnN0XG4gICAgY29uc3QgY2FjaGVkTWVzc2FnZXMgPSBsb2FkTWVzc2FnZXNGcm9tQ2FjaGUoc2lkKTtcbiAgICBjb25zdCBoYXNFeGlzdGluZ01lc3NhZ2VzID0gY2FjaGVkTWVzc2FnZXMubGVuZ3RoID4gMDtcbiAgICBcbiAgICAvLyBJZiB3ZSBoYXZlIGNhY2hlZCBtZXNzYWdlcywgdXNlIHRoZW0gaW1tZWRpYXRlbHlcbiAgICBpZiAoaGFzRXhpc3RpbmdNZXNzYWdlcykge1xuICAgICAgY29uc29sZS5sb2coJ1VzaW5nIGNhY2hlZCBtZXNzYWdlcyB3aGlsZSBiYWNrZW5kIGxvYWRzIGZvciBzZXNzaW9uOicsIHNpZCk7XG4gICAgICAvLyBPbmx5IHNldCBtZXNzYWdlcyBpZiB0aGV5J3JlIGRpZmZlcmVudCBmcm9tIGN1cnJlbnQgbWVzc2FnZXMgdG8gYXZvaWQgdW5uZWNlc3NhcnkgcmVuZGVyc1xuICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KGNhY2hlZE1lc3NhZ2VzKSAhPT0gSlNPTi5zdHJpbmdpZnkobWVzc2FnZXMpKSB7XG4gICAgICAgIHNldE1lc3NhZ2VzKGNhY2hlZE1lc3NhZ2VzKTtcbiAgICAgICAgLy8gTWFyayB0aGVzZSBtZXNzYWdlcyBhcyBmcm9tIGNhY2hlLCBzbyBiYWNrZW5kIGZldGNoIHdvbid0IHJlcGxhY2UgdGhlbSBpZiB0aGV5J3JlIGlkZW50aWNhbFxuICAgICAgICBzZXRNZXNzYWdlc0Zyb21DYWNoZSh0cnVlKTtcbiAgICAgICAgLy8gRW5zdXJlIHRoZSBhY3RpdmUgc2Vzc2lvbiBpcyBzYXZlZCBpbiBsb2NhbFN0b3JhZ2VcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZVNlc3Npb25JZCcsIHNpZCk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHRyeSB7XG4gICAgICBzZXRFcnJvcignJyk7XG4gICAgICAvLyBHZXQgdGhlIGF1dGggdG9rZW4gdG8gZW5zdXJlIHdlJ3JlIHVzaW5nIHRoZSBjdXJyZW50IG9uZVxuICAgICAgY29uc3QgY3VycmVudFRva2VuID0gZ2V0QXV0aFRva2VuKCk7XG4gICAgICBpZiAoIWN1cnJlbnRUb2tlbikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdObyBhdXRoIHRva2VuIGF2YWlsYWJsZScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IHsgZGF0YSwgc3VjY2VzcyB9ID0gYXdhaXQgYXBpLmdldChBUElfRU5EUE9JTlRTLkNIQVQuSElTVE9SWShzaWQpKTtcbiAgICAgIFxuICAgICAgaWYgKHN1Y2Nlc3MgJiYgZGF0YSAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgIC8vIENvbnZlcnQgbWVzc2FnZXMgdG8gb3VyIGV4cGVjdGVkIGZvcm1hdFxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRNZXNzYWdlcyA9IGRhdGEubWFwKChtc2c6IGFueSkgPT4ge1xuICAgICAgICAgIC8vIEhhbmRsZSBkaWZmZXJlbnQgcG9zc2libGUgbWVzc2FnZSBmb3JtYXRzXG4gICAgICAgICAgaWYgKG1zZy51c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzZW5kZXI6ICd1c2VyJyBhcyBjb25zdCwgdGV4dDogbXNnLnVzZXIsIHRpbWVzdGFtcDogbXNnLnRpbWVzdGFtcCB9O1xuICAgICAgICAgIH0gZWxzZSBpZiAobXNnLmJvdCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc2VuZGVyOiAnZ3JhY2UnIGFzIGNvbnN0LCB0ZXh0OiBtc2cuYm90LCB0aW1lc3RhbXA6IG1zZy50aW1lc3RhbXAgfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG1zZzsgLy8gQWxyZWFkeSBpbiBvdXIgZm9ybWF0XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIGJhY2tlbmQgcmV0dXJuZWQgbWVzc2FnZXNcbiAgICAgICAgaWYgKGZvcm1hdHRlZE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAvLyBJZiB3ZSBoYXZlIGNhY2hlZCBtZXNzYWdlcywgd2UgbmVlZCB0byBoYW5kbGUgbWVyZ2luZyBjYXJlZnVsbHlcbiAgICAgICAgICBpZiAoaGFzRXhpc3RpbmdNZXNzYWdlcykge1xuICAgICAgICAgICAgLy8gSWYgYmFja2VuZCBoYXMgbW9yZSBtZXNzYWdlcyB0aGFuIGNhY2hlLCB1c2UgYmFja2VuZCBkYXRhXG4gICAgICAgICAgICBpZiAoZm9ybWF0dGVkTWVzc2FnZXMubGVuZ3RoID4gY2FjaGVkTWVzc2FnZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdCYWNrZW5kIGhhcyBtb3JlIG1lc3NhZ2VzIHRoYW4gY2FjaGUsIHVwZGF0aW5nJyk7XG4gICAgICAgICAgICAgIHNldE1lc3NhZ2VzKGZvcm1hdHRlZE1lc3NhZ2VzKTtcbiAgICAgICAgICAgICAgcGVyc2lzdE1lc3NhZ2VzKHNpZCwgZm9ybWF0dGVkTWVzc2FnZXMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIGFueSBsb2NhbCBtZXNzYWdlcyB0aGF0IG1pZ2h0IG5vdCBoYXZlIHN5bmNlZCB5ZXRcbiAgICAgICAgICAgICAgY29uc3QgbGFzdFNlcnZlck1lc3NhZ2VUaW1lID0gZm9ybWF0dGVkTWVzc2FnZXMubGVuZ3RoID4gMCA/IFxuICAgICAgICAgICAgICAgIG5ldyBEYXRlKGZvcm1hdHRlZE1lc3NhZ2VzW2Zvcm1hdHRlZE1lc3NhZ2VzLmxlbmd0aCAtIDFdLnRpbWVzdGFtcCkuZ2V0VGltZSgpIDogMDtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIEtlZXAgbG9jYWwgbWVzc2FnZXMgc2VudCBhZnRlciB0aGUgbGFzdCBzZXJ2ZXIgbWVzc2FnZVxuICAgICAgICAgICAgICBjb25zdCBsb2NhbE5ld01lc3NhZ2VzID0gY2FjaGVkTWVzc2FnZXMuZmlsdGVyKG0gPT4gXG4gICAgICAgICAgICAgICAgbmV3IERhdGUobS50aW1lc3RhbXAgfHwgRGF0ZS5ub3coKSkuZ2V0VGltZSgpID4gbGFzdFNlcnZlck1lc3NhZ2VUaW1lXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAvLyBDb21iaW5lIHNlcnZlciBtZXNzYWdlcyB3aXRoIGFueSBuZXdlciBsb2NhbCBvbmVzXG4gICAgICAgICAgICAgIGlmIChsb2NhbE5ld01lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTWVyZ2luZyBiYWNrZW5kIG1lc3NhZ2VzIHdpdGggbG9jYWwgbWVzc2FnZXMnKTtcbiAgICAgICAgICAgICAgICBjb25zdCBtZXJnZWRNZXNzYWdlcyA9IFsuLi5mb3JtYXR0ZWRNZXNzYWdlcywgLi4ubG9jYWxOZXdNZXNzYWdlc107XG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZXMobWVyZ2VkTWVzc2FnZXMpO1xuICAgICAgICAgICAgICAgIHBlcnNpc3RNZXNzYWdlcyhzaWQsIG1lcmdlZE1lc3NhZ2VzKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChKU09OLnN0cmluZ2lmeShmb3JtYXR0ZWRNZXNzYWdlcykgIT09IEpTT04uc3RyaW5naWZ5KGNhY2hlZE1lc3NhZ2VzKSkge1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgdXBkYXRlIGlmIGRpZmZlcmVudCB0byBhdm9pZCB1bm5lY2Vzc2FyeSByZW5kZXJzXG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZXMoZm9ybWF0dGVkTWVzc2FnZXMpO1xuICAgICAgICAgICAgICAgIHBlcnNpc3RNZXNzYWdlcyhzaWQsIGZvcm1hdHRlZE1lc3NhZ2VzKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBObyBjYWNoZSwgdXNlIGJhY2tlbmQgZGF0YVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NldHRpbmcgbWVzc2FnZXMgZnJvbSBiYWNrZW5kLCBubyBjYWNoZSBhdmFpbGFibGUnKTtcbiAgICAgICAgICAgIHNldE1lc3NhZ2VzKGZvcm1hdHRlZE1lc3NhZ2VzKTtcbiAgICAgICAgICAgIHBlcnNpc3RNZXNzYWdlcyhzaWQsIGZvcm1hdHRlZE1lc3NhZ2VzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoIWhhc0V4aXN0aW5nTWVzc2FnZXMpIHtcbiAgICAgICAgICAvLyBCYWNrZW5kIHJldHVybmVkIGVtcHR5IGFuZCB3ZSBoYXZlIG5vIGNhY2hlXG4gICAgICAgICAgc2V0TWVzc2FnZXMoW10pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gbG9hZCBtZXNzYWdlcyBmb3Igc2Vzc2lvbiAke3NpZH06YCwgZXJyKTtcbiAgICAgIC8vIElmIHdlIGhhdmUgY2FjaGVkIG1lc3NhZ2VzLCBrZWVwIHVzaW5nIHRoZW0gb24gZXJyb3JcbiAgICAgIGlmICghaGFzRXhpc3RpbmdNZXNzYWdlcykge1xuICAgICAgICBzZXRNZXNzYWdlcyhbXSk7XG4gICAgICB9XG4gICAgfVxuICB9LCBbaXNBdXRoZW50aWNhdGVkXSk7XG5cbiAgLy8gTG9hZCBtZXNzYWdlcyB3aGVuIHNlc3Npb24gSUQgY2hhbmdlc1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIElmIGFueSByZXF1aXJlZCBjb25kaXRpb24gaXMgbWlzc2luZywgcmV0dXJuIGVhcmx5XG4gICAgaWYgKCFzZXNzaW9uSWQgfHwgIWlzQXV0aGVudGljYXRlZCB8fCAhc2Vzc2lvbnNMb2FkZWQpIHJldHVybjtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnU2Vzc2lvbiBJRCBjaGFuZ2VkLCBsb2FkaW5nIG1lc3NhZ2VzIGZvcjonLCBzZXNzaW9uSWQpO1xuICAgIFxuICAgIC8vIFN0b3JlIGN1cnJlbnQgc2Vzc2lvbiBJRCBpbiBsb2NhbFN0b3JhZ2UgdG8gcGVyc2lzdCBhY3Jvc3MgcGFnZSBuYXZpZ2F0aW9uc1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVTZXNzaW9uSWQnLCBzZXNzaW9uSWQpO1xuICAgIFxuICAgIC8vIExvYWQgZnJvbSBiYWNrZW5kIChvdXIgdXBkYXRlZCBmdW5jdGlvbiBub3cgaGFuZGxlcyBjYWNoZSBwcm9wZXJseSlcbiAgICBsb2FkU2Vzc2lvbk1lc3NhZ2VzKHNlc3Npb25JZCk7XG4gIH0sIFtzZXNzaW9uSWQsIGxvYWRTZXNzaW9uTWVzc2FnZXMsIGlzQXV0aGVudGljYXRlZCwgc2Vzc2lvbnNMb2FkZWRdKTtcblxuICAvLyBPbiBjb21wb25lbnQgbW91bnQsIHRyeSB0byByZXN0b3JlIHRoZSBsYXN0IGFjdGl2ZSBzZXNzaW9uIGZyb20gbG9jYWxTdG9yYWdlXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgLy8gSWYgbm90IGF1dGhlbnRpY2F0ZWQgb3Igc2Vzc2lvbnMgbm90IGxvYWRlZCB5ZXQsIG9yIGFscmVhZHkgcmVzdG9yZWQsIHJldHVybiBlYXJseVxuICAgIGlmICghaXNBdXRoZW50aWNhdGVkIHx8ICFzZXNzaW9uc0xvYWRlZCB8fCByZXN0b3JlZE9uY2VSZWYuY3VycmVudCkgcmV0dXJuO1xuXG4gICAgY29uc29sZS5sb2coJ0F0dGVtcHRpbmcgdG8gcmVzdG9yZSBwcmV2aW91cyBzZXNzaW9uJyk7XG5cbiAgICAvLyBTb3J0IHNlc3Npb25zIGJ5IGxhc3QgYWN0aXZpdHkgb25seSBpZiBuZWVkZWRcbiAgICBjb25zdCBzb3J0ZWQgPSBbLi4uc2Vzc2lvbnNdLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIHJldHVybiBuZXcgRGF0ZShiLmxhc3RBY3Rpdml0eSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5sYXN0QWN0aXZpdHkpLmdldFRpbWUoKTtcbiAgICB9KTtcblxuICAgIC8vIE9ubHkgdXBkYXRlIHNlc3Npb25zIGlmIHRoZSBvcmRlciBhY3R1YWxseSBjaGFuZ2VkIHRvIGF2b2lkIGxvb3BzXG4gICAgY29uc3Qgb3JkZXJDaGFuZ2VkID0gSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbnMubWFwKHMgPT4gcy5zZXNzaW9uX2lkIHx8IHMuaWQpKSAhPT0gSlNPTi5zdHJpbmdpZnkoc29ydGVkLm1hcChzID0+IHMuc2Vzc2lvbl9pZCB8fCBzLmlkKSk7XG4gICAgaWYgKG9yZGVyQ2hhbmdlZCkge1xuICAgICAgc2V0U2Vzc2lvbnMoc29ydGVkKTtcbiAgICB9XG5cbiAgICAvLyBUcnkgdG8gcmVzdG9yZSBwcmV2aW91cyBzZXNzaW9uIGlmIGF2YWlsYWJsZVxuICAgIGNvbnN0IHNhdmVkU2Vzc2lvbklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjdGl2ZVNlc3Npb25JZCcpO1xuXG4gICAgaWYgKHNhdmVkU2Vzc2lvbklkICYmIHNvcnRlZC5zb21lKHMgPT4gKHMuc2Vzc2lvbl9pZCB8fCBzLmlkKSA9PT0gc2F2ZWRTZXNzaW9uSWQpKSB7XG4gICAgICBjb25zb2xlLmxvZygnRm91bmQgcHJldmlvdXMgc2Vzc2lvbiBpbiBsb2FkZWQgc2Vzc2lvbnM6Jywgc2F2ZWRTZXNzaW9uSWQpO1xuICAgICAgc2V0U2Vzc2lvbklkKHNhdmVkU2Vzc2lvbklkKTtcbiAgICB9IGVsc2UgaWYgKHNvcnRlZC5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gc2F2ZWQgc2Vzc2lvbiBmb3VuZCwgc2VsZWN0aW5nIG1vc3QgcmVjZW50IHNlc3Npb24nKTtcbiAgICAgIHNldFNlc3Npb25JZChzb3J0ZWRbMF0uc2Vzc2lvbl9pZCB8fCBzb3J0ZWRbMF0uaWQpO1xuICAgIH1cblxuICAgIC8vIE1hcmsgcmVzdG9yYXRpb24gYXMgZG9uZSB0byBwcmV2ZW50IHJlcGVhdGluZ1xuICAgIHJlc3RvcmVkT25jZVJlZi5jdXJyZW50ID0gdHJ1ZTtcbiAgfSwgW2lzQXV0aGVudGljYXRlZCwgc2Vzc2lvbnNMb2FkZWRdKTtcblxuICAvLyBTY3JvbGwgdG8gYm90dG9tIHdoZW5ldmVyIG1lc3NhZ2VzIGNoYW5nZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIC8vIFNjcm9sbCB0byBib3R0b20gb2YgbWVzc2FnZXNcbiAgICBpZiAobWVzc2FnZXNFbmRSZWYuY3VycmVudCkge1xuICAgICAgLy8gVXNlIGEgc21hbGwgdGltZW91dCB0byBlbnN1cmUgdGhlIERPTSBoYXMgdXBkYXRlZFxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIG1lc3NhZ2VzRW5kUmVmLmN1cnJlbnQ/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6ICdzbW9vdGgnIH0pO1xuICAgICAgfSwgMTAwKTtcbiAgICB9XG4gICAgXG4gICAgLy8gU3RvcmUgbWVzc2FnZXMgaW4gbG9jYWxTdG9yYWdlIHVzaW5nIG91ciBoZWxwZXIgZnVuY3Rpb25cbiAgICBpZiAoc2Vzc2lvbklkICYmIG1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIHBlcnNpc3RNZXNzYWdlcyhzZXNzaW9uSWQsIG1lc3NhZ2VzKTtcbiAgICB9XG4gIH0sIFttZXNzYWdlcywgc2Vzc2lvbklkXSk7XG5cbiAgLy8gUmVmcmVzaCBzZXNzaW9ucyBsaXN0IGZyb20gYmFja2VuZCAobWVtb2l6ZWQgd2l0aCB1c2VDYWxsYmFjaylcbiAgY29uc3QgcmVmcmVzaFNlc3Npb25zID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGlmICghaXNBdXRoZW50aWNhdGVkKSByZXR1cm47XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgZGF0YSwgc3VjY2VzcyB9ID0gYXdhaXQgYXBpLmdldChBUElfRU5EUE9JTlRTLkNIQVQuU0VTU0lPTlMpO1xuICAgICAgXG4gICAgICBpZiAoc3VjY2VzcyAmJiBBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgICAgIC8vIFNvcnQgc2Vzc2lvbnMgYnkgbGFzdEFjdGl2aXR5LCBuZXdlc3QgZmlyc3RcbiAgICAgICAgY29uc3Qgc29ydGVkU2Vzc2lvbnMgPSBbLi4uZGF0YV0uc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShiLmxhc3RBY3Rpdml0eSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5sYXN0QWN0aXZpdHkpLmdldFRpbWUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBzZXRTZXNzaW9ucyhzb3J0ZWRTZXNzaW9ucyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVmcmVzaCBzZXNzaW9uczonLCBlcnIpO1xuICAgIH1cbiAgfSwgW2lzQXV0aGVudGljYXRlZF0pO1xuXG4gIC8vIENyZWF0ZSBhIG5ldyBzZXNzaW9uIHdpdGggYmFja2VuZCAobWVtb2l6ZWQgd2l0aCB1c2VDYWxsYmFjaylcbiAgY29uc3QgY3JlYXRlTmV3U2Vzc2lvbiA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICBpZiAoIWlzQXV0aGVudGljYXRlZCkgcmV0dXJuO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBzZXRFcnJvcignJyk7XG4gICAgICBjb25zdCB7IGRhdGEsIHN1Y2Nlc3MgfSA9IGF3YWl0IGFwaS5wb3N0KEFQSV9FTkRQT0lOVFMuQ0hBVC5ORVdfU0VTU0lPTiwge30pO1xuICAgICAgXG4gICAgICBpZiAoc3VjY2VzcyAmJiBkYXRhKSB7XG4gICAgICAgIGNvbnN0IG5ld1Nlc3Npb24gPSB7XG4gICAgICAgICAgaWQ6IGRhdGEuc2Vzc2lvbl9pZCxcbiAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUgfHwgJ05ldyBDb252ZXJzYXRpb24nLCAgLy8gQmV0dGVyIGRlZmF1bHQgbmFtZVxuICAgICAgICAgIGxhc3RBY3Rpdml0eTogZGF0YS5sYXN0QWN0aXZpdHkgfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIG1lc3NhZ2VzOiBbXSxcbiAgICAgICAgICBzZXNzaW9uX2lkOiBkYXRhLnNlc3Npb25faWQsXG4gICAgICAgICAgdG9waWM6IGRhdGEudG9waWMgfHwgJ05ldyBDb252ZXJzYXRpb24nICAvLyBCZXR0ZXIgZGVmYXVsdCB0b3BpY1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRvIGV4aXN0aW5nIHNlc3Npb25zXG4gICAgICAgIHNldFNlc3Npb25zKHByZXYgPT4gW25ld1Nlc3Npb24sIC4uLnByZXZdKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENsZWFyIG1lc3NhZ2VzIGZpcnN0XG4gICAgICAgIHNldE1lc3NhZ2VzKFtdKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCB0aGUgc2Vzc2lvbiBJRFxuICAgICAgICBzZXRTZXNzaW9uSWQobmV3U2Vzc2lvbi5zZXNzaW9uX2lkKTtcbiAgICAgICAgXG4gICAgICAgIC8vIERvIG5vdCBwZXJzaXN0IGVtcHR5IGNhY2hlIHRvIGF2b2lkIGxvb3BzXG4gICAgICAgIFxuICAgICAgICAvLyBTdG9yZSB0aGUgc2Vzc2lvbiBJRCBpbiBsb2NhbFN0b3JhZ2UgdG8gbWFpbnRhaW4gYWNyb3NzIHBhZ2UgbmF2aWdhdGlvbnNcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZVNlc3Npb25JZCcsIG5ld1Nlc3Npb24uc2Vzc2lvbl9pZCk7XG4gICAgICAgIFxuICAgICAgICAvLyBNYXJrIHRoaXMgc2Vzc2lvbiBhcyBsb2FkZWQgZnJvbSBjYWNoZSB0byBwcmV2ZW50IG92ZXJ3cml0aW5nXG4gICAgICAgIHNldE1lc3NhZ2VzRnJvbUNhY2hlKHRydWUpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG5ld1Nlc3Npb24uc2Vzc2lvbl9pZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIG5ldyBzZXNzaW9uOicsIGVycik7XG4gICAgICBzZXRFcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBuZXcgY2hhdCBzZXNzaW9uJyk7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBsb2NhbGx5IGlmIGJhY2tlbmQgZmFpbHNcbiAgICAgIC8vIFVzZSByYW5kb20gY29tcG9uZW50IGZvciBtb3JlIHVuaXF1ZW5lc3NcbiAgICAgIGNvbnN0IGZhbGxiYWNrSWQgPSBgc2Vzc2lvbi0ke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDkpfWA7XG4gICAgICBjb25zdCBmYWxsYmFja1Nlc3Npb24gPSB7XG4gICAgICAgIGlkOiBmYWxsYmFja0lkLFxuICAgICAgICBuYW1lOiAnTmV3IENvbnZlcnNhdGlvbicsICAvLyBCZXR0ZXIgZGVmYXVsdCBuYW1lXG4gICAgICAgIGxhc3RBY3Rpdml0eTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICBtZXNzYWdlczogW10sXG4gICAgICAgIHNlc3Npb25faWQ6IGZhbGxiYWNrSWQsXG4gICAgICAgIHRvcGljOiAnTmV3IENvbnZlcnNhdGlvbicgIC8vIEJldHRlciBkZWZhdWx0IHRvcGljXG4gICAgICB9O1xuICAgICAgXG4gICAgICBzZXRTZXNzaW9ucyhwcmV2ID0+IFtmYWxsYmFja1Nlc3Npb24sIC4uLnByZXZdKTtcbiAgICAgIFxuICAgICAgLy8gQ2xlYXIgbWVzc2FnZXMgZmlyc3RcbiAgICAgIHNldE1lc3NhZ2VzKFtdKTtcbiAgICAgIFxuICAgICAgLy8gU2V0IHRoZSBzZXNzaW9uIElEXG4gICAgICBzZXRTZXNzaW9uSWQoZmFsbGJhY2tJZCk7XG4gICAgICBcbiAgICAgIC8vIEluaXRpYWxpemUgZW1wdHkgY2FjaGUgZm9yIHRoaXMgc2Vzc2lvblxuICAgICAgLy8gRG8gbm90IHBlcnNpc3QgZW1wdHkgY2FjaGUgdG8gYXZvaWQgbG9vcHNcbiAgICAgIFxuICAgICAgLy8gU3RvcmUgZXZlbiBmYWxsYmFjayBzZXNzaW9uIElEXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWN0aXZlU2Vzc2lvbklkJywgZmFsbGJhY2tJZCk7XG4gICAgICBcbiAgICAgIC8vIE1hcmsgdGhpcyBzZXNzaW9uIGFzIGxvYWRlZCBmcm9tIGNhY2hlIHRvIHByZXZlbnQgb3ZlcndyaXRpbmdcbiAgICAgIHNldE1lc3NhZ2VzRnJvbUNhY2hlKHRydWUpO1xuICAgICAgXG4gICAgICByZXR1cm4gZmFsbGJhY2tJZDtcbiAgICB9XG4gIH0sIFtpc0F1dGhlbnRpY2F0ZWRdKTtcblxuXG4gIFxuICAvLyBTZW5kIGNoYXQgbWVzc2FnZSB3aXRoIHNlc3Npb24gSURcbiAgY29uc3Qgc2VuZE1lc3NhZ2UgPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFpbnB1dC50cmltKCkgfHwgIWlzQXV0aGVudGljYXRlZCB8fCAhc2Vzc2lvbklkKSByZXR1cm47XG4gICAgXG4gICAgLy8gQ3JlYXRlIGEgdGVtcCBtZXNzYWdlIG9iamVjdCB0byBzaG93IGltbWVkaWF0ZWx5XG4gICAgY29uc3QgdGVtcFVzZXJNZXNzYWdlOiBDaGF0TWVzc2FnZSA9IHtcbiAgICAgIHNlbmRlcjogJ3VzZXInLFxuICAgICAgdGV4dDogaW5wdXQsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gICAgXG4gICAgLy8gQ3JlYXRlIHVwZGF0ZWQgbWVzc2FnZXMgYXJyYXkgd2l0aCB0aGUgbmV3IG1lc3NhZ2VcbiAgICBjb25zdCB1cGRhdGVkTWVzc2FnZXMgPSBbLi4ubWVzc2FnZXMsIHRlbXBVc2VyTWVzc2FnZV07XG4gICAgXG4gICAgLy8gUGVyc2lzdCBtZXNzYWdlcyB0byBsb2NhbFN0b3JhZ2UgaW1tZWRpYXRlbHkgLSBkbyB0aGlzIEJFRk9SRSBzdGF0ZSB1cGRhdGVcbiAgICAvLyB0byBhdm9pZCBwb3RlbnRpYWwgcmFjZSBjb25kaXRpb25zXG4gICAgcGVyc2lzdE1lc3NhZ2VzKHNlc3Npb25JZCwgdXBkYXRlZE1lc3NhZ2VzKTtcbiAgICBcbiAgICAvLyBFbnN1cmUgdGhlIGFjdGl2ZSBzZXNzaW9uIElEIGlzIHNhdmVkIGluIGxvY2FsU3RvcmFnZVxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVTZXNzaW9uSWQnLCBzZXNzaW9uSWQpO1xuICAgIFxuICAgIC8vIEFkZCB0byBVSSBpbW1lZGlhdGVseVxuICAgIHNldE1lc3NhZ2VzKHVwZGF0ZWRNZXNzYWdlcyk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgcHJlbGltaW5hcnkgdG9waWMgZnJvbSBmaXJzdCBtZXNzYWdlIGlmIG5lZWRlZFxuICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gc2Vzc2lvbnMuZmluZChzID0+IHMuc2Vzc2lvbl9pZCA9PT0gc2Vzc2lvbklkIHx8IHMuaWQgPT09IHNlc3Npb25JZCk7XG4gICAgY29uc3QgaXNHZW5lcmljVG9waWMgPSBjdXJyZW50U2Vzc2lvbiAmJiAoXG4gICAgICAhY3VycmVudFNlc3Npb24udG9waWMgfHwgXG4gICAgICBjdXJyZW50U2Vzc2lvbi50b3BpYyA9PT0gJ05ldyBDb252ZXJzYXRpb24nIHx8IFxuICAgICAgY3VycmVudFNlc3Npb24udG9waWMuc3RhcnRzV2l0aCgnQ2hhdCAnKSB8fFxuICAgICAgY3VycmVudFNlc3Npb24udG9waWMuc3RhcnRzV2l0aCgnQ29udmVyc2F0aW9uICcpXG4gICAgKTtcbiAgICBcbiAgICBpZiAobWVzc2FnZXMubGVuZ3RoID09PSAwICYmIGlzR2VuZXJpY1RvcGljICYmIGlucHV0KSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBtZXNzYWdlLCB1c2UgaXQgdG8gY3JlYXRlIGEgcHJlbGltaW5hcnkgdG9waWNcbiAgICAgICAgY29uc3QgcHJlbGltVG9waWMgPSBnZW5lcmF0ZVNpbXBsZVRvcGljRnJvbU1lc3NhZ2UoaW5wdXQpO1xuICAgICAgICAvLyBVcGRhdGUgc2Vzc2lvbiB3aXRoIGEgbWVhbmluZ2Z1bCBuYW1lIGJhc2VkIG9uIGZpcnN0IG1lc3NhZ2VcbiAgICAgICAgY29uc3QgdXBkYXRlZFNlc3Npb25zID0gc2Vzc2lvbnMubWFwKHMgPT4gXG4gICAgICAgICAgKHMuc2Vzc2lvbl9pZCA9PT0gc2Vzc2lvbklkIHx8IHMuaWQgPT09IHNlc3Npb25JZCkgXG4gICAgICAgICAgICA/IHsgLi4ucywgdG9waWM6IHByZWxpbVRvcGljLCBuYW1lOiBwcmVsaW1Ub3BpYyB9IFxuICAgICAgICAgICAgOiBzXG4gICAgICAgICk7XG4gICAgICAgIHNldFNlc3Npb25zKHVwZGF0ZWRTZXNzaW9ucyk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHNlc3Npb24gdG9waWM6JywgZSk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIENsZWFyIGlucHV0IGZpZWxkXG4gICAgc2V0SW5wdXQoJycpO1xuICAgIFxuICAgIC8vIFNldCBsb2FkaW5nIHN0YXRlXG4gICAgc2V0TG9hZGluZyh0cnVlKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gU2VuZCBtZXNzYWdlIHRvIEFQSVxuICAgICAgY29uc3QgeyBkYXRhLCBzdWNjZXNzIH0gPSBhd2FpdCBhcGkucG9zdChBUElfRU5EUE9JTlRTLkNIQVQuTUVTU0FHRSwge1xuICAgICAgICBzZXNzaW9uX2lkOiBzZXNzaW9uSWQsXG4gICAgICAgIG1lc3NhZ2U6IGlucHV0XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgaWYgKHN1Y2Nlc3MgJiYgZGF0YSkge1xuICAgICAgICAvLyBGb3JtYXQgdGhlIHJlc3BvbnNlIHRvIG1hdGNoIG91ciBtZXNzYWdlIHN0cnVjdHVyZVxuICAgICAgICBjb25zdCBib3RSZXNwb25zZTogQ2hhdE1lc3NhZ2UgPSB7XG4gICAgICAgICAgc2VuZGVyOiAnZ3JhY2UnLFxuICAgICAgICAgIHRleHQ6IGRhdGEucmVzcG9uc2UgfHwgJycsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZSBmaW5hbCBtZXNzYWdlcyBhcnJheSB3aXRoIGJvdGggdXNlciBtZXNzYWdlIGFuZCBib3QgcmVzcG9uc2VcbiAgICAgICAgY29uc3QgZmluYWxNZXNzYWdlcyA9IFsuLi51cGRhdGVkTWVzc2FnZXMsIGJvdFJlc3BvbnNlXTtcbiAgICAgICAgXG4gICAgICAgIC8vIFBlcnNpc3QgdGhlIGNvbXBsZXRlIGNvbnZlcnNhdGlvbiBpbmNsdWRpbmcgYm90IHJlc3BvbnNlIC0gZG8gdGhpcyBCRUZPUkUgc3RhdGUgdXBkYXRlXG4gICAgICAgIC8vIHRvIGF2b2lkIHBvdGVudGlhbCByYWNlIGNvbmRpdGlvbnNcbiAgICAgICAgcGVyc2lzdE1lc3NhZ2VzKHNlc3Npb25JZCwgZmluYWxNZXNzYWdlcyk7XG4gICAgICAgIFxuICAgICAgICAvLyBFbnN1cmUgdGhlIGFjdGl2ZSBzZXNzaW9uIElEIGlzIHNhdmVkIGluIGxvY2FsU3RvcmFnZVxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWN0aXZlU2Vzc2lvbklkJywgc2Vzc2lvbklkKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCB0byBtZXNzYWdlc1xuICAgICAgICBzZXRNZXNzYWdlcyhmaW5hbE1lc3NhZ2VzKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlLXN5bmMgd2l0aCBzZXJ2ZXIgdG8gZW5zdXJlIHdlIGhhdmUgdGhlIGxhdGVzdCBkYXRhXG4gICAgICAgIGxvYWRTZXNzaW9uTWVzc2FnZXMoc2Vzc2lvbklkKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBzZXNzaW9uIGlmIHRoZSBzZXJ2ZXIgcHJvdmlkZXMgYSB0b3BpY1xuICAgICAgICBpZiAoZGF0YS50b3BpYykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBSZXBsYWNlIG91ciBwcmVsaW1pbmFyeSB0b3BpYyB3aXRoIHNlcnZlci1nZW5lcmF0ZWQgb25lXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkU2Vzc2lvbnMgPSBzZXNzaW9ucy5tYXAocyA9PiBcbiAgICAgICAgICAgICAgKHMuc2Vzc2lvbl9pZCA9PT0gc2Vzc2lvbklkIHx8IHMuaWQgPT09IHNlc3Npb25JZCkgXG4gICAgICAgICAgICAgICAgPyB7IC4uLnMsIHRvcGljOiBkYXRhLnRvcGljLCBuYW1lOiBkYXRhLnRvcGljIH0gXG4gICAgICAgICAgICAgICAgOiBzXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgc2V0U2Vzc2lvbnModXBkYXRlZFNlc3Npb25zKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBzZXNzaW9uIHdpdGggc2VydmVyIHRvcGljOicsIGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0RXJyb3IoJ0ZhaWxlZCB0byBnZXQgcmVzcG9uc2UnKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzZW5kIG1lc3NhZ2U6JywgZXJyKTtcbiAgICAgIHNldEVycm9yKCdGYWlsZWQgdG8gc2VuZCBtZXNzYWdlJyk7XG4gICAgICBcbiAgICAgIC8vIEV2ZW4gaWYgdGhlcmUncyBhbiBlcnJvciwgd2Ugc2hvdWxkIHN0aWxsIHNob3cgdGhlIHVzZXIncyBtZXNzYWdlXG4gICAgICAvLyBUaGlzIGVuc3VyZXMgdGhlIHVzZXIgY2FuIHNlZSB0aGVpciBtZXNzYWdlIGV2ZW4gaWYgR3JhY2UgZG9lc24ndCByZXNwb25kXG4gICAgICAvLyBQZXJzaXN0IG1lc3NhZ2VzIHRvIGxvY2FsU3RvcmFnZSBmaXJzdCB0byBhdm9pZCByYWNlIGNvbmRpdGlvbnNcbiAgICAgIHBlcnNpc3RNZXNzYWdlcyhzZXNzaW9uSWQsIHVwZGF0ZWRNZXNzYWdlcyk7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWN0aXZlU2Vzc2lvbklkJywgc2Vzc2lvbklkKTtcbiAgICAgIHNldE1lc3NhZ2VzKHVwZGF0ZWRNZXNzYWdlcyk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldExvYWRpbmcoZmFsc2UpO1xuICAgICAgXG4gICAgICAvLyBFbnN1cmUgd2Ugc2Nyb2xsIHRvIHRoZSBsYXRlc3QgbWVzc2FnZSB3aXRoIGEgc21hbGwgZGVsYXkgdG8gZW5zdXJlIERPTSB1cGRhdGVcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAobWVzc2FnZXNFbmRSZWYuY3VycmVudCkge1xuICAgICAgICAgIG1lc3NhZ2VzRW5kUmVmLmN1cnJlbnQuc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogJ3Ntb290aCcgfSk7XG4gICAgICAgIH1cbiAgICAgIH0sIDEwMCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIFN0YXRlIGZvciBtb2JpbGUgc2lkZWJhciB2aXNpYmlsaXR5XG4gIGNvbnN0IFtzaWRlYmFyVmlzaWJsZSwgc2V0U2lkZWJhclZpc2libGVdID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIC8vIC4uLiAocmVzdCBvZiB0aGUgY29kZSByZW1haW5zIHRoZSBzYW1lKVxuICAvLyBUb2dnbGUgc2lkZWJhciBvbiBtb2JpbGVcbiAgY29uc3QgdG9nZ2xlU2lkZWJhciA9ICgpID0+IHtcbiAgICBzZXRTaWRlYmFyVmlzaWJsZSghc2lkZWJhclZpc2libGUpO1xuICB9O1xuICBcbiAgLy8gU2ltcGxlIGZ1bmN0aW9uIHRvIHJlbmFtZSBhIGNoYXQgc2Vzc2lvblxuICBjb25zdCBoYW5kbGVTZXNzaW9uUmVuYW1lID0gKHNlc3Npb25JZDogc3RyaW5nKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEZpbmQgdGhlIHNlc3Npb24gdG8gcmVuYW1lXG4gICAgICBjb25zdCBzZXNzaW9uID0gc2Vzc2lvbnMuZmluZChzID0+IHMuc2Vzc2lvbl9pZCA9PT0gc2Vzc2lvbklkIHx8IHMuaWQgPT09IHNlc3Npb25JZCk7XG4gICAgICBpZiAoIXNlc3Npb24pIHJldHVybjtcbiAgICAgIFxuICAgICAgLy8gR2V0IGN1cnJlbnQgbmFtZSB0byBzaG93IGFzIGRlZmF1bHRcbiAgICAgIGNvbnN0IGN1cnJlbnROYW1lID0gc2Vzc2lvbi50b3BpYyB8fCBzZXNzaW9uLm5hbWUgfHwgYENoYXQgJHtzZXNzaW9uSWQuc2xpY2UoMCwgNil9YDtcbiAgICAgIFxuICAgICAgLy8gUHJvbXB0IGZvciBuZXcgbmFtZVxuICAgICAgY29uc3QgbmV3TmFtZSA9IHByb21wdCgnRW50ZXIgYSBuZXcgbmFtZSBmb3IgdGhpcyBjaGF0OicsIGN1cnJlbnROYW1lKTtcbiAgICAgIFxuICAgICAgLy8gVXBkYXRlIGlmIG5hbWUgcHJvdmlkZWRcbiAgICAgIGlmIChuZXdOYW1lICYmIG5ld05hbWUudHJpbSgpICYmIG5ld05hbWUgIT09IGN1cnJlbnROYW1lKSB7XG4gICAgICAgIC8vIFVwZGF0ZSBsb2NhbGx5XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRTZXNzaW9ucyA9IHNlc3Npb25zLm1hcChzID0+IFxuICAgICAgICAgIChzLnNlc3Npb25faWQgPT09IHNlc3Npb25JZCB8fCBzLmlkID09PSBzZXNzaW9uSWQpIFxuICAgICAgICAgICAgPyB7IC4uLnMsIHRvcGljOiBuZXdOYW1lLnRyaW0oKSwgbmFtZTogbmV3TmFtZS50cmltKCkgfSBcbiAgICAgICAgICAgIDogc1xuICAgICAgICApO1xuICAgICAgICBzZXRTZXNzaW9ucyh1cGRhdGVkU2Vzc2lvbnMpO1xuICAgICAgICBcbiAgICAgICAgLy8gTm90ZTogSW4gYSBmdWxsIGltcGxlbWVudGF0aW9uLCB5b3Ugd291bGQgYWxzbyB1cGRhdGUgdGhlIHNlcnZlclxuICAgICAgICAvLyBCdXQgZm9yIHRoaXMgbWluaW1hbCBpbXByb3ZlbWVudCwgd2UncmUganVzdCB1cGRhdGluZyB0aGUgVUlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW5hbWluZyBzZXNzaW9uOicsIGUpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBoLVtjYWxjKDEwMHZoLTE2cmVtKV0gb3ZlcmZsb3ctaGlkZGVuIHJvdW5kZWQtbGcgYm9yZGVyIGJvcmRlci1yZWQtNzAwXCI+XG4gICAgICAgIHsvKiBNb2JpbGUgc2lkZWJhciB0b2dnbGUgYnV0dG9uICovfVxuICAgICAgICA8YnV0dG9uIFxuICAgICAgICAgIGNsYXNzTmFtZT1cIm1kOmhpZGRlbiBhYnNvbHV0ZSB0b3AtMiBsZWZ0LTIgei0xMCBiZy1yZWQtODAwIHJvdW5kZWQtZnVsbCBwLTIgdGV4dC13aGl0ZSBzaGFkb3ctbWRcIlxuICAgICAgICAgIG9uQ2xpY2s9e3RvZ2dsZVNpZGViYXJ9XG4gICAgICAgID5cbiAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBjbGFzc05hbWU9XCJoLTUgdy01XCIgdmlld0JveD1cIjAgMCAyMCAyMFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIj5cbiAgICAgICAgICAgIDxwYXRoIGZpbGxSdWxlPVwiZXZlbm9kZFwiIGQ9XCJNMyA1YTEgMSAwIDAxMS0xaDEyYTEgMSAwIDExMCAySDRhMSAxIDAgMDEtMS0xem0wIDVhMSAxIDAgMDExLTFoMTJhMSAxIDAgMTEwIDJINGExIDEgMCAwMS0xLTF6bTAgNWExIDEgMCAwMTEtMWgxMmExIDEgMCAxMTAgMkg0YTEgMSAwIDAxLTEtMXpcIiBjbGlwUnVsZT1cImV2ZW5vZGRcIiAvPlxuICAgICAgICAgIDwvc3ZnPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgXG4gICAgICAgIHsvKiBTaWRlYmFyIC0gcmVzcG9uc2l2ZSB3aXRoIG1kOiBicmVha3BvaW50ICovfVxuICAgICAgICA8YXNpZGUgY2xhc3NOYW1lPXtgJHtzaWRlYmFyVmlzaWJsZSA/ICdibG9jaycgOiAnaGlkZGVuJ30gbWQ6YmxvY2sgYWJzb2x1dGUgbWQ6cmVsYXRpdmUgbWQ6dy02NCB3LTMvNCBiZy1ibGFjayBib3JkZXItciBib3JkZXItcmVkLTgwMCBwLTQgb3ZlcmZsb3cteS1hdXRvIGgtZnVsbCB6LTEwYH0+XG4gICAgICAgICAgPGgyIGNsYXNzTmFtZT1cInRleHQtcmVkLTMwMCB0ZXh0LWxnIGZvbnQtbW9ubyBtYi0yIGZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICAgICAgPHNwYW4+U2Vzc2lvbnM8L3NwYW4+XG4gICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9e3RvZ2dsZVNpZGViYXJ9IGNsYXNzTmFtZT1cIm1kOmhpZGRlbiB0ZXh0LXJlZC0zMDAgaG92ZXI6dGV4dC1yZWQtMTAwXCI+XG4gICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIGNsYXNzTmFtZT1cImgtNSB3LTVcIiB2aWV3Qm94PVwiMCAwIDIwIDIwXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiPlxuICAgICAgICAgICAgICAgIDxwYXRoIGZpbGxSdWxlPVwiZXZlbm9kZFwiIGQ9XCJNNC4yOTMgNC4yOTNhMSAxIDAgMDExLjQxNCAwTDEwIDguNTg2bDQuMjkzLTQuMjkzYTEgMSAwIDExMS40MTQgMS40MTRMMTEuNDE0IDEwbDQuMjkzIDQuMjkzYTEgMSAwIDAxLTEuNDE0IDEuNDE0TDEwIDExLjQxNGwtNC4yOTMgNC4yOTNhMSAxIDAgMDEtMS40MTQtMS40MTRMOC41ODYgMTAgNC4yOTMgNS43MDdhMSAxIDAgMDEwLTEuNDE0elwiIGNsaXBSdWxlPVwiZXZlbm9kZFwiIC8+XG4gICAgICAgICAgICAgIDwvc3ZnPlxuICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPC9oMj5cbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgIGNyZWF0ZU5ld1Nlc3Npb24oKTtcbiAgICAgICAgICAgICAgc2V0U2lkZWJhclZpc2libGUoZmFsc2UpO1xuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBtYi00IHJvdW5kZWQgYmctcmVkLTcwMCBweC00IHB5LTIgaG92ZXI6YmctcmVkLTkwMFwiXG4gICAgICAgICAgICBkaXNhYmxlZD17IWlzQXV0aGVudGljYXRlZCB8fCBsb2FkaW5nfVxuICAgICAgICAgID5cbiAgICAgICAgICAgICsgTmV3IENoYXRcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICBcbiAgICAgICAgICB7ZXJyb3IgJiYgPHAgY2xhc3NOYW1lPVwidGV4dC1yZWQtNTAwIHRleHQteHMgbWItMlwiPntlcnJvcn08L3A+fVxuICAgICAgICAgIFxuICAgICAgICAgIHshaXNBdXRoZW50aWNhdGVkICYmIChcbiAgICAgICAgICAgIDxwIGNsYXNzTmFtZT1cInRleHQteWVsbG93LTUwMCB0ZXh0LXhzIG1iLTJcIj5QbGVhc2UgbG9nIGluIHRvIHVzZSBjaGF0PC9wPlxuICAgICAgICAgICl9XG4gICAgICAgICAgPHVsIGNsYXNzTmFtZT1cInNwYWNlLXktMlwiPlxuICAgICAgICAgICAge3Nlc3Npb25zLm1hcCgocykgPT4ge1xuICAgICAgICAgICAgICAvLyBTYWZlbHkgZ2V0IHRoZSBzZXNzaW9uIElELCBjaGVja2luZyBib3RoIHNlc3Npb25faWQgYW5kIGlkXG4gICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uSWQgPSBzLnNlc3Npb25faWQgfHwgcy5pZDtcbiAgICAgICAgICAgICAgaWYgKCFjdXJyZW50U2Vzc2lvbklkKSByZXR1cm4gbnVsbDsgLy8gU2tpcCBpZiBubyB2YWxpZCBJRFxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8bGkga2V5PXtjdXJyZW50U2Vzc2lvbklkfSBjbGFzc05hbWU9XCJyZWxhdGl2ZSBncm91cFwiPlxuICAgICAgICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgY3VycmVudCBtZXNzYWdlcyBmaXJzdCB0byBhdm9pZCBVSSBmbGFzaGluZ1xuICAgICAgICAgICAgICAgICAgICAgIHNldE1lc3NhZ2VzKFtdKTtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHNlc3Npb24gSURcbiAgICAgICAgICAgICAgICAgICAgICBzZXRTZXNzaW9uSWQoY3VycmVudFNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgLy8gSW1tZWRpYXRlbHkgbG9hZCBtZXNzYWdlcyBmcm9tIGNhY2hlXG4gICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVkTWVzc2FnZXMgPSBsb2FkTWVzc2FnZXNGcm9tQ2FjaGUoY3VycmVudFNlc3Npb25JZCk7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGNhY2hlZE1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldE1lc3NhZ2VzKGNhY2hlZE1lc3NhZ2VzKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgLy8gU3RvcmUgdGhlIGFjdGl2ZSBzZXNzaW9uIElEXG4gICAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FjdGl2ZVNlc3Npb25JZCcsIGN1cnJlbnRTZXNzaW9uSWQpO1xuICAgICAgICAgICAgICAgICAgICAgIC8vIENsb3NlIHNpZGViYXIgb24gbW9iaWxlIGFmdGVyIHNlbGVjdGlvblxuICAgICAgICAgICAgICAgICAgICAgIHNldFNpZGViYXJWaXNpYmxlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgdy1mdWxsIHRleHQtbGVmdCBweC0zIHB5LTIgcm91bmRlZCB0ZXh0LXNtIGhvdmVyOmJnLXJlZC04MDAgJHtzZXNzaW9uSWQgPT09IGN1cnJlbnRTZXNzaW9uSWQgPyAnYmctcmVkLTkwMCB0ZXh0LXdoaXRlJyA6ICd0ZXh0LXJlZC0zMDAnfWB9XG4gICAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICAgIHsvKiBEaXNwbGF5IHRoZSB0b3BpYy9uYW1lIG9yIGdlbmVyYXRlIG9uZSBmcm9tIG1lc3NhZ2UgY29udGVudCAqL31cbiAgICAgICAgICAgICAgICAgICAge3MudG9waWMgfHwgcy5uYW1lIHx8IGBDaGF0ICR7Y3VycmVudFNlc3Npb25JZC5zbGljZSgwLCA2KX1gfVxuICAgICAgICAgICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pfVxuICAgICAgICAgIDwvdWw+XG4gICAgICAgIDwvYXNpZGU+XG5cbiAgICAgICAgey8qIENoYXQgV2luZG93ICovfVxuICAgICAgICB7LyogT3ZlcmxheSB0byBjbG9zZSBzaWRlYmFyIG9uIG1vYmlsZSB3aGVuIGNsaWNrZWQgb3V0c2lkZSAqL31cbiAgICAgICAge3NpZGViYXJWaXNpYmxlICYmIChcbiAgICAgICAgICA8ZGl2IFxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibWQ6aGlkZGVuIGZpeGVkIGluc2V0LTAgYmctYmxhY2sgYmctb3BhY2l0eS01MCB6LTBcIlxuICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2lkZWJhclZpc2libGUoZmFsc2UpfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIFxuICAgICAgICA8bWFpbiBjbGFzc05hbWU9XCJmbGV4LTEgYmctYmxhY2sgZmxleCBmbGV4LWNvbFwiPlxuICAgICAgICAgIDxkaXYgXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJmbGV4LTEgb3ZlcmZsb3cteS1hdXRvIHAtNiBzcGFjZS15LTRcIiBcbiAgICAgICAgICAgIG9uU2Nyb2xsPXtoYW5kbGVTY3JvbGx9XG4gICAgICAgICAgPlxuICAgICAgICAgICAge21lc3NhZ2VzLmxlbmd0aCA9PT0gMCAmJiAhbG9hZGluZyAmJiAoXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXIgdGV4dC1ncmF5LTUwMCBteS04XCI+XG4gICAgICAgICAgICAgICAge2lzQXV0aGVudGljYXRlZCA/ICdObyBtZXNzYWdlcyB5ZXQuIFN0YXJ0IGEgY29udmVyc2F0aW9uIScgOiAnUGxlYXNlIGxvZyBpbiB0byBzdGFydCBjaGF0dGluZyd9XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgey8qIFNob3cgbG9hZGluZyBpbmRpY2F0b3Igd2hlbiB3YWl0aW5nIGZvciBHcmFjZSdzIHJlc3BvbnNlICovfVxuICAgICAgICAgICAge2xvYWRpbmcgJiYgKFxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtY2VudGVyIHRleHQteWVsbG93LTUwMCBteS00IGFuaW1hdGUtcHVsc2VcIj5cbiAgICAgICAgICAgICAgICBHcmFjZSBpcyB0aGlua2luZy4uLlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHttZXNzYWdlcy5tYXAoKG1zZywgaWR4KSA9PiAoXG4gICAgICAgICAgICAgIDxkaXYga2V5PXtpZHh9IGNsYXNzTmFtZT1cIm1iLTRcIj5cbiAgICAgICAgICAgICAgICB7bXNnLnNlbmRlciA9PT0gJ3VzZXInIHx8IG1zZy51c2VyID8gKFxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LXJpZ2h0IHAtMiByb3VuZGVkLWxnIGJnLXJlZC05MDAvMzAgdGV4dC1yZWQtMzAwXCI+XG4gICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cImZvbnQtYm9sZFwiPllvdTo8L3NwYW4+IHttc2cudGV4dCB8fCBtc2cudXNlcn1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHttc2cuc2VuZGVyID09PSAnZ3JhY2UnIHx8IG1zZy5ib3QgPyAoXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRleHQtbGVmdCBwLTIgcm91bmRlZC1sZyBiZy1ncmVlbi05MDAvMzAgdGV4dC1ncmVlbi0zMDBcIj5cbiAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiZm9udC1ib2xkXCI+R3JhY2U6PC9zcGFuPiB7bXNnLnRleHQgfHwgbXNnLmJvdH1cbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB7LyogVGhpcyBlbXB0eSBkaXYgaXMgdXNlZCBhcyBhIHJlZmVyZW5jZSBmb3Igc2Nyb2xsaW5nIHRvIHRoZSBib3R0b20gKi99XG4gICAgICAgICAgICA8ZGl2IHJlZj17bWVzc2FnZXNFbmRSZWZ9IC8+XG4gICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgICA8Zm9vdGVyIGNsYXNzTmFtZT1cImZsZXggYm9yZGVyLXQgYm9yZGVyLXJlZC04MDAgYmctYmxhY2sgcC00XCI+XG4gICAgICAgICAgICA8dGV4dGFyZWFcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiZmxleC0xIG1yLTIgcm91bmRlZCBiZy13aGl0ZS8xMCBwLTIgdGV4dC13aGl0ZSBtaW4taC1bNjBweF0gcmVzaXplLW5vbmVcIlxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17aXNBdXRoZW50aWNhdGVkID8gXCJUeXBlIHlvdXIgbWVzc2FnZS4uLiAoU2hpZnQrRW50ZXIgZm9yIG5ldyBsaW5lKVwiIDogXCJQbGVhc2UgbG9nIGluIHRvIGNoYXRcIn1cbiAgICAgICAgICAgICAgdmFsdWU9e2lucHV0fVxuICAgICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldElucHV0KGUudGFyZ2V0LnZhbHVlKX1cbiAgICAgICAgICAgICAgb25LZXlEb3duPXsoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJyAmJiAhZS5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBQcmV2ZW50IGRlZmF1bHQgdG8gYXZvaWQgbmV3IGxpbmVcbiAgICAgICAgICAgICAgICAgIGlmICghbG9hZGluZyAmJiBpc0F1dGhlbnRpY2F0ZWQgJiYgaW5wdXQudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbmRNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBkaXNhYmxlZD17IWlzQXV0aGVudGljYXRlZCB8fCBsb2FkaW5nfVxuICAgICAgICAgICAgICBhdXRvRm9jdXNcbiAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cIkNoYXQgbWVzc2FnZSBpbnB1dFwiXG4gICAgICAgICAgICAgIHJlZj17KGVsKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRm9jdXMgd2hlbiBzZXNzaW9uIGNoYW5nZXNcbiAgICAgICAgICAgICAgICBpZiAoZWwgJiYgaXNBdXRoZW50aWNhdGVkICYmICFsb2FkaW5nKSB7XG4gICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGVsLmZvY3VzKCksIDEwMCk7IC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBpdCB3b3JrcyBhY3Jvc3MgYnJvd3NlcnNcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgICBvbkNsaWNrPXtzZW5kTWVzc2FnZX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e2xvYWRpbmcgfHwgIWlzQXV0aGVudGljYXRlZCB8fCAhaW5wdXQudHJpbSgpfVxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJyb3VuZGVkIGJnLXJlZC03MDAgcHgtNCBweS0yIGhvdmVyOmJnLXJlZC05MDAgZGlzYWJsZWQ6YmctZ3JheS03MDAgZGlzYWJsZWQ6Y3Vyc29yLW5vdC1hbGxvd2VkXCJcbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge2xvYWRpbmcgPyAnLi4uJyA6ICdTZW5kJ31cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgIDwvZm9vdGVyPlxuICAgICAgICAgIFxuICAgICAgICAgIHsvKiBYRmVlZCBTZWN0aW9uICovfVxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYm9yZGVyLXQgYm9yZGVyLXJlZC04MDAvNTAgcC00IGJnLWJsYWNrLzcwXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLXRyYW5zcGFyZW50IHRleHQtd2hpdGUgcC00XCI+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIG1iLTJcIj5cbiAgICAgICAgICAgICAgICA8aDMgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgdGV4dC1yZWQtNTAwIGZvbnQtYm9sZCByZWxhdGl2ZSBwbC00IGJlZm9yZTpjb250ZW50LVsnJ10gYmVmb3JlOmFic29sdXRlIGJlZm9yZTpsZWZ0LTAgYmVmb3JlOnRvcC0wIGJlZm9yZTpoLWZ1bGwgYmVmb3JlOnctMSBiZWZvcmU6YmctcmVkLTUwMFwiPlxuICAgICAgICAgICAgICAgICAgWEZlZWQgQ2hhbm5lbFxuICAgICAgICAgICAgICAgIDwvaDM+XG4gICAgICAgICAgICAgICAgey8qIERpcmVjdCBBZGQgQWNjb3VudCBCdXR0b24gKi99XG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBcbiAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRmluZCBhbmQgY2xpY2sgdGhlIHNldHRpbmdzIGJ1dHRvbiBpbiBYRmVlZFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZXR0aW5nc0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXhmZWVkLXNldHRpbmdzXScpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2V0dGluZ3NCdG4gJiYgc2V0dGluZ3NCdG4gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzQnRuLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ0ZXh0LXhzIHB4LTIgcHktMSByb3VuZGVkIGJnLXJlZC05MDAvNTAgdGV4dC1yZWQtMjAwIGhvdmVyOmJnLXJlZC04MDAgZmxleCBpdGVtcy1jZW50ZXIgc3BhY2UteC0xXCJcbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LWxnIGxlYWRpbmctbm9uZVwiPis8L3NwYW4+XG4gICAgICAgICAgICAgICAgICA8c3Bhbj5BZGQgQWNjb3VudDwvc3Bhbj5cbiAgICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxociBjbGFzc05hbWU9XCJib3JkZXItZ3JheS04MDAgbWItNFwiIC8+XG4gICAgICAgICAgICAgIDxYRmVlZCBtYXhJdGVtcz17M30gLz4gey8qIExpbWl0IHRvIDMgaXRlbXMgdG8ga2VlcCBpdCBjb21wYWN0ICovfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvbWFpbj5cbiAgICAgIDwvZGl2PlxuICApO1xufVxuIl0sIm5hbWVzIjpbIlJlYWN0IiwidXNlRWZmZWN0IiwidXNlU3RhdGUiLCJ1c2VSZWYiLCJ1c2VDYWxsYmFjayIsImFwaSIsIkFQSV9FTkRQT0lOVFMiLCJ1c2VBdXRoIiwiZ2V0QXV0aFRva2VuIiwidXNlQ2hhdFN0YXRlUGVyc2lzdGVuY2UiLCJYRmVlZCIsIkNoYXQiLCJ1c2VyIiwiaXNBdXRoZW50aWNhdGVkIiwidG9rZW4iLCJzZXNzaW9ucyIsInNldFNlc3Npb25zIiwic2Vzc2lvbklkIiwic2V0U2Vzc2lvbklkIiwibWVzc2FnZXMiLCJzZXRNZXNzYWdlcyIsImlucHV0Iiwic2V0SW5wdXQiLCJsb2FkaW5nIiwic2V0TG9hZGluZyIsImVycm9yIiwic2V0RXJyb3IiLCJzZXNzaW9uc0xvYWRlZCIsInNldFNlc3Npb25zTG9hZGVkIiwibWVzc2FnZXNFbmRSZWYiLCJpbml0aWFsaXplRnJvbVBlcnNpc3RlZFN0YXRlIiwiZ2V0U2F2ZWREcmFmdE1lc3NhZ2UiLCJ1cGRhdGVEcmFmdE1lc3NhZ2UiLCJzeW5jU2Nyb2xsUG9zaXRpb24iLCJnZXRTYXZlZFNjcm9sbFBvc2l0aW9uIiwiZ2VuZXJhdGVTaW1wbGVUb3BpY0Zyb21NZXNzYWdlIiwibWVzc2FnZSIsImZpcnN0U2VudGVuY2UiLCJzcGxpdCIsInRyaW0iLCJ0b3BpY1RleHQiLCJsZW5ndGgiLCJzdWJzdHJpbmciLCJlIiwiY29uc29sZSIsInBlcnNpc3RNZXNzYWdlcyIsInNpZCIsIm1zZ3MiLCJtZXNzYWdlc1RvU3RvcmUiLCJzbGljZSIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwibG9hZE1lc3NhZ2VzRnJvbUNhY2hlIiwic2F2ZWRNZXNzYWdlcyIsImdldEl0ZW0iLCJwYXJzZWRNZXNzYWdlcyIsInBhcnNlIiwiQXJyYXkiLCJpc0FycmF5IiwibG9nIiwiaXNNb3VudGVkUmVmIiwicmVzdG9yZWRPbmNlUmVmIiwibGFzdEhpc3RvcnlMb2FkUmVmIiwicmVzdG9yZWQiLCJzYXZlZERyYWZ0IiwiY3VycmVudCIsInNhdmVkUG9zaXRpb24iLCJzZXRUaW1lb3V0IiwiY2hhdENvbnRhaW5lciIsInBhcmVudEVsZW1lbnQiLCJpc05hTiIsInNjcm9sbFRvcCIsInNjcm9sbEludG9WaWV3IiwiYmVoYXZpb3IiLCJoYW5kbGVTY3JvbGwiLCJjdXJyZW50VGFyZ2V0IiwibG9hZFNlc3Npb25zIiwiYWN0aXZlU2Vzc2lvbklkcyIsImZvckVhY2giLCJyZW1vdmVJdGVtIiwiZGF0YSIsInN1Y2Nlc3MiLCJnZXQiLCJDSEFUIiwiU0VTU0lPTlMiLCJmb3JtYXR0ZWRTZXNzaW9ucyIsIm1hcCIsInMiLCJzZXNzaW9uTmFtZSIsInRvcGljIiwibmFtZSIsInByZXZpZXdfbWVzc2FnZSIsImZpcnN0TXNnIiwibXNnVGV4dCIsInRleHQiLCJsYXN0QWN0aXZpdHkiLCJjcmVhdGVkIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiaWQiLCJzZXNzaW9uX2lkIiwibGFzdF9hY3Rpdml0eSIsInNvcnRlZFNlc3Npb25zIiwic29ydCIsImEiLCJiIiwiZ2V0VGltZSIsInNhdmVkU2Vzc2lvbklkIiwic2Vzc2lvbkV4aXN0cyIsInNvbWUiLCJzZXRNZXNzYWdlc0Zyb21DYWNoZSIsInBhcnNlRXJyb3IiLCJsb2FkU2Vzc2lvbk1lc3NhZ2VzIiwiY3JlYXRlTmV3U2Vzc2lvbiIsImVyciIsIm1lc3NhZ2VzRnJvbUNhY2hlIiwibm93IiwibGFzdCIsImNhY2hlZE1lc3NhZ2VzIiwiaGFzRXhpc3RpbmdNZXNzYWdlcyIsImN1cnJlbnRUb2tlbiIsIkhJU1RPUlkiLCJmb3JtYXR0ZWRNZXNzYWdlcyIsIm1zZyIsInNlbmRlciIsInRpbWVzdGFtcCIsImJvdCIsImxhc3RTZXJ2ZXJNZXNzYWdlVGltZSIsImxvY2FsTmV3TWVzc2FnZXMiLCJmaWx0ZXIiLCJtIiwibWVyZ2VkTWVzc2FnZXMiLCJzb3J0ZWQiLCJvcmRlckNoYW5nZWQiLCJyZWZyZXNoU2Vzc2lvbnMiLCJwb3N0IiwiTkVXX1NFU1NJT04iLCJuZXdTZXNzaW9uIiwicHJldiIsIkVycm9yIiwiZmFsbGJhY2tJZCIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsImZhbGxiYWNrU2Vzc2lvbiIsInNlbmRNZXNzYWdlIiwidGVtcFVzZXJNZXNzYWdlIiwidXBkYXRlZE1lc3NhZ2VzIiwiY3VycmVudFNlc3Npb24iLCJmaW5kIiwiaXNHZW5lcmljVG9waWMiLCJzdGFydHNXaXRoIiwicHJlbGltVG9waWMiLCJ1cGRhdGVkU2Vzc2lvbnMiLCJNRVNTQUdFIiwiYm90UmVzcG9uc2UiLCJyZXNwb25zZSIsImZpbmFsTWVzc2FnZXMiLCJzaWRlYmFyVmlzaWJsZSIsInNldFNpZGViYXJWaXNpYmxlIiwidG9nZ2xlU2lkZWJhciIsImhhbmRsZVNlc3Npb25SZW5hbWUiLCJzZXNzaW9uIiwiY3VycmVudE5hbWUiLCJuZXdOYW1lIiwicHJvbXB0IiwiZGl2IiwiY2xhc3NOYW1lIiwiYnV0dG9uIiwib25DbGljayIsInN2ZyIsInhtbG5zIiwidmlld0JveCIsImZpbGwiLCJwYXRoIiwiZmlsbFJ1bGUiLCJkIiwiY2xpcFJ1bGUiLCJhc2lkZSIsImgyIiwic3BhbiIsImRpc2FibGVkIiwicCIsInVsIiwiY3VycmVudFNlc3Npb25JZCIsImxpIiwibWFpbiIsIm9uU2Nyb2xsIiwiaWR4IiwicmVmIiwiZm9vdGVyIiwidGV4dGFyZWEiLCJwbGFjZWhvbGRlciIsInZhbHVlIiwib25DaGFuZ2UiLCJ0YXJnZXQiLCJvbktleURvd24iLCJrZXkiLCJzaGlmdEtleSIsInByZXZlbnREZWZhdWx0IiwiYXV0b0ZvY3VzIiwiYXJpYS1sYWJlbCIsImVsIiwiZm9jdXMiLCJoMyIsInNldHRpbmdzQnRuIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiSFRNTEVsZW1lbnQiLCJjbGljayIsImhyIiwibWF4SXRlbXMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./pages/chat.tsx\n");

/***/ }),

/***/ "(pages-dir-node)/./styles/animations.css":
/*!*******************************!*\
  !*** ./styles/animations.css ***!
  \*******************************/
/***/ (() => {



/***/ }),

/***/ "(pages-dir-node)/./utils/StateBackupService.ts":
/*!*************************************!*\
  !*** ./utils/StateBackupService.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _StatePersistence__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./StatePersistence */ \"(pages-dir-node)/./utils/StatePersistence.ts\");\n// StateBackupService.ts - Manages additional state backup mechanisms\n\nclass StateBackupService {\n    static instance;\n    serviceWorkerRegistration = null;\n    backupInterval = null;\n    lastBackupTime = 0;\n    BACKUP_INTERVAL_MS = 60000;\n    isRegistering = false;\n    constructor(){\n    // Private constructor for singleton pattern\n    }\n    static getInstance() {\n        if (!StateBackupService.instance) {\n            StateBackupService.instance = new StateBackupService();\n        }\n        return StateBackupService.instance;\n    }\n    /**\n   * Initialize the backup service\n   */ async initialize() {\n        try {\n            // Register service worker only in production builds to avoid 404s in dev\n            const isProd = \"development\" === 'production';\n            if (isProd && 'serviceWorker' in navigator && !this.isRegistering) {\n                this.isRegistering = true;\n                try {\n                    this.serviceWorkerRegistration = await navigator.serviceWorker.register('/serviceWorker.js', {\n                        scope: '/'\n                    });\n                    console.log('Service Worker registered successfully', this.serviceWorkerRegistration);\n                    // Set up service worker message handling\n                    navigator.serviceWorker.addEventListener('message', this.handleServiceWorkerMessage);\n                    // Start periodic backup\n                    this.startPeriodicBackup();\n                    this.isRegistering = false;\n                    return true;\n                } catch (error) {\n                    console.error('Service Worker registration failed:', error);\n                    this.isRegistering = false;\n                    // Even if service worker fails, we can still use local storage backups\n                    this.startPeriodicBackup();\n                    return false;\n                }\n            } else {\n                // Fallback for browsers without SW support or in development\n                if (!isProd) {\n                    console.log('Skipping Service Worker in development; using local storage backups only');\n                } else {\n                    console.log('Service Workers not supported or already registering, using local storage only');\n                }\n                this.startPeriodicBackup();\n                return false;\n            }\n        } catch (error) {\n            console.error('Error initializing backup service:', error);\n            return false;\n        }\n    }\n    /**\n   * Handle messages from service worker\n   */ handleServiceWorkerMessage = (event)=>{\n        if (event.data && event.data.type === 'BACKUP_STATE_COMPLETE') {\n            if (event.data.success) {\n                console.log('Service Worker backup complete');\n            } else {\n                console.error('Service Worker backup failed:', event.data.error);\n            }\n        }\n    };\n    /**\n   * Start periodic state backups\n   */ startPeriodicBackup() {\n        if (this.backupInterval) {\n            clearInterval(this.backupInterval);\n        }\n        this.backupInterval = window.setInterval(()=>{\n            this.backupCurrentState();\n        }, this.BACKUP_INTERVAL_MS);\n        console.log('Periodic state backup started');\n        // Also backup on certain events\n        window.addEventListener('beforeunload', this.backupCurrentState);\n        window.addEventListener('pagehide', this.backupCurrentState);\n        // Backup now\n        this.backupCurrentState();\n    }\n    /**\n   * Stop periodic backups\n   */ stopPeriodicBackup() {\n        if (this.backupInterval) {\n            clearInterval(this.backupInterval);\n            this.backupInterval = null;\n            window.removeEventListener('beforeunload', this.backupCurrentState);\n            window.removeEventListener('pagehide', this.backupCurrentState);\n            console.log('Periodic state backup stopped');\n        }\n    }\n    /**\n   * Backup the current application state\n   */ backupCurrentState = async ()=>{\n        try {\n            // Don't backup too frequently\n            const now = Date.now();\n            if (now - this.lastBackupTime < 10000) {\n                return;\n            }\n            this.lastBackupTime = now;\n            // Get current state snapshot\n            const snapshot = _StatePersistence__WEBPACK_IMPORTED_MODULE_0__[\"default\"].retrieveSnapshot();\n            if (!snapshot) {\n                console.log('No state snapshot to backup');\n                return;\n            }\n            // Backup to service worker if available\n            if (navigator.serviceWorker.controller) {\n                navigator.serviceWorker.controller.postMessage({\n                    type: 'BACKUP_STATE',\n                    state: snapshot\n                });\n                console.log('State backup sent to Service Worker');\n            }\n            // Secondary browser storage backup using a different key\n            try {\n                localStorage.setItem('GRACE_STATE_BACKUP', JSON.stringify({\n                    timestamp: now,\n                    state: snapshot\n                }));\n            } catch (storageError) {\n                console.error('Error backing up to localStorage:', storageError);\n            }\n        } catch (error) {\n            console.error('State backup failed:', error);\n        }\n    };\n    /**\n   * Attempt to recover state from all backup sources\n   */ async attemptRecovery() {\n        try {\n            console.log('Attempting state recovery from all sources');\n            // Try main persistence manager first\n            const mainSnapshot = _StatePersistence__WEBPACK_IMPORTED_MODULE_0__[\"default\"].retrieveSnapshot();\n            if (mainSnapshot) {\n                console.log('Recovered state from main persistence manager');\n                return mainSnapshot;\n            }\n            // Try localStorage backup\n            try {\n                const backupJson = localStorage.getItem('GRACE_STATE_BACKUP');\n                if (backupJson) {\n                    const backup = JSON.parse(backupJson);\n                    if (backup && backup.state) {\n                        console.log('Recovered state from localStorage backup');\n                        return backup.state;\n                    }\n                }\n            } catch (e) {\n                console.error('Error reading from localStorage backup:', e);\n            }\n            // Try service worker backup (this gets complex with async)\n            if (navigator.serviceWorker.controller) {\n                return new Promise((resolve)=>{\n                    // Set up a one-time message handler\n                    const messageHandler = (event)=>{\n                        if (event.data && event.data.type === 'RECOVERY_RESULT') {\n                            navigator.serviceWorker.removeEventListener('message', messageHandler);\n                            if (event.data.state) {\n                                console.log('Recovered state from Service Worker');\n                                resolve(event.data.state);\n                            } else {\n                                console.log('No state found in Service Worker');\n                                resolve(null);\n                            }\n                        }\n                    };\n                    navigator.serviceWorker.addEventListener('message', messageHandler);\n                    // Request recovery - we've already checked controller is not null\n                    navigator.serviceWorker.controller.postMessage({\n                        type: 'RECOVER_STATE'\n                    });\n                    // Set timeout for recovery attempt\n                    setTimeout(()=>{\n                        navigator.serviceWorker.removeEventListener('message', messageHandler);\n                        console.log('Service Worker recovery timed out');\n                        resolve(null);\n                    }, 3000);\n                });\n            }\n            console.log('No state recovered from any source');\n            return null;\n        } catch (error) {\n            console.error('Error during state recovery:', error);\n            return null;\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StateBackupService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL1N0YXRlQmFja3VwU2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLHFFQUFxRTtBQUNaO0FBRXpELE1BQU1DO0lBQ0osT0FBZUMsU0FBNkI7SUFDcENDLDRCQUE4RCxLQUFLO0lBQ25FQyxpQkFBZ0MsS0FBSztJQUNyQ0MsaUJBQXlCLEVBQUU7SUFDbEJDLHFCQUFxQixNQUFNO0lBQ3BDQyxnQkFBZ0IsTUFBTTtJQUU5QixhQUFzQjtJQUNwQiw0Q0FBNEM7SUFDOUM7SUFFQSxPQUFjQyxjQUFrQztRQUM5QyxJQUFJLENBQUNQLG1CQUFtQkMsUUFBUSxFQUFFO1lBQ2hDRCxtQkFBbUJDLFFBQVEsR0FBRyxJQUFJRDtRQUNwQztRQUNBLE9BQU9BLG1CQUFtQkMsUUFBUTtJQUNwQztJQUVBOztHQUVDLEdBQ0QsTUFBYU8sYUFBK0I7UUFDMUMsSUFBSTtZQUNGLHlFQUF5RTtZQUN6RSxNQUFNQyxTQUFTQyxrQkFBeUI7WUFDeEMsSUFBSUQsVUFBVSxtQkFBbUJFLGFBQWEsQ0FBQyxJQUFJLENBQUNMLGFBQWEsRUFBRTtnQkFDakUsSUFBSSxDQUFDQSxhQUFhLEdBQUc7Z0JBQ3JCLElBQUk7b0JBQ0YsSUFBSSxDQUFDSix5QkFBeUIsR0FBRyxNQUFNUyxVQUFVQyxhQUFhLENBQUNDLFFBQVEsQ0FBQyxxQkFBcUI7d0JBQzNGQyxPQUFPO29CQUNUO29CQUNBQyxRQUFRQyxHQUFHLENBQUMsMENBQTBDLElBQUksQ0FBQ2QseUJBQXlCO29CQUVwRix5Q0FBeUM7b0JBQ3pDUyxVQUFVQyxhQUFhLENBQUNLLGdCQUFnQixDQUFDLFdBQVcsSUFBSSxDQUFDQywwQkFBMEI7b0JBRW5GLHdCQUF3QjtvQkFDeEIsSUFBSSxDQUFDQyxtQkFBbUI7b0JBQ3hCLElBQUksQ0FBQ2IsYUFBYSxHQUFHO29CQUNyQixPQUFPO2dCQUNULEVBQUUsT0FBT2MsT0FBTztvQkFDZEwsUUFBUUssS0FBSyxDQUFDLHVDQUF1Q0E7b0JBQ3JELElB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QyxhQUFhLENBQUN1QixVQUFVLENBQUVDLFdBQVcsQ0FBQzt3QkFDOUNiLE1BQU07b0JBQ1I7b0JBRUEsbUNBQW1DO29CQUNuQytCLFdBQVc7d0JBQ1QzQyxVQUFVQyxhQUFhLENBQUNrQixtQkFBbUIsQ0FBQyxXQUFXdUI7d0JBQ3ZEdEMsUUFBUUMsR0FBRyxDQUFDO3dCQUNab0MsUUFBUTtvQkFDVixHQUFHO2dCQUNMO1lBQ0Y7WUFFQXJDLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE9BQU87UUFDVCxFQUFFLE9BQU9JLE9BQU87WUFDZEwsUUFBUUssS0FBSyxDQUFDLGdDQUFnQ0E7WUFDOUMsT0FBTztRQUNUO0lBQ0Y7QUFDRjtBQUVBLGlFQUFlcEIsa0JBQWtCQSxFQUFDIiwic291cmNlcyI6WyIvVXNlcnMvd29ua2Fzd29ybGQvRG93bmxvYWRzL2dyYWNlLXByb2plY3Qvc3JjL3VpL3V0aWxzL1N0YXRlQmFja3VwU2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTdGF0ZUJhY2t1cFNlcnZpY2UudHMgLSBNYW5hZ2VzIGFkZGl0aW9uYWwgc3RhdGUgYmFja3VwIG1lY2hhbmlzbXNcbmltcG9ydCBTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlciBmcm9tICcuL1N0YXRlUGVyc2lzdGVuY2UnO1xuXG5jbGFzcyBTdGF0ZUJhY2t1cFNlcnZpY2Uge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogU3RhdGVCYWNrdXBTZXJ2aWNlO1xuICBwcml2YXRlIHNlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb246IFNlcnZpY2VXb3JrZXJSZWdpc3RyYXRpb24gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBiYWNrdXBJbnRlcnZhbDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgbGFzdEJhY2t1cFRpbWU6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgcmVhZG9ubHkgQkFDS1VQX0lOVEVSVkFMX01TID0gNjAwMDA7IC8vIDEgbWludXRlXG4gIHByaXZhdGUgaXNSZWdpc3RlcmluZyA9IGZhbHNlO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gUHJpdmF0ZSBjb25zdHJ1Y3RvciBmb3Igc2luZ2xldG9uIHBhdHRlcm5cbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogU3RhdGVCYWNrdXBTZXJ2aWNlIHtcbiAgICBpZiAoIVN0YXRlQmFja3VwU2VydmljZS5pbnN0YW5jZSkge1xuICAgICAgU3RhdGVCYWNrdXBTZXJ2aWNlLmluc3RhbmNlID0gbmV3IFN0YXRlQmFja3VwU2VydmljZSgpO1xuICAgIH1cbiAgICByZXR1cm4gU3RhdGVCYWNrdXBTZXJ2aWNlLmluc3RhbmNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIGJhY2t1cCBzZXJ2aWNlXG4gICAqL1xuICBwdWJsaWMgYXN5bmMgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgLy8gUmVnaXN0ZXIgc2VydmljZSB3b3JrZXIgb25seSBpbiBwcm9kdWN0aW9uIGJ1aWxkcyB0byBhdm9pZCA0MDRzIGluIGRldlxuICAgICAgY29uc3QgaXNQcm9kID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJztcbiAgICAgIGlmIChpc1Byb2QgJiYgJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvciAmJiAhdGhpcy5pc1JlZ2lzdGVyaW5nKSB7XG4gICAgICAgIHRoaXMuaXNSZWdpc3RlcmluZyA9IHRydWU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgdGhpcy5zZXJ2aWNlV29ya2VyUmVnaXN0cmF0aW9uID0gYXdhaXQgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJy9zZXJ2aWNlV29ya2VyLmpzJywge1xuICAgICAgICAgICAgc2NvcGU6ICcvJ1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdTZXJ2aWNlIFdvcmtlciByZWdpc3RlcmVkIHN1Y2Nlc3NmdWxseScsIHRoaXMuc2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbik7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU2V0IHVwIHNlcnZpY2Ugd29ya2VyIG1lc3NhZ2UgaGFuZGxpbmdcbiAgICAgICAgICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5oYW5kbGVTZXJ2aWNlV29ya2VyTWVzc2FnZSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU3RhcnQgcGVyaW9kaWMgYmFja3VwXG4gICAgICAgICAgdGhpcy5zdGFydFBlcmlvZGljQmFja3VwKCk7XG4gICAgICAgICAgdGhpcy5pc1JlZ2lzdGVyaW5nID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignU2VydmljZSBXb3JrZXIgcmVnaXN0cmF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICAgICAgdGhpcy5pc1JlZ2lzdGVyaW5nID0gZmFsc2U7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gRXZlbiBpZiBzZXJ2aWNlIHdvcmtlciBmYWlscywgd2UgY2FuIHN0aWxsIHVzZSBsb2NhbCBzdG9yYWdlIGJhY2t1cHNcbiAgICAgICAgICB0aGlzLnN0YXJ0UGVyaW9kaWNCYWNrdXAoKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZhbGxiYWNrIGZvciBicm93c2VycyB3aXRob3V0IFNXIHN1cHBvcnQgb3IgaW4gZGV2ZWxvcG1lbnRcbiAgICAgICAgaWYgKCFpc1Byb2QpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnU2tpcHBpbmcgU2VydmljZSBXb3JrZXIgaW4gZGV2ZWxvcG1lbnQ7IHVzaW5nIGxvY2FsIHN0b3JhZ2UgYmFja3VwcyBvbmx5Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ1NlcnZpY2UgV29ya2VycyBub3Qgc3VwcG9ydGVkIG9yIGFscmVhZHkgcmVnaXN0ZXJpbmcsIHVzaW5nIGxvY2FsIHN0b3JhZ2Ugb25seScpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3RhcnRQZXJpb2RpY0JhY2t1cCgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBiYWNrdXAgc2VydmljZTonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBtZXNzYWdlcyBmcm9tIHNlcnZpY2Ugd29ya2VyXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVNlcnZpY2VXb3JrZXJNZXNzYWdlID0gKGV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IHtcbiAgICBpZiAoZXZlbnQuZGF0YSAmJiBldmVudC5kYXRhLnR5cGUgPT09ICdCQUNLVVBfU1RBVEVfQ09NUExFVEUnKSB7XG4gICAgICBpZiAoZXZlbnQuZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTZXJ2aWNlIFdvcmtlciBiYWNrdXAgY29tcGxldGUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NlcnZpY2UgV29ya2VyIGJhY2t1cCBmYWlsZWQ6JywgZXZlbnQuZGF0YS5lcnJvcik7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBTdGFydCBwZXJpb2RpYyBzdGF0ZSBiYWNrdXBzXG4gICAqL1xuICBwdWJsaWMgc3RhcnRQZXJpb2RpY0JhY2t1cCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5iYWNrdXBJbnRlcnZhbCkge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmJhY2t1cEludGVydmFsKTtcbiAgICB9XG4gICAgXG4gICAgdGhpcy5iYWNrdXBJbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLmJhY2t1cEN1cnJlbnRTdGF0ZSgpO1xuICAgIH0sIHRoaXMuQkFDS1VQX0lOVEVSVkFMX01TKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnUGVyaW9kaWMgc3RhdGUgYmFja3VwIHN0YXJ0ZWQnKTtcbiAgICBcbiAgICAvLyBBbHNvIGJhY2t1cCBvbiBjZXJ0YWluIGV2ZW50c1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCB0aGlzLmJhY2t1cEN1cnJlbnRTdGF0ZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VoaWRlJywgdGhpcy5iYWNrdXBDdXJyZW50U3RhdGUpO1xuICAgIFxuICAgIC8vIEJhY2t1cCBub3dcbiAgICB0aGlzLmJhY2t1cEN1cnJlbnRTdGF0ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgcGVyaW9kaWMgYmFja3Vwc1xuICAgKi9cbiAgcHVibGljIHN0b3BQZXJpb2RpY0JhY2t1cCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5iYWNrdXBJbnRlcnZhbCkge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmJhY2t1cEludGVydmFsKTtcbiAgICAgIHRoaXMuYmFja3VwSW50ZXJ2YWwgPSBudWxsO1xuICAgICAgXG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgdGhpcy5iYWNrdXBDdXJyZW50U3RhdGUpO1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3BhZ2VoaWRlJywgdGhpcy5iYWNrdXBDdXJyZW50U3RhdGUpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnUGVyaW9kaWMgc3RhdGUgYmFja3VwIHN0b3BwZWQnKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQmFja3VwIHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uIHN0YXRlXG4gICAqL1xuICBwdWJsaWMgYmFja3VwQ3VycmVudFN0YXRlID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBEb24ndCBiYWNrdXAgdG9vIGZyZXF1ZW50bHlcbiAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICBpZiAobm93IC0gdGhpcy5sYXN0QmFja3VwVGltZSA8IDEwMDAwKSB7IC8vIE1pbiAxMHMgYmV0d2VlbiBiYWNrdXBzXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgdGhpcy5sYXN0QmFja3VwVGltZSA9IG5vdztcbiAgICAgIFxuICAgICAgLy8gR2V0IGN1cnJlbnQgc3RhdGUgc25hcHNob3RcbiAgICAgIGNvbnN0IHNuYXBzaG90ID0gU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXIucmV0cmlldmVTbmFwc2hvdCgpO1xuICAgICAgaWYgKCFzbmFwc2hvdCkge1xuICAgICAgICBjb25zb2xlLmxvZygnTm8gc3RhdGUgc25hcHNob3QgdG8gYmFja3VwJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQmFja3VwIHRvIHNlcnZpY2Ugd29ya2VyIGlmIGF2YWlsYWJsZVxuICAgICAgaWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHtcbiAgICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlci5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgdHlwZTogJ0JBQ0tVUF9TVEFURScsXG4gICAgICAgICAgc3RhdGU6IHNuYXBzaG90XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZygnU3RhdGUgYmFja3VwIHNlbnQgdG8gU2VydmljZSBXb3JrZXInKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU2Vjb25kYXJ5IGJyb3dzZXIgc3RvcmFnZSBiYWNrdXAgdXNpbmcgYSBkaWZmZXJlbnQga2V5XG4gICAgICB0cnkge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnR1JBQ0VfU1RBVEVfQkFDS1VQJywgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIHRpbWVzdGFtcDogbm93LFxuICAgICAgICAgIHN0YXRlOiBzbmFwc2hvdFxuICAgICAgICB9KSk7XG4gICAgICB9IGNhdGNoIChzdG9yYWdlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgYmFja2luZyB1cCB0byBsb2NhbFN0b3JhZ2U6Jywgc3RvcmFnZUVycm9yKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignU3RhdGUgYmFja3VwIGZhaWxlZDonLCBlcnJvcik7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBBdHRlbXB0IHRvIHJlY292ZXIgc3RhdGUgZnJvbSBhbGwgYmFja3VwIHNvdXJjZXNcbiAgICovXG4gIHB1YmxpYyBhc3luYyBhdHRlbXB0UmVjb3ZlcnkoKTogUHJvbWlzZTxhbnkgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIHN0YXRlIHJlY292ZXJ5IGZyb20gYWxsIHNvdXJjZXMnKTtcbiAgICAgIFxuICAgICAgLy8gVHJ5IG1haW4gcGVyc2lzdGVuY2UgbWFuYWdlciBmaXJzdFxuICAgICAgY29uc3QgbWFpblNuYXBzaG90ID0gU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXIucmV0cmlldmVTbmFwc2hvdCgpO1xuICAgICAgaWYgKG1haW5TbmFwc2hvdCkge1xuICAgICAgICBjb25zb2xlLmxvZygnUmVjb3ZlcmVkIHN0YXRlIGZyb20gbWFpbiBwZXJzaXN0ZW5jZSBtYW5hZ2VyJyk7XG4gICAgICAgIHJldHVybiBtYWluU25hcHNob3Q7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFRyeSBsb2NhbFN0b3JhZ2UgYmFja3VwXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBiYWNrdXBKc29uID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0dSQUNFX1NUQVRFX0JBQ0tVUCcpO1xuICAgICAgICBpZiAoYmFja3VwSnNvbikge1xuICAgICAgICAgIGNvbnN0IGJhY2t1cCA9IEpTT04ucGFyc2UoYmFja3VwSnNvbik7XG4gICAgICAgICAgaWYgKGJhY2t1cCAmJiBiYWNrdXAuc3RhdGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZWNvdmVyZWQgc3RhdGUgZnJvbSBsb2NhbFN0b3JhZ2UgYmFja3VwJyk7XG4gICAgICAgICAgICByZXR1cm4gYmFja3VwLnN0YXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGZyb20gbG9jYWxTdG9yYWdlIGJhY2t1cDonLCBlKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVHJ5IHNlcnZpY2Ugd29ya2VyIGJhY2t1cCAodGhpcyBnZXRzIGNvbXBsZXggd2l0aCBhc3luYylcbiAgICAgIGlmIChuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5jb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgIC8vIFNldCB1cCBhIG9uZS10aW1lIG1lc3NhZ2UgaGFuZGxlclxuICAgICAgICAgIGNvbnN0IG1lc3NhZ2VIYW5kbGVyID0gKGV2ZW50OiBNZXNzYWdlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5kYXRhICYmIGV2ZW50LmRhdGEudHlwZSA9PT0gJ1JFQ09WRVJZX1JFU1VMVCcpIHtcbiAgICAgICAgICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIG1lc3NhZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgICAgaWYgKGV2ZW50LmRhdGEuc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUmVjb3ZlcmVkIHN0YXRlIGZyb20gU2VydmljZSBXb3JrZXInKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGV2ZW50LmRhdGEuc3RhdGUpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyBzdGF0ZSBmb3VuZCBpbiBTZXJ2aWNlIFdvcmtlcicpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIFxuICAgICAgICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBtZXNzYWdlSGFuZGxlcik7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gUmVxdWVzdCByZWNvdmVyeSAtIHdlJ3ZlIGFscmVhZHkgY2hlY2tlZCBjb250cm9sbGVyIGlzIG5vdCBudWxsXG4gICAgICAgICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlciEucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgdHlwZTogJ1JFQ09WRVJfU1RBVEUnXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU2V0IHRpbWVvdXQgZm9yIHJlY292ZXJ5IGF0dGVtcHRcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBtZXNzYWdlSGFuZGxlcik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnU2VydmljZSBXb3JrZXIgcmVjb3ZlcnkgdGltZWQgb3V0Jyk7XG4gICAgICAgICAgICByZXNvbHZlKG51bGwpO1xuICAgICAgICAgIH0sIDMwMDApO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ05vIHN0YXRlIHJlY292ZXJlZCBmcm9tIGFueSBzb3VyY2UnKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgc3RhdGUgcmVjb3Zlcnk6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFN0YXRlQmFja3VwU2VydmljZTtcbiJdLCJuYW1lcyI6WyJTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlciIsIlN0YXRlQmFja3VwU2VydmljZSIsImluc3RhbmNlIiwic2VydmljZVdvcmtlclJlZ2lzdHJhdGlvbiIsImJhY2t1cEludGVydmFsIiwibGFzdEJhY2t1cFRpbWUiLCJCQUNLVVBfSU5URVJWQUxfTVMiLCJpc1JlZ2lzdGVyaW5nIiwiZ2V0SW5zdGFuY2UiLCJpbml0aWFsaXplIiwiaXNQcm9kIiwicHJvY2VzcyIsIm5hdmlnYXRvciIsInNlcnZpY2VXb3JrZXIiLCJyZWdpc3RlciIsInNjb3BlIiwiY29uc29sZSIsImxvZyIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVTZXJ2aWNlV29ya2VyTWVzc2FnZSIsInN0YXJ0UGVyaW9kaWNCYWNrdXAiLCJlcnJvciIsImV2ZW50IiwiZGF0YSIsInR5cGUiLCJzdWNjZXNzIiwiY2xlYXJJbnRlcnZhbCIsIndpbmRvdyIsInNldEludGVydmFsIiwiYmFja3VwQ3VycmVudFN0YXRlIiwic3RvcFBlcmlvZGljQmFja3VwIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm5vdyIsIkRhdGUiLCJzbmFwc2hvdCIsInJldHJpZXZlU25hcHNob3QiLCJjb250cm9sbGVyIiwicG9zdE1lc3NhZ2UiLCJzdGF0ZSIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJKU09OIiwic3RyaW5naWZ5IiwidGltZXN0YW1wIiwic3RvcmFnZUVycm9yIiwiYXR0ZW1wdFJlY292ZXJ5IiwibWFpblNuYXBzaG90IiwiYmFja3VwSnNvbiIsImdldEl0ZW0iLCJiYWNrdXAiLCJwYXJzZSIsImUiLCJQcm9taXNlIiwicmVzb2x2ZSIsIm1lc3NhZ2VIYW5kbGVyIiwic2V0VGltZW91dCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/StateBackupService.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./utils/StateOperationLock.ts":
/*!*************************************!*\
  !*** ./utils/StateOperationLock.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/**\n * StateOperationLock - Prevents race conditions in state operations\n * \n * This utility provides a central locking mechanism to prevent concurrent state operations\n * from interfering with each other, which can cause race conditions and lost updates.\n */ class StateOperationLock {\n    static instance;\n    activeLocks = new Map();\n    DEFAULT_TIMEOUT = 5000;\n    // Make this a singleton\n    constructor(){}\n    static getInstance() {\n        if (!StateOperationLock.instance) {\n            StateOperationLock.instance = new StateOperationLock();\n        }\n        return StateOperationLock.instance;\n    }\n    /**\n   * Acquires a lock for a specific operation\n   * @param resourceId Identifier for the resource being locked (e.g., 'chat', 'trading')\n   * @param operation Description of the operation being performed\n   * @param timeoutMs Lock timeout in milliseconds\n   * @returns Lock ID if acquired, null if failed\n   */ acquireLock(resourceId, operation, timeoutMs = this.DEFAULT_TIMEOUT) {\n        // Clean expired locks first\n        this.cleanExpiredLocks();\n        // Check if the resource is already locked\n        if (this.activeLocks.has(resourceId)) {\n            console.warn(`Resource ${resourceId} is already locked for operation: ${this.activeLocks.get(resourceId)?.operation}`);\n            return null;\n        }\n        // Create a new lock\n        const lockId = `lock_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\n        const now = Date.now();\n        const lockInfo = {\n            id: lockId,\n            operation,\n            acquiredAt: now,\n            expiresAt: now + timeoutMs\n        };\n        // Set the lock\n        this.activeLocks.set(resourceId, lockInfo);\n        console.log(`Lock acquired for ${resourceId}: ${operation}`);\n        // Set automatic release after timeout\n        setTimeout(()=>{\n            this.releaseLock(resourceId, lockId);\n        }, timeoutMs);\n        return lockId;\n    }\n    /**\n   * Releases a lock if the lockId matches\n   * @param resourceId Resource identifier\n   * @param lockId Lock ID returned from acquireLock\n   * @returns true if released, false if not found or ID doesn't match\n   */ releaseLock(resourceId, lockId) {\n        const lock = this.activeLocks.get(resourceId);\n        if (!lock) {\n            console.warn(`No lock found for resource ${resourceId}`);\n            return false;\n        }\n        if (lock.id !== lockId) {\n            console.warn(`Lock ID mismatch for ${resourceId}: expected ${lock.id}, got ${lockId}`);\n            return false;\n        }\n        // Release the lock\n        this.activeLocks.delete(resourceId);\n        console.log(`Lock released for ${resourceId}`);\n        return true;\n    }\n    /**\n   * Checks if a resource is currently locked\n   * @param resourceId Resource identifier\n   * @returns true if locked, false otherwise\n   */ isLocked(resourceId) {\n        this.cleanExpiredLocks();\n        return this.activeLocks.has(resourceId);\n    }\n    /**\n   * Clean up any expired locks\n   */ cleanExpiredLocks() {\n        const now = Date.now();\n        for (const [resourceId, lock] of this.activeLocks.entries()){\n            if (lock.expiresAt < now) {\n                console.log(`Lock for ${resourceId} expired and was auto-released`);\n                this.activeLocks.delete(resourceId);\n            }\n        }\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StateOperationLock.getInstance());\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL1N0YXRlT3BlcmF0aW9uTG9jay50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7Ozs7O0NBS0MsR0FTRCxNQUFNQTtJQUNKLE9BQWVDLFNBQTZCO0lBQ3BDQyxjQUFxQyxJQUFJQyxNQUFNO0lBQy9DQyxrQkFBa0IsS0FBSztJQUUvQix3QkFBd0I7SUFDeEIsYUFBc0IsQ0FBQztJQUV2QixPQUFjQyxjQUFrQztRQUM5QyxJQUFJLENBQUNMLG1CQUFtQkMsUUFBUSxFQUFFO1lBQ2hDRCxtQkFBbUJDLFFBQVEsR0FBRyxJQUFJRDtRQUNwQztRQUNBLE9BQU9BLG1CQUFtQkMsUUFBUTtJQUNwQztJQUVBOzs7Ozs7R0FNQyxHQUNELFlBQW1CTSxVQUFrQixFQUFFQyxTQUFpQixFQUFFQyxZQUFZLElBQUksQ0FBQ0wsZUFBZSxFQUFpQjtRQUN6Ryw0QkFBNEI7UUFDNUIsSUFBSSxDQUFDTSxpQkFBaUI7UUFFdEIsMENBQTBDO1FBQzFDLElBQUksSUFBSSxDQUFDUixXQUFXLENBQUNTLEdBQUcsQ0FBQ0osYUFBYTtZQUNwQ0ssUUFBUUMsSUFBSSxDQUFDLENBQUMsU0FBUyxFQUFFTixXQUFXLGtDQUFrQyxFQUFFLElBQUksQ0FBQ0wsV0FBVyxDQUFDWSxHQUFHLENBQUNQLGFBQWFDLFdBQVc7WUFDckgsT0FBTztRQUNUO1FBRUEsb0JBQW9CO1FBQ3BCLE1BQU1PLFNBQVMsQ0FBQyxLQUFLLEVBQUVDLEtBQUtDLEdBQUcsR0FBRyxDQUFDLEVBQUVDLEtBQUtDLE1BQU0sR0FBR0MsUUFBUSxDQUFDLElBQUlDLFNBQVMsQ0FBQyxHQUFHLElBQUk7UUFDakYsTUFBTUosTUFBTUQsS0FBS0MsR0FBRztRQUVwQixNQUFNSyxXQUFxQjtZQUN6QkMsSUFBSVI7WUFDSlA7WUFDQWdCLFlBQVlQO1lBQ1pRLFdBQVdSLE1BQU1SO1FBQ25CO1FBRUEsZUFBZTtRQUNmLElBQUksQ0FBQ1AsV0FBVyxDQUFDd0IsR0FBRyxDQUFDbkIsWUFBWWU7UUFDakNWLFFBQVFlLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixFQUFFcEIsV0FBVyxFQUFFLEVBQUVDLFdBQVc7UUFFM0Qsc0NBQXNDO1FBQ3RDb0IsV0FBVztZQUNULElBQUksQ0FBQ0MsV0FBVyxDQUFDdEIsWUFBWVE7UUFDL0IsR0FBR047UUFFSCxPQUFPTTtJQUNUO0lBRUE7Ozs7O0dBS0MsR0FDRCxZQUFtQlIsVUFBa0IsRUFBRVEsTUFBYyxFQUFXO1FBQzlELE1BQU1lLE9BQU8sSUFBSSxDQUFDNUIsV0FBVyxDQUFDWSxHQUFHLENBQUNQO1FBRWxDLElBQUksQ0FBQ3VCLE1BQU07WUFDVGxCLFFBQVFDLElBQUksQ0FBQyxDQUFDLDJCQUEyQixFQUFFTixZQUFZO1lBQ3ZELE9BQU87UUFDVDtRQUVBLElBQUl1QixLQUFLUCxFQUFFLEtBQUtSLFFBQVE7WUFDdEJILFFBQVFDLElBQUksQ0FBQyxDQUFDLHFCQUFxQixFQUFFTixXQUFXLFdBQVcsRUFBRXVCLEtBQUtQLEVBQUUsQ0FBQyxNQUFNLEVBQUVSLFFBQVE7WUFDckYsT0FBTztRQUNUO1FBRUEsbUJBQW1CO1FBQ25CLElBQUksQ0FBQ2IsV0FBVyxDQUFDNkIsTUFBTSxDQUFDeEI7UUFDeEJLLFFBQVFlLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixFQUFFcEIsWUFBWTtRQUU3QyxPQUFPO0lBQ1Q7SUFFQTs7OztHQUlDLEdBQ0QsU0FBZ0JBLFVBQWtCLEVBQVc7UUFDM0MsSUFBSSxDQUFDRyxpQkFBaUI7UUFDdEIsT0FBTyxJQUFJLENBQUNSLFdBQVcsQ0FBQ1MsR0FBRyxDQUFDSjtJQUM5QjtJQUVBOztHQUVDLEdBQ0Qsb0JBQWtDO1FBQ2hDLE1BQU1VLE1BQU1ELEtBQUtDLEdBQUc7UUFFcEIsS0FBSyxNQUFNLENBQUNWLFlBQVl1QixLQUFLLElBQUksSUFBSSxDQUFDNUIsV0FBVyxDQUFDK0IsT0FBTyxHQUFJO1lBQzNELElBQUlILEtBQUtMLFNBQVMsR0FBR1IsS0FBSztnQkFDeEJMLFFBQVFlLEdBQUcsQ0FBQyxDQUFDLFNBQVMsRUFBRXBCLFdBQVcsOEJBQThCLENBQUM7Z0JBQ2xFLElBQUksQ0FBQ0wsV0FBVyxDQUFDNkIsTUFBTSxDQUFDeEI7WUFDMUI7UUFDRjtJQUNGO0FBQ0Y7QUFFQSxpRUFBZVAsbUJBQW1CSyxXQUFXLEVBQUUsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL3dvbmthc3dvcmxkL0Rvd25sb2Fkcy9ncmFjZS1wcm9qZWN0L3NyYy91aS91dGlscy9TdGF0ZU9wZXJhdGlvbkxvY2sudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTdGF0ZU9wZXJhdGlvbkxvY2sgLSBQcmV2ZW50cyByYWNlIGNvbmRpdGlvbnMgaW4gc3RhdGUgb3BlcmF0aW9uc1xuICogXG4gKiBUaGlzIHV0aWxpdHkgcHJvdmlkZXMgYSBjZW50cmFsIGxvY2tpbmcgbWVjaGFuaXNtIHRvIHByZXZlbnQgY29uY3VycmVudCBzdGF0ZSBvcGVyYXRpb25zXG4gKiBmcm9tIGludGVyZmVyaW5nIHdpdGggZWFjaCBvdGhlciwgd2hpY2ggY2FuIGNhdXNlIHJhY2UgY29uZGl0aW9ucyBhbmQgbG9zdCB1cGRhdGVzLlxuICovXG5cbmludGVyZmFjZSBMb2NrSW5mbyB7XG4gIGlkOiBzdHJpbmc7XG4gIG9wZXJhdGlvbjogc3RyaW5nO1xuICBhY3F1aXJlZEF0OiBudW1iZXI7XG4gIGV4cGlyZXNBdDogbnVtYmVyO1xufVxuXG5jbGFzcyBTdGF0ZU9wZXJhdGlvbkxvY2sge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogU3RhdGVPcGVyYXRpb25Mb2NrO1xuICBwcml2YXRlIGFjdGl2ZUxvY2tzOiBNYXA8c3RyaW5nLCBMb2NrSW5mbz4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgREVGQVVMVF9USU1FT1VUID0gNTAwMDsgLy8gRGVmYXVsdCBsb2NrIHRpbWVvdXQ6IDUgc2Vjb25kc1xuXG4gIC8vIE1ha2UgdGhpcyBhIHNpbmdsZXRvblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IFN0YXRlT3BlcmF0aW9uTG9jayB7XG4gICAgaWYgKCFTdGF0ZU9wZXJhdGlvbkxvY2suaW5zdGFuY2UpIHtcbiAgICAgIFN0YXRlT3BlcmF0aW9uTG9jay5pbnN0YW5jZSA9IG5ldyBTdGF0ZU9wZXJhdGlvbkxvY2soKTtcbiAgICB9XG4gICAgcmV0dXJuIFN0YXRlT3BlcmF0aW9uTG9jay5pbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBY3F1aXJlcyBhIGxvY2sgZm9yIGEgc3BlY2lmaWMgb3BlcmF0aW9uXG4gICAqIEBwYXJhbSByZXNvdXJjZUlkIElkZW50aWZpZXIgZm9yIHRoZSByZXNvdXJjZSBiZWluZyBsb2NrZWQgKGUuZy4sICdjaGF0JywgJ3RyYWRpbmcnKVxuICAgKiBAcGFyYW0gb3BlcmF0aW9uIERlc2NyaXB0aW9uIG9mIHRoZSBvcGVyYXRpb24gYmVpbmcgcGVyZm9ybWVkXG4gICAqIEBwYXJhbSB0aW1lb3V0TXMgTG9jayB0aW1lb3V0IGluIG1pbGxpc2Vjb25kc1xuICAgKiBAcmV0dXJucyBMb2NrIElEIGlmIGFjcXVpcmVkLCBudWxsIGlmIGZhaWxlZFxuICAgKi9cbiAgcHVibGljIGFjcXVpcmVMb2NrKHJlc291cmNlSWQ6IHN0cmluZywgb3BlcmF0aW9uOiBzdHJpbmcsIHRpbWVvdXRNcyA9IHRoaXMuREVGQVVMVF9USU1FT1VUKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgLy8gQ2xlYW4gZXhwaXJlZCBsb2NrcyBmaXJzdFxuICAgIHRoaXMuY2xlYW5FeHBpcmVkTG9ja3MoKTtcbiAgICBcbiAgICAvLyBDaGVjayBpZiB0aGUgcmVzb3VyY2UgaXMgYWxyZWFkeSBsb2NrZWRcbiAgICBpZiAodGhpcy5hY3RpdmVMb2Nrcy5oYXMocmVzb3VyY2VJZCkpIHtcbiAgICAgIGNvbnNvbGUud2FybihgUmVzb3VyY2UgJHtyZXNvdXJjZUlkfSBpcyBhbHJlYWR5IGxvY2tlZCBmb3Igb3BlcmF0aW9uOiAke3RoaXMuYWN0aXZlTG9ja3MuZ2V0KHJlc291cmNlSWQpPy5vcGVyYXRpb259YCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlIGEgbmV3IGxvY2tcbiAgICBjb25zdCBsb2NrSWQgPSBgbG9ja18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDkpfWA7XG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBcbiAgICBjb25zdCBsb2NrSW5mbzogTG9ja0luZm8gPSB7XG4gICAgICBpZDogbG9ja0lkLFxuICAgICAgb3BlcmF0aW9uLFxuICAgICAgYWNxdWlyZWRBdDogbm93LFxuICAgICAgZXhwaXJlc0F0OiBub3cgKyB0aW1lb3V0TXNcbiAgICB9O1xuICAgIFxuICAgIC8vIFNldCB0aGUgbG9ja1xuICAgIHRoaXMuYWN0aXZlTG9ja3Muc2V0KHJlc291cmNlSWQsIGxvY2tJbmZvKTtcbiAgICBjb25zb2xlLmxvZyhgTG9jayBhY3F1aXJlZCBmb3IgJHtyZXNvdXJjZUlkfTogJHtvcGVyYXRpb259YCk7XG4gICAgXG4gICAgLy8gU2V0IGF1dG9tYXRpYyByZWxlYXNlIGFmdGVyIHRpbWVvdXRcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMucmVsZWFzZUxvY2socmVzb3VyY2VJZCwgbG9ja0lkKTtcbiAgICB9LCB0aW1lb3V0TXMpO1xuICAgIFxuICAgIHJldHVybiBsb2NrSWQ7XG4gIH1cblxuICAvKipcbiAgICogUmVsZWFzZXMgYSBsb2NrIGlmIHRoZSBsb2NrSWQgbWF0Y2hlc1xuICAgKiBAcGFyYW0gcmVzb3VyY2VJZCBSZXNvdXJjZSBpZGVudGlmaWVyXG4gICAqIEBwYXJhbSBsb2NrSWQgTG9jayBJRCByZXR1cm5lZCBmcm9tIGFjcXVpcmVMb2NrXG4gICAqIEByZXR1cm5zIHRydWUgaWYgcmVsZWFzZWQsIGZhbHNlIGlmIG5vdCBmb3VuZCBvciBJRCBkb2Vzbid0IG1hdGNoXG4gICAqL1xuICBwdWJsaWMgcmVsZWFzZUxvY2socmVzb3VyY2VJZDogc3RyaW5nLCBsb2NrSWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGxvY2sgPSB0aGlzLmFjdGl2ZUxvY2tzLmdldChyZXNvdXJjZUlkKTtcbiAgICBcbiAgICBpZiAoIWxvY2spIHtcbiAgICAgIGNvbnNvbGUud2FybihgTm8gbG9jayBmb3VuZCBmb3IgcmVzb3VyY2UgJHtyZXNvdXJjZUlkfWApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICBpZiAobG9jay5pZCAhPT0gbG9ja0lkKSB7XG4gICAgICBjb25zb2xlLndhcm4oYExvY2sgSUQgbWlzbWF0Y2ggZm9yICR7cmVzb3VyY2VJZH06IGV4cGVjdGVkICR7bG9jay5pZH0sIGdvdCAke2xvY2tJZH1gKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgLy8gUmVsZWFzZSB0aGUgbG9ja1xuICAgIHRoaXMuYWN0aXZlTG9ja3MuZGVsZXRlKHJlc291cmNlSWQpO1xuICAgIGNvbnNvbGUubG9nKGBMb2NrIHJlbGVhc2VkIGZvciAke3Jlc291cmNlSWR9YCk7XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGEgcmVzb3VyY2UgaXMgY3VycmVudGx5IGxvY2tlZFxuICAgKiBAcGFyYW0gcmVzb3VyY2VJZCBSZXNvdXJjZSBpZGVudGlmaWVyXG4gICAqIEByZXR1cm5zIHRydWUgaWYgbG9ja2VkLCBmYWxzZSBvdGhlcndpc2VcbiAgICovXG4gIHB1YmxpYyBpc0xvY2tlZChyZXNvdXJjZUlkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICB0aGlzLmNsZWFuRXhwaXJlZExvY2tzKCk7XG4gICAgcmV0dXJuIHRoaXMuYWN0aXZlTG9ja3MuaGFzKHJlc291cmNlSWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFuIHVwIGFueSBleHBpcmVkIGxvY2tzXG4gICAqL1xuICBwcml2YXRlIGNsZWFuRXhwaXJlZExvY2tzKCk6IHZvaWQge1xuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgXG4gICAgZm9yIChjb25zdCBbcmVzb3VyY2VJZCwgbG9ja10gb2YgdGhpcy5hY3RpdmVMb2Nrcy5lbnRyaWVzKCkpIHtcbiAgICAgIGlmIChsb2NrLmV4cGlyZXNBdCA8IG5vdykge1xuICAgICAgICBjb25zb2xlLmxvZyhgTG9jayBmb3IgJHtyZXNvdXJjZUlkfSBleHBpcmVkIGFuZCB3YXMgYXV0by1yZWxlYXNlZGApO1xuICAgICAgICB0aGlzLmFjdGl2ZUxvY2tzLmRlbGV0ZShyZXNvdXJjZUlkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU3RhdGVPcGVyYXRpb25Mb2NrLmdldEluc3RhbmNlKCk7XG4iXSwibmFtZXMiOlsiU3RhdGVPcGVyYXRpb25Mb2NrIiwiaW5zdGFuY2UiLCJhY3RpdmVMb2NrcyIsIk1hcCIsIkRFRkFVTFRfVElNRU9VVCIsImdldEluc3RhbmNlIiwiYWNxdWlyZUxvY2siLCJyZXNvdXJjZUlkIiwib3BlcmF0aW9uIiwidGltZW91dE1zIiwiY2xlYW5FeHBpcmVkTG9ja3MiLCJoYXMiLCJjb25zb2xlIiwid2FybiIsImdldCIsImxvY2tJZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJsb2NrSW5mbyIsImlkIiwiYWNxdWlyZWRBdCIsImV4cGlyZXNBdCIsInNldCIsImxvZyIsInNldFRpbWVvdXQiLCJyZWxlYXNlTG9jayIsImxvY2siLCJkZWxldGUiLCJpc0xvY2tlZCIsImVudHJpZXMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/StateOperationLock.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./utils/StatePersistence.ts":
/*!***********************************!*\
  !*** ./utils/StatePersistence.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   preventUnintendedRefresh: () => (/* binding */ preventUnintendedRefresh)\n/* harmony export */ });\n/* harmony import */ var _StateOperationLock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./StateOperationLock */ \"(pages-dir-node)/./utils/StateOperationLock.ts\");\n\nclass StatePersistenceManager {\n    static getStoredState() {\n        throw new Error('Method not implemented.');\n    }\n    // Storage keys - making this public so it can be referenced by sync logic\n    static STORAGE_KEY = 'GRACE_DYNAMIC_SNAPSHOT';\n    static MAX_SNAPSHOT_AGE = 24 * 60 * 60 * 1000;\n    static STORAGE_VERSION = 1;\n    static MAX_STORAGE_SIZE = 4 * 1024 * 1024;\n    // Advanced logging mechanism\n    static log(message, level = 'info') {\n        const timestamp = new Date().toISOString();\n        const logMessage = `[StatePersistence:${level.toUpperCase()}] ${timestamp} - ${message}`;\n        switch(level){\n            case 'info':\n                console.log(logMessage);\n                break;\n            case 'warn':\n                console.warn(logMessage);\n                break;\n            case 'error':\n                console.error(logMessage);\n                break;\n        }\n    // Optional: Send to error tracking service\n    // this.reportToErrorTracking(message, level);\n    }\n    // Check storage quota and manage size\n    static async checkStorageQuota() {\n        try {\n            // Use the Storage API if available (modern browsers)\n            if ('storage' in navigator && 'estimate' in navigator.storage) {\n                const estimate = await navigator.storage.estimate();\n                const { usage, quota } = estimate;\n                if (usage && quota) {\n                    const usageRatio = usage / quota;\n                    this.log(`Storage usage: ${(usageRatio * 100).toFixed(2)}% (${Math.round(usage / 1024 / 1024)}MB / ${Math.round(quota / 1024 / 1024)}MB)`);\n                    // If over 90% of quota, try to clean up\n                    if (usageRatio > 0.9) {\n                        this.log('Storage quota nearing limit, cleaning up old data', 'warn');\n                        return this.cleanupStorage();\n                    }\n                }\n            } else {\n                // Fallback for browsers without Storage API\n                // Check current storage size\n                let totalSize = 0;\n                for(let i = 0; i < localStorage.length; i++){\n                    const key = localStorage.key(i);\n                    if (key) {\n                        const value = localStorage.getItem(key) || '';\n                        totalSize += key.length + value.length;\n                    }\n                }\n                // Convert to MB for easier debugging\n                const sizeMB = totalSize / (1024 * 1024);\n                this.log(`Estimated localStorage usage: ${sizeMB.toFixed(2)}MB`);\n                // If over 4MB, clean up (typical localStorage limit is 5MB)\n                if (totalSize > this.MAX_STORAGE_SIZE) {\n                    this.log('Storage size nearing limit, cleaning up old data', 'warn');\n                    return this.cleanupStorage();\n                }\n            }\n            return true;\n        } catch (error) {\n            this.log(`Error checking storage quota: ${error}`, 'error');\n            return true; // Continue anyway to not block operation\n        }\n    }\n    // Clean up storage when approaching quota limits\n    static cleanupStorage() {\n        try {\n            // Strategy 1: Remove old chat messages (typically the largest data)\n            const keysToCheck = [];\n            for(let i = 0; i < localStorage.length; i++){\n                const key = localStorage.key(i);\n                if (key && (key.startsWith('messages_') || key.includes('draft_'))) {\n                    keysToCheck.push(key);\n                }\n            }\n            // Sort by last access time if available\n            const keysWithTime = keysToCheck.map((key)=>{\n                // Ensure key is a string before calling replace\n                const sessionId = String(key).replace('messages_', '').replace('draft_', '');\n                const lastSynced = localStorage.getItem(`lastSynced_${sessionId}`);\n                const timestamp = lastSynced ? new Date(lastSynced).getTime() : 0;\n                return {\n                    key,\n                    timestamp\n                };\n            });\n            // Sort oldest first\n            keysWithTime.sort((a, b)=>a.timestamp - b.timestamp);\n            // Remove oldest 30% of items\n            const itemsToRemove = Math.ceil(keysWithTime.length * 0.3);\n            for(let i = 0; i < itemsToRemove; i++){\n                if (i < keysWithTime.length) {\n                    localStorage.removeItem(keysWithTime[i].key);\n                    this.log(`Removed old data: ${keysWithTime[i].key}`);\n                }\n            }\n            // Strategy 2: If main snapshot is too large, try to trim it\n            const snapshot = localStorage.getItem(this.STORAGE_KEY);\n            if (snapshot && snapshot.length > 1024 * 1024) {\n                try {\n                    const parsedSnapshot = JSON.parse(snapshot);\n                    // Trim message history to reduce size\n                    if (parsedSnapshot.chatContext && parsedSnapshot.chatContext.messages) {\n                        // Keep only last 20 messages\n                        parsedSnapshot.chatContext.messages = parsedSnapshot.chatContext.messages.slice(-20);\n                    }\n                    // Store the trimmed version\n                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(parsedSnapshot));\n                    this.log('Trimmed main snapshot size');\n                } catch (e) {\n                    this.log(`Error trimming snapshot: ${e}`, 'error');\n                }\n            }\n            return true;\n        } catch (error) {\n            this.log(`Error cleaning up storage: ${error}`, 'error');\n            return false;\n        }\n    }\n    // Validate snapshot structure and schema\n    static validateSnapshotSchema(snapshot) {\n        if (!snapshot || typeof snapshot !== 'object') return false;\n        // Check required fields\n        if (typeof snapshot.timestamp !== 'number') return false;\n        // Check for required sub-objects\n        const requiredObjects = [\n            'userSession',\n            'chatContext',\n            'pageState',\n            'widgetStates'\n        ];\n        for (const obj of requiredObjects){\n            if (!snapshot[obj] || typeof snapshot[obj] !== 'object') {\n                return false;\n            }\n        }\n        return true;\n    }\n    // Create a backup of the current snapshot\n    static createBackup() {\n        try {\n            const currentSnapshot = localStorage.getItem(this.STORAGE_KEY);\n            if (currentSnapshot) {\n                localStorage.setItem(`${this.STORAGE_KEY}_BACKUP`, currentSnapshot);\n            }\n        } catch (error) {\n            this.log(`Failed to create backup: ${error}`, 'warn');\n        }\n    }\n    // Capture the current application state with enhanced safety\n    static async captureSnapshot(partialState) {\n        // Acquire a lock for state operations to prevent race conditions\n        const lockId = _StateOperationLock__WEBPACK_IMPORTED_MODULE_0__[\"default\"].acquireLock('state_snapshot', 'capture_snapshot');\n        if (!lockId) {\n            this.log('Could not acquire lock for state operation, another operation is in progress', 'warn');\n            return;\n        }\n        try {\n            // Validate storage availability\n            if (!this.isStorageAvailable()) {\n                this.log('Local storage not available', 'warn');\n                return;\n            }\n            // Check quota before writing\n            const quotaOk = await this.checkStorageQuota();\n            if (!quotaOk) {\n                this.log('Storage quota issues, data may not be saved completely', 'warn');\n            }\n            const existingSnapshot = this.retrieveSnapshot();\n            const newSnapshot = {\n                timestamp: Date.now(),\n                version: this.STORAGE_VERSION,\n                userSession: partialState?.userSession || existingSnapshot?.userSession || {},\n                chatContext: partialState?.chatContext || existingSnapshot?.chatContext || {},\n                pageState: partialState?.pageState || existingSnapshot?.pageState || {},\n                widgetStates: partialState?.widgetStates || existingSnapshot?.widgetStates || {}\n            };\n            // Create a backup of the current state before updating\n            this.createBackup();\n            // Attempt to save state\n            try {\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(newSnapshot));\n                this.log('State snapshot captured successfully');\n            } catch (storageError) {\n                // If failed due to quota, force cleanup and try again\n                this.log(`Storage error, forcing cleanup: ${storageError}`, 'warn');\n                this.cleanupStorage();\n                // Try one more time with a more minimal state\n                const minimalSnapshot = {\n                    timestamp: Date.now(),\n                    version: this.STORAGE_VERSION,\n                    userSession: newSnapshot.userSession,\n                    // Minimal objects to ensure basic functionality\n                    chatContext: {\n                        currentConversationId: newSnapshot.chatContext.currentConversationId\n                    },\n                    pageState: {\n                        lastVisitedPath: newSnapshot.pageState.lastVisitedPath\n                    },\n                    widgetStates: {}\n                };\n                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(minimalSnapshot));\n                this.log('Minimal state snapshot saved as fallback');\n            }\n        } catch (error) {\n            this.log(`Failed to capture state snapshot: ${error}`, 'error');\n        } finally{\n            // Always release the lock\n            _StateOperationLock__WEBPACK_IMPORTED_MODULE_0__[\"default\"].releaseLock('state_snapshot', lockId);\n        }\n    }\n    // Check local storage availability\n    static isStorageAvailable() {\n        try {\n            const testKey = '__storage_test__';\n            localStorage.setItem(testKey, testKey);\n            localStorage.removeItem(testKey);\n            return true;\n        } catch (e) {\n            return false;\n        }\n    }\n    // Validate snapshot age and integrity\n    static validateSnapshot(snapshot) {\n        if (!snapshot) return false;\n        // Check schema/structure validity\n        if (!this.validateSnapshotSchema(snapshot)) {\n            this.log('Snapshot has invalid schema, discarding', 'warn');\n            return false;\n        }\n        const currentTime = Date.now();\n        const snapshotAge = currentTime - snapshot.timestamp;\n        if (snapshotAge > this.MAX_SNAPSHOT_AGE) {\n            this.log('Snapshot too old, discarding', 'warn');\n            return false;\n        }\n        return true;\n    }\n    // Retrieve the last saved state snapshot with corruption recovery\n    static retrieveSnapshot() {\n        // We don't lock for reads, but we do check if there's a write in progress\n        if (_StateOperationLock__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isLocked('state_snapshot')) {\n            this.log('State snapshot is currently being updated, using existing snapshot', 'warn');\n        }\n        try {\n            const snapshot = localStorage.getItem(this.STORAGE_KEY);\n            if (!snapshot) return null;\n            try {\n                const parsedSnapshot = JSON.parse(snapshot);\n                // Validate snapshot integrity\n                if (this.validateSnapshot(parsedSnapshot)) {\n                    return parsedSnapshot;\n                } else {\n                    this.log('Invalid snapshot detected, attempting recovery', 'warn');\n                    return this.attemptSnapshotRecovery();\n                }\n            } catch (parseError) {\n                this.log(`JSON parse error: ${parseError}, attempting recovery`, 'error');\n                return this.attemptSnapshotRecovery();\n            }\n        } catch (error) {\n            this.log(`Failed to retrieve state snapshot: ${error}`, 'error');\n            return null;\n        }\n    }\n    // Attempt to recover corrupted state\n    static attemptSnapshotRecovery() {\n        try {\n            this.log('Attempting state recovery', 'warn');\n            // Strategy 1: Check for backup\n            const backupSnapshot = localStorage.getItem(`${this.STORAGE_KEY}_BACKUP`);\n            if (backupSnapshot) {\n                try {\n                    const parsedBackup = JSON.parse(backupSnapshot);\n                    if (this.validateSnapshot(parsedBackup)) {\n                        this.log('Recovered state from backup', 'info');\n                        return parsedBackup;\n                    }\n                } catch (e) {\n                    this.log('Backup snapshot also corrupted', 'warn');\n                }\n            }\n            // Strategy 2: Build from individual pieces in localStorage\n            const recoveredState = {\n                timestamp: Date.now(),\n                version: this.STORAGE_VERSION,\n                userSession: {},\n                chatContext: {},\n                pageState: {},\n                widgetStates: {}\n            };\n            // Try to get last path from localStorage\n            const activeSessionId = localStorage.getItem('activeSessionId');\n            if (activeSessionId) {\n                recoveredState.chatContext.currentConversationId = activeSessionId;\n            }\n            // Set recovery flag\n            recoveredState.recovered = true;\n            this.log('Created minimal recovered state', 'info');\n            return recoveredState;\n        } catch (error) {\n            this.log(`Recovery failed: ${error}`, 'error');\n            return null;\n        }\n    }\n    // Hydrate application state\n    static hydrateState(router) {\n        const snapshot = this.retrieveSnapshot();\n        if (snapshot) {\n            // Optionally navigate to last visited path\n            if (router && snapshot.pageState.lastVisitedPath) {\n                router.push(snapshot.pageState.lastVisitedPath);\n            }\n            return snapshot;\n        }\n        return {};\n    }\n    // Clear the snapshot (used during logout)\n    static clearSnapshot() {\n        localStorage.removeItem(this.STORAGE_KEY);\n    }\n}\n// Prevent accidental page unload\nfunction preventUnintendedRefresh(e) {\n    e.preventDefault();\n    e.returnValue = ''; // Required for Chrome\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (StatePersistenceManager);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL1N0YXRlUGVyc2lzdGVuY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ3NEO0FBNkR0RCxNQUFNQztJQUNKLE9BQU9DLGlCQUFpQjtRQUN0QixNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFDQSwwRUFBMEU7SUFDMUUsT0FBY0MsY0FBYyx5QkFBeUI7SUFDckQsT0FBZUMsbUJBQW1CLEtBQUssS0FBSyxLQUFLLEtBQUs7SUFDdEQsT0FBZUMsa0JBQWtCLEVBQUU7SUFDbkMsT0FBZUMsbUJBQW1CLElBQUksT0FBTyxLQUFLO0lBRWxELDZCQUE2QjtJQUM3QixPQUFlQyxJQUFJQyxPQUFlLEVBQUVDLFFBQW1DLE1BQU0sRUFBRTtRQUM3RSxNQUFNQyxZQUFZLElBQUlDLE9BQU9DLFdBQVc7UUFDeEMsTUFBTUMsYUFBYSxDQUFDLGtCQUFrQixFQUFFSixNQUFNSyxXQUFXLEdBQUcsRUFBRSxFQUFFSixVQUFVLEdBQUcsRUFBRUYsU0FBUztRQUV4RixPQUFPQztZQUNMLEtBQUs7Z0JBQVFNLFFBQVFSLEdBQUcsQ0FBQ007Z0JBQWE7WUFDdEMsS0FBSztnQkFBUUUsUUFBUUMsSUFBSSxDQUFDSDtnQkFBYTtZQUN2QyxLQUFLO2dCQUFTRSxRQUFRRSxLQUFLLENBQUNKO2dCQUFhO1FBQzNDO0lBRUEsMkNBQTJDO0lBQzNDLDhDQUE4QztJQUNoRDtJQUVBLHNDQUFzQztJQUN0QyxhQUFxQkssb0JBQXNDO1FBQ3pELElBQUk7WUFDRixxREFBcUQ7WUFDckQsSUFBSSxhQUFhQyxhQUFhLGNBQWNBLFVBQVVDLE9BQU8sRUFBRTtnQkFDN0QsTUFBTUMsV0FBVyxNQUFNRixVQUFVQyxPQUFPLENBQUNDLFFBQVE7Z0JBQ2pELE1BQU0sRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUUsR0FBR0Y7Z0JBRXpCLElBQUlDLFNBQVNDLE9BQU87b0JBQ2xCLE1BQU1DLGFBQWFGLFFBQVFDO29CQUMzQixJQUFJLENBQUNoQixHQUFHLENBQUMsQ0FB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LENBQUM7WUFDakI7WUFFQSx5Q0FBeUM7WUFDekMsTUFBTWdCLGtCQUFrQm5FLGFBQWFJLE9BQU8sQ0FBQztZQUM3QyxJQUFJK0QsaUJBQWlCO2dCQUNuQkQsZUFBZXZDLFdBQVcsQ0FBQzJCLHFCQUFxQixHQUFHYTtZQUNyRDtZQUVBLG9CQUFvQjtZQUNwQkQsZUFBZUUsU0FBUyxHQUFHO1lBRTNCLElBQUksQ0FBQzVGLEdBQUcsQ0FBQyxtQ0FBbUM7WUFDNUMsT0FBTzBGO1FBQ1QsRUFBRSxPQUFPaEYsT0FBTztZQUNkLElBQUksQ0FBQ1YsR0FBRyxDQUFDLENBQUMsaUJBQWlCLEVBQUVVLE9BQU8sRUFBRTtZQUN0QyxPQUFPO1FBQ1Q7SUFDRjtJQUVBLDRCQUE0QjtJQUM1QixPQUFPbUYsYUFBYUMsTUFBbUIsRUFBaUM7UUFDdEUsTUFBTS9DLFdBQVcsSUFBSSxDQUFDc0IsZ0JBQWdCO1FBRXRDLElBQUl0QixVQUFVO1lBQ1osMkNBQTJDO1lBQzNDLElBQUkrQyxVQUFVL0MsU0FBUzJCLFNBQVMsQ0FBQ0ssZUFBZSxFQUFFO2dCQUNoRGUsT0FBTzdELElBQUksQ0FBQ2MsU0FBUzJCLFNBQVMsQ0FBQ0ssZUFBZTtZQUNoRDtZQUVBLE9BQU9oQztRQUNUO1FBRUEsT0FBTyxDQUFDO0lBQ1Y7SUFFQSwwQ0FBMEM7SUFDMUMsT0FBT2dELGdCQUFzQjtRQUMzQnZFLGFBQWFzQixVQUFVLENBQUMsSUFBSSxDQUFDbEQsV0FBVztJQUMxQztBQUNGO0FBRUEsaUNBQWlDO0FBQzFCLFNBQVNvRyx5QkFBeUJ4QyxDQUFvQjtJQUMzREEsRUFBRXlDLGNBQWM7SUFDaEJ6QyxFQUFFMEMsV0FBVyxHQUFHLElBQUksc0JBQXNCO0FBQzVDO0FBRUEsaUVBQWV6Ryx1QkFBdUJBLEVBQUMiLCJzb3VyY2VzIjpbIi9Vc2Vycy93b25rYXN3b3JsZC9Eb3dubG9hZHMvZ3JhY2UtcHJvamVjdC9zcmMvdWkvdXRpbHMvU3RhdGVQZXJzaXN0ZW5jZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0Um91dGVyIH0gZnJvbSAnbmV4dC9yb3V0ZXInO1xuaW1wb3J0IFN0YXRlT3BlcmF0aW9uTG9jayBmcm9tICcuL1N0YXRlT3BlcmF0aW9uTG9jayc7XG5cbi8vIERlZmluZSB0aGUgc2hhcGUgb2Ygb3VyIHBlcnNpc3RlbnQgc3RhdGVcbmV4cG9ydCBpbnRlcmZhY2UgRHluYW1pY1N0YXRlU25hcHNob3Qge1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgdmVyc2lvbj86IG51bWJlcjsgICAgICAvLyBTY2hlbWEgdmVyc2lvbiBmb3IgbWlncmF0aW9uc1xuICByZWNvdmVyZWQ/OiBib29sZWFuOyAgIC8vIEZsYWcgZm9yIHJlY292ZXJlZCBzdGF0ZVxuICB1c2VyU2Vzc2lvbjoge1xuICAgIHRva2VuPzogc3RyaW5nO1xuICAgIHVzZXJuYW1lPzogc3RyaW5nO1xuICB9O1xuICBjaGF0Q29udGV4dDoge1xuICAgIGN1cnJlbnRDb252ZXJzYXRpb25JZD86IHN0cmluZztcbiAgICBkcmFmdE1lc3NhZ2U/OiBzdHJpbmc7XG4gICAgbGFzdE1lc3NhZ2VUaW1lc3RhbXA/OiBudW1iZXI7XG4gIH07XG4gIHBhZ2VTdGF0ZToge1xuICAgIGxhc3RWaXNpdGVkUGF0aD86IHN0cmluZztcbiAgICBzY3JvbGxQb3NpdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICB9O1xuICB3aWRnZXRTdGF0ZXM6IHtcbiAgICB0cmFkaW5nUG9zaXRpb25zPzogYW55W107XG4gICAgd2FsbGV0QmFsYW5jZT86IG51bWJlcjtcbiAgfTtcbiAgXG4gIC8vIEV4dGVuZGVkIHN0YXRlIHByb3BlcnRpZXNcbiAgY2hhdFN0YXRlPzoge1xuICAgIGN1cnJlbnRTZXNzaW9uSWQ/OiBzdHJpbmc7XG4gICAgYWN0aXZlU2Vzc2lvbnM/OiBzdHJpbmdbXTtcbiAgICBzZXNzaW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gICAgZHJhZnRNZXNzYWdlcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIH07XG4gIFxuICB0cmFkaW5nU3RhdGU/OiB7XG4gICAgc2VsZWN0ZWRUb2tlbj86IGFueTtcbiAgICB3YXRjaGxpc3Q/OiBzdHJpbmdbXTtcbiAgICB0cmFkZUhpc3Rvcnk/OiBhbnlbXTtcbiAgICB0cmFkZUZvcm0/OiBhbnk7XG4gICAgcmVzb2x1dGlvbj86IHN0cmluZztcbiAgICBzZWFyY2g/OiBzdHJpbmc7XG4gICAgcG9zaXRpb25zPzogYW55W107XG4gIH07XG4gIFxuICB3YWxsZXRTdGF0ZT86IHtcbiAgICBjb25uZWN0ZWRXYWxsZXRzPzogYW55W107XG4gICAgdHJhbnNhY3Rpb25zPzogYW55W107XG4gIH07XG4gIFxuICBzb2NpYWxTdGF0ZT86IHtcbiAgICBwb3N0cz86IGFueVtdO1xuICAgIGZvbGxvd2luZz86IHN0cmluZ1tdO1xuICAgIG5vdGlmaWNhdGlvbnM/OiBhbnlbXTtcbiAgfTtcbiAgXG4gIHVpU3RhdGU/OiB7XG4gICAgZGFya01vZGU/OiBib29sZWFuO1xuICAgIHNpZGViYXJPcGVuPzogYm9vbGVhbjtcbiAgICBhY3RpdmVUYWJzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgfTtcbn1cblxuY2xhc3MgU3RhdGVQZXJzaXN0ZW5jZU1hbmFnZXIge1xuICBzdGF0aWMgZ2V0U3RvcmVkU3RhdGUoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdNZXRob2Qgbm90IGltcGxlbWVudGVkLicpO1xuICB9XG4gIC8vIFN0b3JhZ2Uga2V5cyAtIG1ha2luZyB0aGlzIHB1YmxpYyBzbyBpdCBjYW4gYmUgcmVmZXJlbmNlZCBieSBzeW5jIGxvZ2ljXG4gIHB1YmxpYyBzdGF0aWMgU1RPUkFHRV9LRVkgPSAnR1JBQ0VfRFlOQU1JQ19TTkFQU0hPVCc7XG4gIHByaXZhdGUgc3RhdGljIE1BWF9TTkFQU0hPVF9BR0UgPSAyNCAqIDYwICogNjAgKiAxMDAwOyAvLyAyNCBob3Vyc1xuICBwcml2YXRlIHN0YXRpYyBTVE9SQUdFX1ZFUlNJT04gPSAxOyAvLyBVc2VkIGZvciBzY2hlbWEgbWlncmF0aW9uc1xuICBwcml2YXRlIHN0YXRpYyBNQVhfU1RPUkFHRV9TSVpFID0gNCAqIDEwMjQgKiAxMDI0OyAvLyA0TUIgbWF4IHNpemUgKGxvY2FsU3RvcmFnZSBpcyB0eXBpY2FsbHkgNU1CKVxuXG4gIC8vIEFkdmFuY2VkIGxvZ2dpbmcgbWVjaGFuaXNtXG4gIHByaXZhdGUgc3RhdGljIGxvZyhtZXNzYWdlOiBzdHJpbmcsIGxldmVsOiAnaW5mbycgfCAnd2FybicgfCAnZXJyb3InID0gJ2luZm8nKSB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xuICAgIGNvbnN0IGxvZ01lc3NhZ2UgPSBgW1N0YXRlUGVyc2lzdGVuY2U6JHtsZXZlbC50b1VwcGVyQ2FzZSgpfV0gJHt0aW1lc3RhbXB9IC0gJHttZXNzYWdlfWA7XG4gICAgXG4gICAgc3dpdGNoKGxldmVsKSB7XG4gICAgICBjYXNlICdpbmZvJzogY29uc29sZS5sb2cobG9nTWVzc2FnZSk7IGJyZWFrO1xuICAgICAgY2FzZSAnd2Fybic6IGNvbnNvbGUud2Fybihsb2dNZXNzYWdlKTsgYnJlYWs7XG4gICAgICBjYXNlICdlcnJvcic6IGNvbnNvbGUuZXJyb3IobG9nTWVzc2FnZSk7IGJyZWFrO1xuICAgIH1cblxuICAgIC8vIE9wdGlvbmFsOiBTZW5kIHRvIGVycm9yIHRyYWNraW5nIHNlcnZpY2VcbiAgICAvLyB0aGlzLnJlcG9ydFRvRXJyb3JUcmFja2luZyhtZXNzYWdlLCBsZXZlbCk7XG4gIH1cblxuICAvLyBDaGVjayBzdG9yYWdlIHF1b3RhIGFuZCBtYW5hZ2Ugc2l6ZVxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBjaGVja1N0b3JhZ2VRdW90YSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgLy8gVXNlIHRoZSBTdG9yYWdlIEFQSSBpZiBhdmFpbGFibGUgKG1vZGVybiBicm93c2VycylcbiAgICAgIGlmICgnc3RvcmFnZScgaW4gbmF2aWdhdG9yICYmICdlc3RpbWF0ZScgaW4gbmF2aWdhdG9yLnN0b3JhZ2UpIHtcbiAgICAgICAgY29uc3QgZXN0aW1hdGUgPSBhd2FpdCBuYXZpZ2F0b3Iuc3RvcmFnZS5lc3RpbWF0ZSgpO1xuICAgICAgICBjb25zdCB7IHVzYWdlLCBxdW90YSB9ID0gZXN0aW1hdGU7XG4gICAgICAgIFxuICAgICAgICBpZiAodXNhZ2UgJiYgcXVvdGEpIHtcbiAgICAgICAgICBjb25zdCB1c2FnZVJhdGlvID0gdXNhZ2UgLyBxdW90YTtcbiAgICAgICAgICB0aGlzLmxvZyhgU3RvcmFnZSB1c2FnZTogJHsodXNhZ2VSYXRpbyAqIDEwMCkudG9GaXhlZCgyKX0lICgke01hdGgucm91bmQodXNhZ2UgLyAxMDI0IC8gMTAyNCl9TUIgLyAke01hdGgucm91bmQocXVvdGEgLyAxMDI0IC8gMTAyNCl9TUIpYCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gSWYgb3ZlciA5MCUgb2YgcXVvdGEsIHRyeSB0byBjbGVhbiB1cFxuICAgICAgICAgIGlmICh1c2FnZVJhdGlvID4gMC45KSB7XG4gICAgICAgICAgICB0aGlzLmxvZygnU3RvcmFnZSBxdW90YSBuZWFyaW5nIGxpbWl0LCBjbGVhbmluZyB1cCBvbGQgZGF0YScsICd3YXJuJyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jbGVhbnVwU3RvcmFnZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRmFsbGJhY2sgZm9yIGJyb3dzZXJzIHdpdGhvdXQgU3RvcmFnZSBBUElcbiAgICAgICAgLy8gQ2hlY2sgY3VycmVudCBzdG9yYWdlIHNpemVcbiAgICAgICAgbGV0IHRvdGFsU2l6ZSA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYWxTdG9yYWdlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gbG9jYWxTdG9yYWdlLmtleShpKTtcbiAgICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkgfHwgJyc7XG4gICAgICAgICAgICB0b3RhbFNpemUgKz0ga2V5Lmxlbmd0aCArIHZhbHVlLmxlbmd0aDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENvbnZlcnQgdG8gTUIgZm9yIGVhc2llciBkZWJ1Z2dpbmdcbiAgICAgICAgY29uc3Qgc2l6ZU1CID0gdG90YWxTaXplIC8gKDEwMjQgKiAxMDI0KTtcbiAgICAgICAgdGhpcy5sb2coYEVzdGltYXRlZCBsb2NhbFN0b3JhZ2UgdXNhZ2U6ICR7c2l6ZU1CLnRvRml4ZWQoMil9TUJgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG92ZXIgNE1CLCBjbGVhbiB1cCAodHlwaWNhbCBsb2NhbFN0b3JhZ2UgbGltaXQgaXMgNU1CKVxuICAgICAgICBpZiAodG90YWxTaXplID4gdGhpcy5NQVhfU1RPUkFHRV9TSVpFKSB7XG4gICAgICAgICAgdGhpcy5sb2coJ1N0b3JhZ2Ugc2l6ZSBuZWFyaW5nIGxpbWl0LCBjbGVhbmluZyB1cCBvbGQgZGF0YScsICd3YXJuJyk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuY2xlYW51cFN0b3JhZ2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2coYEVycm9yIGNoZWNraW5nIHN0b3JhZ2UgcXVvdGE6ICR7ZXJyb3J9YCwgJ2Vycm9yJyk7XG4gICAgICByZXR1cm4gdHJ1ZTsgLy8gQ29udGludWUgYW55d2F5IHRvIG5vdCBibG9jayBvcGVyYXRpb25cbiAgICB9XG4gIH1cbiAgXG4gIC8vIENsZWFuIHVwIHN0b3JhZ2Ugd2hlbiBhcHByb2FjaGluZyBxdW90YSBsaW1pdHNcbiAgcHJpdmF0ZSBzdGF0aWMgY2xlYW51cFN0b3JhZ2UoKTogYm9vbGVhbiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFN0cmF0ZWd5IDE6IFJlbW92ZSBvbGQgY2hhdCBtZXNzYWdlcyAodHlwaWNhbGx5IHRoZSBsYXJnZXN0IGRhdGEpXG4gICAgICBjb25zdCBrZXlzVG9DaGVjazogc3RyaW5nW10gPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYWxTdG9yYWdlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGtleSA9IGxvY2FsU3RvcmFnZS5rZXkoaSk7XG4gICAgICAgIGlmIChrZXkgJiYgKGtleS5zdGFydHNXaXRoKCdtZXNzYWdlc18nKSB8fCBrZXkuaW5jbHVkZXMoJ2RyYWZ0XycpKSkge1xuICAgICAgICAgIGtleXNUb0NoZWNrLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTb3J0IGJ5IGxhc3QgYWNjZXNzIHRpbWUgaWYgYXZhaWxhYmxlXG4gICAgICBjb25zdCBrZXlzV2l0aFRpbWUgPSBrZXlzVG9DaGVjay5tYXAoa2V5ID0+IHtcbiAgICAgICAgLy8gRW5zdXJlIGtleSBpcyBhIHN0cmluZyBiZWZvcmUgY2FsbGluZyByZXBsYWNlXG4gICAgICAgIGNvbnN0IHNlc3Npb25JZCA9IFN0cmluZyhrZXkpLnJlcGxhY2UoJ21lc3NhZ2VzXycsICcnKS5yZXBsYWNlKCdkcmFmdF8nLCAnJyk7XG4gICAgICAgIGNvbnN0IGxhc3RTeW5jZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShgbGFzdFN5bmNlZF8ke3Nlc3Npb25JZH1gKTtcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbGFzdFN5bmNlZCA/IG5ldyBEYXRlKGxhc3RTeW5jZWQpLmdldFRpbWUoKSA6IDA7XG4gICAgICAgIHJldHVybiB7IGtleSwgdGltZXN0YW1wIH07XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gU29ydCBvbGRlc3QgZmlyc3RcbiAgICAgIGtleXNXaXRoVGltZS5zb3J0KChhLCBiKSA9PiBhLnRpbWVzdGFtcCAtIGIudGltZXN0YW1wKTtcbiAgICAgIFxuICAgICAgLy8gUmVtb3ZlIG9sZGVzdCAzMCUgb2YgaXRlbXNcbiAgICAgIGNvbnN0IGl0ZW1zVG9SZW1vdmUgPSBNYXRoLmNlaWwoa2V5c1dpdGhUaW1lLmxlbmd0aCAqIDAuMyk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zVG9SZW1vdmU7IGkrKykge1xuICAgICAgICBpZiAoaSA8IGtleXNXaXRoVGltZS5sZW5ndGgpIHtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXlzV2l0aFRpbWVbaV0ua2V5KTtcbiAgICAgICAgICB0aGlzLmxvZyhgUmVtb3ZlZCBvbGQgZGF0YTogJHtrZXlzV2l0aFRpbWVbaV0ua2V5fWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFN0cmF0ZWd5IDI6IElmIG1haW4gc25hcHNob3QgaXMgdG9vIGxhcmdlLCB0cnkgdG8gdHJpbSBpdFxuICAgICAgY29uc3Qgc25hcHNob3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLlNUT1JBR0VfS0VZKTtcbiAgICAgIGlmIChzbmFwc2hvdCAmJiBzbmFwc2hvdC5sZW5ndGggPiAxMDI0ICogMTAyNCkgeyAvLyBJZiBvdmVyIDFNQlxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHBhcnNlZFNuYXBzaG90ID0gSlNPTi5wYXJzZShzbmFwc2hvdCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gVHJpbSBtZXNzYWdlIGhpc3RvcnkgdG8gcmVkdWNlIHNpemVcbiAgICAgICAgICBpZiAocGFyc2VkU25hcHNob3QuY2hhdENvbnRleHQgJiYgcGFyc2VkU25hcHNob3QuY2hhdENvbnRleHQubWVzc2FnZXMpIHtcbiAgICAgICAgICAgIC8vIEtlZXAgb25seSBsYXN0IDIwIG1lc3NhZ2VzXG4gICAgICAgICAgICBwYXJzZWRTbmFwc2hvdC5jaGF0Q29udGV4dC5tZXNzYWdlcyA9IFxuICAgICAgICAgICAgICBwYXJzZWRTbmFwc2hvdC5jaGF0Q29udGV4dC5tZXNzYWdlcy5zbGljZSgtMjApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBTdG9yZSB0aGUgdHJpbW1lZCB2ZXJzaW9uXG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGhpcy5TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkocGFyc2VkU25hcHNob3QpKTtcbiAgICAgICAgICB0aGlzLmxvZygnVHJpbW1lZCBtYWluIHNuYXBzaG90IHNpemUnKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHRoaXMubG9nKGBFcnJvciB0cmltbWluZyBzbmFwc2hvdDogJHtlfWAsICdlcnJvcicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZyhgRXJyb3IgY2xlYW5pbmcgdXAgc3RvcmFnZTogJHtlcnJvcn1gLCAnZXJyb3InKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIFZhbGlkYXRlIHNuYXBzaG90IHN0cnVjdHVyZSBhbmQgc2NoZW1hXG4gIHByaXZhdGUgc3RhdGljIHZhbGlkYXRlU25hcHNob3RTY2hlbWEoc25hcHNob3Q6IGFueSk6IGJvb2xlYW4ge1xuICAgIGlmICghc25hcHNob3QgfHwgdHlwZW9mIHNuYXBzaG90ICE9PSAnb2JqZWN0JykgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIC8vIENoZWNrIHJlcXVpcmVkIGZpZWxkc1xuICAgIGlmICh0eXBlb2Ygc25hcHNob3QudGltZXN0YW1wICE9PSAnbnVtYmVyJykgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIC8vIENoZWNrIGZvciByZXF1aXJlZCBzdWItb2JqZWN0c1xuICAgIGNvbnN0IHJlcXVpcmVkT2JqZWN0cyA9IFsndXNlclNlc3Npb24nLCAnY2hhdENvbnRleHQnLCAncGFnZVN0YXRlJywgJ3dpZGdldFN0YXRlcyddO1xuICAgIGZvciAoY29uc3Qgb2JqIG9mIHJlcXVpcmVkT2JqZWN0cykge1xuICAgICAgaWYgKCFzbmFwc2hvdFtvYmpdIHx8IHR5cGVvZiBzbmFwc2hvdFtvYmpdICE9PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLy8gQ3JlYXRlIGEgYmFja3VwIG9mIHRoZSBjdXJyZW50IHNuYXBzaG90XG4gIHByaXZhdGUgc3RhdGljIGNyZWF0ZUJhY2t1cCgpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY3VycmVudFNuYXBzaG90ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGhpcy5TVE9SQUdFX0tFWSk7XG4gICAgICBpZiAoY3VycmVudFNuYXBzaG90KSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGAke3RoaXMuU1RPUkFHRV9LRVl9X0JBQ0tVUGAsIGN1cnJlbnRTbmFwc2hvdCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nKGBGYWlsZWQgdG8gY3JlYXRlIGJhY2t1cDogJHtlcnJvcn1gLCAnd2FybicpO1xuICAgIH1cbiAgfVxuXG4gIC8vIENhcHR1cmUgdGhlIGN1cnJlbnQgYXBwbGljYXRpb24gc3RhdGUgd2l0aCBlbmhhbmNlZCBzYWZldHlcbiAgc3RhdGljIGFzeW5jIGNhcHR1cmVTbmFwc2hvdChwYXJ0aWFsU3RhdGU/OiBQYXJ0aWFsPER5bmFtaWNTdGF0ZVNuYXBzaG90Pik6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIEFjcXVpcmUgYSBsb2NrIGZvciBzdGF0ZSBvcGVyYXRpb25zIHRvIHByZXZlbnQgcmFjZSBjb25kaXRpb25zXG4gICAgY29uc3QgbG9ja0lkID0gU3RhdGVPcGVyYXRpb25Mb2NrLmFjcXVpcmVMb2NrKCdzdGF0ZV9zbmFwc2hvdCcsICdjYXB0dXJlX3NuYXBzaG90Jyk7XG4gICAgaWYgKCFsb2NrSWQpIHtcbiAgICAgIHRoaXMubG9nKCdDb3VsZCBub3QgYWNxdWlyZSBsb2NrIGZvciBzdGF0ZSBvcGVyYXRpb24sIGFub3RoZXIgb3BlcmF0aW9uIGlzIGluIHByb2dyZXNzJywgJ3dhcm4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIFZhbGlkYXRlIHN0b3JhZ2UgYXZhaWxhYmlsaXR5XG4gICAgICBpZiAoIXRoaXMuaXNTdG9yYWdlQXZhaWxhYmxlKCkpIHtcbiAgICAgICAgdGhpcy5sb2coJ0xvY2FsIHN0b3JhZ2Ugbm90IGF2YWlsYWJsZScsICd3YXJuJyk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgcXVvdGEgYmVmb3JlIHdyaXRpbmdcbiAgICAgIGNvbnN0IHF1b3RhT2sgPSBhd2FpdCB0aGlzLmNoZWNrU3RvcmFnZVF1b3RhKCk7XG4gICAgICBpZiAoIXF1b3RhT2spIHtcbiAgICAgICAgdGhpcy5sb2coJ1N0b3JhZ2UgcXVvdGEgaXNzdWVzLCBkYXRhIG1heSBub3QgYmUgc2F2ZWQgY29tcGxldGVseScsICd3YXJuJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGV4aXN0aW5nU25hcHNob3QgPSB0aGlzLnJldHJpZXZlU25hcHNob3QoKTtcbiAgICAgIGNvbnN0IG5ld1NuYXBzaG90OiBEeW5hbWljU3RhdGVTbmFwc2hvdCA9IHtcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB2ZXJzaW9uOiB0aGlzLlNUT1JBR0VfVkVSU0lPTiwgLy8gQWRkIHZlcnNpb24gZm9yIHNjaGVtYSBtaWdyYXRpb25zXG4gICAgICAgIHVzZXJTZXNzaW9uOiBwYXJ0aWFsU3RhdGU/LnVzZXJTZXNzaW9uIHx8IGV4aXN0aW5nU25hcHNob3Q/LnVzZXJTZXNzaW9uIHx8IHt9LFxuICAgICAgICBjaGF0Q29udGV4dDogcGFydGlhbFN0YXRlPy5jaGF0Q29udGV4dCB8fCBleGlzdGluZ1NuYXBzaG90Py5jaGF0Q29udGV4dCB8fCB7fSxcbiAgICAgICAgcGFnZVN0YXRlOiBwYXJ0aWFsU3RhdGU/LnBhZ2VTdGF0ZSB8fCBleGlzdGluZ1NuYXBzaG90Py5wYWdlU3RhdGUgfHwge30sXG4gICAgICAgIHdpZGdldFN0YXRlczogcGFydGlhbFN0YXRlPy53aWRnZXRTdGF0ZXMgfHwgZXhpc3RpbmdTbmFwc2hvdD8ud2lkZ2V0U3RhdGVzIHx8IHt9XG4gICAgICB9O1xuXG4gICAgICAvLyBDcmVhdGUgYSBiYWNrdXAgb2YgdGhlIGN1cnJlbnQgc3RhdGUgYmVmb3JlIHVwZGF0aW5nXG4gICAgICB0aGlzLmNyZWF0ZUJhY2t1cCgpO1xuICAgICAgXG4gICAgICAvLyBBdHRlbXB0IHRvIHNhdmUgc3RhdGVcbiAgICAgIHRyeSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRoaXMuU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KG5ld1NuYXBzaG90KSk7XG4gICAgICAgIHRoaXMubG9nKCdTdGF0ZSBzbmFwc2hvdCBjYXB0dXJlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgIH0gY2F0Y2ggKHN0b3JhZ2VFcnJvcikge1xuICAgICAgICAvLyBJZiBmYWlsZWQgZHVlIHRvIHF1b3RhLCBmb3JjZSBjbGVhbnVwIGFuZCB0cnkgYWdhaW5cbiAgICAgICAgdGhpcy5sb2coYFN0b3JhZ2UgZXJyb3IsIGZvcmNpbmcgY2xlYW51cDogJHtzdG9yYWdlRXJyb3J9YCwgJ3dhcm4nKTtcbiAgICAgICAgdGhpcy5jbGVhbnVwU3RvcmFnZSgpO1xuICAgICAgICBcbiAgICAgICAgLy8gVHJ5IG9uZSBtb3JlIHRpbWUgd2l0aCBhIG1vcmUgbWluaW1hbCBzdGF0ZVxuICAgICAgICBjb25zdCBtaW5pbWFsU25hcHNob3QgPSB7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHZlcnNpb246IHRoaXMuU1RPUkFHRV9WRVJTSU9OLFxuICAgICAgICAgIHVzZXJTZXNzaW9uOiBuZXdTbmFwc2hvdC51c2VyU2Vzc2lvbixcbiAgICAgICAgICAvLyBNaW5pbWFsIG9iamVjdHMgdG8gZW5zdXJlIGJhc2ljIGZ1bmN0aW9uYWxpdHlcbiAgICAgICAgICBjaGF0Q29udGV4dDogeyBjdXJyZW50Q29udmVyc2F0aW9uSWQ6IG5ld1NuYXBzaG90LmNoYXRDb250ZXh0LmN1cnJlbnRDb252ZXJzYXRpb25JZCB9LFxuICAgICAgICAgIHBhZ2VTdGF0ZTogeyBsYXN0VmlzaXRlZFBhdGg6IG5ld1NuYXBzaG90LnBhZ2VTdGF0ZS5sYXN0VmlzaXRlZFBhdGggfSxcbiAgICAgICAgICB3aWRnZXRTdGF0ZXM6IHt9XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0aGlzLlNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShtaW5pbWFsU25hcHNob3QpKTtcbiAgICAgICAgdGhpcy5sb2coJ01pbmltYWwgc3RhdGUgc25hcHNob3Qgc2F2ZWQgYXMgZmFsbGJhY2snKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5sb2coYEZhaWxlZCB0byBjYXB0dXJlIHN0YXRlIHNuYXBzaG90OiAke2Vycm9yfWAsICdlcnJvcicpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBBbHdheXMgcmVsZWFzZSB0aGUgbG9ja1xuICAgICAgU3RhdGVPcGVyYXRpb25Mb2NrLnJlbGVhc2VMb2NrKCdzdGF0ZV9zbmFwc2hvdCcsIGxvY2tJZCk7XG4gICAgfVxuICB9XG5cbiAgLy8gQ2hlY2sgbG9jYWwgc3RvcmFnZSBhdmFpbGFiaWxpdHlcbiAgcHJpdmF0ZSBzdGF0aWMgaXNTdG9yYWdlQXZhaWxhYmxlKCk6IGJvb2xlYW4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB0ZXN0S2V5ID0gJ19fc3RvcmFnZV90ZXN0X18nO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odGVzdEtleSwgdGVzdEtleSk7XG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSh0ZXN0S2V5KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvLyBWYWxpZGF0ZSBzbmFwc2hvdCBhZ2UgYW5kIGludGVncml0eVxuICBwcml2YXRlIHN0YXRpYyB2YWxpZGF0ZVNuYXBzaG90KHNuYXBzaG90OiBEeW5hbWljU3RhdGVTbmFwc2hvdCk6IGJvb2xlYW4ge1xuICAgIGlmICghc25hcHNob3QpIHJldHVybiBmYWxzZTtcblxuICAgIC8vIENoZWNrIHNjaGVtYS9zdHJ1Y3R1cmUgdmFsaWRpdHlcbiAgICBpZiAoIXRoaXMudmFsaWRhdGVTbmFwc2hvdFNjaGVtYShzbmFwc2hvdCkpIHtcbiAgICAgIHRoaXMubG9nKCdTbmFwc2hvdCBoYXMgaW52YWxpZCBzY2hlbWEsIGRpc2NhcmRpbmcnLCAnd2FybicpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBzbmFwc2hvdEFnZSA9IGN1cnJlbnRUaW1lIC0gc25hcHNob3QudGltZXN0YW1wO1xuXG4gICAgaWYgKHNuYXBzaG90QWdlID4gdGhpcy5NQVhfU05BUFNIT1RfQUdFKSB7XG4gICAgICB0aGlzLmxvZygnU25hcHNob3QgdG9vIG9sZCwgZGlzY2FyZGluZycsICd3YXJuJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBSZXRyaWV2ZSB0aGUgbGFzdCBzYXZlZCBzdGF0ZSBzbmFwc2hvdCB3aXRoIGNvcnJ1cHRpb24gcmVjb3ZlcnlcbiAgc3RhdGljIHJldHJpZXZlU25hcHNob3QoKTogRHluYW1pY1N0YXRlU25hcHNob3QgfCBudWxsIHtcbiAgICAvLyBXZSBkb24ndCBsb2NrIGZvciByZWFkcywgYnV0IHdlIGRvIGNoZWNrIGlmIHRoZXJlJ3MgYSB3cml0ZSBpbiBwcm9ncmVzc1xuICAgIGlmIChTdGF0ZU9wZXJhdGlvbkxvY2suaXNMb2NrZWQoJ3N0YXRlX3NuYXBzaG90JykpIHtcbiAgICAgIHRoaXMubG9nKCdTdGF0ZSBzbmFwc2hvdCBpcyBjdXJyZW50bHkgYmVpbmcgdXBkYXRlZCwgdXNpbmcgZXhpc3Rpbmcgc25hcHNob3QnLCAnd2FybicpO1xuICAgIH1cbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc25hcHNob3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSh0aGlzLlNUT1JBR0VfS0VZKTtcbiAgICAgIGlmICghc25hcHNob3QpIHJldHVybiBudWxsO1xuXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJzZWRTbmFwc2hvdDogRHluYW1pY1N0YXRlU25hcHNob3QgPSBKU09OLnBhcnNlKHNuYXBzaG90KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFZhbGlkYXRlIHNuYXBzaG90IGludGVncml0eVxuICAgICAgICBpZiAodGhpcy52YWxpZGF0ZVNuYXBzaG90KHBhcnNlZFNuYXBzaG90KSkge1xuICAgICAgICAgIHJldHVybiBwYXJzZWRTbmFwc2hvdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmxvZygnSW52YWxpZCBzbmFwc2hvdCBkZXRlY3RlZCwgYXR0ZW1wdGluZyByZWNvdmVyeScsICd3YXJuJyk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYXR0ZW1wdFNuYXBzaG90UmVjb3ZlcnkoKTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICB0aGlzLmxvZyhgSlNPTiBwYXJzZSBlcnJvcjogJHtwYXJzZUVycm9yfSwgYXR0ZW1wdGluZyByZWNvdmVyeWAsICdlcnJvcicpO1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRlbXB0U25hcHNob3RSZWNvdmVyeSgpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmxvZyhgRmFpbGVkIHRvIHJldHJpZXZlIHN0YXRlIHNuYXBzaG90OiAke2Vycm9yfWAsICdlcnJvcicpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG4gIFxuICAvLyBBdHRlbXB0IHRvIHJlY292ZXIgY29ycnVwdGVkIHN0YXRlXG4gIHByaXZhdGUgc3RhdGljIGF0dGVtcHRTbmFwc2hvdFJlY292ZXJ5KCk6IER5bmFtaWNTdGF0ZVNuYXBzaG90IHwgbnVsbCB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMubG9nKCdBdHRlbXB0aW5nIHN0YXRlIHJlY292ZXJ5JywgJ3dhcm4nKTtcbiAgICAgIFxuICAgICAgLy8gU3RyYXRlZ3kgMTogQ2hlY2sgZm9yIGJhY2t1cFxuICAgICAgY29uc3QgYmFja3VwU25hcHNob3QgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShgJHt0aGlzLlNUT1JBR0VfS0VZfV9CQUNLVVBgKTtcbiAgICAgIGlmIChiYWNrdXBTbmFwc2hvdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHBhcnNlZEJhY2t1cCA9IEpTT04ucGFyc2UoYmFja3VwU25hcHNob3QpO1xuICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlU25hcHNob3QocGFyc2VkQmFja3VwKSkge1xuICAgICAgICAgICAgdGhpcy5sb2coJ1JlY292ZXJlZCBzdGF0ZSBmcm9tIGJhY2t1cCcsICdpbmZvJyk7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VkQmFja3VwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHRoaXMubG9nKCdCYWNrdXAgc25hcHNob3QgYWxzbyBjb3JydXB0ZWQnLCAnd2FybicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFN0cmF0ZWd5IDI6IEJ1aWxkIGZyb20gaW5kaXZpZHVhbCBwaWVjZXMgaW4gbG9jYWxTdG9yYWdlXG4gICAgICBjb25zdCByZWNvdmVyZWRTdGF0ZTogRHluYW1pY1N0YXRlU25hcHNob3QgPSB7XG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgdmVyc2lvbjogdGhpcy5TVE9SQUdFX1ZFUlNJT04sXG4gICAgICAgIHVzZXJTZXNzaW9uOiB7fSxcbiAgICAgICAgY2hhdENvbnRleHQ6IHt9LFxuICAgICAgICBwYWdlU3RhdGU6IHt9LFxuICAgICAgICB3aWRnZXRTdGF0ZXM6IHt9XG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBUcnkgdG8gZ2V0IGxhc3QgcGF0aCBmcm9tIGxvY2FsU3RvcmFnZVxuICAgICAgY29uc3QgYWN0aXZlU2Vzc2lvbklkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjdGl2ZVNlc3Npb25JZCcpO1xuICAgICAgaWYgKGFjdGl2ZVNlc3Npb25JZCkge1xuICAgICAgICByZWNvdmVyZWRTdGF0ZS5jaGF0Q29udGV4dC5jdXJyZW50Q29udmVyc2F0aW9uSWQgPSBhY3RpdmVTZXNzaW9uSWQ7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFNldCByZWNvdmVyeSBmbGFnXG4gICAgICByZWNvdmVyZWRTdGF0ZS5yZWNvdmVyZWQgPSB0cnVlO1xuICAgICAgXG4gICAgICB0aGlzLmxvZygnQ3JlYXRlZCBtaW5pbWFsIHJlY292ZXJlZCBzdGF0ZScsICdpbmZvJyk7XG4gICAgICByZXR1cm4gcmVjb3ZlcmVkU3RhdGU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMubG9nKGBSZWNvdmVyeSBmYWlsZWQ6ICR7ZXJyb3J9YCwgJ2Vycm9yJyk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvLyBIeWRyYXRlIGFwcGxpY2F0aW9uIHN0YXRlXG4gIHN0YXRpYyBoeWRyYXRlU3RhdGUocm91dGVyPzogTmV4dFJvdXRlcik6IFBhcnRpYWw8RHluYW1pY1N0YXRlU25hcHNob3Q+IHtcbiAgICBjb25zdCBzbmFwc2hvdCA9IHRoaXMucmV0cmlldmVTbmFwc2hvdCgpO1xuICAgIFxuICAgIGlmIChzbmFwc2hvdCkge1xuICAgICAgLy8gT3B0aW9uYWxseSBuYXZpZ2F0ZSB0byBsYXN0IHZpc2l0ZWQgcGF0aFxuICAgICAgaWYgKHJvdXRlciAmJiBzbmFwc2hvdC5wYWdlU3RhdGUubGFzdFZpc2l0ZWRQYXRoKSB7XG4gICAgICAgIHJvdXRlci5wdXNoKHNuYXBzaG90LnBhZ2VTdGF0ZS5sYXN0VmlzaXRlZFBhdGgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gc25hcHNob3Q7XG4gICAgfVxuXG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgLy8gQ2xlYXIgdGhlIHNuYXBzaG90ICh1c2VkIGR1cmluZyBsb2dvdXQpXG4gIHN0YXRpYyBjbGVhclNuYXBzaG90KCk6IHZvaWQge1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRoaXMuU1RPUkFHRV9LRVkpO1xuICB9XG59XG5cbi8vIFByZXZlbnQgYWNjaWRlbnRhbCBwYWdlIHVubG9hZFxuZXhwb3J0IGZ1bmN0aW9uIHByZXZlbnRVbmludGVuZGVkUmVmcmVzaChlOiBCZWZvcmVVbmxvYWRFdmVudCkge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGUucmV0dXJuVmFsdWUgPSAnJzsgLy8gUmVxdWlyZWQgZm9yIENocm9tZVxufVxuXG5leHBvcnQgZGVmYXVsdCBTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlcjtcbiJdLCJuYW1lcyI6WyJTdGF0ZU9wZXJhdGlvbkxvY2siLCJTdGF0ZVBlcnNpc3RlbmNlTWFuYWdlciIsImdldFN0b3JlZFN0YXRlIiwiRXJyb3IiLCJTVE9SQUdFX0tFWSIsIk1BWF9TTkFQU0hPVF9BR0UiLCJTVE9SQUdFX1ZFUlNJT04iLCJNQVhfU1RPUkFHRV9TSVpFIiwibG9nIiwibWVzc2FnZSIsImxldmVsIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwibG9nTWVzc2FnZSIsInRvVXBwZXJDYXNlIiwiY29uc29sZSIsIndhcm4iLCJlcnJvciIsImNoZWNrU3RvcmFnZVF1b3RhIiwibmF2aWdhdG9yIiwic3RvcmFnZSIsImVzdGltYXRlIiwidXNhZ2UiLCJxdW90YSIsInVzYWdlUmF0aW8iLCJ0b0ZpeGVkIiwiTWF0aCIsInJvdW5kIiwiY2xlYW51cFN0b3JhZ2UiLCJ0b3RhbFNpemUiLCJpIiwibG9jYWxTdG9yYWdlIiwibGVuZ3RoIiwia2V5IiwidmFsdWUiLCJnZXRJdGVtIiwic2l6ZU1CIiwia2V5c1RvQ2hlY2siLCJzdGFydHNXaXRoIiwiaW5jbHVkZXMiLCJwdXNoIiwia2V5c1dpdGhUaW1lIiwibWFwIiwic2Vzc2lvbklkIiwiU3RyaW5nIiwicmVwbGFjZSIsImxhc3RTeW5jZWQiLCJnZXRUaW1lIiwic29ydCIsImEiLCJiIiwiaXRlbXNUb1JlbW92ZSIsImNlaWwiLCJyZW1vdmVJdGVtIiwic25hcHNob3QiLCJwYXJzZWRTbmFwc2hvdCIsIkpTT04iLCJwYXJzZSIsImNoYXRDb250ZXh0IiwibWVzc2FnZXMiLCJzbGljZSIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJlIiwidmFsaWRhdGVTbmFwc2hvdFNjaGVtYSIsInJlcXVpcmVkT2JqZWN0cyIsIm9iaiIsImNyZWF0ZUJhY2t1cCIsImN1cnJlbnRTbmFwc2hvdCIsImNhcHR1cmVTbmFwc2hvdCIsInBhcnRpYWxTdGF0ZSIsImxvY2tJZCIsImFjcXVpcmVMb2NrIiwiaXNTdG9yYWdlQXZhaWxhYmxlIiwicXVvdGFPayIsImV4aXN0aW5nU25hcHNob3QiLCJyZXRyaWV2ZVNuYXBzaG90IiwibmV3U25hcHNob3QiLCJub3ciLCJ2ZXJzaW9uIiwidXNlclNlc3Npb24iLCJwYWdlU3RhdGUiLCJ3aWRnZXRTdGF0ZXMiLCJzdG9yYWdlRXJyb3IiLCJtaW5pbWFsU25hcHNob3QiLCJjdXJyZW50Q29udmVyc2F0aW9uSWQiLCJsYXN0VmlzaXRlZFBhdGgiLCJyZWxlYXNlTG9jayIsInRlc3RLZXkiLCJ2YWxpZGF0ZVNuYXBzaG90IiwiY3VycmVudFRpbWUiLCJzbmFwc2hvdEFnZSIsImlzTG9ja2VkIiwiYXR0ZW1wdFNuYXBzaG90UmVjb3ZlcnkiLCJwYXJzZUVycm9yIiwiYmFja3VwU25hcHNob3QiLCJwYXJzZWRCYWNrdXAiLCJyZWNvdmVyZWRTdGF0ZSIsImFjdGl2ZVNlc3Npb25JZCIsInJlY292ZXJlZCIsImh5ZHJhdGVTdGF0ZSIsInJvdXRlciIsImNsZWFyU25hcHNob3QiLCJwcmV2ZW50VW5pbnRlbmRlZFJlZnJlc2giLCJwcmV2ZW50RGVmYXVsdCIsInJldHVyblZhbHVlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/StatePersistence.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./utils/authUtils.ts":
/*!****************************!*\
  !*** ./utils/authUtils.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   TOKEN_EXPIRY_KEY: () => (/* binding */ TOKEN_EXPIRY_KEY),\n/* harmony export */   TOKEN_KEY: () => (/* binding */ TOKEN_KEY),\n/* harmony export */   addAuthHeaders: () => (/* binding */ addAuthHeaders),\n/* harmony export */   authFetch: () => (/* binding */ authFetch),\n/* harmony export */   clearAuthTokens: () => (/* binding */ clearAuthTokens),\n/* harmony export */   getAuthToken: () => (/* binding */ getAuthToken),\n/* harmony export */   getTokenExpiry: () => (/* binding */ getTokenExpiry),\n/* harmony export */   isTokenExpired: () => (/* binding */ isTokenExpired),\n/* harmony export */   storeAuthToken: () => (/* binding */ storeAuthToken)\n/* harmony export */ });\n/**\n * Authentication Utilities for Grace App\n * \n * Provides standardized token management compatible with the existing auth-utils.js system.\n */ // Token storage constants - exported for consistency across the codebase\nconst TOKEN_KEY = 'grace_token';\nconst TOKEN_EXPIRY_KEY = 'grace_token_expiry';\n// Backward/parallel compatibility: some modules may use this alternate key\nconst ALT_TOKEN_KEY = 'grace_auth_token';\n// Simple mutex to prevent race conditions\nlet tokenMutex = Promise.resolve();\n/**\n * Store authentication token with remember-me preference\n * Uses a mutex to prevent race conditions\n */ async function storeAuthToken(token, rememberMe = false) {\n    if (true) return;\n    // Wait for any existing operation to complete\n    await tokenMutex;\n    // Create a new lock that others will wait for\n    let releaseLock;\n    tokenMutex = new Promise((resolve)=>{\n        releaseLock = resolve;\n    });\n    try {\n        // Clear both to prevent any token conflicts\n        clearAuthTokens();\n        // Store in the appropriate location\n        const storage = rememberMe ? localStorage : sessionStorage;\n        // Write under both keys for compatibility\n        storage.setItem(TOKEN_KEY, token);\n        storage.setItem(ALT_TOKEN_KEY, token);\n        // Set expiry date (24 hours from now)\n        const expiry = new Date();\n        expiry.setHours(expiry.getHours() + 24);\n        storage.setItem(TOKEN_EXPIRY_KEY, expiry.toISOString());\n    } finally{\n        releaseLock();\n    }\n}\n/**\n * Get the current authentication token from storage\n * Checks sessionStorage first, then falls back to localStorage\n */ function getAuthToken() {\n    if (false) {}\n    return null;\n}\n/**\n * Get token expiration date\n */ function getTokenExpiry() {\n    if (false) {}\n    return null;\n}\n/**\n * Check if token is expired\n */ function isTokenExpired() {\n    const expiry = getTokenExpiry();\n    return !expiry || expiry < new Date();\n}\n/**\n * Clear all authentication tokens\n */ function clearAuthTokens() {\n    if (false) {}\n}\n/**\n * Add authorization headers to fetch options\n */ function addAuthHeaders(options = {}) {\n    const token = getAuthToken();\n    const headers = {\n        ...options.headers,\n        'Content-Type': 'application/json'\n    };\n    if (token) {\n        headers['Authorization'] = `Bearer ${token}`;\n    }\n    return {\n        ...options,\n        headers\n    };\n}\n/**\n * Wrapper for fetch with authentication headers\n */ async function authFetch(url, options = {}) {\n    return fetch(url, addAuthHeaders(options));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL2F1dGhVdGlscy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTs7OztDQUlDLEdBRUQseUVBQXlFO0FBQ2xFLE1BQU1BLFlBQVksY0FBYztBQUNoQyxNQUFNQyxtQkFBbUIscUJBQXFCO0FBQ3JELDJFQUEyRTtBQUMzRSxNQUFNQyxnQkFBZ0I7QUFFdEIsMENBQTBDO0FBQzFDLElBQUlDLGFBQWFDLFFBQVFDLE9BQU87QUFFaEM7OztDQUdDLEdBQ00sZUFBZUMsZUFBZUMsS0FBYSxFQUFFQyxhQUFzQixLQUFLO0lBQzdFLElBQUksSUFBNkIsRUFBRTtJQUVuQyw4Q0FBOEM7SUFDOUMsTUFBTUw7SUFFTiw4Q0FBOEM7SUFDOUMsSUFBSU07SUFDSk4sYUFBYSxJQUFJQyxRQUFRQyxDQUFBQTtRQUN2QkksY0FBY0o7SUFDaEI7SUFFQSxJQUFJO1FBQ0YsNENBQTRDO1FBQzVDSztRQUVBLG9DQUFvQztRQUNwQyxNQUFNQyxVQUFVSCxhQUFhSSxlQUFlQztRQUM1QywwQ0FBMEM7UUFDMUNGLFFBQVFHLE9BQU8sQ0FBQ2QsV0FBV087UUFDM0JJLFFBQVFHLE9BQU8sQ0FBQ1osZUFBZUs7UUFFL0Isc0NBQXNDO1FBQ3RDLE1BQU1RLFNBQVMsSUFBSUM7UUFDbkJELE9BQU9FLFFBQVEsQ0FBQ0YsT0FBT0csUUFBUSxLQUFLO1FBQ3BDUCxRQUFRRyxPQUFPLENBQUNiLGtCQUFrQmMsT0FBT0ksV0FBVztJQUN0RCxTQUFVO1FBQ1JWO0lBQ0Y7QUFDRjtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNXO0lBQ2QsSUFBSSxLQUE2QixFQUFFLEVBU2xDO0lBQ0QsT0FBTztBQUNUO0FBRUE7O0NBRUMsR0FDTSxTQUFTRTtJQUNkLElBQUksS0FBNkIsRUFBRSxFQUdsQztJQUNELE9BQU87QUFDVDtBQUVBOztDQUVDLEdBQ00sU0FBU0U7SUFDZCxNQUFNVCxTQUFTTztJQUNmLE9BQU8sQ0FBQ1AsVUFBVUEsU0FBUyxJQUFJQztBQUNqQztBQUVBOztDQUVDLEdBQ00sU0FBU047SUFDZCxJQUFJLEtBQTZCLEVBQUUsRUFRbEM7QUFDSDtBQUVBOztDQUVDLEdBQ00sU0FBU2dCLGVBQWVDLFVBQXVCLENBQUMsQ0FBQztJQUN0RCxNQUFNcEIsUUFBUWE7SUFDZCxNQUFNUSxVQUFVO1FBQ2QsR0FBR0QsUUFBUUMsT0FBTztRQUNsQixnQkFBZ0I7SUFDbEI7SUFFQSxJQUFJckIsT0FBTztRQUNUcUIsT0FBTyxDQUFDLGdCQUFnQixHQUFHLENBQUMsT0FBTyxFQUFFckIsT0FBTztJQUM5QztJQUVBLE9BQU87UUFDTCxHQUFHb0IsT0FBTztRQUNWQztJQUNGO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVDLFVBQVVDLEdBQVcsRUFBRUgsVUFBdUIsQ0FBQyxDQUFDO0lBQ3BFLE9BQU9JLE1BQU1ELEtBQUtKLGVBQWVDO0FBQ25DIiwic291cmNlcyI6WyIvVXNlcnMvd29ua2Fzd29ybGQvRG93bmxvYWRzL2dyYWNlLXByb2plY3Qvc3JjL3VpL3V0aWxzL2F1dGhVdGlscy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEF1dGhlbnRpY2F0aW9uIFV0aWxpdGllcyBmb3IgR3JhY2UgQXBwXG4gKiBcbiAqIFByb3ZpZGVzIHN0YW5kYXJkaXplZCB0b2tlbiBtYW5hZ2VtZW50IGNvbXBhdGlibGUgd2l0aCB0aGUgZXhpc3RpbmcgYXV0aC11dGlscy5qcyBzeXN0ZW0uXG4gKi9cblxuLy8gVG9rZW4gc3RvcmFnZSBjb25zdGFudHMgLSBleHBvcnRlZCBmb3IgY29uc2lzdGVuY3kgYWNyb3NzIHRoZSBjb2RlYmFzZVxuZXhwb3J0IGNvbnN0IFRPS0VOX0tFWSA9ICdncmFjZV90b2tlbic7XG5leHBvcnQgY29uc3QgVE9LRU5fRVhQSVJZX0tFWSA9ICdncmFjZV90b2tlbl9leHBpcnknO1xuLy8gQmFja3dhcmQvcGFyYWxsZWwgY29tcGF0aWJpbGl0eTogc29tZSBtb2R1bGVzIG1heSB1c2UgdGhpcyBhbHRlcm5hdGUga2V5XG5jb25zdCBBTFRfVE9LRU5fS0VZID0gJ2dyYWNlX2F1dGhfdG9rZW4nO1xuXG4vLyBTaW1wbGUgbXV0ZXggdG8gcHJldmVudCByYWNlIGNvbmRpdGlvbnNcbmxldCB0b2tlbk11dGV4ID0gUHJvbWlzZS5yZXNvbHZlKCk7XG5cbi8qKlxuICogU3RvcmUgYXV0aGVudGljYXRpb24gdG9rZW4gd2l0aCByZW1lbWJlci1tZSBwcmVmZXJlbmNlXG4gKiBVc2VzIGEgbXV0ZXggdG8gcHJldmVudCByYWNlIGNvbmRpdGlvbnNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0b3JlQXV0aFRva2VuKHRva2VuOiBzdHJpbmcsIHJlbWVtYmVyTWU6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8dm9pZD4ge1xuICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybjtcbiAgXG4gIC8vIFdhaXQgZm9yIGFueSBleGlzdGluZyBvcGVyYXRpb24gdG8gY29tcGxldGVcbiAgYXdhaXQgdG9rZW5NdXRleDtcbiAgXG4gIC8vIENyZWF0ZSBhIG5ldyBsb2NrIHRoYXQgb3RoZXJzIHdpbGwgd2FpdCBmb3JcbiAgbGV0IHJlbGVhc2VMb2NrOiAoKSA9PiB2b2lkO1xuICB0b2tlbk11dGV4ID0gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgcmVsZWFzZUxvY2sgPSByZXNvbHZlO1xuICB9KTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gQ2xlYXIgYm90aCB0byBwcmV2ZW50IGFueSB0b2tlbiBjb25mbGljdHNcbiAgICBjbGVhckF1dGhUb2tlbnMoKTtcbiAgICBcbiAgICAvLyBTdG9yZSBpbiB0aGUgYXBwcm9wcmlhdGUgbG9jYXRpb25cbiAgICBjb25zdCBzdG9yYWdlID0gcmVtZW1iZXJNZSA/IGxvY2FsU3RvcmFnZSA6IHNlc3Npb25TdG9yYWdlO1xuICAgIC8vIFdyaXRlIHVuZGVyIGJvdGgga2V5cyBmb3IgY29tcGF0aWJpbGl0eVxuICAgIHN0b3JhZ2Uuc2V0SXRlbShUT0tFTl9LRVksIHRva2VuKTtcbiAgICBzdG9yYWdlLnNldEl0ZW0oQUxUX1RPS0VOX0tFWSwgdG9rZW4pO1xuICAgIFxuICAgIC8vIFNldCBleHBpcnkgZGF0ZSAoMjQgaG91cnMgZnJvbSBub3cpXG4gICAgY29uc3QgZXhwaXJ5ID0gbmV3IERhdGUoKTtcbiAgICBleHBpcnkuc2V0SG91cnMoZXhwaXJ5LmdldEhvdXJzKCkgKyAyNCk7XG4gICAgc3RvcmFnZS5zZXRJdGVtKFRPS0VOX0VYUElSWV9LRVksIGV4cGlyeS50b0lTT1N0cmluZygpKTtcbiAgfSBmaW5hbGx5IHtcbiAgICByZWxlYXNlTG9jayEoKTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCB0aGUgY3VycmVudCBhdXRoZW50aWNhdGlvbiB0b2tlbiBmcm9tIHN0b3JhZ2VcbiAqIENoZWNrcyBzZXNzaW9uU3RvcmFnZSBmaXJzdCwgdGhlbiBmYWxscyBiYWNrIHRvIGxvY2FsU3RvcmFnZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXV0aFRva2VuKCk6IHN0cmluZyB8IG51bGwge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBQcmVmZXIgc2Vzc2lvblN0b3JhZ2UgZm9yIGN1cnJlbnQgc2Vzc2lvbiwgdGhlbiBsb2NhbFN0b3JhZ2VcbiAgICAvLyBDaGVjayBib3RoIHByaW1hcnkgYW5kIGFsdGVybmF0ZSBrZXlzXG4gICAgcmV0dXJuIChcbiAgICAgIHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oVE9LRU5fS0VZKSB8fFxuICAgICAgc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShBTFRfVE9LRU5fS0VZKSB8fFxuICAgICAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fS0VZKSB8fFxuICAgICAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oQUxUX1RPS0VOX0tFWSlcbiAgICApO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIEdldCB0b2tlbiBleHBpcmF0aW9uIGRhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFRva2VuRXhwaXJ5KCk6IERhdGUgfCBudWxsIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgY29uc3QgZXhwaXJ5U3RyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fRVhQSVJZX0tFWSkgfHwgc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9FWFBJUllfS0VZKTtcbiAgICByZXR1cm4gZXhwaXJ5U3RyID8gbmV3IERhdGUoZXhwaXJ5U3RyKSA6IG51bGw7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdG9rZW4gaXMgZXhwaXJlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNUb2tlbkV4cGlyZWQoKTogYm9vbGVhbiB7XG4gIGNvbnN0IGV4cGlyeSA9IGdldFRva2VuRXhwaXJ5KCk7XG4gIHJldHVybiAhZXhwaXJ5IHx8IGV4cGlyeSA8IG5ldyBEYXRlKCk7XG59XG5cbi8qKlxuICogQ2xlYXIgYWxsIGF1dGhlbnRpY2F0aW9uIHRva2Vuc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJBdXRoVG9rZW5zKCk6IHZvaWQge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBDbGVhciBmcm9tIGJvdGggc3RvcmFnZSBsb2NhdGlvbnMgdG8gYmUgc2FmZVxuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFRPS0VOX0tFWSk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oQUxUX1RPS0VOX0tFWSk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oVE9LRU5fRVhQSVJZX0tFWSk7XG4gICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShUT0tFTl9LRVkpO1xuICAgIHNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oQUxUX1RPS0VOX0tFWSk7XG4gICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbShUT0tFTl9FWFBJUllfS0VZKTtcbiAgfVxufVxuXG4vKipcbiAqIEFkZCBhdXRob3JpemF0aW9uIGhlYWRlcnMgdG8gZmV0Y2ggb3B0aW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gYWRkQXV0aEhlYWRlcnMob3B0aW9uczogUmVxdWVzdEluaXQgPSB7fSk6IFJlcXVlc3RJbml0IHtcbiAgY29uc3QgdG9rZW4gPSBnZXRBdXRoVG9rZW4oKTtcbiAgY29uc3QgaGVhZGVycyA9IHsgXG4gICAgLi4ub3B0aW9ucy5oZWFkZXJzLFxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gIH07XG4gIFxuICBpZiAodG9rZW4pIHtcbiAgICBoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSBgQmVhcmVyICR7dG9rZW59YDtcbiAgfVxuICBcbiAgcmV0dXJuIHtcbiAgICAuLi5vcHRpb25zLFxuICAgIGhlYWRlcnMsXG4gIH07XG59XG5cbi8qKlxuICogV3JhcHBlciBmb3IgZmV0Y2ggd2l0aCBhdXRoZW50aWNhdGlvbiBoZWFkZXJzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhdXRoRmV0Y2godXJsOiBzdHJpbmcsIG9wdGlvbnM6IFJlcXVlc3RJbml0ID0ge30pOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gIHJldHVybiBmZXRjaCh1cmwsIGFkZEF1dGhIZWFkZXJzKG9wdGlvbnMpKTtcbn1cblxuIl0sIm5hbWVzIjpbIlRPS0VOX0tFWSIsIlRPS0VOX0VYUElSWV9LRVkiLCJBTFRfVE9LRU5fS0VZIiwidG9rZW5NdXRleCIsIlByb21pc2UiLCJyZXNvbHZlIiwic3RvcmVBdXRoVG9rZW4iLCJ0b2tlbiIsInJlbWVtYmVyTWUiLCJyZWxlYXNlTG9jayIsImNsZWFyQXV0aFRva2VucyIsInN0b3JhZ2UiLCJsb2NhbFN0b3JhZ2UiLCJzZXNzaW9uU3RvcmFnZSIsInNldEl0ZW0iLCJleHBpcnkiLCJEYXRlIiwic2V0SG91cnMiLCJnZXRIb3VycyIsInRvSVNPU3RyaW5nIiwiZ2V0QXV0aFRva2VuIiwiZ2V0SXRlbSIsImdldFRva2VuRXhwaXJ5IiwiZXhwaXJ5U3RyIiwiaXNUb2tlbkV4cGlyZWQiLCJyZW1vdmVJdGVtIiwiYWRkQXV0aEhlYWRlcnMiLCJvcHRpb25zIiwiaGVhZGVycyIsImF1dGhGZXRjaCIsInVybCIsImZldGNoIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/authUtils.ts\n");

/***/ }),

/***/ "(pages-dir-node)/./utils/devAuth.ts":
/*!**************************!*\
  !*** ./utils/devAuth.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bypassLogin: () => (/* binding */ bypassLogin),\n/* harmony export */   getAdminAuthData: () => (/* binding */ getAdminAuthData),\n/* harmony export */   hasAdminBypass: () => (/* binding */ hasAdminBypass)\n/* harmony export */ });\n/* harmony import */ var _authUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./authUtils */ \"(pages-dir-node)/./utils/authUtils.ts\");\n/**\n * Grace Admin Access Utilities\n * \n * This file contains the admin backdoor mechanism that provides\n * immediate access to the Grace interface with full privileges.\n */ \n// Admin user credentials with full access permissions\nconst ADMIN_USER = {\n    id: 'admin-kdot-id',\n    username: 'kdot',\n    email: 'kmanjo11@gmail.com',\n    role: 'admin',\n    permissions: [\n        'ALL'\n    ],\n    wallets: [],\n    settings: {\n        theme: 'dark',\n        notifications: true\n    }\n};\n// Admin authentication token (extremely long-lived - 10 years)\n// This is a properly formatted JWT that should pass validation checks\nconst ADMIN_TOKEN = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhZG1pbi1rZG90LWlkIiwidXNlcm5hbWUiOiJrZG90IiwiZW1haWwiOiJrbWFuam8xMUBnbWFpbC5jb20iLCJyb2xlIjoiYWRtaW4iLCJwZXJtaXNzaW9ucyI6WyJBTEwiXSwiZXhwIjoxOTAwMDAwMDAwLCJpYXQiOjE1ODAwMDAwMDB9.p58K8xzT2BEuBRKgNUMTdbzHRhPgpnL_q91qfm8qRCk';\n/**\n * Check for admin backdoor query parameter\n */ const hasAdminBypass = ()=>{\n    const urlParams = new URLSearchParams(window.location.search);\n    // Secret parameter with a specific value for added security\n    return urlParams.get('xmaster') === 'kdotaccess';\n};\n/**\n * Create admin authentication data\n */ const getAdminAuthData = ()=>{\n    return {\n        token: ADMIN_TOKEN,\n        user: ADMIN_USER,\n        remember_me: true\n    };\n};\n/**\n * Bypass normal login for admin user with all access privileges\n * \n * @param loginFunction The real login function from AuthContext\n */ const bypassLogin = (loginFunction)=>{\n    try {\n        // Get admin credentials and token\n        const adminAuthData = getAdminAuthData();\n        if (adminAuthData) {\n            console.info(' Using admin master access');\n            // Ensure the token is stored in BOTH localStorage and sessionStorage\n            // This guarantees it will be found regardless of which storage is checked\n            localStorage.setItem('grace_token', adminAuthData.token);\n            sessionStorage.setItem('grace_token', adminAuthData.token);\n            // Set a very far future expiry to prevent token timeout\n            const farFuture = new Date();\n            farFuture.setFullYear(farFuture.getFullYear() + 10); // 10 years in the future\n            localStorage.setItem('grace_token_expiry', farFuture.toISOString());\n            sessionStorage.setItem('grace_token_expiry', farFuture.toISOString());\n            // Use the standard auth function to store properly\n            (0,_authUtils__WEBPACK_IMPORTED_MODULE_0__.storeAuthToken)(adminAuthData.token, true);\n            // Call the real login function with our admin data\n            loginFunction(adminAuthData);\n            // Store a flag indicating we're using admin mode\n            localStorage.setItem('grace_admin_mode', 'true');\n        }\n    } catch (error) {\n        console.error('Admin access failed:', error);\n        // Fallback direct storage in case of error\n        const adminAuthData = getAdminAuthData();\n        localStorage.setItem('grace_token', adminAuthData.token);\n        localStorage.setItem('grace_admin_mode', 'true');\n        window.location.reload(); // Force reload to retry auth\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS8uL3V0aWxzL2RldkF1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOzs7OztDQUtDLEdBRTRDO0FBRTdDLHNEQUFzRDtBQUN0RCxNQUFNQyxhQUFhO0lBQ2pCQyxJQUFJO0lBQ0pDLFVBQVU7SUFDVkMsT0FBTztJQUNQQyxNQUFNO0lBQ05DLGFBQWE7UUFBQztLQUFNO0lBQ3BCQyxTQUFTLEVBQUU7SUFDWEMsVUFBVTtRQUNSQyxPQUFPO1FBQ1BDLGVBQWU7SUFDakI7QUFDRjtBQUVBLCtEQUErRDtBQUMvRCxzRUFBc0U7QUFDdEUsTUFBTUMsY0FBYztBQUVwQjs7Q0FFQyxHQUNNLE1BQU1DLGlCQUFpQjtJQUM1QixNQUFNQyxZQUFZLElBQUlDLGdCQUFnQkMsT0FBT0MsUUFBUSxDQUFDQyxNQUFNO0lBQzVELDREQUE0RDtJQUM1RCxPQUFPSixVQUFVSyxHQUFHLENBQUMsZUFBZTtBQUN0QyxFQUFFO0FBRUY7O0NBRUMsR0FDTSxNQUFNQyxtQkFBbUI7SUFDOUIsT0FBTztRQUNMQyxPQUFPVDtRQUNQVSxNQUFNcEI7UUFDTnFCLGFBQWE7SUFDZjtBQUNGLEVBQUU7QUFFRjs7OztDQUlDLEdBQ00sTUFBTUMsY0FBYyxDQUFDQztJQUMxQixJQUFJO1FBQ0Ysa0NBQWtDO1FBQ2xDLE1BQU1DLGdCQUFnQk47UUFFdEIsSUFBSU0sZUFBZTtZQUNqQkMsUUFBUUMsSUFBSSxDQUFDO1lBRWIscUVBQXFFO1lBQ3JFLDBFQUEwRTtZQUMxRUMsYUFBYUMsT0FBTyxDQUFDLGVBQWVKLGNBQWNMLEtBQUs7WUFDdkRVLGVBQWVELE9BQU8sQ0FBQyxlQUFlSixjQUFjTCxLQUFLO1lBRXpELHdEQUF3RDtZQUN4RCxNQUFNVyxZQUFZLElBQUlDO1lBQ3RCRCxVQUFVRSxXQUFXLENBQUNGLFVBQVVHLFdBQVcsS0FBSyxLQUFLLHlCQUF5QjtZQUM5RU4sYUFBYUMsT0FBTyxDQUFDLHNCQUFzQkUsVUFBVUksV0FBVztZQUNoRUwsZUFBZUQsT0FBTyxDQUFDLHNCQUFzQkUsVUFBVUksV0FBVztZQUVsRSxtREFBbUQ7WUFDbkRuQywwREFBY0EsQ0FBQ3lCLGNBQWNMLEtBQUssRUFBRTtZQUVwQyxtREFBbUQ7WUFDbkRJLGNBQWNDO1lBRWQsaURBQWlEO1lBQ2pERyxhQUFhQyxPQUFPLENBQUMsb0JBQW9CO1FBQzNDO0lBQ0YsRUFBRSxPQUFPTyxPQUFPO1FBQ2RWLFFBQVFVLEtBQUssQ0FBQyx3QkFBd0JBO1FBQ3RDLDJDQUEyQztRQUMzQyxNQUFNWCxnQkFBZ0JOO1FBQ3RCUyxhQUFhQyxPQUFPLENBQUMsZUFBZUosY0FBY0wsS0FBSztRQUN2RFEsYUFBYUMsT0FBTyxDQUFDLG9CQUFvQjtRQUN6Q2QsT0FBT0MsUUFBUSxDQUFDcUIsTUFBTSxJQUFJLDZCQUE2QjtJQUN6RDtBQUNGLEVBQUUiLCJzb3VyY2VzIjpbIi9Vc2Vycy93b25rYXN3b3JsZC9Eb3dubG9hZHMvZ3JhY2UtcHJvamVjdC9zcmMvdWkvdXRpbHMvZGV2QXV0aC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEdyYWNlIEFkbWluIEFjY2VzcyBVdGlsaXRpZXNcbiAqIFxuICogVGhpcyBmaWxlIGNvbnRhaW5zIHRoZSBhZG1pbiBiYWNrZG9vciBtZWNoYW5pc20gdGhhdCBwcm92aWRlc1xuICogaW1tZWRpYXRlIGFjY2VzcyB0byB0aGUgR3JhY2UgaW50ZXJmYWNlIHdpdGggZnVsbCBwcml2aWxlZ2VzLlxuICovXG5cbmltcG9ydCB7IHN0b3JlQXV0aFRva2VuIH0gZnJvbSAnLi9hdXRoVXRpbHMnO1xuXG4vLyBBZG1pbiB1c2VyIGNyZWRlbnRpYWxzIHdpdGggZnVsbCBhY2Nlc3MgcGVybWlzc2lvbnNcbmNvbnN0IEFETUlOX1VTRVIgPSB7XG4gIGlkOiAnYWRtaW4ta2RvdC1pZCcsXG4gIHVzZXJuYW1lOiAna2RvdCcsXG4gIGVtYWlsOiAna21hbmpvMTFAZ21haWwuY29tJyxcbiAgcm9sZTogJ2FkbWluJyxcbiAgcGVybWlzc2lvbnM6IFsnQUxMJ10sXG4gIHdhbGxldHM6IFtdLCAvLyBXaWxsIGJlIHBvcHVsYXRlZCBieSB0aGUgYXBwXG4gIHNldHRpbmdzOiB7XG4gICAgdGhlbWU6ICdkYXJrJyxcbiAgICBub3RpZmljYXRpb25zOiB0cnVlXG4gIH1cbn07XG5cbi8vIEFkbWluIGF1dGhlbnRpY2F0aW9uIHRva2VuIChleHRyZW1lbHkgbG9uZy1saXZlZCAtIDEwIHllYXJzKVxuLy8gVGhpcyBpcyBhIHByb3Blcmx5IGZvcm1hdHRlZCBKV1QgdGhhdCBzaG91bGQgcGFzcyB2YWxpZGF0aW9uIGNoZWNrc1xuY29uc3QgQURNSU5fVE9LRU4gPSAnZXlKaGJHY2lPaUpJVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SnpkV0lpT2lKaFpHMXBiaTFyWkc5MExXbGtJaXdpZFhObGNtNWhiV1VpT2lKclpHOTBJaXdpWlcxaGFXd2lPaUpyYldGdWFtOHhNVUJuYldGcGJDNWpiMjBpTENKeWIyeGxJam9pWVdSdGFXNGlMQ0p3WlhKdGFYTnphVzl1Y3lJNld5SkJURXdpWFN3aVpYaHdJam94T1RBd01EQXdNREF3TENKcFlYUWlPakUxT0RBd01EQXdNREI5LnA1OEs4eHpUMkJFdUJSS2dOVU1UZGJ6SFJoUGdwbkxfcTkxcWZtOHFSQ2snOyBcblxuLyoqXG4gKiBDaGVjayBmb3IgYWRtaW4gYmFja2Rvb3IgcXVlcnkgcGFyYW1ldGVyXG4gKi9cbmV4cG9ydCBjb25zdCBoYXNBZG1pbkJ5cGFzcyA9ICgpOiBib29sZWFuID0+IHtcbiAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcbiAgLy8gU2VjcmV0IHBhcmFtZXRlciB3aXRoIGEgc3BlY2lmaWMgdmFsdWUgZm9yIGFkZGVkIHNlY3VyaXR5XG4gIHJldHVybiB1cmxQYXJhbXMuZ2V0KCd4bWFzdGVyJykgPT09ICdrZG90YWNjZXNzJztcbn07XG5cbi8qKlxuICogQ3JlYXRlIGFkbWluIGF1dGhlbnRpY2F0aW9uIGRhdGFcbiAqL1xuZXhwb3J0IGNvbnN0IGdldEFkbWluQXV0aERhdGEgPSAoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgdG9rZW46IEFETUlOX1RPS0VOLFxuICAgIHVzZXI6IEFETUlOX1VTRVIsXG4gICAgcmVtZW1iZXJfbWU6IHRydWVcbiAgfTtcbn07XG5cbi8qKlxuICogQnlwYXNzIG5vcm1hbCBsb2dpbiBmb3IgYWRtaW4gdXNlciB3aXRoIGFsbCBhY2Nlc3MgcHJpdmlsZWdlc1xuICogXG4gKiBAcGFyYW0gbG9naW5GdW5jdGlvbiBUaGUgcmVhbCBsb2dpbiBmdW5jdGlvbiBmcm9tIEF1dGhDb250ZXh0XG4gKi9cbmV4cG9ydCBjb25zdCBieXBhc3NMb2dpbiA9IChsb2dpbkZ1bmN0aW9uOiAoZGF0YTogYW55KSA9PiB2b2lkKTogdm9pZCA9PiB7XG4gIHRyeSB7XG4gICAgLy8gR2V0IGFkbWluIGNyZWRlbnRpYWxzIGFuZCB0b2tlblxuICAgIGNvbnN0IGFkbWluQXV0aERhdGEgPSBnZXRBZG1pbkF1dGhEYXRhKCk7XG4gICAgXG4gICAgaWYgKGFkbWluQXV0aERhdGEpIHtcbiAgICAgIGNvbnNvbGUuaW5mbygn8J+UkSBVc2luZyBhZG1pbiBtYXN0ZXIgYWNjZXNzJyk7XG4gICAgICBcbiAgICAgIC8vIEVuc3VyZSB0aGUgdG9rZW4gaXMgc3RvcmVkIGluIEJPVEggbG9jYWxTdG9yYWdlIGFuZCBzZXNzaW9uU3RvcmFnZVxuICAgICAgLy8gVGhpcyBndWFyYW50ZWVzIGl0IHdpbGwgYmUgZm91bmQgcmVnYXJkbGVzcyBvZiB3aGljaCBzdG9yYWdlIGlzIGNoZWNrZWRcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdncmFjZV90b2tlbicsIGFkbWluQXV0aERhdGEudG9rZW4pO1xuICAgICAgc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSgnZ3JhY2VfdG9rZW4nLCBhZG1pbkF1dGhEYXRhLnRva2VuKTtcbiAgICAgIFxuICAgICAgLy8gU2V0IGEgdmVyeSBmYXIgZnV0dXJlIGV4cGlyeSB0byBwcmV2ZW50IHRva2VuIHRpbWVvdXRcbiAgICAgIGNvbnN0IGZhckZ1dHVyZSA9IG5ldyBEYXRlKCk7XG4gICAgICBmYXJGdXR1cmUuc2V0RnVsbFllYXIoZmFyRnV0dXJlLmdldEZ1bGxZZWFyKCkgKyAxMCk7IC8vIDEwIHllYXJzIGluIHRoZSBmdXR1cmVcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdncmFjZV90b2tlbl9leHBpcnknLCBmYXJGdXR1cmUudG9JU09TdHJpbmcoKSk7XG4gICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdncmFjZV90b2tlbl9leHBpcnknLCBmYXJGdXR1cmUudG9JU09TdHJpbmcoKSk7XG4gICAgICBcbiAgICAgIC8vIFVzZSB0aGUgc3RhbmRhcmQgYXV0aCBmdW5jdGlvbiB0byBzdG9yZSBwcm9wZXJseVxuICAgICAgc3RvcmVBdXRoVG9rZW4oYWRtaW5BdXRoRGF0YS50b2tlbiwgdHJ1ZSk7XG4gICAgICBcbiAgICAgIC8vIENhbGwgdGhlIHJlYWwgbG9naW4gZnVuY3Rpb24gd2l0aCBvdXIgYWRtaW4gZGF0YVxuICAgICAgbG9naW5GdW5jdGlvbihhZG1pbkF1dGhEYXRhKTtcbiAgICAgIFxuICAgICAgLy8gU3RvcmUgYSBmbGFnIGluZGljYXRpbmcgd2UncmUgdXNpbmcgYWRtaW4gbW9kZVxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2dyYWNlX2FkbWluX21vZGUnLCAndHJ1ZScpO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBZG1pbiBhY2Nlc3MgZmFpbGVkOicsIGVycm9yKTtcbiAgICAvLyBGYWxsYmFjayBkaXJlY3Qgc3RvcmFnZSBpbiBjYXNlIG9mIGVycm9yXG4gICAgY29uc3QgYWRtaW5BdXRoRGF0YSA9IGdldEFkbWluQXV0aERhdGEoKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZ3JhY2VfdG9rZW4nLCBhZG1pbkF1dGhEYXRhLnRva2VuKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZ3JhY2VfYWRtaW5fbW9kZScsICd0cnVlJyk7XG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpOyAvLyBGb3JjZSByZWxvYWQgdG8gcmV0cnkgYXV0aFxuICB9XG59O1xuIl0sIm5hbWVzIjpbInN0b3JlQXV0aFRva2VuIiwiQURNSU5fVVNFUiIsImlkIiwidXNlcm5hbWUiLCJlbWFpbCIsInJvbGUiLCJwZXJtaXNzaW9ucyIsIndhbGxldHMiLCJzZXR0aW5ncyIsInRoZW1lIiwibm90aWZpY2F0aW9ucyIsIkFETUlOX1RPS0VOIiwiaGFzQWRtaW5CeXBhc3MiLCJ1cmxQYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsImdldCIsImdldEFkbWluQXV0aERhdGEiLCJ0b2tlbiIsInVzZXIiLCJyZW1lbWJlcl9tZSIsImJ5cGFzc0xvZ2luIiwibG9naW5GdW5jdGlvbiIsImFkbWluQXV0aERhdGEiLCJjb25zb2xlIiwiaW5mbyIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJzZXNzaW9uU3RvcmFnZSIsImZhckZ1dHVyZSIsIkRhdGUiLCJzZXRGdWxsWWVhciIsImdldEZ1bGxZZWFyIiwidG9JU09TdHJpbmciLCJlcnJvciIsInJlbG9hZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/./utils/devAuth.ts\n");

/***/ }),

/***/ "(pages-dir-node)/__barrel_optimize__?names=ArrowPathIcon,ArrowPathRoundedSquareIcon,Cog6ToothIcon,HeartIcon,PlusIcon,TrashIcon!=!./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/index.js":
/*!**************************************************************************************************************************************************************************************************************************************!*\
  !*** __barrel_optimize__?names=ArrowPathIcon,ArrowPathRoundedSquareIcon,Cog6ToothIcon,HeartIcon,PlusIcon,TrashIcon!=!./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/index.js ***!
  \**************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ArrowPathIcon: () => (/* reexport safe */ _ArrowPathIcon_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"]),\n/* harmony export */   ArrowPathRoundedSquareIcon: () => (/* reexport safe */ _ArrowPathRoundedSquareIcon_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"]),\n/* harmony export */   Cog6ToothIcon: () => (/* reexport safe */ _Cog6ToothIcon_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"]),\n/* harmony export */   HeartIcon: () => (/* reexport safe */ _HeartIcon_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"]),\n/* harmony export */   PlusIcon: () => (/* reexport safe */ _PlusIcon_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"]),\n/* harmony export */   TrashIcon: () => (/* reexport safe */ _TrashIcon_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"])\n/* harmony export */ });\n/* harmony import */ var _ArrowPathIcon_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ArrowPathIcon.js */ \"(pages-dir-node)/./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/ArrowPathIcon.js\");\n/* harmony import */ var _ArrowPathRoundedSquareIcon_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ArrowPathRoundedSquareIcon.js */ \"(pages-dir-node)/./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/ArrowPathRoundedSquareIcon.js\");\n/* harmony import */ var _Cog6ToothIcon_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Cog6ToothIcon.js */ \"(pages-dir-node)/./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/Cog6ToothIcon.js\");\n/* harmony import */ var _HeartIcon_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./HeartIcon.js */ \"(pages-dir-node)/./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/HeartIcon.js\");\n/* harmony import */ var _PlusIcon_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./PlusIcon.js */ \"(pages-dir-node)/./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/PlusIcon.js\");\n/* harmony import */ var _TrashIcon_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TrashIcon.js */ \"(pages-dir-node)/./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/TrashIcon.js\");\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS9fX2JhcnJlbF9vcHRpbWl6ZV9fP25hbWVzPUFycm93UGF0aEljb24sQXJyb3dQYXRoUm91bmRlZFNxdWFyZUljb24sQ29nNlRvb3RoSWNvbixIZWFydEljb24sUGx1c0ljb24sVHJhc2hJY29uIT0hLi9ub2RlX21vZHVsZXMvLnBucG0vQGhlcm9pY29ucytyZWFjdEAyLjIuMF9yZWFjdEAxOS4xLjEvbm9kZV9tb2R1bGVzL0BoZXJvaWNvbnMvcmVhY3QvMjQvb3V0bGluZS9lc20vaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUM2RDtBQUMwQjtBQUMxQjtBQUNSO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy93b25rYXN3b3JsZC9Eb3dubG9hZHMvZ3JhY2UtcHJvamVjdC9zcmMvdWkvbm9kZV9tb2R1bGVzLy5wbnBtL0BoZXJvaWNvbnMrcmVhY3RAMi4yLjBfcmVhY3RAMTkuMS4xL25vZGVfbW9kdWxlcy9AaGVyb2ljb25zL3JlYWN0LzI0L291dGxpbmUvZXNtL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuZXhwb3J0IHsgZGVmYXVsdCBhcyBBcnJvd1BhdGhJY29uIH0gZnJvbSBcIi4vQXJyb3dQYXRoSWNvbi5qc1wiXG5leHBvcnQgeyBkZWZhdWx0IGFzIEFycm93UGF0aFJvdW5kZWRTcXVhcmVJY29uIH0gZnJvbSBcIi4vQXJyb3dQYXRoUm91bmRlZFNxdWFyZUljb24uanNcIlxuZXhwb3J0IHsgZGVmYXVsdCBhcyBDb2c2VG9vdGhJY29uIH0gZnJvbSBcIi4vQ29nNlRvb3RoSWNvbi5qc1wiXG5leHBvcnQgeyBkZWZhdWx0IGFzIEhlYXJ0SWNvbiB9IGZyb20gXCIuL0hlYXJ0SWNvbi5qc1wiXG5leHBvcnQgeyBkZWZhdWx0IGFzIFBsdXNJY29uIH0gZnJvbSBcIi4vUGx1c0ljb24uanNcIlxuZXhwb3J0IHsgZGVmYXVsdCBhcyBUcmFzaEljb24gfSBmcm9tIFwiLi9UcmFzaEljb24uanNcIiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/__barrel_optimize__?names=ArrowPathIcon,ArrowPathRoundedSquareIcon,Cog6ToothIcon,HeartIcon,PlusIcon,TrashIcon!=!./node_modules/.pnpm/@heroicons+react@2.2.0_react@19.1.1/node_modules/@heroicons/react/24/outline/esm/index.js\n");

/***/ }),

/***/ "(pages-dir-node)/__barrel_optimize__?names=Dialog,Transition!=!./node_modules/.pnpm/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/@headlessui/react/dist/headlessui.esm.js":
/*!****************************************************************************************************************************************************************************************************!*\
  !*** __barrel_optimize__?names=Dialog,Transition!=!./node_modules/.pnpm/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/@headlessui/react/dist/headlessui.esm.js ***!
  \****************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Dialog: () => (/* reexport safe */ _Users_wonkasworld_Downloads_grace_project_src_ui_node_modules_pnpm_headlessui_react_2_2_7_react_dom_19_1_1_react_19_1_1_react_19_1_1_node_modules_headlessui_react_dist_components_dialog_dialog_js__WEBPACK_IMPORTED_MODULE_0__.Dialog),\n/* harmony export */   Transition: () => (/* reexport safe */ _Users_wonkasworld_Downloads_grace_project_src_ui_node_modules_pnpm_headlessui_react_2_2_7_react_dom_19_1_1_react_19_1_1_react_19_1_1_node_modules_headlessui_react_dist_components_transition_transition_js__WEBPACK_IMPORTED_MODULE_1__.Transition)\n/* harmony export */ });\n/* harmony import */ var _Users_wonkasworld_Downloads_grace_project_src_ui_node_modules_pnpm_headlessui_react_2_2_7_react_dom_19_1_1_react_19_1_1_react_19_1_1_node_modules_headlessui_react_dist_components_dialog_dialog_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/.pnpm/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/@headlessui/react/dist/components/dialog/dialog.js */ \"(pages-dir-node)/./node_modules/.pnpm/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/@headlessui/react/dist/components/dialog/dialog.js\");\n/* harmony import */ var _Users_wonkasworld_Downloads_grace_project_src_ui_node_modules_pnpm_headlessui_react_2_2_7_react_dom_19_1_1_react_19_1_1_react_19_1_1_node_modules_headlessui_react_dist_components_transition_transition_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./node_modules/.pnpm/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/@headlessui/react/dist/components/transition/transition.js */ \"(pages-dir-node)/./node_modules/.pnpm/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/@headlessui/react/dist/components/transition/transition.js\");\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHBhZ2VzLWRpci1ub2RlKS9fX2JhcnJlbF9vcHRpbWl6ZV9fP25hbWVzPURpYWxvZyxUcmFuc2l0aW9uIT0hLi9ub2RlX21vZHVsZXMvLnBucG0vQGhlYWRsZXNzdWkrcmVhY3RAMi4yLjdfcmVhY3QtZG9tQDE5LjEuMV9yZWFjdEAxOS4xLjFfX3JlYWN0QDE5LjEuMS9ub2RlX21vZHVsZXMvQGhlYWRsZXNzdWkvcmVhY3QvZGlzdC9oZWFkbGVzc3VpLmVzbS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUNpTyIsInNvdXJjZXMiOlsiL1VzZXJzL3dvbmthc3dvcmxkL0Rvd25sb2Fkcy9ncmFjZS1wcm9qZWN0L3NyYy91aS9ub2RlX21vZHVsZXMvLnBucG0vQGhlYWRsZXNzdWkrcmVhY3RAMi4yLjdfcmVhY3QtZG9tQDE5LjEuMV9yZWFjdEAxOS4xLjFfX3JlYWN0QDE5LjEuMS9ub2RlX21vZHVsZXMvQGhlYWRsZXNzdWkvcmVhY3QvZGlzdC9oZWFkbGVzc3VpLmVzbS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCB7IERpYWxvZyB9IGZyb20gXCIvVXNlcnMvd29ua2Fzd29ybGQvRG93bmxvYWRzL2dyYWNlLXByb2plY3Qvc3JjL3VpL25vZGVfbW9kdWxlcy8ucG5wbS9AaGVhZGxlc3N1aStyZWFjdEAyLjIuN19yZWFjdC1kb21AMTkuMS4xX3JlYWN0QDE5LjEuMV9fcmVhY3RAMTkuMS4xL25vZGVfbW9kdWxlcy9AaGVhZGxlc3N1aS9yZWFjdC9kaXN0L2NvbXBvbmVudHMvZGlhbG9nL2RpYWxvZy5qc1wiXG5leHBvcnQgeyBUcmFuc2l0aW9uIH0gZnJvbSBcIi9Vc2Vycy93b25rYXN3b3JsZC9Eb3dubG9hZHMvZ3JhY2UtcHJvamVjdC9zcmMvdWkvbm9kZV9tb2R1bGVzLy5wbnBtL0BoZWFkbGVzc3VpK3JlYWN0QDIuMi43X3JlYWN0LWRvbUAxOS4xLjFfcmVhY3RAMTkuMS4xX19yZWFjdEAxOS4xLjEvbm9kZV9tb2R1bGVzL0BoZWFkbGVzc3VpL3JlYWN0L2Rpc3QvY29tcG9uZW50cy90cmFuc2l0aW9uL3RyYW5zaXRpb24uanNcIiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(pages-dir-node)/__barrel_optimize__?names=Dialog,Transition!=!./node_modules/.pnpm/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/@headlessui/react/dist/headlessui.esm.js\n");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = import("axios");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "next/dist/compiled/next-server/pages.runtime.dev.js":
/*!**********************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages.runtime.dev.js" ***!
  \**********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/pages.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/page-path/normalize-data-path":
/*!*********************************************************************!*\
  !*** external "next/dist/shared/lib/page-path/normalize-data-path" ***!
  \*********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/page-path/normalize-data-path");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/add-path-prefix":
/*!********************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/add-path-prefix" ***!
  \********************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/add-path-prefix");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/format-url":
/*!***************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/format-url" ***!
  \***************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/format-url");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/is-bot":
/*!***********************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/is-bot" ***!
  \***********************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/is-bot");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/remove-trailing-slash":
/*!**************************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/remove-trailing-slash" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/remove-trailing-slash");

/***/ }),

/***/ "next/dist/shared/lib/utils":
/*!*********************************************!*\
  !*** external "next/dist/shared/lib/utils" ***!
  \*********************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/utils");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("react");

/***/ }),

/***/ "react-dom":
/*!****************************!*\
  !*** external "react-dom" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("react-dom");

/***/ }),

/***/ "react-toastify":
/*!*********************************!*\
  !*** external "react-toastify" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = import("react-toastify");;

/***/ }),

/***/ "react/jsx-dev-runtime":
/*!****************************************!*\
  !*** external "react/jsx-dev-runtime" ***!
  \****************************************/
/***/ ((module) => {

"use strict";
module.exports = require("react/jsx-dev-runtime");

/***/ }),

/***/ "react/jsx-runtime":
/*!************************************!*\
  !*** external "react/jsx-runtime" ***!
  \************************************/
/***/ ((module) => {

"use strict";
module.exports = require("react/jsx-runtime");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1","vendor-chunks/@swc+helpers@0.5.15","vendor-chunks/react-toastify@10.0.6_react-dom@19.1.1_react@19.1.1__react@19.1.1","vendor-chunks/@headlessui+react@2.2.7_react-dom@19.1.1_react@19.1.1__react@19.1.1","vendor-chunks/@heroicons+react@2.2.0_react@19.1.1","vendor-chunks/use-sync-external-store@1.5.0_react@19.1.1"], () => (__webpack_exec__("(pages-dir-node)/./node_modules/.pnpm/next@15.4.5_@babel+core@7.28.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES&page=%2Fchat&preferredRegion=&absolutePagePath=.%2Fpages%2Fchat.tsx&absoluteAppPath=private-next-pages%2F_app&absoluteDocumentPath=private-next-pages%2F_document&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();